2024-11-30 13:19:04,709 - INFO - reading batch[0] client 1
2024-11-30 13:19:04,747 - INFO - reading batch[0] client 2
2024-11-30 13:19:04,784 - INFO - reading batch[0] client 3
2024-11-30 13:19:04,832 - INFO - reading batch[0] client 4
2024-11-30 13:19:04,897 - INFO - reading batch[1] client 1
2024-11-30 13:19:04,945 - INFO - reading batch[1] client 2
2024-11-30 13:19:04,994 - INFO - reading batch[1] client 3
2024-11-30 13:19:05,040 - INFO - reading batch[1] client 4
2024-11-30 13:19:05,095 - INFO - reading batch[2] client 1
2024-11-30 13:19:05,141 - INFO - reading batch[2] client 2
2024-11-30 13:19:05,182 - INFO - reading batch[2] client 3
2024-11-30 13:19:05,232 - INFO - reading batch[2] client 4
2024-11-30 13:19:05,280 - INFO - reading batch[3] client 1
2024-11-30 13:19:05,322 - INFO - reading batch[3] client 2
2024-11-30 13:19:05,354 - INFO - reading batch[3] client 3
2024-11-30 13:19:05,400 - INFO - reading batch[3] client 4
2024-11-30 13:19:05,446 - INFO - reading batch[4] client 1
2024-11-30 13:19:05,489 - INFO - reading batch[4] client 2
2024-11-30 13:19:05,534 - INFO - reading batch[4] client 3
2024-11-30 13:19:05,565 - INFO - reading batch[4] client 4
2024-11-30 13:19:05,613 - INFO - reading batch[5] client 1
2024-11-30 13:19:05,653 - INFO - reading batch[5] client 2
2024-11-30 13:19:05,678 - INFO - reading batch[5] client 3
2024-11-30 13:19:05,734 - INFO - reading batch[5] client 4
2024-11-30 13:19:05,768 - INFO - Final partition
2024-11-30 13:19:05,769 - ERROR - loss function:2.3017492294311523
2024-11-30 13:19:05,770 - INFO - reading batch[6] client 1
2024-11-30 13:19:05,814 - INFO - reading batch[6] client 2
2024-11-30 13:19:05,861 - INFO - reading batch[6] client 3
2024-11-30 13:19:05,910 - INFO - reading batch[6] client 4
2024-11-30 13:19:05,957 - INFO - reading batch[7] client 1
2024-11-30 13:19:05,998 - INFO - reading batch[7] client 2
2024-11-30 13:19:06,057 - INFO - reading batch[7] client 3
2024-11-30 13:19:06,087 - INFO - reading batch[7] client 4
2024-11-30 13:19:06,131 - INFO - reading batch[8] client 1
2024-11-30 13:19:06,177 - INFO - reading batch[8] client 2
2024-11-30 13:19:06,210 - INFO - reading batch[8] client 3
2024-11-30 13:19:06,256 - INFO - reading batch[8] client 4
2024-11-30 13:19:06,307 - INFO - reading batch[9] client 1
2024-11-30 13:19:06,348 - INFO - reading batch[9] client 2
2024-11-30 13:19:06,394 - INFO - reading batch[9] client 3
2024-11-30 13:19:06,426 - CRITICAL - we have message type backward
2024-11-30 13:19:06,426 - CRITICAL - calculate backward $4 on client4
2024-11-30 13:19:06,443 - INFO - reading batch[10] client 1
2024-11-30 13:19:06,482 - INFO - reading batch[10] client 2
2024-11-30 13:19:06,510 - INFO - reading batch[10] client 3
2024-11-30 13:19:06,555 - INFO - reading batch[11] client 1
2024-11-30 13:19:06,591 - INFO - reading batch[11] client 2
2024-11-30 13:19:06,635 - INFO - reading batch[11] client 3
2024-11-30 13:19:06,680 - INFO - reading batch[12] client 1
2024-11-30 13:19:06,724 - INFO - reading batch[12] client 2
2024-11-30 13:19:06,755 - INFO - reading batch[12] client 3
2024-11-30 13:19:37,798 - INFO - reading batch[0] client 1
2024-11-30 13:19:37,818 - INFO - reading batch[0] client 2
2024-11-30 13:19:37,843 - INFO - reading batch[0] client 3
2024-11-30 13:19:37,868 - INFO - reading batch[0] client 4
2024-11-30 13:19:37,909 - INFO - reading batch[1] client 1
2024-11-30 13:19:37,936 - INFO - reading batch[1] client 2
2024-11-30 13:19:37,966 - INFO - reading batch[1] client 3
2024-11-30 13:19:37,997 - INFO - reading batch[1] client 4
2024-11-30 13:19:38,033 - INFO - reading batch[2] client 1
2024-11-30 13:19:38,057 - INFO - reading batch[2] client 2
2024-11-30 13:19:38,091 - INFO - reading batch[2] client 3
2024-11-30 13:19:38,122 - INFO - reading batch[2] client 4
2024-11-30 13:19:38,156 - INFO - reading batch[3] client 1
2024-11-30 13:19:38,180 - INFO - reading batch[3] client 2
2024-11-30 13:19:38,197 - INFO - reading batch[3] client 3
2024-11-30 13:19:38,224 - INFO - reading batch[3] client 4
2024-11-30 13:19:38,256 - INFO - reading batch[4] client 1
2024-11-30 13:19:38,282 - INFO - reading batch[4] client 2
2024-11-30 13:19:38,310 - INFO - reading batch[4] client 3
2024-11-30 13:19:38,327 - INFO - reading batch[4] client 4
2024-11-30 13:19:38,357 - INFO - reading batch[5] client 1
2024-11-30 13:19:38,385 - INFO - reading batch[5] client 2
2024-11-30 13:19:38,404 - INFO - reading batch[5] client 3
2024-11-30 13:19:38,437 - INFO - reading batch[5] client 4
2024-11-30 13:19:38,453 - INFO - Final partition
2024-11-30 13:19:38,455 - ERROR - loss function:2.3073854446411133
2024-11-30 13:19:38,456 - INFO - reading batch[6] client 1
2024-11-30 13:19:38,482 - INFO - reading batch[6] client 2
2024-11-30 13:19:38,517 - INFO - reading batch[6] client 3
2024-11-30 13:19:38,555 - INFO - reading batch[6] client 4
2024-11-30 13:19:38,582 - INFO - reading batch[7] client 1
2024-11-30 13:19:38,607 - INFO - reading batch[7] client 2
2024-11-30 13:19:38,639 - INFO - reading batch[7] client 3
2024-11-30 13:19:38,664 - INFO - reading batch[7] client 4
2024-11-30 13:19:38,697 - INFO - reading batch[8] client 1
2024-11-30 13:19:38,729 - INFO - reading batch[8] client 2
2024-11-30 13:19:38,751 - INFO - reading batch[8] client 3
2024-11-30 13:19:38,780 - INFO - reading batch[8] client 4
2024-11-30 13:19:38,814 - INFO - reading batch[9] client 1
2024-11-30 13:19:38,842 - INFO - reading batch[9] client 2
2024-11-30 13:19:38,874 - INFO - reading batch[9] client 3
2024-11-30 13:19:38,901 - INFO - reading batch[10] client 1
2024-11-30 13:19:38,928 - INFO - reading batch[10] client 2
2024-11-30 13:19:38,947 - INFO - reading batch[10] client 3
2024-11-30 13:19:38,978 - INFO - reading batch[11] client 1
2024-11-30 13:19:39,006 - INFO - reading batch[11] client 2
2024-11-30 13:19:39,033 - INFO - reading batch[11] client 3
2024-11-30 13:19:39,067 - INFO - reading batch[12] client 1
2024-11-30 13:19:39,097 - INFO - reading batch[12] client 2
2024-11-30 13:19:39,120 - INFO - reading batch[12] client 3
2024-11-30 13:20:20,425 - INFO - reading batch[0] client 1
2024-11-30 13:20:20,451 - INFO - reading batch[0] client 2
2024-11-30 13:20:20,486 - INFO - reading batch[0] client 3
2024-11-30 13:20:20,510 - INFO - reading batch[0] client 4
2024-11-30 13:20:20,546 - INFO - reading batch[1] client 1
2024-11-30 13:20:20,580 - INFO - reading batch[1] client 2
2024-11-30 13:20:20,609 - INFO - reading batch[1] client 3
2024-11-30 13:20:20,642 - INFO - reading batch[1] client 4
2024-11-30 13:20:20,678 - INFO - reading batch[2] client 1
2024-11-30 13:20:20,713 - INFO - reading batch[2] client 2
2024-11-30 13:20:20,753 - INFO - reading batch[2] client 3
2024-11-30 13:20:20,789 - INFO - reading batch[2] client 4
2024-11-30 13:20:20,823 - INFO - reading batch[3] client 1
2024-11-30 13:20:20,847 - INFO - reading batch[3] client 2
2024-11-30 13:20:20,864 - INFO - reading batch[3] client 3
2024-11-30 13:20:20,896 - INFO - reading batch[3] client 4
2024-11-30 13:20:20,935 - INFO - reading batch[4] client 1
2024-11-30 13:20:20,966 - INFO - reading batch[4] client 2
2024-11-30 13:20:21,001 - INFO - reading batch[4] client 3
2024-11-30 13:20:21,023 - INFO - reading batch[4] client 4
2024-11-30 13:20:21,055 - INFO - reading batch[5] client 1
2024-11-30 13:20:21,082 - INFO - reading batch[5] client 2
2024-11-30 13:20:21,099 - INFO - reading batch[5] client 3
2024-11-30 13:20:21,132 - INFO - reading batch[5] client 4
2024-11-30 13:20:21,148 - INFO - Final partition
2024-11-30 13:20:21,149 - ERROR - loss function:2.290792465209961
2024-11-30 13:20:21,151 - INFO - reading batch[6] client 1
2024-11-30 13:20:21,172 - INFO - reading batch[6] client 2
2024-11-30 13:20:21,203 - INFO - reading batch[6] client 3
2024-11-30 13:20:21,231 - INFO - reading batch[6] client 4
2024-11-30 13:20:21,261 - INFO - reading batch[7] client 1
2024-11-30 13:20:21,286 - INFO - reading batch[7] client 2
2024-11-30 13:20:21,317 - INFO - reading batch[7] client 3
2024-11-30 13:20:21,343 - INFO - reading batch[7] client 4
2024-11-30 13:20:21,402 - INFO - reading batch[8] client 1
2024-11-30 13:20:21,441 - INFO - reading batch[8] client 2
2024-11-30 13:20:21,472 - INFO - reading batch[8] client 3
2024-11-30 13:20:21,513 - INFO - reading batch[8] client 4
2024-11-30 13:20:21,558 - INFO - reading batch[9] client 1
2024-11-30 13:20:21,591 - INFO - reading batch[9] client 2
2024-11-30 13:20:21,626 - INFO - reading batch[9] client 3
2024-11-30 13:20:21,649 - ERROR - backward on partition 4
2024-11-30 13:20:21,652 - CRITICAL - calculate backward $4 on client4
2024-11-30 13:20:21,689 - CRITICAL - new gradient:tensor([[-1.8665e-04, -2.1932e-04,  5.4996e-04,  ..., -8.4299e-05,
         -2.8059e-04,  1.5958e-04],
        [-4.6474e-04,  4.7373e-04, -3.5754e-04,  ..., -3.2084e-04,
         -1.5615e-04, -6.3361e-04],
        [ 4.7528e-04,  2.5860e-04,  2.6462e-04,  ...,  1.5214e-04,
          5.8055e-04, -1.2829e-04],
        ...,
        [-4.5411e-04, -4.3976e-04,  6.9003e-04,  ...,  6.4042e-04,
         -5.8562e-04, -9.9124e-05],
        [ 4.8091e-04,  1.7920e-04, -1.1622e-05,  ..., -3.0395e-04,
          2.1401e-05,  6.8230e-04],
        [ 1.8381e-05,  4.4840e-04, -2.8056e-04,  ...,  3.6340e-04,
          5.4193e-04, -2.4169e-04]]) 
 old gradient:tensor([[ 0.0015,  0.0016,  0.0019,  0.0015,  0.0015, -0.0143,  0.0016,  0.0016,
          0.0014,  0.0017],
        [ 0.0017,  0.0016, -0.0138,  0.0015,  0.0015,  0.0014,  0.0015,  0.0016,
          0.0014,  0.0017],
        [ 0.0016,  0.0016,  0.0018, -0.0140,  0.0014,  0.0014,  0.0016,  0.0016,
          0.0015,  0.0015],
        [ 0.0015,  0.0016,  0.0018,  0.0015,  0.0014,  0.0014,  0.0016, -0.0140,
          0.0014,  0.0016],
        [ 0.0016,  0.0016,  0.0019, -0.0141,  0.0015,  0.0014,  0.0015,  0.0016,
          0.0014,  0.0016],
        [-0.0141,  0.0015,  0.0018,  0.0015,  0.0016,  0.0014,  0.0016,  0.0017,
          0.0014,  0.0017],
        [ 0.0016,  0.0016, -0.0137,  0.0015,  0.0014,  0.0013,  0.0016,  0.0017,
          0.0014,  0.0016],
        [ 0.0016,  0.0016,  0.0019,  0.0015,  0.0015,  0.0014,  0.0016,  0.0016,
          0.0014, -0.0139],
        [ 0.0016,  0.0017, -0.0139,  0.0015,  0.0015,  0.0014,  0.0015,  0.0016,
          0.0014,  0.0016],
        [-0.0140,  0.0015,  0.0018,  0.0015,  0.0015,  0.0013,  0.0016,  0.0017,
          0.0014,  0.0016],
        [ 0.0016,  0.0015,  0.0019,  0.0015,  0.0015,  0.0014, -0.0140,  0.0017,
          0.0014,  0.0017],
        [ 0.0017,  0.0016, -0.0138,  0.0014,  0.0015,  0.0014,  0.0015,  0.0016,
          0.0015,  0.0016],
        [ 0.0016,  0.0015,  0.0019,  0.0015,  0.0015,  0.0013,  0.0016,  0.0017,
          0.0015, -0.0140],
        [ 0.0016,  0.0016,  0.0018,  0.0016,  0.0014,  0.0014,  0.0016, -0.0140,
          0.0014,  0.0016],
        [ 0.0016, -0.0141,  0.0017,  0.0015,  0.0015,  0.0015,  0.0016,  0.0016,
          0.0014,  0.0016],
        [ 0.0015,  0.0015, -0.0137,  0.0015,  0.0015,  0.0015,  0.0016,  0.0017,
          0.0015,  0.0016],
        [ 0.0016,  0.0016,  0.0019, -0.0141,  0.0014,  0.0014,  0.0016,  0.0016,
          0.0014,  0.0016],
        [ 0.0015,  0.0014, -0.0138,  0.0015,  0.0016,  0.0015,  0.0015,  0.0017,
          0.0014,  0.0016],
        [ 0.0016,  0.0015,  0.0019,  0.0015,  0.0015,  0.0015,  0.0015, -0.0140,
          0.0014,  0.0016],
        [ 0.0016, -0.0140,  0.0017,  0.0016,  0.0015,  0.0014,  0.0016,  0.0015,
          0.0014,  0.0016],
        [ 0.0017,  0.0015, -0.0138,  0.0016,  0.0015,  0.0013,  0.0015,  0.0017,
          0.0014,  0.0016],
        [ 0.0016,  0.0016,  0.0020,  0.0015,  0.0014, -0.0142,  0.0016,  0.0016,
          0.0014,  0.0015],
        [-0.0141,  0.0016,  0.0019,  0.0016,  0.0015,  0.0014,  0.0016,  0.0016,
          0.0014,  0.0016],
        [ 0.0017, -0.0141,  0.0017,  0.0015,  0.0016,  0.0014,  0.0016,  0.0016,
          0.0014,  0.0017],
        [ 0.0017,  0.0016,  0.0019,  0.0015,  0.0014,  0.0013,  0.0016,  0.0016,
         -0.0142,  0.0017],
        [ 0.0015,  0.0015,  0.0019,  0.0015,  0.0015, -0.0142,  0.0017,  0.0017,
          0.0013,  0.0017],
        [ 0.0015,  0.0015,  0.0019,  0.0015, -0.0142,  0.0013,  0.0017,  0.0017,
          0.0014,  0.0016],
        [-0.0140,  0.0015,  0.0019,  0.0015,  0.0014,  0.0013,  0.0016,  0.0017,
          0.0014,  0.0016],
        [ 0.0016,  0.0014,  0.0019,  0.0014, -0.0140,  0.0014,  0.0016,  0.0016,
          0.0014,  0.0017],
        [ 0.0016,  0.0016,  0.0019, -0.0141,  0.0014,  0.0014,  0.0016,  0.0016,
          0.0014,  0.0016],
        [ 0.0016,  0.0016,  0.0018,  0.0015,  0.0015,  0.0014,  0.0015,  0.0015,
         -0.0143,  0.0017],
        [ 0.0017,  0.0016,  0.0019,  0.0015,  0.0014,  0.0013,  0.0016,  0.0017,
         -0.0142,  0.0016],
        [ 0.0017,  0.0014,  0.0018,  0.0015,  0.0014,  0.0014, -0.0140,  0.0016,
          0.0014,  0.0016],
        [ 0.0016,  0.0015,  0.0018,  0.0015,  0.0015,  0.0014,  0.0016, -0.0140,
          0.0015,  0.0017],
        [ 0.0014,  0.0016,  0.0019,  0.0015,  0.0015,  0.0014,  0.0016, -0.0140,
          0.0015,  0.0017],
        [ 0.0015,  0.0015,  0.0018,  0.0015,  0.0015,  0.0014, -0.0140,  0.0017,
          0.0014,  0.0016],
        [ 0.0016, -0.0140,  0.0017,  0.0015,  0.0015,  0.0015,  0.0015,  0.0016,
          0.0014,  0.0017],
        [ 0.0015,  0.0016,  0.0018,  0.0015,  0.0015,  0.0014,  0.0016,  0.0015,
          0.0015, -0.0139],
        [ 0.0015,  0.0016,  0.0018,  0.0015,  0.0016,  0.0014,  0.0015, -0.0141,
          0.0015,  0.0016],
        [ 0.0015,  0.0016,  0.0018,  0.0015,  0.0015,  0.0014,  0.0016, -0.0140,
          0.0015,  0.0017],
        [ 0.0015,  0.0016,  0.0019,  0.0015,  0.0015, -0.0143,  0.0016,  0.0016,
          0.0013,  0.0017],
        [ 0.0017,  0.0015, -0.0138,  0.0016,  0.0015,  0.0014,  0.0015,  0.0015,
          0.0015,  0.0016],
        [ 0.0016,  0.0016, -0.0137,  0.0015,  0.0015,  0.0014,  0.0015,  0.0016,
          0.0014,  0.0015],
        [ 0.0016,  0.0016,  0.0018,  0.0016,  0.0015,  0.0015,  0.0015, -0.0141,
          0.0015,  0.0016],
        [ 0.0015,  0.0014,  0.0020,  0.0014,  0.0016,  0.0014,  0.0017,  0.0017,
          0.0014, -0.0140],
        [-0.0141,  0.0016,  0.0018,  0.0016,  0.0015,  0.0013,  0.0017,  0.0015,
          0.0014,  0.0017],
        [ 0.0016,  0.0016,  0.0019,  0.0015,  0.0014,  0.0014,  0.0016,  0.0016,
         -0.0142,  0.0016],
        [ 0.0015,  0.0017,  0.0018, -0.0141,  0.0014,  0.0014,  0.0015,  0.0017,
          0.0014,  0.0017],
        [ 0.0016,  0.0016,  0.0020,  0.0016,  0.0014,  0.0014,  0.0015,  0.0016,
         -0.0142,  0.0016],
        [ 0.0016,  0.0015,  0.0020,  0.0015,  0.0014,  0.0013,  0.0016,  0.0016,
          0.0014, -0.0139],
        [ 0.0015,  0.0016,  0.0017,  0.0015,  0.0016,  0.0015,  0.0015, -0.0141,
          0.0015,  0.0017],
        [ 0.0016,  0.0015, -0.0137,  0.0016,  0.0015,  0.0014,  0.0016,  0.0016,
          0.0014,  0.0017],
        [ 0.0015,  0.0015,  0.0019,  0.0015, -0.0141,  0.0013,  0.0016,  0.0016,
          0.0014,  0.0017],
        [-0.0140,  0.0015,  0.0018,  0.0015,  0.0015,  0.0013,  0.0017,  0.0017,
          0.0015,  0.0016],
        [ 0.0016,  0.0016,  0.0018, -0.0142,  0.0014,  0.0014,  0.0016,  0.0016,
          0.0014,  0.0017],
        [ 0.0016,  0.0016,  0.0018, -0.0141,  0.0015,  0.0014,  0.0015,  0.0016,
          0.0015,  0.0016],
        [ 0.0016, -0.0141,  0.0017,  0.0016,  0.0015,  0.0015,  0.0016,  0.0015,
          0.0014,  0.0016],
        [ 0.0016,  0.0016,  0.0017,  0.0015,  0.0015,  0.0014,  0.0015, -0.0141,
          0.0016,  0.0017],
        [ 0.0016,  0.0015, -0.0139,  0.0015,  0.0016,  0.0014,  0.0015,  0.0016,
          0.0015,  0.0016],
        [ 0.0017,  0.0016,  0.0019,  0.0016,  0.0015,  0.0013,  0.0016,  0.0016,
         -0.0143,  0.0017],
        [ 0.0015,  0.0016,  0.0019,  0.0015,  0.0015, -0.0143,  0.0016,  0.0016,
          0.0014,  0.0017],
        [ 0.0015,  0.0016,  0.0021,  0.0015,  0.0014,  0.0014,  0.0016,  0.0016,
         -0.0142,  0.0015],
        [ 0.0016,  0.0015,  0.0018,  0.0016,  0.0014,  0.0014, -0.0140,  0.0017,
          0.0015,  0.0016],
        [ 0.0016, -0.0140,  0.0018,  0.0015,  0.0015,  0.0014,  0.0016,  0.0016,
          0.0014,  0.0016]])
2024-11-30 13:20:21,709 - INFO - reading batch[9] client 4
2024-11-30 13:20:21,745 - INFO - reading batch[10] client 1
2024-11-30 13:20:21,779 - INFO - reading batch[10] client 2
2024-11-30 13:20:21,799 - INFO - reading batch[10] client 3
2024-11-30 13:20:21,832 - INFO - reading batch[10] client 4
2024-11-30 13:20:21,867 - INFO - reading batch[11] client 1
2024-11-30 13:20:21,891 - INFO - reading batch[11] client 2
2024-11-30 13:20:21,923 - INFO - reading batch[11] client 3
2024-11-30 13:20:21,955 - INFO - reading batch[11] client 4
2024-11-30 13:20:21,987 - INFO - reading batch[12] client 1
2024-11-30 13:20:22,022 - INFO - reading batch[12] client 2
2024-11-30 13:20:22,048 - INFO - reading batch[12] client 3
2024-11-30 13:20:22,065 - INFO - reading batch[12] client 4
2024-11-30 13:20:22,102 - INFO - reading batch[13] client 1
2024-11-30 13:20:22,128 - INFO - reading batch[13] client 2
2024-11-30 13:20:22,164 - INFO - reading batch[13] client 3
2024-11-30 13:20:22,197 - INFO - reading batch[13] client 4
2024-11-30 13:20:22,224 - INFO - reading batch[14] client 1
2024-11-30 13:20:22,253 - INFO - reading batch[14] client 2
2024-11-30 13:20:22,288 - INFO - reading batch[14] client 3
2024-11-30 13:20:22,320 - INFO - reading batch[14] client 4
2024-11-30 13:20:22,353 - INFO - reading batch[15] client 1
2024-11-30 13:20:22,376 - INFO - reading batch[15] client 2
2024-11-30 13:20:22,401 - INFO - reading batch[15] client 3
2024-11-30 13:20:22,420 - INFO - reading batch[15] client 4
2024-11-30 13:20:22,455 - INFO - reading batch[16] client 1
2024-11-30 13:20:22,486 - INFO - reading batch[16] client 2
2024-11-30 13:20:22,522 - INFO - reading batch[16] client 3
2024-11-30 13:20:22,555 - INFO - reading batch[16] client 4
2024-11-30 13:20:22,585 - INFO - reading batch[17] client 1
2024-11-30 13:20:22,610 - INFO - reading batch[17] client 2
2024-11-30 13:20:22,631 - ERROR - backward on partition 3
2024-11-30 13:20:22,638 - CRITICAL - calculate backward $3 on client3
2024-11-30 13:20:22,652 - CRITICAL - new gradient:tensor([[[[-1.9140e-04,  1.7515e-04,  7.9342e-06,  4.5124e-06],
          [-4.6612e-05,  1.0925e-04,  8.2451e-05, -7.1870e-05],
          [-8.9759e-05, -1.4102e-04,  2.0592e-04, -7.4145e-05],
          [-1.2278e-04,  4.7746e-05, -9.6602e-05, -1.6610e-04]],

         [[ 5.6604e-05,  1.1178e-04, -3.1846e-05,  1.0523e-04],
          [ 1.0248e-04, -7.2293e-05,  1.2083e-04, -2.0547e-04],
          [-1.4972e-04, -9.2173e-06,  2.3110e-05,  6.8611e-05],
          [-1.4782e-04, -4.2648e-06,  5.0039e-05, -1.0624e-04]],

         [[-7.4841e-05,  2.5811e-05,  3.5533e-05, -5.9742e-05],
          [ 1.3771e-04, -6.0707e-05,  1.8002e-04,  2.1218e-04],
          [-4.1828e-05, -1.8497e-05,  4.2757e-05, -8.2766e-05],
          [ 1.8397e-05, -1.4870e-04,  1.0979e-04, -7.5069e-06]],

         ...,

         [[-1.2035e-04,  1.9338e-04,  1.2854e-04, -1.3262e-04],
          [ 3.9335e-05, -3.7915e-05,  6.3697e-05,  1.8612e-06],
          [-6.6304e-06, -9.7497e-05,  1.4271e-04,  9.0403e-05],
          [ 2.1090e-04,  3.7005e-05,  8.2423e-05,  9.5455e-06]],

         [[ 3.6412e-05,  1.9712e-04,  4.3104e-05, -1.2043e-04],
          [-1.0941e-04,  1.5606e-05, -6.8180e-06, -2.2645e-04],
          [-1.7334e-04, -5.5845e-05,  4.9315e-06,  1.3644e-04],
          [-1.5017e-04, -1.7454e-05,  5.9032e-05,  1.5963e-04]],

         [[-1.3180e-04,  2.0306e-04,  9.7420e-05,  4.5981e-05],
          [ 9.3998e-05, -9.5886e-05, -3.2468e-05, -1.3105e-04],
          [ 1.1756e-04,  1.8453e-04,  9.6093e-05, -8.7626e-06],
          [ 1.5838e-04, -1.0147e-04, -3.1710e-05, -2.0271e-05]]],


        [[[ 1.2655e-04, -7.5692e-05, -9.9574e-05, -1.6605e-05],
          [-3.2712e-05, -5.1955e-06, -1.4913e-05, -1.3807e-04],
          [ 6.5761e-05,  3.9749e-05,  9.1268e-05, -6.8123e-05],
          [-3.0618e-05,  1.0642e-04, -3.5230e-05,  8.7165e-05]],

         [[ 2.5076e-04,  2.0001e-05,  1.5740e-04, -7.2082e-05],
          [ 3.3746e-05,  1.1116e-05,  2.0873e-04,  1.7655e-04],
          [-6.4657e-05, -1.3615e-04, -8.7920e-05,  4.9968e-05],
          [-1.1018e-04, -5.4809e-05,  1.4213e-04, -2.8491e-04]],

         [[-1.2380e-04, -1.3168e-04,  6.3293e-05,  1.8055e-04],
          [-4.7647e-05, -1.1893e-05, -9.1081e-05, -3.2342e-04],
          [-9.7732e-05, -6.6316e-06, -3.1209e-05, -1.1383e-04],
          [-1.9638e-04,  1.4492e-04,  5.3739e-05,  7.6711e-05]],

         ...,

         [[-9.9096e-05,  3.8528e-05, -6.8121e-05, -1.0975e-04],
          [-1.5131e-04,  9.4415e-05,  3.5936e-05, -2.7517e-05],
          [-1.3721e-04, -4.6087e-05,  7.5696e-05, -9.6743e-05],
          [ 9.3828e-05, -8.5653e-05,  6.8124e-05,  3.9809e-05]],

         [[ 1.1761e-04,  1.0191e-04, -1.7969e-04, -1.2368e-05],
          [ 4.7159e-05,  1.7582e-06, -1.8637e-04, -1.1645e-04],
          [-1.2969e-04,  1.8484e-04,  2.9056e-05,  4.0852e-05],
          [ 1.4379e-05,  3.9235e-05,  6.6542e-05,  5.8290e-05]],

         [[ 5.5185e-05, -1.0104e-04,  2.2393e-04, -1.7540e-04],
          [ 1.0863e-04,  1.9941e-04,  1.0433e-04, -4.2805e-05],
          [-3.9572e-05,  1.4299e-04,  4.5498e-05,  7.2002e-07],
          [ 5.2331e-05, -4.7830e-05, -4.0968e-05,  9.0389e-05]]],


        [[[ 5.1021e-05,  3.8101e-06,  1.1981e-04, -5.5000e-05],
          [-1.5716e-06, -3.4774e-05,  1.0097e-04, -5.1520e-06],
          [ 6.5749e-05, -1.6320e-04,  5.8024e-05,  8.9904e-05],
          [ 1.1467e-04,  8.6611e-05, -4.1536e-05,  8.1639e-05]],

         [[-1.0379e-04, -8.0186e-05,  7.4189e-05,  3.0956e-05],
          [-2.2998e-04,  2.5608e-05,  2.5226e-06,  1.4859e-04],
          [ 4.3625e-05, -1.7719e-04,  4.6932e-05,  7.4735e-05],
          [ 4.5626e-05,  2.8884e-04,  6.8211e-05,  1.3592e-04]],

         [[-2.8111e-05, -3.4536e-05, -1.6245e-06, -1.5684e-04],
          [ 4.1490e-05,  1.8543e-04,  2.8185e-05,  6.7409e-06],
          [ 1.8574e-04,  1.0856e-04,  1.0189e-05,  2.3877e-05],
          [ 5.5289e-06,  5.0486e-05, -1.4397e-04, -1.2140e-05]],

         ...,

         [[-1.3166e-04, -1.6229e-05,  1.0066e-05, -5.8044e-05],
          [-3.7609e-05,  2.9590e-05, -6.7169e-05, -2.6891e-06],
          [ 1.3818e-04, -2.7593e-04,  5.9682e-05, -2.3063e-04],
          [ 2.9783e-05,  2.0729e-05, -9.3133e-05, -1.9492e-05]],

         [[-1.3592e-04, -2.8788e-04,  3.6576e-06,  4.3968e-05],
          [-1.2199e-04, -1.0745e-04,  2.2426e-04, -2.3543e-05],
          [ 1.1980e-04, -4.4396e-05,  6.4797e-05,  3.8501e-05],
          [ 2.0983e-04, -1.8712e-04, -1.1417e-04, -7.9441e-05]],

         [[ 3.4037e-05,  1.0704e-04,  2.2940e-07, -1.5175e-04],
          [ 1.2055e-04,  7.9186e-05,  1.9692e-04, -2.2756e-05],
          [-5.0889e-05,  1.8031e-04, -1.8533e-04, -9.9901e-06],
          [ 4.8618e-05, -1.3585e-05, -1.2242e-04,  8.2888e-05]]],


        ...,


        [[[-1.1318e-04,  1.4361e-04, -1.1351e-04,  7.3680e-05],
          [ 1.8016e-04, -1.3964e-04,  1.4150e-05, -2.2622e-04],
          [ 1.2208e-04,  3.4701e-05,  5.1439e-05,  5.9478e-05],
          [ 1.6615e-04, -3.0554e-04, -1.6966e-04,  9.5881e-05]],

         [[ 1.9326e-04,  1.2974e-04,  5.7006e-05,  1.4405e-04],
          [-6.7195e-06, -1.8905e-05, -3.4497e-05, -1.3471e-04],
          [-8.2089e-05,  9.7301e-05,  1.5548e-05,  9.7582e-05],
          [-1.2750e-04, -1.1440e-04,  5.4708e-05,  1.0436e-04]],

         [[ 8.3277e-05,  1.0399e-04, -5.4379e-05,  3.7173e-05],
          [ 1.9559e-04,  1.4101e-05, -9.5605e-05,  4.9714e-05],
          [-1.8825e-04, -2.7576e-05,  8.0834e-05,  9.2849e-05],
          [ 2.9003e-05, -9.9637e-05, -6.9833e-05, -7.8081e-05]],

         ...,

         [[ 6.6996e-05,  3.1437e-05,  1.9103e-05, -2.7026e-04],
          [ 6.5820e-05,  5.0361e-05,  1.4291e-04,  1.1785e-04],
          [ 1.5382e-04, -1.4316e-04,  2.7644e-06,  1.3269e-04],
          [-1.2468e-04,  4.8159e-06, -1.9841e-05,  1.7583e-04]],

         [[-2.0600e-04, -1.0344e-04,  2.5918e-04, -6.2365e-05],
          [-1.0297e-04, -7.5362e-05,  2.3879e-05,  4.8361e-05],
          [-7.4121e-06,  1.2052e-04, -6.6295e-05,  5.0070e-05],
          [-9.4455e-05,  2.8497e-05, -1.3983e-04,  1.0677e-04]],

         [[-7.1965e-05,  1.4229e-04, -9.8439e-05,  6.7423e-06],
          [-2.5019e-04, -1.4712e-04, -1.4940e-04, -9.9704e-06],
          [ 6.4750e-05,  1.6480e-04, -2.1622e-04,  1.0173e-04],
          [ 2.1926e-04, -3.5826e-05, -2.3947e-04, -8.0186e-06]]],


        [[[-4.6456e-05,  1.3529e-04, -3.8788e-05,  6.7411e-05],
          [ 4.7901e-05,  1.8899e-06, -2.2112e-04,  1.0430e-04],
          [ 7.1426e-05,  1.1969e-05, -9.0901e-05,  2.0936e-04],
          [ 5.7696e-05, -1.9517e-04,  2.4138e-04,  1.2949e-05]],

         [[-1.5742e-04, -1.2652e-04, -1.5367e-04, -2.3074e-05],
          [-3.9636e-05, -1.3765e-04, -3.2160e-05, -1.4954e-04],
          [-1.4679e-05,  1.4093e-04,  4.7931e-05,  1.5518e-04],
          [ 1.7911e-04,  1.1097e-04, -5.6313e-05,  1.5892e-04]],

         [[ 1.0924e-04, -1.2885e-04, -9.5596e-05,  1.2473e-04],
          [-8.7814e-05, -4.2135e-05,  2.9218e-05,  3.9746e-05],
          [-4.8560e-05,  1.5009e-04,  2.1278e-05, -3.5942e-05],
          [ 2.3684e-06,  1.0278e-04,  2.8862e-05,  2.6602e-05]],

         ...,

         [[ 2.8412e-04, -1.6346e-04,  6.8551e-05,  6.5470e-05],
          [ 9.4070e-05,  1.6270e-04,  5.7791e-05,  9.7512e-05],
          [-6.6798e-05, -2.1586e-04, -7.3196e-05, -2.5698e-05],
          [ 3.2031e-07,  3.4360e-05, -3.9292e-05,  6.9736e-06]],

         [[-1.0986e-04, -1.1128e-04, -2.8978e-05, -2.1087e-05],
          [-2.5254e-05,  1.3842e-04,  1.7386e-05, -1.1017e-04],
          [-2.5888e-05,  6.1766e-05,  4.0894e-06,  7.0041e-05],
          [-6.6915e-05, -3.6149e-06, -1.4562e-04, -1.5770e-04]],

         [[-2.0100e-04,  1.5349e-04, -5.7713e-05,  1.8862e-04],
          [-6.8081e-06,  7.8983e-05, -3.4619e-06,  1.8134e-04],
          [ 5.4785e-05, -1.4342e-04, -1.6504e-04, -2.3314e-04],
          [-2.3153e-05,  2.5944e-05,  9.5576e-05, -5.7315e-05]]],


        [[[-2.7139e-05, -6.5672e-05,  2.0614e-04, -5.1671e-05],
          [-8.9794e-06,  1.4953e-04,  9.1944e-05, -3.4053e-05],
          [-6.0947e-05,  1.8400e-04,  1.0173e-04,  1.3452e-06],
          [-3.5763e-05,  7.4290e-06,  6.5431e-05,  1.6007e-04]],

         [[-6.3710e-05, -8.5568e-05, -2.8030e-05,  5.0096e-05],
          [ 6.8380e-05, -2.6731e-05, -1.5135e-04, -1.6468e-04],
          [-1.1460e-04,  1.3266e-04,  7.7507e-06, -5.3448e-05],
          [-4.0247e-05,  1.0611e-04, -1.7618e-05,  1.5176e-04]],

         [[ 1.2217e-04,  1.2068e-05, -2.0281e-05, -1.1712e-04],
          [ 4.9429e-05,  4.9753e-05,  5.0918e-05,  8.1302e-05],
          [-4.1233e-05, -1.5028e-04, -8.1152e-05,  1.6920e-04],
          [-6.7098e-05, -5.9116e-06,  3.8749e-05, -6.5863e-05]],

         ...,

         [[ 2.2277e-05,  2.8512e-05, -7.1677e-06,  7.5737e-05],
          [-1.3066e-04, -9.5339e-07, -2.3189e-04,  7.4771e-05],
          [-3.7948e-05, -6.4456e-05, -1.3017e-05, -7.9997e-06],
          [-1.5857e-04,  7.2711e-05, -1.0327e-04,  2.8688e-05]],

         [[-3.1743e-05, -1.5970e-04, -1.0985e-05,  9.4438e-05],
          [ 1.4120e-04,  1.1423e-04,  2.0929e-04,  1.0504e-04],
          [ 8.3474e-05, -1.3865e-04,  8.6907e-05,  4.5813e-05],
          [-1.9052e-04, -1.3559e-04,  3.6144e-05,  1.6959e-04]],

         [[ 5.5360e-05, -1.6229e-05, -1.3377e-04, -4.6891e-05],
          [-1.4226e-05, -1.7781e-04, -7.8381e-05, -4.2155e-05],
          [ 5.7167e-05, -8.7494e-05,  9.0286e-05, -5.8426e-05],
          [ 3.1902e-05, -1.6134e-04, -1.5028e-04,  9.4233e-05]]]]) 
 old gradient:tensor([[-1.8665e-04, -2.1932e-04,  5.4996e-04,  ..., -8.4299e-05,
         -2.8059e-04,  1.5958e-04],
        [-4.6474e-04,  4.7373e-04, -3.5754e-04,  ..., -3.2084e-04,
         -1.5615e-04, -6.3361e-04],
        [ 4.7528e-04,  2.5860e-04,  2.6462e-04,  ...,  1.5214e-04,
          5.8055e-04, -1.2829e-04],
        ...,
        [-4.5411e-04, -4.3976e-04,  6.9003e-04,  ...,  6.4042e-04,
         -5.8562e-04, -9.9124e-05],
        [ 4.8091e-04,  1.7920e-04, -1.1622e-05,  ..., -3.0395e-04,
          2.1401e-05,  6.8230e-04],
        [ 1.8381e-05,  4.4840e-04, -2.8056e-04,  ...,  3.6340e-04,
          5.4193e-04, -2.4169e-04]])
2024-11-30 13:20:22,677 - INFO - reading batch[17] client 3
2024-11-30 13:20:22,713 - INFO - reading batch[17] client 4
2024-11-30 13:20:22,746 - INFO - reading batch[18] client 1
2024-11-30 13:20:22,767 - INFO - reading batch[18] client 2
2024-11-30 13:20:22,787 - INFO - reading batch[18] client 3
2024-11-30 13:20:22,810 - INFO - reading batch[18] client 4
2024-11-30 13:20:22,840 - INFO - reading batch[19] client 1
2024-11-30 13:20:22,872 - INFO - reading batch[19] client 2
2024-11-30 13:20:22,900 - INFO - reading batch[19] client 3
2024-11-30 13:20:22,931 - INFO - reading batch[19] client 4
2024-11-30 13:20:22,960 - INFO - reading batch[20] client 1
2024-11-30 13:20:22,982 - INFO - reading batch[20] client 2
2024-11-30 13:20:23,005 - INFO - reading batch[20] client 3
2024-11-30 13:20:23,032 - INFO - reading batch[20] client 4
2024-11-30 13:20:23,050 - INFO - Final partition
2024-11-30 13:20:23,050 - ERROR - loss function:2.3018312454223633
2024-11-30 13:20:23,051 - INFO - reading batch[21] client 1
2024-11-30 13:20:23,078 - INFO - reading batch[21] client 2
2024-11-30 13:20:23,115 - INFO - reading batch[21] client 3
2024-11-30 13:20:23,145 - INFO - reading batch[21] client 4
2024-11-30 13:20:23,176 - INFO - reading batch[22] client 1
2024-11-30 13:20:23,205 - INFO - reading batch[22] client 2
2024-11-30 13:20:23,233 - INFO - reading batch[22] client 3
2024-11-30 13:20:23,250 - INFO - reading batch[22] client 4
2024-11-30 13:20:23,284 - INFO - reading batch[23] client 1
2024-11-30 13:20:23,312 - INFO - reading batch[23] client 2
2024-11-30 13:20:23,333 - INFO - Final partition
2024-11-30 13:20:23,334 - ERROR - loss function:2.2827486991882324
2024-11-30 13:20:23,335 - INFO - reading batch[23] client 3
2024-11-30 13:20:23,353 - INFO - Final partition
2024-11-30 13:20:23,353 - ERROR - loss function:2.290539026260376
2024-11-30 13:20:23,354 - INFO - reading batch[23] client 4
2024-11-30 13:20:23,388 - INFO - reading batch[24] client 1
2024-11-30 13:20:23,416 - INFO - reading batch[24] client 2
2024-11-30 13:20:23,434 - INFO - reading batch[24] client 3
2024-11-30 13:20:23,469 - INFO - reading batch[24] client 4
2024-11-30 13:20:23,501 - INFO - reading batch[25] client 1
2024-11-30 13:20:23,527 - INFO - reading batch[25] client 2
2024-11-30 13:20:23,574 - INFO - reading batch[25] client 3
2024-11-30 13:20:23,603 - INFO - reading batch[25] client 4
2024-11-30 13:20:23,630 - INFO - reading batch[26] client 1
2024-11-30 13:20:23,657 - INFO - reading batch[26] client 2
2024-11-30 13:20:23,680 - INFO - reading batch[26] client 3
2024-11-30 13:20:23,713 - INFO - reading batch[26] client 4
2024-11-30 13:20:23,740 - INFO - reading batch[27] client 1
2024-11-30 13:20:23,757 - INFO - Final partition
2024-11-30 13:20:23,758 - ERROR - loss function:2.2993104457855225
2024-11-30 13:20:23,758 - INFO - reading batch[27] client 2
2024-11-30 13:20:23,791 - INFO - reading batch[27] client 3
2024-11-30 13:20:23,809 - INFO - reading batch[27] client 4
2024-11-30 13:20:23,838 - INFO - reading batch[28] client 1
2024-11-30 13:20:23,864 - INFO - reading batch[28] client 2
2024-11-30 13:20:23,886 - INFO - reading batch[28] client 3
2024-11-30 13:20:23,921 - INFO - reading batch[28] client 4
2024-11-30 13:20:24,012 - INFO - reading batch[29] client 1
2024-11-30 13:20:24,047 - INFO - reading batch[29] client 2
2024-11-30 13:20:24,075 - INFO - reading batch[29] client 3
2024-11-30 13:20:24,110 - INFO - reading batch[29] client 4
2024-11-30 13:20:24,136 - INFO - reading batch[30] client 1
2024-11-30 13:20:24,164 - INFO - reading batch[30] client 2
2024-11-30 13:20:24,195 - INFO - reading batch[30] client 3
2024-11-30 13:20:24,217 - INFO - reading batch[30] client 4
2024-11-30 13:20:24,251 - INFO - reading batch[31] client 1
2024-11-30 13:20:24,274 - INFO - reading batch[31] client 2
2024-11-30 13:20:24,295 - INFO - reading batch[31] client 3
2024-11-30 13:20:24,328 - INFO - reading batch[31] client 4
2024-11-30 13:20:24,353 - INFO - reading batch[32] client 1
2024-11-30 13:20:24,378 - INFO - reading batch[32] client 2
2024-11-30 13:20:24,411 - INFO - reading batch[32] client 3
2024-11-30 13:20:24,433 - ERROR - backward on partition 4
2024-11-30 13:20:24,434 - CRITICAL - calculate backward $4 on client4
2024-11-30 13:20:24,442 - CRITICAL - new gradient:tensor([[ 4.8025e-04,  2.5899e-04,  2.6081e-04,  ...,  1.5411e-04,
          5.8469e-04, -1.2935e-04],
        [ 4.2880e-04, -2.3572e-04, -5.8861e-04,  ..., -4.8648e-04,
          4.4810e-04,  8.3627e-05],
        [ 4.7596e-04,  2.6111e-04,  2.5684e-04,  ...,  1.5391e-04,
          5.8393e-04, -1.3462e-04],
        ...,
        [ 1.4009e-05,  4.5759e-04, -2.8392e-04,  ...,  3.6029e-04,
          5.4283e-04, -2.4359e-04],
        [-4.6461e-04, -4.2847e-04,  6.9803e-04,  ...,  6.4103e-04,
         -5.9226e-04, -1.0223e-04],
        [ 4.3531e-04, -2.3163e-04, -5.9903e-04,  ..., -4.8712e-04,
          4.5717e-04,  8.3855e-05]]) 
 old gradient:tensor([[ 0.0016,  0.0015,  0.0018, -0.0140,  0.0016,  0.0013,  0.0015,  0.0016,
          0.0014,  0.0016],
        [-0.0140,  0.0015,  0.0018,  0.0015,  0.0015,  0.0013,  0.0016,  0.0017,
          0.0014,  0.0017],
        [ 0.0016,  0.0016,  0.0018, -0.0140,  0.0014,  0.0014,  0.0016,  0.0016,
          0.0015,  0.0016],
        [-0.0141,  0.0015,  0.0019,  0.0015,  0.0015,  0.0012,  0.0017,  0.0017,
          0.0013,  0.0016],
        [ 0.0016,  0.0015,  0.0020,  0.0015,  0.0015,  0.0014, -0.0141,  0.0016,
          0.0014,  0.0016],
        [ 0.0016, -0.0140,  0.0018,  0.0015,  0.0014,  0.0014,  0.0016,  0.0016,
          0.0014,  0.0016],
        [ 0.0015,  0.0016,  0.0018, -0.0140,  0.0015,  0.0014,  0.0016,  0.0016,
          0.0014,  0.0016],
        [ 0.0016,  0.0014,  0.0021,  0.0015,  0.0014,  0.0014, -0.0140,  0.0017,
          0.0014,  0.0016],
        [-0.0140,  0.0015,  0.0018,  0.0016,  0.0014,  0.0013,  0.0015,  0.0018,
          0.0014,  0.0017],
        [-0.0141,  0.0016,  0.0019,  0.0016,  0.0015,  0.0014,  0.0015,  0.0017,
          0.0014,  0.0016],
        [ 0.0016,  0.0015,  0.0019,  0.0015,  0.0015,  0.0014, -0.0139,  0.0017,
          0.0014,  0.0016],
        [ 0.0015,  0.0015,  0.0018,  0.0015, -0.0141,  0.0014,  0.0016,  0.0017,
          0.0015,  0.0016],
        [ 0.0016,  0.0016,  0.0019,  0.0015,  0.0014,  0.0014,  0.0016,  0.0016,
         -0.0142,  0.0017],
        [ 0.0017,  0.0016,  0.0019,  0.0016,  0.0014,  0.0013,  0.0015,  0.0016,
         -0.0142,  0.0016],
        [-0.0141,  0.0015,  0.0018,  0.0015,  0.0015,  0.0014,  0.0016,  0.0016,
          0.0014,  0.0017],
        [ 0.0016,  0.0015,  0.0019,  0.0015,  0.0015,  0.0014,  0.0015,  0.0016,
          0.0014, -0.0139],
        [-0.0141,  0.0015,  0.0017,  0.0015,  0.0015,  0.0013,  0.0015,  0.0018,
          0.0015,  0.0017],
        [ 0.0016,  0.0016,  0.0019,  0.0015,  0.0014,  0.0013,  0.0016,  0.0016,
         -0.0142,  0.0017],
        [ 0.0016,  0.0015, -0.0137,  0.0015,  0.0015,  0.0013,  0.0015,  0.0017,
          0.0015,  0.0016],
        [ 0.0016,  0.0015,  0.0018,  0.0015, -0.0141,  0.0014,  0.0016,  0.0016,
          0.0015,  0.0017],
        [ 0.0016,  0.0015,  0.0020,  0.0015,  0.0014,  0.0013, -0.0140,  0.0017,
          0.0014,  0.0016],
        [ 0.0016, -0.0141,  0.0017,  0.0015,  0.0015,  0.0015,  0.0015,  0.0016,
          0.0014,  0.0017],
        [ 0.0017,  0.0014,  0.0019,  0.0015,  0.0014,  0.0014, -0.0140,  0.0017,
          0.0014,  0.0017],
        [ 0.0015,  0.0016,  0.0019,  0.0015,  0.0015,  0.0014,  0.0015, -0.0141,
          0.0015,  0.0016],
        [ 0.0016,  0.0015, -0.0139,  0.0016,  0.0015,  0.0014,  0.0016,  0.0016,
          0.0014,  0.0016],
        [ 0.0015,  0.0016,  0.0018,  0.0016,  0.0015,  0.0014,  0.0015, -0.0141,
          0.0015,  0.0017],
        [ 0.0016,  0.0016,  0.0018,  0.0016,  0.0015,  0.0014,  0.0014, -0.0141,
          0.0015,  0.0017],
        [ 0.0016,  0.0015,  0.0018,  0.0015,  0.0015,  0.0015,  0.0015,  0.0017,
          0.0014, -0.0140],
        [-0.0141,  0.0016,  0.0018,  0.0016,  0.0015,  0.0014,  0.0016,  0.0016,
          0.0014,  0.0016],
        [ 0.0016,  0.0014,  0.0018,  0.0015, -0.0141,  0.0014,  0.0016,  0.0016,
          0.0015,  0.0016],
        [ 0.0016,  0.0016,  0.0018,  0.0015,  0.0015,  0.0013, -0.0140,  0.0017,
          0.0014,  0.0017],
        [ 0.0016, -0.0141,  0.0018,  0.0015,  0.0015,  0.0014,  0.0015,  0.0017,
          0.0014,  0.0017],
        [-0.0141,  0.0015,  0.0018,  0.0015,  0.0015,  0.0013,  0.0016,  0.0017,
          0.0015,  0.0017],
        [ 0.0017,  0.0016, -0.0138,  0.0015,  0.0013,  0.0013,  0.0016,  0.0016,
          0.0014,  0.0017],
        [ 0.0016,  0.0015,  0.0019,  0.0015, -0.0142,  0.0013,  0.0016,  0.0017,
          0.0015,  0.0017],
        [ 0.0015,  0.0014,  0.0018,  0.0016,  0.0015,  0.0014,  0.0016,  0.0017,
          0.0015, -0.0140],
        [ 0.0016,  0.0016,  0.0019,  0.0016,  0.0014, -0.0143,  0.0015,  0.0015,
          0.0015,  0.0017],
        [ 0.0015,  0.0016,  0.0019,  0.0015,  0.0015, -0.0142,  0.0016,  0.0016,
          0.0014,  0.0017],
        [ 0.0018,  0.0015,  0.0018,  0.0014,  0.0015,  0.0013,  0.0016,  0.0017,
         -0.0142,  0.0016],
        [ 0.0015,  0.0016,  0.0019,  0.0015,  0.0016,  0.0014,  0.0015,  0.0016,
          0.0015, -0.0140],
        [ 0.0016,  0.0014,  0.0018,  0.0015, -0.0140,  0.0014,  0.0016,  0.0017,
          0.0014,  0.0017],
        [ 0.0016,  0.0016,  0.0018,  0.0015,  0.0015,  0.0014, -0.0140,  0.0016,
          0.0014,  0.0015],
        [-0.0141,  0.0015,  0.0018,  0.0015,  0.0015,  0.0014,  0.0016,  0.0017,
          0.0014,  0.0016],
        [ 0.0016,  0.0016,  0.0018, -0.0141,  0.0014,  0.0014,  0.0016,  0.0016,
          0.0014,  0.0016],
        [ 0.0015,  0.0015,  0.0019, -0.0141,  0.0014,  0.0014,  0.0016,  0.0017,
          0.0014,  0.0017],
        [ 0.0016,  0.0015,  0.0019,  0.0016, -0.0143,  0.0014,  0.0016,  0.0016,
          0.0015,  0.0017],
        [ 0.0016,  0.0016,  0.0018,  0.0014,  0.0014,  0.0014,  0.0016, -0.0140,
          0.0014,  0.0017],
        [ 0.0016,  0.0016,  0.0018,  0.0014,  0.0015,  0.0014, -0.0140,  0.0017,
          0.0014,  0.0016],
        [ 0.0017, -0.0140,  0.0018,  0.0015,  0.0014,  0.0014,  0.0016,  0.0016,
          0.0014,  0.0016],
        [ 0.0015,  0.0016,  0.0020,  0.0015,  0.0015,  0.0014,  0.0015,  0.0016,
          0.0015, -0.0140],
        [-0.0140,  0.0016,  0.0018,  0.0016,  0.0015,  0.0014,  0.0016,  0.0016,
          0.0014,  0.0016],
        [ 0.0016,  0.0014,  0.0018,  0.0015,  0.0015,  0.0014, -0.0140,  0.0017,
          0.0014,  0.0017],
        [ 0.0015,  0.0016,  0.0019,  0.0015, -0.0141,  0.0014,  0.0016,  0.0016,
          0.0014,  0.0016],
        [ 0.0016,  0.0017,  0.0019, -0.0141,  0.0014,  0.0013,  0.0016,  0.0017,
          0.0015,  0.0015],
        [ 0.0016, -0.0140,  0.0017,  0.0015,  0.0015,  0.0015,  0.0016,  0.0016,
          0.0015,  0.0016],
        [ 0.0015,  0.0015,  0.0018,  0.0015, -0.0141,  0.0014,  0.0016,  0.0017,
          0.0014,  0.0017],
        [ 0.0016,  0.0015, -0.0137,  0.0016,  0.0014,  0.0013,  0.0015,  0.0017,
          0.0014,  0.0016],
        [ 0.0015,  0.0016,  0.0019,  0.0015,  0.0014, -0.0143,  0.0016,  0.0017,
          0.0014,  0.0017],
        [-0.0141,  0.0015,  0.0021,  0.0015,  0.0015,  0.0013,  0.0016,  0.0017,
          0.0014,  0.0016],
        [ 0.0014,  0.0016,  0.0018,  0.0015,  0.0015,  0.0014,  0.0016, -0.0140,
          0.0015,  0.0016],
        [ 0.0015,  0.0016,  0.0018,  0.0016,  0.0015,  0.0015,  0.0016, -0.0141,
          0.0015,  0.0016],
        [ 0.0016, -0.0141,  0.0017,  0.0016,  0.0015,  0.0014,  0.0015,  0.0017,
          0.0015,  0.0017],
        [ 0.0017,  0.0016,  0.0019,  0.0015,  0.0014,  0.0013,  0.0015,  0.0017,
         -0.0142,  0.0016],
        [-0.0140,  0.0014,  0.0018,  0.0015,  0.0016,  0.0014,  0.0016,  0.0016,
          0.0014,  0.0017]])
2024-11-30 13:20:24,460 - INFO - reading batch[32] client 4
2024-11-30 13:20:24,494 - INFO - reading batch[33] client 1
2024-11-30 13:20:24,524 - INFO - reading batch[33] client 2
2024-11-30 13:20:24,541 - INFO - reading batch[33] client 3
2024-11-30 13:20:24,575 - INFO - reading batch[33] client 4
2024-11-30 13:20:24,596 - INFO - Final partition
2024-11-30 13:20:24,597 - ERROR - loss function:2.300644874572754
2024-11-30 13:20:24,598 - INFO - reading batch[34] client 1
2024-11-30 13:20:24,623 - INFO - reading batch[34] client 2
2024-11-30 13:20:24,653 - INFO - reading batch[34] client 3
2024-11-30 13:20:24,683 - INFO - reading batch[34] client 4
2024-11-30 13:20:24,715 - INFO - reading batch[35] client 1
2024-11-30 13:20:24,738 - INFO - reading batch[35] client 2
2024-11-30 13:20:24,770 - INFO - reading batch[35] client 3
2024-11-30 13:20:24,789 - ERROR - backward on partition 4
2024-11-30 13:20:24,790 - CRITICAL - calculate backward $4 on client4
2024-11-30 13:20:24,799 - CRITICAL - new gradient:tensor([[ 4.9165e-04,  7.0572e-04, -1.1225e-05,  ...,  5.2032e-04,
          1.1227e-03, -3.6981e-04],
        [ 1.0318e-03, -4.8946e-04, -1.1853e-03,  ..., -3.4488e-05,
          6.5419e-04,  3.8365e-05],
        [ 8.0419e-06,  7.2740e-04, -9.0906e-05,  ..., -1.6444e-04,
          4.1818e-04, -7.6146e-04],
        ...,
        [-4.4886e-04,  9.2294e-04, -6.3195e-04,  ...,  3.8283e-05,
          3.8747e-04, -8.6288e-04],
        [-9.2561e-04, -8.5975e-04,  1.3876e-03,  ...,  1.2770e-03,
         -1.1851e-03, -1.9949e-04],
        [ 9.1076e-04,  2.9050e-05, -3.3825e-04,  ..., -3.2956e-04,
          1.0409e-03, -5.1217e-05]]) 
 old gradient:tensor([[ 0.0016, -0.0140,  0.0019,  0.0015,  0.0014,  0.0014,  0.0016,  0.0016,
          0.0014,  0.0016],
        [ 0.0014,  0.0015,  0.0019,  0.0016,  0.0014,  0.0015,  0.0016, -0.0140,
          0.0014,  0.0015],
        [ 0.0018,  0.0016, -0.0138,  0.0016,  0.0014,  0.0013,  0.0015,  0.0016,
          0.0014,  0.0016],
        [-0.0140,  0.0015,  0.0018,  0.0015,  0.0015,  0.0014,  0.0016,  0.0018,
          0.0015,  0.0016],
        [ 0.0016,  0.0014,  0.0020,  0.0016,  0.0014,  0.0013, -0.0139,  0.0017,
          0.0013,  0.0016],
        [ 0.0016,  0.0015,  0.0019,  0.0015,  0.0015,  0.0014, -0.0141,  0.0017,
          0.0014,  0.0016],
        [ 0.0016,  0.0016,  0.0019,  0.0015,  0.0015,  0.0013,  0.0015,  0.0016,
          0.0015, -0.0140],
        [ 0.0015,  0.0016,  0.0017,  0.0016,  0.0015,  0.0015,  0.0015, -0.0141,
          0.0015,  0.0016],
        [ 0.0016,  0.0015,  0.0019,  0.0015, -0.0141,  0.0014,  0.0016,  0.0016,
          0.0014,  0.0016],
        [ 0.0016,  0.0014,  0.0019,  0.0015, -0.0141,  0.0014,  0.0016,  0.0017,
          0.0014,  0.0017],
        [ 0.0015,  0.0016,  0.0018,  0.0016,  0.0014,  0.0015,  0.0016, -0.0141,
          0.0014,  0.0017],
        [ 0.0017,  0.0016, -0.0137,  0.0015,  0.0015,  0.0013,  0.0015,  0.0017,
          0.0014,  0.0016],
        [ 0.0016,  0.0015,  0.0019,  0.0014,  0.0015,  0.0013, -0.0140,  0.0017,
          0.0013,  0.0017],
        [ 0.0017,  0.0015,  0.0018,  0.0015, -0.0142,  0.0013,  0.0015,  0.0016,
          0.0014,  0.0018],
        [ 0.0017,  0.0015,  0.0018,  0.0015,  0.0015,  0.0013, -0.0140,  0.0016,
          0.0015,  0.0016],
        [ 0.0016,  0.0015,  0.0019,  0.0015,  0.0014,  0.0013,  0.0015,  0.0016,
         -0.0142,  0.0017],
        [ 0.0016,  0.0016,  0.0018,  0.0015,  0.0014,  0.0014, -0.0140,  0.0017,
          0.0014,  0.0016],
        [ 0.0017,  0.0017, -0.0138,  0.0015,  0.0014,  0.0014,  0.0015,  0.0016,
          0.0014,  0.0016],
        [ 0.0017,  0.0016,  0.0019,  0.0016,  0.0014, -0.0143,  0.0015,  0.0016,
          0.0014,  0.0015],
        [ 0.0016,  0.0015,  0.0019,  0.0015,  0.0014,  0.0014,  0.0016, -0.0141,
          0.0014,  0.0018],
        [ 0.0016,  0.0016,  0.0017,  0.0016,  0.0015,  0.0015,  0.0015, -0.0141,
          0.0014,  0.0017],
        [ 0.0016,  0.0014, -0.0136,  0.0016,  0.0015,  0.0014,  0.0015,  0.0016,
          0.0014,  0.0015],
        [ 0.0017,  0.0016,  0.0019,  0.0015,  0.0014,  0.0013,  0.0015,  0.0016,
         -0.0142,  0.0016],
        [ 0.0016,  0.0015,  0.0018,  0.0015,  0.0015,  0.0014,  0.0015,  0.0016,
          0.0015, -0.0140],
        [ 0.0016,  0.0015, -0.0138,  0.0015,  0.0014,  0.0014,  0.0015,  0.0018,
          0.0014,  0.0017],
        [ 0.0015,  0.0016,  0.0019, -0.0141,  0.0015,  0.0014,  0.0015,  0.0016,
          0.0014,  0.0016],
        [ 0.0015,  0.0015,  0.0018,  0.0016,  0.0014, -0.0143,  0.0016,  0.0016,
          0.0014,  0.0017],
        [ 0.0015,  0.0015,  0.0018,  0.0015,  0.0015,  0.0014, -0.0140,  0.0017,
          0.0015,  0.0017],
        [ 0.0016,  0.0016,  0.0018,  0.0015,  0.0015,  0.0014,  0.0015, -0.0140,
          0.0014,  0.0017],
        [ 0.0017,  0.0015,  0.0020,  0.0015,  0.0014,  0.0013, -0.0140,  0.0016,
          0.0014,  0.0016],
        [ 0.0016,  0.0015,  0.0020,  0.0015,  0.0015,  0.0013, -0.0141,  0.0017,
          0.0014,  0.0016],
        [ 0.0015,  0.0015,  0.0019,  0.0016,  0.0014,  0.0015,  0.0016,  0.0016,
          0.0014, -0.0140],
        [ 0.0015,  0.0016,  0.0019, -0.0140,  0.0014,  0.0014,  0.0015,  0.0016,
          0.0015,  0.0016],
        [ 0.0015,  0.0015,  0.0017,  0.0017,  0.0015,  0.0014,  0.0016, -0.0140,
          0.0015,  0.0016],
        [ 0.0016,  0.0014,  0.0019,  0.0016, -0.0141,  0.0013,  0.0016,  0.0017,
          0.0014,  0.0016],
        [ 0.0016,  0.0016,  0.0020, -0.0141,  0.0015,  0.0013,  0.0016,  0.0016,
          0.0013,  0.0016],
        [ 0.0015,  0.0015,  0.0019,  0.0016,  0.0014, -0.0143,  0.0016,  0.0017,
          0.0014,  0.0017],
        [ 0.0015,  0.0016,  0.0018,  0.0016,  0.0015,  0.0015,  0.0016, -0.0141,
          0.0015,  0.0016],
        [ 0.0015,  0.0017,  0.0020,  0.0015,  0.0014, -0.0143,  0.0015,  0.0017,
          0.0014,  0.0016],
        [ 0.0017,  0.0016, -0.0137,  0.0015,  0.0014,  0.0014,  0.0015,  0.0016,
          0.0015,  0.0015],
        [ 0.0016, -0.0140,  0.0019,  0.0015,  0.0014,  0.0014,  0.0016,  0.0016,
          0.0014,  0.0016],
        [ 0.0017,  0.0015, -0.0138,  0.0015,  0.0015,  0.0014,  0.0015,  0.0017,
          0.0014,  0.0016],
        [-0.0141,  0.0015,  0.0018,  0.0017,  0.0015,  0.0013,  0.0016,  0.0016,
          0.0014,  0.0016],
        [-0.0141,  0.0015,  0.0019,  0.0016,  0.0015,  0.0013,  0.0016,  0.0017,
          0.0014,  0.0016],
        [ 0.0015,  0.0016,  0.0018,  0.0015,  0.0015,  0.0014,  0.0016, -0.0141,
          0.0015,  0.0016],
        [ 0.0016, -0.0141,  0.0017,  0.0015,  0.0015,  0.0015,  0.0016,  0.0016,
          0.0014,  0.0016],
        [ 0.0015,  0.0016,  0.0019,  0.0015,  0.0015,  0.0013,  0.0016,  0.0016,
          0.0014, -0.0139],
        [ 0.0015,  0.0015,  0.0019,  0.0015,  0.0014, -0.0141,  0.0016,  0.0016,
          0.0014,  0.0016],
        [ 0.0016,  0.0016,  0.0017,  0.0016,  0.0013,  0.0014,  0.0016, -0.0140,
          0.0014,  0.0017],
        [ 0.0017,  0.0016,  0.0018, -0.0141,  0.0014,  0.0013,  0.0016,  0.0016,
          0.0014,  0.0017],
        [ 0.0016,  0.0015,  0.0021,  0.0015,  0.0014, -0.0143,  0.0016,  0.0017,
          0.0014,  0.0016],
        [ 0.0016, -0.0141,  0.0018,  0.0015,  0.0015,  0.0014,  0.0015,  0.0017,
          0.0014,  0.0016],
        [ 0.0016,  0.0015,  0.0019,  0.0015, -0.0142,  0.0013,  0.0016,  0.0017,
          0.0014,  0.0016],
        [ 0.0017,  0.0015, -0.0137,  0.0015,  0.0015,  0.0014,  0.0014,  0.0016,
          0.0015,  0.0016],
        [ 0.0017,  0.0015, -0.0138,  0.0016,  0.0015,  0.0013,  0.0015,  0.0017,
          0.0014,  0.0017],
        [ 0.0016,  0.0016,  0.0020,  0.0015,  0.0015,  0.0013,  0.0016,  0.0016,
          0.0014, -0.0140],
        [ 0.0016,  0.0016,  0.0019,  0.0016,  0.0015,  0.0014,  0.0015, -0.0141,
          0.0014,  0.0016],
        [ 0.0016,  0.0016,  0.0020,  0.0016,  0.0014,  0.0013,  0.0017,  0.0015,
         -0.0142,  0.0015],
        [ 0.0017,  0.0015,  0.0020,  0.0015,  0.0014,  0.0014, -0.0141,  0.0017,
          0.0014,  0.0015],
        [ 0.0016,  0.0015,  0.0019,  0.0016,  0.0014,  0.0013,  0.0015,  0.0016,
         -0.0142,  0.0016],
        [ 0.0016,  0.0016,  0.0019,  0.0015,  0.0015,  0.0013,  0.0015,  0.0016,
          0.0015, -0.0140],
        [ 0.0016,  0.0014, -0.0136,  0.0016,  0.0015,  0.0013,  0.0015,  0.0017,
          0.0014,  0.0016],
        [ 0.0017,  0.0016,  0.0019,  0.0016,  0.0014,  0.0013,  0.0015,  0.0016,
         -0.0142,  0.0015],
        [ 0.0016,  0.0016,  0.0018, -0.0140,  0.0014,  0.0014,  0.0016,  0.0016,
          0.0014,  0.0016]])
2024-11-30 13:20:24,816 - INFO - reading batch[35] client 4
2024-11-30 13:20:24,852 - INFO - reading batch[36] client 1
2024-11-30 13:20:24,880 - INFO - reading batch[36] client 2
2024-11-30 13:20:24,903 - INFO - reading batch[36] client 3
2024-11-30 13:20:24,921 - ERROR - backward on partition 4
2024-11-30 13:20:24,923 - CRITICAL - calculate backward $4 on client4
2024-11-30 13:20:24,932 - CRITICAL - new gradient:tensor([[ 2.0959e-05,  1.1716e-03, -3.6828e-04,  ...,  1.8114e-04,
          9.5768e-04, -9.9451e-04],
        [ 1.4571e-03, -7.2421e-04, -1.7867e-03,  ..., -5.2577e-04,
          1.1043e-03,  1.1397e-04],
        [ 4.8707e-04,  9.0454e-04, -9.9907e-05,  ..., -4.7093e-04,
          4.4009e-04, -7.4364e-05],
        ...,
        [ 2.8281e-05,  1.0910e-03, -6.3213e-04,  ..., -2.6133e-04,
          4.0288e-04, -1.7283e-04],
        [-1.6015e-03, -7.6034e-04,  1.8716e-03,  ...,  1.5152e-03,
         -1.5970e-03, -3.5200e-04],
        [ 9.2648e-04,  4.8031e-04, -6.1278e-04,  ...,  4.0594e-05,
          1.5820e-03, -2.9166e-04]]) 
 old gradient:tensor([[ 0.0016,  0.0016, -0.0138,  0.0016,  0.0014,  0.0014,  0.0015,  0.0017,
          0.0015,  0.0015],
        [-0.0141,  0.0015,  0.0017,  0.0016,  0.0015,  0.0014,  0.0017,  0.0016,
          0.0014,  0.0016],
        [ 0.0016,  0.0015,  0.0019,  0.0015,  0.0014,  0.0013, -0.0140,  0.0017,
          0.0015,  0.0016],
        [ 0.0016,  0.0016,  0.0019,  0.0015, -0.0142,  0.0014,  0.0016,  0.0016,
          0.0014,  0.0016],
        [ 0.0015,  0.0016,  0.0018,  0.0016,  0.0014,  0.0015,  0.0016, -0.0141,
          0.0015,  0.0016],
        [ 0.0017,  0.0013,  0.0020,  0.0016, -0.0142,  0.0014,  0.0016,  0.0016,
          0.0013,  0.0017],
        [ 0.0016,  0.0016,  0.0020,  0.0014,  0.0014,  0.0014,  0.0015,  0.0016,
          0.0014, -0.0140],
        [ 0.0016,  0.0015, -0.0138,  0.0015,  0.0015,  0.0014,  0.0015,  0.0016,
          0.0014,  0.0017],
        [ 0.0015,  0.0013,  0.0020,  0.0015, -0.0141,  0.0014,  0.0016,  0.0017,
          0.0013,  0.0016],
        [ 0.0016, -0.0140,  0.0017,  0.0015,  0.0015,  0.0014,  0.0016,  0.0016,
          0.0015,  0.0016],
        [ 0.0016,  0.0015,  0.0019,  0.0016,  0.0015,  0.0013,  0.0015,  0.0016,
         -0.0142,  0.0017],
        [ 0.0017,  0.0015, -0.0138,  0.0016,  0.0015,  0.0014,  0.0015,  0.0016,
          0.0015,  0.0016],
        [ 0.0015,  0.0015,  0.0018,  0.0015, -0.0141,  0.0014,  0.0017,  0.0016,
          0.0014,  0.0017],
        [ 0.0015,  0.0016,  0.0019,  0.0015,  0.0015,  0.0014,  0.0016,  0.0016,
          0.0015, -0.0139],
        [ 0.0016, -0.0141,  0.0017,  0.0016,  0.0015,  0.0015,  0.0015,  0.0016,
          0.0014,  0.0016],
        [ 0.0016,  0.0016,  0.0019,  0.0015,  0.0014,  0.0013,  0.0015,  0.0016,
         -0.0143,  0.0018],
        [ 0.0015,  0.0016,  0.0018,  0.0016,  0.0015,  0.0014,  0.0015,  0.0015,
          0.0015, -0.0140],
        [ 0.0015,  0.0014,  0.0020,  0.0016,  0.0015,  0.0013,  0.0016, -0.0140,
          0.0014,  0.0016],
        [ 0.0017, -0.0141,  0.0017,  0.0015,  0.0015,  0.0014,  0.0015,  0.0016,
          0.0015,  0.0017],
        [ 0.0017,  0.0016,  0.0019, -0.0142,  0.0014,  0.0014,  0.0015,  0.0016,
          0.0014,  0.0016],
        [-0.0141,  0.0015,  0.0018,  0.0016,  0.0015,  0.0015,  0.0015,  0.0015,
          0.0014,  0.0017],
        [ 0.0017,  0.0015,  0.0020,  0.0015,  0.0014,  0.0013,  0.0015,  0.0016,
         -0.0141,  0.0015],
        [ 0.0016, -0.0140,  0.0018,  0.0015,  0.0014,  0.0015,  0.0016,  0.0015,
          0.0014,  0.0016],
        [ 0.0016,  0.0016,  0.0017,  0.0015,  0.0015,  0.0015,  0.0015, -0.0141,
          0.0015,  0.0017],
        [-0.0141,  0.0016,  0.0018,  0.0015,  0.0015,  0.0013,  0.0016,  0.0016,
          0.0014,  0.0017],
        [ 0.0016,  0.0015,  0.0019,  0.0014, -0.0142,  0.0014,  0.0016,  0.0017,
          0.0014,  0.0017],
        [ 0.0015,  0.0016,  0.0019,  0.0015,  0.0015,  0.0013,  0.0016,  0.0016,
          0.0014, -0.0141],
        [ 0.0015,  0.0015,  0.0020,  0.0015, -0.0141,  0.0014,  0.0016,  0.0017,
          0.0014,  0.0016],
        [ 0.0015,  0.0016,  0.0020,  0.0015,  0.0015,  0.0014,  0.0015,  0.0016,
          0.0014, -0.0140],
        [ 0.0016,  0.0016,  0.0018, -0.0141,  0.0015,  0.0013,  0.0015,  0.0017,
          0.0015,  0.0016],
        [ 0.0016,  0.0015,  0.0018,  0.0015,  0.0014, -0.0141,  0.0016,  0.0017,
          0.0014,  0.0016],
        [ 0.0015,  0.0015,  0.0019,  0.0015,  0.0014,  0.0013,  0.0016,  0.0016,
          0.0015, -0.0140],
        [ 0.0016,  0.0016,  0.0017,  0.0015,  0.0015,  0.0015,  0.0015, -0.0141,
          0.0014,  0.0017],
        [-0.0142,  0.0016,  0.0019,  0.0015,  0.0015,  0.0014,  0.0016,  0.0016,
          0.0014,  0.0017],
        [ 0.0016, -0.0140,  0.0018,  0.0015,  0.0014,  0.0014,  0.0016,  0.0016,
          0.0014,  0.0016],
        [ 0.0016,  0.0015,  0.0019,  0.0015,  0.0015,  0.0014, -0.0141,  0.0016,
          0.0014,  0.0016],
        [ 0.0015,  0.0017,  0.0019,  0.0016,  0.0015, -0.0143,  0.0016,  0.0015,
          0.0014,  0.0016],
        [ 0.0017,  0.0016, -0.0139,  0.0016,  0.0015,  0.0014,  0.0016,  0.0016,
          0.0014,  0.0016],
        [ 0.0017,  0.0015,  0.0019,  0.0015,  0.0015, -0.0143,  0.0015,  0.0016,
          0.0014,  0.0017],
        [ 0.0015,  0.0015,  0.0019,  0.0015,  0.0015,  0.0014,  0.0015,  0.0017,
          0.0015, -0.0140],
        [-0.0141,  0.0016,  0.0018,  0.0015,  0.0016,  0.0013,  0.0015,  0.0017,
          0.0014,  0.0016],
        [ 0.0015,  0.0013,  0.0019,  0.0016, -0.0141,  0.0014,  0.0015,  0.0017,
          0.0014,  0.0017],
        [ 0.0017, -0.0140,  0.0017,  0.0016,  0.0015,  0.0014,  0.0015,  0.0016,
          0.0014,  0.0017],
        [ 0.0016, -0.0141,  0.0018,  0.0016,  0.0015,  0.0014,  0.0016,  0.0016,
          0.0014,  0.0016],
        [ 0.0016, -0.0140,  0.0018,  0.0015,  0.0015,  0.0014,  0.0016,  0.0015,
          0.0014,  0.0016],
        [-0.0140,  0.0016,  0.0018,  0.0016,  0.0015,  0.0013,  0.0016,  0.0016,
          0.0014,  0.0017],
        [ 0.0016,  0.0016,  0.0018, -0.0141,  0.0014,  0.0014,  0.0016,  0.0016,
          0.0015,  0.0017],
        [ 0.0017,  0.0015, -0.0139,  0.0015,  0.0015,  0.0014,  0.0015,  0.0016,
          0.0015,  0.0017],
        [ 0.0016, -0.0140,  0.0018,  0.0015,  0.0015,  0.0014,  0.0015,  0.0016,
          0.0014,  0.0016],
        [ 0.0017,  0.0016, -0.0138,  0.0015,  0.0014,  0.0014,  0.0015,  0.0016,
          0.0014,  0.0016],
        [-0.0140,  0.0015,  0.0019,  0.0015,  0.0015,  0.0013,  0.0016,  0.0016,
          0.0014,  0.0016],
        [ 0.0017, -0.0141,  0.0017,  0.0016,  0.0015,  0.0015,  0.0015,  0.0016,
          0.0014,  0.0017],
        [ 0.0016,  0.0014,  0.0020,  0.0015,  0.0014,  0.0013, -0.0140,  0.0017,
          0.0015,  0.0016],
        [-0.0141,  0.0015,  0.0019,  0.0016,  0.0015,  0.0013,  0.0016,  0.0016,
          0.0014,  0.0016],
        [ 0.0016,  0.0016,  0.0019,  0.0016,  0.0015,  0.0013,  0.0017,  0.0015,
         -0.0142,  0.0016],
        [ 0.0016, -0.0140,  0.0018,  0.0015,  0.0014,  0.0014,  0.0016,  0.0016,
          0.0014,  0.0016],
        [ 0.0015,  0.0016,  0.0019,  0.0015,  0.0015,  0.0014,  0.0015,  0.0016,
          0.0014, -0.0140],
        [ 0.0016,  0.0015,  0.0018,  0.0015, -0.0142,  0.0013,  0.0016,  0.0017,
          0.0014,  0.0017],
        [ 0.0016,  0.0015,  0.0019,  0.0015,  0.0015,  0.0013,  0.0015,  0.0016,
          0.0014, -0.0140],
        [ 0.0016,  0.0015, -0.0137,  0.0015,  0.0015,  0.0014,  0.0015,  0.0017,
          0.0015,  0.0015],
        [ 0.0017,  0.0015, -0.0138,  0.0015,  0.0015,  0.0014,  0.0015,  0.0016,
          0.0014,  0.0016],
        [ 0.0017,  0.0015,  0.0020,  0.0015,  0.0014,  0.0013, -0.0140,  0.0017,
          0.0014,  0.0015],
        [ 0.0016,  0.0014,  0.0019,  0.0014, -0.0140,  0.0014,  0.0016,  0.0017,
          0.0014,  0.0017],
        [ 0.0016, -0.0141,  0.0018,  0.0015,  0.0015,  0.0014,  0.0016,  0.0016,
          0.0014,  0.0017]])
2024-11-30 13:20:24,951 - INFO - reading batch[36] client 4
2024-11-30 13:20:24,986 - INFO - reading batch[37] client 1
2024-11-30 13:20:25,008 - INFO - reading batch[37] client 2
2024-11-30 13:20:25,033 - INFO - reading batch[37] client 3
2024-11-30 13:20:25,063 - INFO - reading batch[37] client 4
2024-11-30 13:20:25,092 - INFO - reading batch[38] client 1
2024-11-30 13:20:25,120 - INFO - reading batch[38] client 2
2024-11-30 13:20:25,150 - INFO - reading batch[38] client 3
2024-11-30 13:20:25,166 - INFO - reading batch[38] client 4
2024-11-30 13:20:25,199 - INFO - reading batch[39] client 1
2024-11-30 13:20:25,231 - INFO - reading batch[39] client 2
2024-11-30 13:20:25,250 - INFO - reading batch[39] client 3
2024-11-30 13:20:25,281 - INFO - reading batch[39] client 4
2024-11-30 13:20:25,309 - INFO - reading batch[40] client 1
2024-11-30 13:20:25,338 - INFO - reading batch[40] client 2
2024-11-30 13:20:25,365 - INFO - reading batch[40] client 3
2024-11-30 13:20:25,397 - INFO - reading batch[40] client 4
2024-11-30 13:20:25,427 - INFO - reading batch[41] client 1
2024-11-30 13:20:25,448 - INFO - reading batch[41] client 2
2024-11-30 13:20:25,464 - INFO - Final partition
2024-11-30 13:20:25,465 - ERROR - loss function:2.3198323249816895
2024-11-30 13:20:25,466 - INFO - reading batch[41] client 3
2024-11-30 13:20:25,487 - INFO - reading batch[41] client 4
2024-11-30 13:20:25,519 - INFO - reading batch[42] client 1
2024-11-30 13:20:25,545 - INFO - reading batch[42] client 2
2024-11-30 13:20:25,563 - INFO - reading batch[42] client 3
2024-11-30 13:20:25,595 - INFO - reading batch[42] client 4
2024-11-30 13:20:25,633 - INFO - reading batch[43] client 1
2024-11-30 13:20:25,660 - INFO - reading batch[43] client 2
2024-11-30 13:20:25,687 - INFO - reading batch[43] client 3
2024-11-30 13:20:25,705 - ERROR - backward on partition 4
2024-11-30 13:20:25,706 - CRITICAL - calculate backward $4 on client4
2024-11-30 13:20:25,715 - CRITICAL - new gradient:tensor([[-6.8424e-04,  9.6905e-05,  4.8556e-04,  ...,  2.3692e-04,
         -4.1960e-04, -1.5284e-04],
        [-2.5246e-04, -4.2043e-04,  8.7653e-05,  ..., -5.1181e-04,
         -4.1902e-04,  4.5462e-04],
        [-6.8271e-04,  9.3626e-05,  4.8152e-04,  ...,  2.3926e-04,
         -4.1531e-04, -1.5498e-04],
        ...,
        [ 6.0787e-04, -2.4699e-04, -5.9832e-04,  ...,  4.4563e-04,
          2.1021e-04, -4.7844e-05],
        [-4.6388e-04,  4.7398e-04, -3.6541e-04,  ..., -3.2928e-04,
         -1.5233e-04, -6.3327e-04],
        [ 4.8192e-04,  1.7705e-04, -3.6251e-06,  ..., -2.9883e-04,
          2.3441e-05,  6.8232e-04]]) 
 old gradient:tensor([[ 0.0017,  0.0015,  0.0019,  0.0014, -0.0141,  0.0014,  0.0016,  0.0016,
          0.0014,  0.0016],
        [ 0.0016,  0.0015,  0.0018,  0.0015,  0.0015,  0.0014,  0.0016,  0.0016,
          0.0015, -0.0139],
        [ 0.0016,  0.0014,  0.0019,  0.0015, -0.0140,  0.0014,  0.0016,  0.0017,
          0.0013,  0.0017],
        [ 0.0016,  0.0016,  0.0017, -0.0140,  0.0015,  0.0014,  0.0016,  0.0017,
          0.0014,  0.0016],
        [ 0.0016,  0.0016,  0.0018, -0.0140,  0.0015,  0.0013,  0.0016,  0.0017,
          0.0014,  0.0016],
        [ 0.0016,  0.0015,  0.0019,  0.0015,  0.0015,  0.0014,  0.0015,  0.0016,
          0.0015, -0.0140],
        [ 0.0016,  0.0017,  0.0019,  0.0014,  0.0014, -0.0142,  0.0016,  0.0016,
          0.0014,  0.0016],
        [ 0.0015,  0.0016,  0.0019,  0.0015,  0.0015, -0.0143,  0.0016,  0.0016,
          0.0014,  0.0017],
        [ 0.0017,  0.0016,  0.0019,  0.0015,  0.0015,  0.0013,  0.0016,  0.0015,
         -0.0143,  0.0016],
        [ 0.0017,  0.0016,  0.0019,  0.0015,  0.0014,  0.0014, -0.0140,  0.0016,
          0.0014,  0.0016],
        [ 0.0016,  0.0016,  0.0019, -0.0141,  0.0015,  0.0013,  0.0016,  0.0016,
          0.0014,  0.0016],
        [ 0.0016,  0.0016,  0.0020,  0.0014,  0.0015,  0.0013,  0.0015,  0.0016,
          0.0014, -0.0140],
        [ 0.0016,  0.0016,  0.0018, -0.0140,  0.0015,  0.0014,  0.0016,  0.0015,
          0.0015,  0.0016],
        [ 0.0016,  0.0016,  0.0019,  0.0015,  0.0014, -0.0143,  0.0015,  0.0016,
          0.0014,  0.0017],
        [-0.0140,  0.0016,  0.0018,  0.0015,  0.0015,  0.0013,  0.0015,  0.0017,
          0.0014,  0.0017],
        [ 0.0017,  0.0015,  0.0019,  0.0015,  0.0015,  0.0014,  0.0016,  0.0016,
         -0.0142,  0.0016],
        [ 0.0016, -0.0140,  0.0017,  0.0015,  0.0015,  0.0014,  0.0016,  0.0016,
          0.0014,  0.0016],
        [ 0.0016,  0.0016,  0.0018, -0.0140,  0.0014,  0.0014,  0.0016,  0.0016,
          0.0014,  0.0017],
        [ 0.0015,  0.0015,  0.0019,  0.0015,  0.0015,  0.0014,  0.0016,  0.0016,
          0.0014, -0.0140],
        [ 0.0017,  0.0016,  0.0019,  0.0015,  0.0014,  0.0013, -0.0139,  0.0015,
          0.0014,  0.0016],
        [ 0.0016,  0.0016,  0.0018,  0.0015,  0.0015,  0.0015,  0.0015, -0.0141,
          0.0015,  0.0016],
        [ 0.0015,  0.0014,  0.0018,  0.0016,  0.0015,  0.0014,  0.0016, -0.0140,
          0.0015,  0.0016],
        [ 0.0016, -0.0141,  0.0017,  0.0015,  0.0016,  0.0015,  0.0016,  0.0016,
          0.0014,  0.0017],
        [ 0.0015,  0.0016,  0.0019,  0.0016,  0.0014,  0.0014,  0.0016,  0.0016,
          0.0015, -0.0141],
        [ 0.0016,  0.0016, -0.0139,  0.0015,  0.0015,  0.0015,  0.0015,  0.0016,
          0.0015,  0.0016],
        [ 0.0016,  0.0015,  0.0018,  0.0015,  0.0015, -0.0143,  0.0016,  0.0016,
          0.0014,  0.0017],
        [ 0.0016,  0.0016,  0.0021,  0.0015,  0.0014,  0.0013,  0.0016,  0.0017,
         -0.0142,  0.0015],
        [ 0.0014,  0.0016,  0.0019,  0.0015,  0.0015,  0.0013,  0.0016, -0.0140,
          0.0015,  0.0016],
        [ 0.0016,  0.0015,  0.0018, -0.0141,  0.0015,  0.0014,  0.0016,  0.0016,
          0.0014,  0.0016],
        [ 0.0017,  0.0015,  0.0019,  0.0015,  0.0015,  0.0014, -0.0140,  0.0016,
          0.0014,  0.0017],
        [ 0.0016, -0.0141,  0.0017,  0.0016,  0.0015,  0.0014,  0.0016,  0.0016,
          0.0014,  0.0016],
        [-0.0141,  0.0016,  0.0018,  0.0015,  0.0015,  0.0013,  0.0016,  0.0017,
          0.0014,  0.0017],
        [ 0.0015,  0.0015,  0.0018,  0.0016,  0.0015,  0.0014,  0.0016,  0.0016,
          0.0015, -0.0140],
        [ 0.0016, -0.0140,  0.0017,  0.0015,  0.0015,  0.0015,  0.0015,  0.0016,
          0.0014,  0.0017],
        [ 0.0016,  0.0016,  0.0018, -0.0141,  0.0015,  0.0014,  0.0015,  0.0017,
          0.0014,  0.0016],
        [ 0.0016,  0.0016,  0.0019,  0.0014,  0.0015, -0.0143,  0.0016,  0.0016,
          0.0013,  0.0017],
        [ 0.0015,  0.0016,  0.0018,  0.0015,  0.0015, -0.0142,  0.0016,  0.0017,
          0.0014,  0.0016],
        [ 0.0016, -0.0140,  0.0016,  0.0015,  0.0015,  0.0015,  0.0015,  0.0016,
          0.0014,  0.0017],
        [ 0.0016,  0.0015,  0.0019,  0.0014,  0.0015,  0.0014, -0.0141,  0.0017,
          0.0014,  0.0017],
        [ 0.0015,  0.0016,  0.0019,  0.0015,  0.0014,  0.0014,  0.0016,  0.0016,
          0.0015, -0.0140],
        [ 0.0017,  0.0016,  0.0019,  0.0014, -0.0141,  0.0013,  0.0016,  0.0017,
          0.0014,  0.0017],
        [ 0.0015,  0.0015,  0.0019,  0.0015,  0.0016,  0.0014,  0.0016, -0.0140,
          0.0014,  0.0016],
        [ 0.0015,  0.0015,  0.0019,  0.0015,  0.0015,  0.0014,  0.0016,  0.0016,
          0.0014, -0.0140],
        [ 0.0016,  0.0014, -0.0138,  0.0015,  0.0015,  0.0014,  0.0016,  0.0016,
          0.0015,  0.0017],
        [-0.0140,  0.0016,  0.0018,  0.0015,  0.0016,  0.0013,  0.0016,  0.0017,
          0.0014,  0.0016],
        [ 0.0016,  0.0016,  0.0018, -0.0141,  0.0014,  0.0014,  0.0015,  0.0016,
          0.0015,  0.0016],
        [ 0.0016,  0.0015,  0.0019,  0.0015,  0.0015,  0.0013,  0.0015,  0.0017,
          0.0015, -0.0139],
        [ 0.0016,  0.0015,  0.0019,  0.0016,  0.0014, -0.0143,  0.0015,  0.0016,
          0.0014,  0.0018],
        [ 0.0016,  0.0016,  0.0019, -0.0141,  0.0014,  0.0014,  0.0016,  0.0016,
          0.0014,  0.0016],
        [ 0.0016,  0.0014,  0.0019,  0.0015, -0.0142,  0.0013,  0.0017,  0.0016,
          0.0014,  0.0017],
        [ 0.0016,  0.0016,  0.0018,  0.0014,  0.0015, -0.0143,  0.0016,  0.0016,
          0.0015,  0.0016],
        [ 0.0016, -0.0139,  0.0018,  0.0015,  0.0014,  0.0014,  0.0016,  0.0016,
          0.0014,  0.0017],
        [ 0.0015,  0.0016,  0.0019,  0.0015,  0.0015, -0.0141,  0.0016,  0.0016,
          0.0014,  0.0016],
        [ 0.0014,  0.0016,  0.0019,  0.0015,  0.0015,  0.0014,  0.0017, -0.0141,
          0.0014,  0.0017],
        [ 0.0015,  0.0016,  0.0019,  0.0015,  0.0015,  0.0014,  0.0016,  0.0016,
          0.0015, -0.0140],
        [ 0.0016,  0.0016,  0.0019,  0.0014,  0.0014,  0.0015, -0.0139,  0.0016,
          0.0014,  0.0015],
        [ 0.0017,  0.0015, -0.0137,  0.0015,  0.0015,  0.0014,  0.0015,  0.0016,
          0.0014,  0.0016],
        [ 0.0016, -0.0140,  0.0017,  0.0016,  0.0015,  0.0015,  0.0016,  0.0015,
          0.0014,  0.0016],
        [ 0.0016,  0.0015,  0.0021,  0.0014,  0.0015,  0.0013, -0.0139,  0.0016,
          0.0014,  0.0016],
        [ 0.0016,  0.0015,  0.0019,  0.0014, -0.0141,  0.0014,  0.0016,  0.0017,
          0.0014,  0.0016],
        [ 0.0017,  0.0016, -0.0138,  0.0015,  0.0014,  0.0014,  0.0016,  0.0016,
          0.0014,  0.0016],
        [ 0.0015,  0.0016,  0.0018,  0.0015,  0.0015,  0.0014,  0.0016, -0.0140,
          0.0015,  0.0016],
        [ 0.0016,  0.0014, -0.0138,  0.0016,  0.0015,  0.0014,  0.0015,  0.0017,
          0.0015,  0.0016],
        [ 0.0016,  0.0015,  0.0019,  0.0014,  0.0014,  0.0014, -0.0140,  0.0017,
          0.0015,  0.0016]])
2024-11-30 13:20:25,732 - INFO - reading batch[43] client 4
2024-11-30 13:20:25,768 - INFO - reading batch[44] client 1
2024-11-30 13:20:25,802 - INFO - reading batch[44] client 2
2024-11-30 13:20:25,821 - INFO - reading batch[44] client 3
2024-11-30 13:20:25,844 - INFO - Final partition
2024-11-30 13:20:25,845 - ERROR - loss function:2.305410385131836
2024-11-30 13:20:25,846 - INFO - reading batch[44] client 4
2024-11-30 13:20:25,873 - INFO - reading batch[45] client 1
2024-11-30 13:20:25,897 - INFO - reading batch[45] client 2
2024-11-30 13:20:25,930 - INFO - reading batch[45] client 3
2024-11-30 13:20:25,958 - INFO - reading batch[45] client 4
2024-11-30 13:20:25,976 - INFO - Final partition
2024-11-30 13:20:25,977 - ERROR - loss function:2.3171942234039307
2024-11-30 13:20:25,978 - INFO - reading batch[46] client 1
2024-11-30 13:20:26,008 - INFO - reading batch[46] client 2
2024-11-30 13:20:26,049 - INFO - reading batch[46] client 3
2024-11-30 13:20:26,066 - INFO - reading batch[46] client 4
2024-11-30 13:20:26,100 - INFO - reading batch[47] client 1
2024-11-30 13:20:26,125 - INFO - reading batch[47] client 2
2024-11-30 13:20:26,142 - INFO - reading batch[47] client 3
2024-11-30 13:20:26,175 - INFO - reading batch[47] client 4
2024-11-30 13:20:26,206 - INFO - reading batch[48] client 1
2024-11-30 13:20:26,233 - INFO - reading batch[48] client 2
2024-11-30 13:20:26,265 - INFO - reading batch[48] client 3
2024-11-30 13:20:26,293 - INFO - reading batch[48] client 4
2024-11-30 13:20:26,323 - INFO - reading batch[49] client 1
2024-11-30 13:20:26,348 - INFO - reading batch[49] client 2
2024-11-30 13:20:26,383 - INFO - reading batch[49] client 3
2024-11-30 13:20:26,412 - INFO - reading batch[49] client 4
2024-11-30 13:20:26,441 - INFO - reading batch[50] client 1
2024-11-30 13:20:26,472 - INFO - reading batch[50] client 2
2024-11-30 13:20:26,491 - INFO - reading batch[50] client 3
2024-11-30 13:20:26,513 - INFO - reading batch[50] client 4
2024-11-30 13:20:26,544 - INFO - reading batch[51] client 1
2024-11-30 13:20:26,567 - INFO - reading batch[51] client 2
2024-11-30 13:20:26,599 - INFO - reading batch[51] client 3
2024-11-30 13:20:26,629 - INFO - reading batch[51] client 4
2024-11-30 13:20:26,661 - INFO - reading batch[52] client 1
2024-11-30 13:20:26,684 - INFO - reading batch[52] client 2
2024-11-30 13:20:26,703 - INFO - reading batch[52] client 3
2024-11-30 13:20:26,732 - INFO - reading batch[52] client 4
2024-11-30 13:20:26,766 - INFO - reading batch[53] client 1
2024-11-30 13:20:26,788 - INFO - reading batch[53] client 2
2024-11-30 13:20:26,820 - INFO - reading batch[53] client 3
2024-11-30 13:20:26,842 - INFO - reading batch[53] client 4
2024-11-30 13:20:26,874 - INFO - reading batch[54] client 1
2024-11-30 13:20:26,901 - INFO - reading batch[54] client 2
2024-11-30 13:20:26,930 - INFO - reading batch[54] client 3
2024-11-30 13:20:26,958 - INFO - reading batch[54] client 4
2024-11-30 13:20:26,988 - INFO - reading batch[55] client 1
2024-11-30 13:20:27,012 - INFO - reading batch[55] client 2
2024-11-30 13:20:27,031 - INFO - reading batch[55] client 3
2024-11-30 13:20:27,050 - ERROR - backward on partition 4
2024-11-30 13:20:27,052 - CRITICAL - calculate backward $4 on client4
2024-11-30 13:20:27,061 - CRITICAL - new gradient:tensor([[ 4.8804e-04,  1.7248e-04, -1.0768e-05,  ..., -3.0347e-04,
          2.3427e-05,  6.9014e-04],
        [-6.8231e-04,  9.0888e-05,  4.8163e-04,  ...,  2.3343e-04,
         -4.1676e-04, -1.4780e-04],
        [-1.8835e-04, -2.2401e-04,  5.5716e-04,  ..., -8.6724e-05,
         -2.8686e-04,  1.7215e-04],
        ...,
        [ 4.7745e-04,  1.7226e-04,  4.5916e-06,  ..., -2.9289e-04,
          1.7652e-05,  6.8633e-04],
        [ 4.8098e-04,  1.7433e-04,  3.4527e-06,  ..., -2.9757e-04,
          2.0220e-05,  6.9209e-04],
        [ 6.0922e-04, -2.4568e-04, -5.9623e-04,  ...,  4.5637e-04,
          2.1541e-04, -5.3725e-05]]) 
 old gradient:tensor([[ 0.0015,  0.0015,  0.0019,  0.0015,  0.0014,  0.0014, -0.0141,  0.0017,
          0.0014,  0.0016],
        [ 0.0016,  0.0014,  0.0019,  0.0015, -0.0140,  0.0014,  0.0016,  0.0017,
          0.0014,  0.0016],
        [ 0.0015,  0.0016,  0.0020,  0.0015,  0.0014, -0.0142,  0.0016,  0.0016,
          0.0015,  0.0015],
        [ 0.0015,  0.0016,  0.0019,  0.0016,  0.0015,  0.0014,  0.0015, -0.0141,
          0.0014,  0.0017],
        [ 0.0016,  0.0015,  0.0019,  0.0015, -0.0142,  0.0014,  0.0016,  0.0017,
          0.0015,  0.0017],
        [ 0.0015,  0.0016,  0.0019,  0.0016,  0.0014,  0.0015,  0.0016, -0.0141,
          0.0015,  0.0016],
        [ 0.0016, -0.0141,  0.0017,  0.0015,  0.0015,  0.0015,  0.0015,  0.0016,
          0.0014,  0.0016],
        [ 0.0016,  0.0015,  0.0019,  0.0015, -0.0142,  0.0014,  0.0016,  0.0017,
          0.0014,  0.0017],
        [ 0.0017,  0.0014,  0.0020,  0.0015, -0.0143,  0.0013,  0.0016,  0.0016,
          0.0014,  0.0017],
        [ 0.0016,  0.0015, -0.0137,  0.0016,  0.0015,  0.0014,  0.0015,  0.0016,
          0.0015,  0.0016],
        [ 0.0016,  0.0015, -0.0135,  0.0015,  0.0015,  0.0013,  0.0015,  0.0016,
          0.0014,  0.0016],
        [ 0.0016,  0.0015,  0.0019,  0.0016,  0.0014, -0.0142,  0.0016,  0.0016,
          0.0014,  0.0016],
        [ 0.0016,  0.0015,  0.0020,  0.0015, -0.0141,  0.0013,  0.0015,  0.0017,
          0.0015,  0.0016],
        [ 0.0016,  0.0016,  0.0018,  0.0016,  0.0015,  0.0014,  0.0015, -0.0141,
          0.0015,  0.0017],
        [ 0.0016, -0.0141,  0.0017,  0.0015,  0.0015,  0.0015,  0.0016,  0.0016,
          0.0014,  0.0016],
        [ 0.0016,  0.0016,  0.0018, -0.0141,  0.0014,  0.0014,  0.0016,  0.0017,
          0.0014,  0.0016],
        [ 0.0017,  0.0015,  0.0019,  0.0015,  0.0014,  0.0014, -0.0141,  0.0017,
          0.0014,  0.0016],
        [ 0.0015,  0.0016,  0.0018, -0.0140,  0.0014,  0.0014,  0.0015,  0.0016,
          0.0014,  0.0017],
        [ 0.0016,  0.0016,  0.0019,  0.0016,  0.0015,  0.0013,  0.0015,  0.0016,
         -0.0142,  0.0017],
        [ 0.0016,  0.0014, -0.0137,  0.0015,  0.0015,  0.0014,  0.0015,  0.0017,
          0.0014,  0.0016],
        [ 0.0015,  0.0016,  0.0018,  0.0016,  0.0014, -0.0143,  0.0015,  0.0017,
          0.0013,  0.0018],
        [ 0.0016,  0.0015, -0.0138,  0.0015,  0.0015,  0.0014,  0.0015,  0.0016,
          0.0015,  0.0017],
        [ 0.0016,  0.0015,  0.0019,  0.0015, -0.0141,  0.0014,  0.0016,  0.0017,
          0.0014,  0.0016],
        [ 0.0016,  0.0016,  0.0017,  0.0015,  0.0015,  0.0014,  0.0015, -0.0140,
          0.0015,  0.0017],
        [ 0.0015,  0.0016,  0.0020, -0.0141,  0.0014,  0.0014,  0.0016,  0.0016,
          0.0014,  0.0016],
        [ 0.0015,  0.0016,  0.0021,  0.0014,  0.0015, -0.0142,  0.0016,  0.0017,
          0.0014,  0.0016],
        [ 0.0016,  0.0016,  0.0020,  0.0015,  0.0015, -0.0143,  0.0015,  0.0015,
          0.0014,  0.0017],
        [ 0.0016,  0.0015, -0.0136,  0.0015,  0.0015,  0.0013,  0.0015,  0.0017,
          0.0014,  0.0016],
        [ 0.0017,  0.0016, -0.0138,  0.0016,  0.0014,  0.0014,  0.0015,  0.0016,
          0.0014,  0.0016],
        [ 0.0016,  0.0013,  0.0020,  0.0015, -0.0142,  0.0014,  0.0016,  0.0017,
          0.0014,  0.0016],
        [ 0.0016, -0.0140,  0.0019,  0.0015,  0.0015,  0.0014,  0.0016,  0.0016,
          0.0014,  0.0016],
        [ 0.0015,  0.0016,  0.0018,  0.0016,  0.0014,  0.0013,  0.0016,  0.0016,
         -0.0142,  0.0016],
        [ 0.0016, -0.0141,  0.0017,  0.0015,  0.0015,  0.0014,  0.0016,  0.0016,
          0.0014,  0.0016],
        [ 0.0016,  0.0016,  0.0019,  0.0015,  0.0014,  0.0014,  0.0015,  0.0017,
         -0.0142,  0.0016],
        [-0.0140,  0.0015,  0.0018,  0.0016,  0.0015,  0.0013,  0.0016,  0.0017,
          0.0014,  0.0016],
        [ 0.0016,  0.0016,  0.0019, -0.0141,  0.0014,  0.0014,  0.0016,  0.0017,
          0.0014,  0.0016],
        [-0.0140,  0.0016,  0.0018,  0.0016,  0.0014,  0.0014,  0.0016,  0.0016,
          0.0014,  0.0015],
        [ 0.0015,  0.0016,  0.0018,  0.0015, -0.0141,  0.0014,  0.0015,  0.0016,
          0.0015,  0.0016],
        [ 0.0016,  0.0015, -0.0137,  0.0015,  0.0014,  0.0014,  0.0015,  0.0017,
          0.0014,  0.0016],
        [ 0.0016,  0.0015,  0.0019,  0.0015,  0.0014, -0.0141,  0.0015,  0.0017,
          0.0014,  0.0015],
        [ 0.0016,  0.0016,  0.0018,  0.0016,  0.0015,  0.0014,  0.0015, -0.0141,
          0.0014,  0.0016],
        [ 0.0017, -0.0141,  0.0017,  0.0016,  0.0015,  0.0014,  0.0015,  0.0016,
          0.0014,  0.0017],
        [ 0.0016,  0.0016,  0.0019,  0.0014,  0.0014,  0.0013,  0.0015,  0.0016,
         -0.0142,  0.0016],
        [ 0.0016,  0.0016,  0.0018, -0.0142,  0.0015,  0.0014,  0.0015,  0.0016,
          0.0014,  0.0017],
        [ 0.0015,  0.0016,  0.0019,  0.0015,  0.0015,  0.0015,  0.0015, -0.0141,
          0.0015,  0.0016],
        [ 0.0016,  0.0016,  0.0018,  0.0015,  0.0015,  0.0014,  0.0015, -0.0141,
          0.0015,  0.0017],
        [ 0.0016,  0.0015,  0.0021,  0.0015,  0.0014,  0.0014, -0.0141,  0.0016,
          0.0013,  0.0016],
        [ 0.0016,  0.0015,  0.0019,  0.0016,  0.0015,  0.0014, -0.0141,  0.0016,
          0.0014,  0.0017],
        [ 0.0016,  0.0016,  0.0019, -0.0140,  0.0014,  0.0014,  0.0015,  0.0016,
          0.0014,  0.0016],
        [ 0.0016,  0.0016,  0.0020,  0.0014,  0.0014,  0.0014,  0.0015,  0.0016,
          0.0015, -0.0140],
        [ 0.0016,  0.0014, -0.0136,  0.0015,  0.0014,  0.0014,  0.0016,  0.0016,
          0.0015,  0.0015],
        [ 0.0016,  0.0016,  0.0018,  0.0016,  0.0015,  0.0014,  0.0015, -0.0141,
          0.0015,  0.0017],
        [ 0.0016,  0.0016,  0.0018, -0.0141,  0.0014,  0.0014,  0.0015,  0.0017,
          0.0014,  0.0016],
        [ 0.0016,  0.0015,  0.0020,  0.0015,  0.0014,  0.0014,  0.0016,  0.0016,
          0.0014, -0.0141],
        [ 0.0017,  0.0015, -0.0138,  0.0016,  0.0015,  0.0013,  0.0015,  0.0016,
          0.0015,  0.0017],
        [ 0.0016,  0.0015,  0.0018,  0.0015,  0.0015,  0.0014,  0.0015, -0.0140,
          0.0015,  0.0016],
        [ 0.0017,  0.0015,  0.0020,  0.0015,  0.0014,  0.0013,  0.0016,  0.0017,
         -0.0142,  0.0016],
        [ 0.0015,  0.0015,  0.0019,  0.0015,  0.0015,  0.0014,  0.0016,  0.0017,
          0.0015, -0.0140],
        [ 0.0016,  0.0017,  0.0019,  0.0015,  0.0014, -0.0142,  0.0016,  0.0016,
          0.0014,  0.0016],
        [-0.0141,  0.0016,  0.0018,  0.0016,  0.0015,  0.0013,  0.0015,  0.0017,
          0.0015,  0.0015],
        [ 0.0016, -0.0140,  0.0018,  0.0016,  0.0015,  0.0014,  0.0015,  0.0016,
          0.0014,  0.0016],
        [ 0.0016,  0.0015,  0.0020,  0.0015,  0.0014,  0.0014, -0.0140,  0.0018,
          0.0013,  0.0016],
        [ 0.0016,  0.0014,  0.0020,  0.0015,  0.0014,  0.0013, -0.0140,  0.0018,
          0.0014,  0.0016],
        [ 0.0015,  0.0015,  0.0019,  0.0015,  0.0015,  0.0014,  0.0016, -0.0140,
          0.0014,  0.0017]])
2024-11-30 13:20:27,080 - INFO - reading batch[55] client 4
2024-11-30 13:20:27,112 - INFO - reading batch[56] client 1
2024-11-30 13:20:27,139 - INFO - reading batch[56] client 2
2024-11-30 13:20:27,168 - INFO - reading batch[56] client 3
2024-11-30 13:24:22,353 - INFO - reading batch[0] client 1
2024-11-30 13:24:22,380 - INFO - reading batch[0] client 2
2024-11-30 13:24:22,406 - INFO - reading batch[0] client 3
2024-11-30 13:24:22,431 - INFO - reading batch[0] client 4
2024-11-30 13:24:22,473 - INFO - reading batch[1] client 1
2024-11-30 13:24:22,508 - INFO - reading batch[1] client 2
2024-11-30 13:24:22,535 - INFO - reading batch[1] client 3
2024-11-30 13:24:22,568 - INFO - reading batch[1] client 4
2024-11-30 13:24:22,596 - INFO - reading batch[2] client 1
2024-11-30 13:24:22,620 - INFO - reading batch[2] client 2
2024-11-30 13:24:22,650 - INFO - reading batch[2] client 3
2024-11-30 13:24:22,681 - INFO - reading batch[2] client 4
2024-11-30 13:24:22,711 - INFO - reading batch[3] client 1
2024-11-30 13:24:22,738 - INFO - reading batch[3] client 2
2024-11-30 13:24:22,755 - INFO - reading batch[3] client 3
2024-11-30 13:24:22,784 - INFO - reading batch[3] client 4
2024-11-30 13:24:22,814 - INFO - reading batch[4] client 1
2024-11-30 13:24:22,842 - INFO - reading batch[4] client 2
2024-11-30 13:24:22,874 - INFO - reading batch[4] client 3
2024-11-30 13:24:22,890 - INFO - reading batch[4] client 4
2024-11-30 13:24:22,921 - INFO - reading batch[5] client 1
2024-11-30 13:24:22,950 - INFO - reading batch[5] client 2
2024-11-30 13:24:22,974 - INFO - reading batch[5] client 3
2024-11-30 13:24:23,003 - INFO - reading batch[5] client 4
2024-11-30 13:24:23,022 - INFO - Final partition
2024-11-30 13:24:23,023 - ERROR - loss function:2.33219838142395
2024-11-30 13:24:23,024 - INFO - reading batch[6] client 1
2024-11-30 13:24:23,053 - INFO - reading batch[6] client 2
2024-11-30 13:24:23,084 - INFO - reading batch[6] client 3
2024-11-30 13:24:23,116 - INFO - reading batch[6] client 4
2024-11-30 13:24:23,149 - INFO - reading batch[7] client 1
2024-11-30 13:24:23,175 - INFO - reading batch[7] client 2
2024-11-30 13:24:23,202 - INFO - reading batch[7] client 3
2024-11-30 13:24:23,225 - INFO - reading batch[7] client 4
2024-11-30 13:24:23,258 - INFO - reading batch[8] client 1
2024-11-30 13:24:23,291 - INFO - reading batch[8] client 2
2024-11-30 13:24:23,309 - INFO - reading batch[8] client 3
2024-11-30 13:24:23,343 - INFO - reading batch[8] client 4
2024-11-30 13:24:23,369 - INFO - reading batch[9] client 1
2024-11-30 13:24:23,392 - INFO - reading batch[9] client 2
2024-11-30 13:24:23,424 - INFO - reading batch[9] client 3
2024-11-30 13:24:23,441 - ERROR - backward on partition 4
2024-11-30 13:24:23,443 - CRITICAL - calculate backward $4 on client4
2024-11-30 13:24:23,457 - CRITICAL - new gradient:tensor([[-5.8677e-04, -1.5781e-05,  4.9224e-04,  ..., -1.1292e-04,
         -2.3181e-04, -7.0598e-04],
        [ 5.0273e-04,  3.4496e-04,  4.8134e-04,  ...,  1.7904e-04,
         -7.6976e-04, -3.9709e-04],
        [ 1.4805e-04,  3.6995e-04, -1.5025e-04,  ...,  2.3118e-04,
          4.4254e-04,  4.6526e-04],
        ...,
        [-1.1459e-04, -7.4338e-04, -8.6073e-05,  ...,  2.2013e-05,
          4.5410e-04,  1.3576e-04],
        [ 2.3498e-04,  2.1178e-04, -8.4258e-04,  ...,  4.7719e-04,
         -4.1902e-04,  2.4892e-04],
        [ 1.2337e-04,  2.2861e-04, -1.0849e-04,  ..., -1.5557e-04,
         -1.5647e-05, -3.6762e-04]]) 
 old gradient:tensor([[ 0.0013,  0.0011,  0.0014, -0.0136,  0.0013,  0.0018,  0.0018,  0.0015,
          0.0012,  0.0020],
        [ 0.0014,  0.0012,  0.0014,  0.0020,  0.0013,  0.0018,  0.0017,  0.0015,
         -0.0143,  0.0020],
        [ 0.0013,  0.0013,  0.0015,  0.0019,  0.0014,  0.0019,  0.0017, -0.0142,
          0.0012,  0.0019],
        [ 0.0015,  0.0013,  0.0014,  0.0019, -0.0142,  0.0017,  0.0017,  0.0015,
          0.0014,  0.0018],
        [-0.0142,  0.0012,  0.0014,  0.0020,  0.0013,  0.0017,  0.0015,  0.0015,
          0.0015,  0.0020],
        [ 0.0014,  0.0012,  0.0015,  0.0020,  0.0014,  0.0017, -0.0141,  0.0016,
          0.0015,  0.0018],
        [ 0.0014,  0.0012,  0.0014, -0.0136,  0.0013,  0.0018,  0.0017,  0.0015,
          0.0013,  0.0020],
        [-0.0142,  0.0011,  0.0015,  0.0020,  0.0015,  0.0016,  0.0015,  0.0016,
          0.0016,  0.0020],
        [ 0.0013,  0.0011, -0.0142,  0.0020,  0.0016,  0.0017,  0.0016,  0.0016,
          0.0013,  0.0020],
        [ 0.0013,  0.0012,  0.0013,  0.0020,  0.0014,  0.0018,  0.0017,  0.0016,
         -0.0143,  0.0020],
        [ 0.0014,  0.0012,  0.0014, -0.0136,  0.0013,  0.0020,  0.0016,  0.0016,
          0.0013,  0.0020],
        [ 0.0013,  0.0012, -0.0142,  0.0021,  0.0014,  0.0018,  0.0017,  0.0015,
          0.0013,  0.0020],
        [ 0.0014,  0.0013,  0.0015,  0.0019,  0.0014,  0.0017,  0.0017, -0.0142,
          0.0014,  0.0019],
        [-0.0142,  0.0011,  0.0015,  0.0022,  0.0014,  0.0015,  0.0015,  0.0016,
          0.0014,  0.0020],
        [ 0.0014,  0.0012,  0.0014,  0.0019,  0.0013,  0.0018,  0.0017,  0.0016,
         -0.0143,  0.0019],
        [ 0.0014,  0.0013,  0.0015,  0.0018,  0.0015,  0.0018,  0.0017,  0.0015,
         -0.0143,  0.0019],
        [ 0.0014,  0.0013,  0.0014,  0.0020,  0.0014, -0.0140,  0.0017,  0.0014,
          0.0013,  0.0020],
        [ 0.0014,  0.0012,  0.0014, -0.0135,  0.0014,  0.0018,  0.0017,  0.0014,
          0.0013,  0.0019],
        [ 0.0014,  0.0013,  0.0015, -0.0137,  0.0014,  0.0017,  0.0018,  0.0015,
          0.0012,  0.0019],
        [ 0.0014,  0.0012,  0.0014,  0.0021,  0.0013,  0.0017, -0.0141,  0.0015,
          0.0013,  0.0021],
        [ 0.0014,  0.0012,  0.0014,  0.0020, -0.0143,  0.0018,  0.0017,  0.0015,
          0.0013,  0.0019],
        [ 0.0014,  0.0011, -0.0142,  0.0019,  0.0014,  0.0018,  0.0017,  0.0015,
          0.0015,  0.0018],
        [ 0.0014, -0.0144,  0.0014,  0.0020,  0.0014,  0.0018,  0.0017,  0.0016,
          0.0014,  0.0018],
        [ 0.0014, -0.0144,  0.0014,  0.0020,  0.0014,  0.0018,  0.0017,  0.0015,
          0.0014,  0.0018],
        [ 0.0013,  0.0012,  0.0014,  0.0020,  0.0014,  0.0018,  0.0018,  0.0015,
         -0.0143,  0.0021],
        [ 0.0013,  0.0011,  0.0014,  0.0021,  0.0013,  0.0017, -0.0141,  0.0016,
          0.0015,  0.0021],
        [ 0.0014, -0.0144,  0.0014,  0.0020,  0.0014,  0.0018,  0.0017,  0.0016,
          0.0014,  0.0018],
        [ 0.0014,  0.0012,  0.0015,  0.0020,  0.0013, -0.0139,  0.0017,  0.0014,
          0.0013,  0.0020],
        [-0.0142,  0.0012,  0.0014,  0.0019,  0.0015,  0.0016,  0.0015,  0.0015,
          0.0015,  0.0020],
        [ 0.0015,  0.0012, -0.0142,  0.0020,  0.0014,  0.0018,  0.0016,  0.0015,
          0.0013,  0.0019],
        [ 0.0014,  0.0012,  0.0015,  0.0021,  0.0013,  0.0017,  0.0017,  0.0014,
         -0.0142,  0.0020],
        [ 0.0014,  0.0012, -0.0142,  0.0020,  0.0014,  0.0018,  0.0016,  0.0015,
          0.0014,  0.0020],
        [ 0.0014,  0.0011, -0.0142,  0.0020,  0.0013,  0.0018,  0.0016,  0.0016,
          0.0014,  0.0020],
        [ 0.0014,  0.0013,  0.0015,  0.0020,  0.0014,  0.0017,  0.0018, -0.0142,
          0.0013,  0.0019],
        [ 0.0014,  0.0012,  0.0014,  0.0021,  0.0014,  0.0018,  0.0016,  0.0015,
         -0.0143,  0.0020],
        [ 0.0014,  0.0013,  0.0014,  0.0018,  0.0014,  0.0019,  0.0017, -0.0141,
          0.0013,  0.0019],
        [ 0.0014,  0.0012,  0.0014,  0.0021,  0.0013, -0.0138,  0.0016,  0.0015,
          0.0012,  0.0020],
        [-0.0142,  0.0011,  0.0015,  0.0021,  0.0013,  0.0017,  0.0015,  0.0016,
          0.0014,  0.0020],
        [-0.0142,  0.0012,  0.0013,  0.0021,  0.0013,  0.0017,  0.0017,  0.0015,
          0.0015,  0.0019],
        [ 0.0014,  0.0012, -0.0142,  0.0019,  0.0014,  0.0018,  0.0016,  0.0016,
          0.0013,  0.0020],
        [ 0.0013,  0.0011,  0.0014,  0.0022,  0.0013,  0.0017, -0.0140,  0.0015,
          0.0014,  0.0020],
        [ 0.0014,  0.0012,  0.0015,  0.0019,  0.0014,  0.0018,  0.0018,  0.0014,
          0.0014, -0.0137],
        [ 0.0014, -0.0143,  0.0014,  0.0020,  0.0014,  0.0019,  0.0017,  0.0015,
          0.0013,  0.0017],
        [ 0.0015, -0.0144,  0.0014,  0.0019,  0.0014,  0.0018,  0.0017,  0.0015,
          0.0014,  0.0018],
        [ 0.0014,  0.0013, -0.0143,  0.0019,  0.0014,  0.0019,  0.0016,  0.0016,
          0.0013,  0.0018],
        [ 0.0013,  0.0012,  0.0014,  0.0021,  0.0013, -0.0140,  0.0017,  0.0014,
          0.0014,  0.0020],
        [ 0.0014,  0.0011, -0.0141,  0.0021,  0.0014,  0.0018,  0.0017,  0.0016,
          0.0014,  0.0017],
        [ 0.0014,  0.0012,  0.0014,  0.0021,  0.0014,  0.0018,  0.0018,  0.0015,
          0.0013, -0.0137],
        [ 0.0014,  0.0011,  0.0015,  0.0019,  0.0014,  0.0018,  0.0017,  0.0015,
          0.0014, -0.0137],
        [ 0.0014,  0.0012,  0.0014,  0.0020,  0.0013, -0.0139,  0.0017,  0.0015,
          0.0015,  0.0020],
        [ 0.0014,  0.0012,  0.0013,  0.0021,  0.0013,  0.0019,  0.0017,  0.0015,
         -0.0142,  0.0018],
        [ 0.0013,  0.0012,  0.0015,  0.0020,  0.0014,  0.0018,  0.0019,  0.0014,
          0.0013, -0.0136],
        [ 0.0013,  0.0012, -0.0142,  0.0020,  0.0015,  0.0017,  0.0016,  0.0015,
          0.0015,  0.0020],
        [ 0.0013,  0.0012,  0.0014,  0.0020,  0.0013,  0.0017,  0.0017,  0.0016,
         -0.0143,  0.0020],
        [ 0.0014,  0.0012,  0.0015, -0.0137,  0.0014,  0.0018,  0.0018,  0.0014,
          0.0013,  0.0019],
        [-0.0142,  0.0010,  0.0014,  0.0022,  0.0014,  0.0017,  0.0015,  0.0016,
          0.0014,  0.0020],
        [ 0.0014,  0.0012,  0.0015,  0.0021,  0.0013,  0.0016, -0.0140,  0.0015,
          0.0015,  0.0020],
        [ 0.0013,  0.0013,  0.0014,  0.0019, -0.0142,  0.0018,  0.0018,  0.0015,
          0.0013,  0.0020],
        [-0.0142,  0.0011,  0.0015,  0.0021,  0.0013,  0.0015,  0.0016,  0.0016,
          0.0014,  0.0020],
        [ 0.0014,  0.0013,  0.0014,  0.0019,  0.0014,  0.0019,  0.0017, -0.0142,
          0.0013,  0.0018],
        [ 0.0013,  0.0012,  0.0015,  0.0019,  0.0014,  0.0017,  0.0017,  0.0015,
          0.0014, -0.0138],
        [ 0.0014,  0.0011, -0.0141,  0.0019,  0.0014,  0.0019,  0.0016,  0.0016,
          0.0013,  0.0019],
        [ 0.0014,  0.0011,  0.0016,  0.0019,  0.0014,  0.0018,  0.0016,  0.0016,
          0.0014, -0.0138],
        [ 0.0013,  0.0011,  0.0014,  0.0021,  0.0013,  0.0018, -0.0141,  0.0015,
          0.0014,  0.0021]])
2024-11-30 13:24:23,513 - INFO - reading batch[9] client 4
2024-11-30 13:24:23,591 - INFO - reading batch[10] client 1
2024-11-30 13:24:23,611 - INFO - reading batch[10] client 2
2024-11-30 13:24:23,630 - INFO - reading batch[10] client 3
2024-11-30 13:24:23,661 - INFO - reading batch[10] client 4
2024-11-30 13:24:23,691 - INFO - reading batch[11] client 1
2024-11-30 13:24:23,717 - INFO - reading batch[11] client 2
2024-11-30 13:24:23,751 - INFO - reading batch[11] client 3
2024-11-30 13:24:23,781 - INFO - reading batch[11] client 4
2024-11-30 13:24:23,808 - INFO - reading batch[12] client 1
2024-11-30 13:24:23,839 - INFO - reading batch[12] client 2
2024-11-30 13:24:23,860 - INFO - reading batch[12] client 3
2024-11-30 13:24:23,877 - INFO - reading batch[12] client 4
2024-11-30 13:24:23,903 - INFO - reading batch[13] client 1
2024-11-30 13:24:23,929 - INFO - reading batch[13] client 2
2024-11-30 13:24:23,958 - INFO - reading batch[13] client 3
2024-11-30 13:24:23,986 - INFO - reading batch[13] client 4
2024-11-30 13:24:24,017 - INFO - reading batch[14] client 1
2024-11-30 13:24:24,041 - INFO - reading batch[14] client 2
2024-11-30 13:24:24,073 - INFO - reading batch[14] client 3
2024-11-30 13:24:24,098 - INFO - reading batch[14] client 4
2024-11-30 13:24:24,129 - INFO - reading batch[15] client 1
2024-11-30 13:24:24,156 - INFO - reading batch[15] client 2
2024-11-30 13:24:24,177 - INFO - reading batch[15] client 3
2024-11-30 13:24:24,197 - INFO - reading batch[15] client 4
2024-11-30 13:24:24,230 - INFO - reading batch[16] client 1
2024-11-30 13:24:24,259 - INFO - reading batch[16] client 2
2024-11-30 13:24:24,292 - INFO - reading batch[16] client 3
2024-11-30 13:24:24,324 - INFO - reading batch[16] client 4
2024-11-30 13:24:24,350 - INFO - reading batch[17] client 1
2024-11-30 13:24:24,381 - INFO - reading batch[17] client 2
2024-11-30 13:24:24,400 - ERROR - backward on partition 3
2024-11-30 13:24:24,407 - CRITICAL - calculate backward $3 on client3
2024-11-30 13:24:24,420 - CRITICAL - new gradient:tensor([[[[ 5.9545e-05, -5.6066e-05,  2.4672e-05,  2.0720e-06],
          [ 3.0617e-05,  7.1218e-06,  2.0700e-05, -7.4714e-05],
          [ 2.2404e-05, -1.0059e-04, -7.2172e-05,  1.0347e-04],
          [ 6.6304e-05,  7.6805e-06,  5.7772e-05,  9.3027e-05]],

         [[-1.8198e-04, -2.0877e-05, -6.0874e-05, -5.6793e-05],
          [ 3.6573e-06, -1.7620e-04,  6.0875e-05, -7.5737e-05],
          [-6.1911e-05, -6.8232e-05,  1.8959e-06, -1.3831e-04],
          [-1.7340e-04,  1.5617e-04, -7.2439e-05,  4.9963e-05]],

         [[ 2.0438e-04,  1.7356e-05,  1.0268e-04, -2.0388e-04],
          [-8.8093e-05,  2.5489e-05, -8.6003e-05, -1.8296e-04],
          [ 4.6899e-05,  2.0454e-04, -3.4832e-05, -8.8368e-05],
          [-3.6733e-05, -1.6063e-05, -4.6689e-06, -2.1484e-04]],

         ...,

         [[-2.5521e-05, -1.4046e-04,  2.1769e-04,  1.9692e-05],
          [ 2.4639e-04, -1.1543e-05, -8.1802e-05, -1.7512e-05],
          [-1.0936e-04,  1.5311e-04,  3.4466e-05,  7.2473e-05],
          [-1.5115e-04,  1.0716e-04,  6.8978e-05, -2.1048e-05]],

         [[ 1.7784e-04,  2.0888e-04, -2.8527e-05, -1.3353e-04],
          [ 9.4656e-05,  4.5825e-05, -9.0934e-05,  1.7471e-04],
          [ 6.5909e-05, -1.0738e-04,  2.0585e-05,  6.3036e-05],
          [ 7.2429e-05, -2.4934e-06, -4.4629e-05, -4.0145e-05]],

         [[-1.6209e-04, -9.2347e-05, -6.7746e-05, -7.0576e-05],
          [-3.8351e-05,  5.5923e-05,  1.3262e-04, -1.2328e-04],
          [-2.3392e-04, -2.6429e-05,  6.8021e-06, -3.4002e-05],
          [-1.4735e-05, -1.4344e-04,  2.4157e-06,  1.6269e-04]]],


        [[[ 5.8287e-05, -9.2576e-05,  4.7217e-05,  1.1193e-04],
          [ 4.6120e-05,  1.8068e-04,  9.6343e-05, -6.2736e-05],
          [ 2.9969e-04,  2.2161e-05,  1.8439e-04,  3.3295e-05],
          [-1.0098e-04,  1.2191e-05, -4.5261e-05, -2.5568e-04]],

         [[-5.1612e-05,  1.7629e-04,  7.2231e-06,  6.9446e-05],
          [-1.0996e-04, -1.7817e-04, -4.5092e-05, -1.4043e-05],
          [-9.7459e-05,  3.3152e-05,  1.2612e-04, -2.9859e-04],
          [-1.6688e-04,  1.3451e-04, -9.2925e-05,  1.6504e-04]],

         [[-1.0309e-04, -2.0497e-04, -1.2833e-05,  1.8839e-04],
          [ 8.9444e-05,  8.6390e-06, -2.2148e-04, -1.8416e-04],
          [-4.5992e-05,  1.8115e-04,  2.0918e-04,  1.8234e-04],
          [-6.0283e-05,  9.6349e-05, -1.8740e-05,  6.2053e-05]],

         ...,

         [[-1.0787e-04,  1.3885e-04,  1.2771e-04,  1.2584e-04],
          [ 1.6163e-04,  2.5221e-04,  1.2162e-05, -5.5424e-05],
          [-4.0442e-05, -1.1884e-04,  8.1734e-05,  2.9498e-04],
          [ 1.6864e-04,  1.0166e-04, -1.2656e-05,  1.0106e-04]],

         [[-2.3961e-04, -7.1205e-05,  9.0323e-05,  1.7597e-04],
          [ 1.5299e-05, -8.8264e-05,  1.2545e-04, -3.1275e-05],
          [-1.0182e-04, -5.8587e-05,  6.7782e-05, -4.2992e-05],
          [ 1.7855e-04,  8.1700e-05,  1.0009e-04,  1.1803e-04]],

         [[-5.0070e-05,  1.4576e-04, -5.8909e-05, -4.0561e-05],
          [-1.4106e-04,  2.8514e-05,  1.9615e-04,  8.0537e-05],
          [-2.8627e-04, -1.9505e-04, -2.7011e-05,  1.7453e-04],
          [-1.9117e-05,  2.4103e-05, -6.2637e-05,  3.9787e-06]]],


        [[[-2.0671e-04,  1.2389e-04, -8.2785e-05, -1.1332e-04],
          [ 1.7979e-05,  1.3063e-04, -2.6044e-04, -2.8516e-05],
          [ 8.6179e-05, -1.0205e-05,  9.3125e-05, -1.2351e-04],
          [ 2.3062e-05, -1.2546e-04, -9.3936e-05,  5.3050e-05]],

         [[-9.2395e-05, -1.9269e-05, -6.2298e-05, -2.0312e-04],
          [ 5.7617e-05,  1.7093e-04, -2.1615e-04,  7.7006e-05],
          [ 2.2797e-04,  2.0072e-05,  2.6816e-04,  4.5594e-05],
          [-3.7202e-05, -4.9824e-05,  9.3169e-05, -8.2026e-05]],

         [[-8.0399e-05, -8.5628e-05,  4.9181e-05,  8.8642e-05],
          [ 7.9112e-05, -1.4756e-04,  1.0368e-05,  1.8864e-04],
          [-4.0618e-05,  7.2805e-05, -1.2219e-04, -2.4288e-05],
          [-6.6742e-05, -6.3166e-05,  1.8287e-05, -3.4122e-07]],

         ...,

         [[-1.2983e-04,  1.9131e-04, -9.0510e-05, -2.6132e-04],
          [-9.9832e-05,  8.7307e-05,  1.8794e-04, -4.0601e-05],
          [-8.1326e-07, -8.7917e-05,  8.7600e-05, -4.1273e-05],
          [ 1.2186e-05,  1.6325e-06, -1.3842e-04, -2.5476e-04]],

         [[ 3.2104e-04, -2.5062e-04,  1.4810e-04,  2.7222e-04],
          [-1.6793e-04,  7.4855e-05,  1.0789e-04,  6.8512e-05],
          [-8.2833e-05, -2.5929e-04,  4.0562e-06,  2.1748e-05],
          [-8.2343e-05, -1.9836e-05, -1.2172e-04,  4.9103e-05]],

         [[-4.6420e-05,  3.2278e-05,  1.3752e-04,  8.9424e-05],
          [ 1.7623e-05,  3.9174e-05, -5.9093e-05,  2.0784e-04],
          [ 1.5310e-04,  2.5860e-05,  5.0118e-05,  6.4620e-05],
          [-4.4948e-05,  1.1815e-04,  1.6380e-04, -3.6654e-05]]],


        ...,


        [[[-8.8162e-05,  1.9370e-04,  9.9429e-05,  1.2579e-04],
          [-3.2624e-04, -2.4988e-04,  5.0725e-05,  1.3187e-04],
          [ 5.9243e-05,  4.2257e-05,  8.4129e-06, -1.3819e-05],
          [-1.9119e-05,  1.3811e-04, -8.3019e-05,  2.5320e-06]],

         [[-5.5187e-05,  5.2870e-05, -6.7863e-05,  9.5811e-05],
          [-2.6188e-05, -5.7943e-05, -6.2578e-05,  9.5511e-05],
          [-1.5118e-04,  5.6005e-05, -3.7006e-05, -1.3803e-04],
          [-7.1133e-05,  9.7781e-05,  7.5389e-05,  1.1184e-05]],

         [[ 1.1066e-04, -6.5363e-05, -1.5714e-04, -9.7883e-05],
          [ 1.9931e-04, -1.1126e-04,  5.4650e-05, -8.4099e-05],
          [-4.9301e-05,  1.6299e-04,  7.7733e-05,  7.9024e-05],
          [ 1.3201e-04,  2.1421e-05, -1.4205e-04, -1.6940e-05]],

         ...,

         [[-2.7259e-05, -5.2477e-05,  1.1382e-04, -1.9775e-04],
          [ 1.3637e-05, -1.1016e-04, -9.0438e-05, -2.0991e-04],
          [-9.3165e-05,  3.7273e-05,  9.5250e-06, -4.5455e-05],
          [ 5.4673e-05,  1.4480e-04, -7.3389e-05, -6.3654e-05]],

         [[-8.0886e-05,  1.3358e-04,  6.4967e-05,  7.1950e-05],
          [-2.9387e-05,  5.1544e-05,  2.6835e-05,  1.1242e-04],
          [ 6.6459e-05,  5.7702e-05, -9.9608e-06, -3.0260e-04],
          [ 6.8613e-05, -2.9312e-05,  3.7342e-05, -9.0993e-05]],

         [[-7.2265e-05,  1.2907e-04,  3.6176e-05, -5.3809e-05],
          [-2.0683e-05,  1.4073e-05, -1.9509e-04, -2.7904e-04],
          [-4.8546e-06,  4.5214e-05, -1.2991e-06, -1.3647e-05],
          [-1.5085e-05,  2.5378e-04,  1.7768e-05, -2.0210e-05]]],


        [[[ 6.4967e-05, -1.4357e-04,  4.7272e-05, -1.0002e-04],
          [-9.5040e-06, -9.7575e-05, -1.6120e-04, -1.0227e-04],
          [-1.0574e-04, -1.0659e-04, -9.0033e-05, -1.5987e-04],
          [-8.2709e-05,  1.9367e-04, -1.1790e-04, -7.4819e-05]],

         [[-1.0278e-05, -2.5486e-04,  5.3342e-05,  2.8415e-05],
          [-8.7043e-05,  6.6559e-05, -1.8742e-05, -1.7274e-04],
          [ 8.8624e-05,  6.8715e-05, -2.2515e-04, -1.2601e-04],
          [ 2.9272e-05, -8.0449e-05, -1.6243e-04, -2.0014e-04]],

         [[-6.3260e-05, -2.1209e-05,  3.5158e-05,  3.2043e-05],
          [ 8.3829e-06, -1.4877e-04, -6.7651e-05,  8.3471e-05],
          [ 1.1909e-04, -2.7512e-04, -6.0541e-06, -9.6963e-05],
          [ 4.4366e-05, -4.7355e-05, -7.0888e-05,  7.9589e-05]],

         ...,

         [[ 5.6963e-05,  4.9699e-05,  1.2173e-04,  1.8633e-04],
          [ 7.0770e-05,  7.5502e-05, -7.4844e-05, -1.6212e-05],
          [-1.4741e-04, -1.3354e-04, -6.5842e-05,  1.5144e-04],
          [-2.1332e-04,  6.1162e-05,  7.3267e-05,  1.8998e-04]],

         [[-7.0570e-05, -1.6693e-04, -1.5461e-04, -4.3154e-05],
          [-1.5884e-04, -8.7680e-05, -2.4749e-05,  1.4962e-04],
          [ 1.3175e-04,  1.6720e-05, -1.0837e-04,  6.1533e-05],
          [-4.5484e-05, -9.5674e-06, -4.1531e-05, -3.1391e-05]],

         [[ 1.0388e-04, -1.1397e-04,  6.6070e-05,  1.6995e-04],
          [-3.1090e-06,  3.9442e-05, -9.7957e-05,  6.8320e-06],
          [-5.4071e-05,  9.6626e-06, -3.1110e-05, -2.2172e-05],
          [ 8.4688e-05, -1.5001e-04, -6.5034e-05, -1.5338e-04]]],


        [[[ 1.0122e-04,  1.0356e-04, -2.9774e-04, -1.6357e-05],
          [-1.7787e-04, -1.1046e-04, -1.5482e-05, -3.5801e-06],
          [ 5.7620e-05,  7.2593e-05, -1.2473e-04, -2.1015e-04],
          [ 9.0055e-05, -1.3676e-04, -1.8668e-04, -4.2967e-05]],

         [[ 1.0790e-04,  3.0606e-04,  1.0779e-04,  1.0749e-04],
          [ 1.7293e-04,  1.7136e-05,  5.5854e-05,  1.0398e-04],
          [-3.5780e-06, -4.3918e-05, -1.0040e-04,  5.0488e-05],
          [-1.0195e-04,  1.2689e-04, -2.5171e-06, -5.6587e-05]],

         [[-2.2552e-04,  2.3975e-04,  3.2844e-06,  2.3095e-04],
          [ 2.2198e-05,  1.5626e-04,  1.6172e-04,  1.0010e-04],
          [-4.1630e-05, -1.8152e-04, -2.2768e-04, -8.3210e-05],
          [ 1.0314e-05, -7.2635e-05,  1.6973e-04, -6.4593e-05]],

         ...,

         [[-1.8650e-05, -1.6937e-05, -1.7526e-04,  2.5207e-05],
          [-1.5555e-04,  6.3853e-05, -7.9617e-05, -4.1424e-05],
          [ 1.9090e-04, -1.2582e-04,  1.2925e-04, -1.2176e-05],
          [ 1.4228e-04, -3.9195e-05, -1.6481e-04,  2.3814e-05]],

         [[-1.3910e-04, -1.9820e-05, -7.4987e-05, -1.0152e-04],
          [ 3.3630e-05, -6.8295e-06,  5.0034e-05, -2.1133e-04],
          [ 9.3815e-05,  2.5767e-05,  1.6393e-04, -1.7766e-04],
          [-1.0055e-04, -6.0585e-05,  1.0491e-05,  1.8688e-05]],

         [[-6.2017e-06, -4.2175e-05,  1.7813e-05, -7.4299e-05],
          [ 2.7375e-05, -6.6972e-05,  2.8884e-05,  6.3823e-05],
          [ 1.0341e-04,  9.7475e-05, -2.3747e-04, -9.7427e-05],
          [-1.4748e-05, -1.2736e-04,  5.3076e-05, -1.6305e-04]]]]) 
 old gradient:tensor([[-5.8677e-04, -1.5781e-05,  4.9224e-04,  ..., -1.1292e-04,
         -2.3181e-04, -7.0598e-04],
        [ 5.0273e-04,  3.4496e-04,  4.8134e-04,  ...,  1.7904e-04,
         -7.6976e-04, -3.9709e-04],
        [ 1.4805e-04,  3.6995e-04, -1.5025e-04,  ...,  2.3118e-04,
          4.4254e-04,  4.6526e-04],
        ...,
        [-1.1459e-04, -7.4338e-04, -8.6073e-05,  ...,  2.2013e-05,
          4.5410e-04,  1.3576e-04],
        [ 2.3498e-04,  2.1178e-04, -8.4258e-04,  ...,  4.7719e-04,
         -4.1902e-04,  2.4892e-04],
        [ 1.2337e-04,  2.2861e-04, -1.0849e-04,  ..., -1.5557e-04,
         -1.5647e-05, -3.6762e-04]])
2024-11-30 13:24:24,451 - INFO - reading batch[17] client 3
2024-11-30 13:24:24,484 - INFO - reading batch[17] client 4
2024-11-30 13:24:24,511 - INFO - reading batch[18] client 1
2024-11-30 13:24:24,536 - INFO - reading batch[18] client 2
2024-11-30 13:24:24,557 - INFO - reading batch[18] client 3
2024-11-30 13:24:24,578 - INFO - reading batch[18] client 4
2024-11-30 13:24:24,613 - INFO - reading batch[19] client 1
2024-11-30 13:25:16,832 - INFO - reading batch[0] client 1
2024-11-30 13:25:16,855 - INFO - reading batch[0] client 2
2024-11-30 13:25:16,876 - INFO - reading batch[0] client 3
2024-11-30 13:25:16,901 - INFO - reading batch[0] client 4
2024-11-30 13:25:16,939 - INFO - reading batch[1] client 1
2024-11-30 13:25:16,970 - INFO - reading batch[1] client 2
2024-11-30 13:25:17,000 - INFO - reading batch[1] client 3
2024-11-30 13:25:17,034 - INFO - reading batch[1] client 4
2024-11-30 13:25:17,066 - INFO - reading batch[2] client 1
2024-11-30 13:25:17,092 - INFO - reading batch[2] client 2
2024-11-30 13:25:17,120 - INFO - reading batch[2] client 3
2024-11-30 13:25:17,154 - INFO - reading batch[2] client 4
2024-11-30 13:25:17,188 - INFO - reading batch[3] client 1
2024-11-30 13:25:17,210 - INFO - reading batch[3] client 2
2024-11-30 13:25:17,229 - INFO - reading batch[3] client 3
2024-11-30 13:25:17,259 - INFO - reading batch[3] client 4
2024-11-30 13:25:17,290 - INFO - reading batch[4] client 1
2024-11-30 13:25:17,321 - INFO - reading batch[4] client 2
2024-11-30 13:25:17,352 - INFO - reading batch[4] client 3
2024-11-30 13:25:17,373 - INFO - reading batch[4] client 4
2024-11-30 13:25:17,406 - INFO - reading batch[5] client 1
2024-11-30 13:25:17,431 - INFO - reading batch[5] client 2
2024-11-30 13:25:17,452 - INFO - reading batch[5] client 3
2024-11-30 13:25:17,486 - INFO - reading batch[5] client 4
2024-11-30 13:25:17,509 - INFO - Final partition
2024-11-30 13:25:17,510 - ERROR - loss function:2.3066065311431885
2024-11-30 13:25:17,511 - INFO - reading batch[6] client 1
2024-11-30 13:25:17,538 - INFO - reading batch[6] client 2
2024-11-30 13:25:17,567 - INFO - reading batch[6] client 3
2024-11-30 13:25:17,600 - INFO - reading batch[6] client 4
2024-11-30 13:25:17,633 - INFO - reading batch[7] client 1
2024-11-30 13:25:17,657 - INFO - reading batch[7] client 2
2024-11-30 13:25:17,682 - INFO - reading batch[7] client 3
2024-11-30 13:25:17,705 - INFO - reading batch[7] client 4
2024-11-30 13:25:17,737 - INFO - reading batch[8] client 1
2024-11-30 13:25:17,764 - INFO - reading batch[8] client 2
2024-11-30 13:25:17,780 - INFO - reading batch[8] client 3
2024-11-30 13:25:17,808 - INFO - reading batch[8] client 4
2024-11-30 13:25:17,833 - INFO - reading batch[9] client 1
2024-11-30 13:25:17,860 - INFO - reading batch[9] client 2
2024-11-30 13:25:17,897 - INFO - reading batch[9] client 3
2024-11-30 13:25:17,914 - ERROR - backward on partition 4
2024-11-30 13:25:17,916 - CRITICAL - calculate backward $4 on client4
2024-11-30 13:25:17,932 - CRITICAL - new gradient:tensor([[-1.0310e-04, -1.9926e-04,  7.1742e-05,  ...,  2.5485e-05,
         -5.4704e-04,  2.3038e-04],
        [-1.0824e-04, -1.9137e-04,  5.9826e-05,  ...,  2.1808e-05,
         -5.3940e-04,  2.2926e-04],
        [-3.8911e-04,  2.2883e-04,  2.0356e-04,  ...,  2.0792e-04,
         -7.2883e-04,  5.9866e-05],
        ...,
        [ 6.3565e-04, -7.1656e-04, -1.2773e-05,  ...,  2.9271e-04,
          2.4610e-04, -8.1324e-05],
        [-1.2643e-04,  2.7639e-04, -2.9555e-04,  ..., -2.4473e-04,
         -1.3960e-05, -3.3797e-04],
        [-1.6249e-04,  5.4486e-04, -5.4518e-04,  ..., -3.4614e-04,
          4.8378e-04, -4.1530e-04]]) 
 old gradient:tensor([[ 0.0016,  0.0019,  0.0016, -0.0143,  0.0015,  0.0014,  0.0014,  0.0016,
          0.0016,  0.0017],
        [ 0.0015,  0.0019,  0.0017, -0.0142,  0.0015,  0.0015,  0.0014,  0.0016,
          0.0016,  0.0016],
        [ 0.0015, -0.0139,  0.0016,  0.0014,  0.0016,  0.0015,  0.0014,  0.0016,
          0.0017,  0.0016],
        [ 0.0015,  0.0017,  0.0017,  0.0014,  0.0015, -0.0141,  0.0014,  0.0016,
          0.0016,  0.0017],
        [ 0.0016,  0.0018,  0.0016,  0.0013,  0.0016, -0.0142,  0.0014,  0.0016,
          0.0016,  0.0017],
        [ 0.0015, -0.0138,  0.0015,  0.0015,  0.0016,  0.0015,  0.0014,  0.0016,
          0.0017,  0.0017],
        [ 0.0016,  0.0017,  0.0016,  0.0015,  0.0015,  0.0015,  0.0014, -0.0141,
          0.0016,  0.0017],
        [ 0.0015,  0.0017,  0.0017,  0.0014, -0.0141,  0.0015,  0.0014,  0.0016,
          0.0016,  0.0017],
        [ 0.0016,  0.0017,  0.0017, -0.0143,  0.0016,  0.0015,  0.0014,  0.0015,
          0.0017,  0.0016],
        [ 0.0015,  0.0017, -0.0141,  0.0015,  0.0016,  0.0015,  0.0014,  0.0017,
          0.0016,  0.0016],
        [ 0.0015,  0.0018,  0.0016, -0.0142,  0.0016,  0.0015,  0.0014,  0.0017,
          0.0016,  0.0016],
        [ 0.0016,  0.0017, -0.0141,  0.0014,  0.0015,  0.0015,  0.0014,  0.0016,
          0.0016,  0.0016],
        [ 0.0016,  0.0018,  0.0017,  0.0014,  0.0015,  0.0015,  0.0014,  0.0015,
          0.0016, -0.0140],
        [-0.0141,  0.0019,  0.0017,  0.0014,  0.0015,  0.0015,  0.0014,  0.0016,
          0.0016,  0.0015],
        [ 0.0015,  0.0018,  0.0016,  0.0014,  0.0016,  0.0015,  0.0015,  0.0016,
          0.0017, -0.0140],
        [ 0.0015,  0.0017,  0.0017,  0.0013,  0.0016, -0.0141,  0.0014,  0.0016,
          0.0016,  0.0017],
        [ 0.0016,  0.0016,  0.0016,  0.0014,  0.0016,  0.0015,  0.0014,  0.0016,
          0.0017, -0.0139],
        [ 0.0015,  0.0017,  0.0016,  0.0014,  0.0016,  0.0015,  0.0013,  0.0016,
          0.0017, -0.0139],
        [ 0.0016,  0.0018,  0.0016,  0.0013,  0.0016,  0.0013,  0.0013,  0.0017,
         -0.0140,  0.0017],
        [ 0.0015,  0.0018,  0.0016,  0.0014,  0.0015, -0.0142,  0.0014,  0.0016,
          0.0016,  0.0017],
        [ 0.0015,  0.0018,  0.0016,  0.0014,  0.0016,  0.0015,  0.0014,  0.0016,
          0.0016, -0.0140],
        [ 0.0015, -0.0139,  0.0016,  0.0014,  0.0016,  0.0015,  0.0013,  0.0016,
          0.0016,  0.0017],
        [ 0.0015,  0.0018,  0.0016,  0.0016, -0.0141,  0.0015,  0.0014,  0.0016,
          0.0016,  0.0017],
        [ 0.0015, -0.0139,  0.0015,  0.0015,  0.0016,  0.0014,  0.0015,  0.0016,
          0.0016,  0.0017],
        [ 0.0016,  0.0017,  0.0016,  0.0014,  0.0017,  0.0014,  0.0013,  0.0016,
          0.0016, -0.0139],
        [ 0.0016, -0.0139,  0.0015,  0.0015,  0.0016,  0.0015,  0.0014,  0.0015,
          0.0017,  0.0016],
        [ 0.0015,  0.0017,  0.0017,  0.0015,  0.0015,  0.0015,  0.0013, -0.0140,
          0.0016,  0.0016],
        [ 0.0016,  0.0017,  0.0016,  0.0014, -0.0141,  0.0015,  0.0013,  0.0016,
          0.0016,  0.0017],
        [ 0.0016,  0.0018,  0.0015,  0.0014,  0.0016,  0.0014,  0.0013,  0.0018,
         -0.0141,  0.0017],
        [ 0.0016,  0.0018,  0.0016,  0.0014,  0.0016,  0.0014, -0.0143,  0.0017,
          0.0016,  0.0016],
        [ 0.0016,  0.0018,  0.0015,  0.0013,  0.0016,  0.0014,  0.0014,  0.0016,
         -0.0140,  0.0017],
        [ 0.0016,  0.0017, -0.0140,  0.0015,  0.0015,  0.0014,  0.0014,  0.0016,
          0.0016,  0.0017],
        [-0.0141,  0.0018,  0.0016,  0.0014,  0.0017,  0.0015,  0.0014,  0.0016,
          0.0015,  0.0016],
        [ 0.0016,  0.0018,  0.0015,  0.0014,  0.0016,  0.0014,  0.0014,  0.0017,
         -0.0140,  0.0017],
        [ 0.0015, -0.0139,  0.0015,  0.0015,  0.0016,  0.0014,  0.0014,  0.0016,
          0.0017,  0.0017],
        [ 0.0015,  0.0018,  0.0017, -0.0143,  0.0017,  0.0015,  0.0014,  0.0016,
          0.0016,  0.0016],
        [ 0.0016,  0.0017,  0.0017,  0.0014,  0.0015,  0.0015,  0.0014, -0.0140,
          0.0016,  0.0016],
        [ 0.0015,  0.0018, -0.0141,  0.0014,  0.0016,  0.0014,  0.0014,  0.0016,
          0.0017,  0.0017],
        [ 0.0016,  0.0017,  0.0016,  0.0014,  0.0016,  0.0015,  0.0014,  0.0017,
          0.0015, -0.0140],
        [ 0.0015,  0.0018,  0.0017, -0.0143,  0.0016,  0.0015,  0.0014,  0.0016,
          0.0016,  0.0016],
        [ 0.0016, -0.0139,  0.0016,  0.0014,  0.0016,  0.0015,  0.0014,  0.0016,
          0.0017,  0.0016],
        [ 0.0015,  0.0017, -0.0141,  0.0014,  0.0016,  0.0016,  0.0013,  0.0016,
          0.0017,  0.0017],
        [ 0.0015, -0.0138,  0.0015,  0.0015,  0.0016,  0.0015,  0.0014,  0.0016,
          0.0016,  0.0016],
        [ 0.0015,  0.0018,  0.0016,  0.0014,  0.0016,  0.0015,  0.0014, -0.0141,
          0.0016,  0.0016],
        [ 0.0015,  0.0017, -0.0141,  0.0014,  0.0015,  0.0016,  0.0015,  0.0016,
          0.0017,  0.0016],
        [ 0.0015,  0.0017,  0.0016,  0.0014,  0.0016,  0.0015,  0.0014,  0.0016,
          0.0016, -0.0139],
        [-0.0141,  0.0019,  0.0017,  0.0013,  0.0016,  0.0015,  0.0014,  0.0015,
          0.0016,  0.0016],
        [-0.0141,  0.0019,  0.0017,  0.0014,  0.0016,  0.0014,  0.0013,  0.0016,
          0.0016,  0.0016],
        [ 0.0016,  0.0017,  0.0016,  0.0015,  0.0016,  0.0015,  0.0014, -0.0140,
          0.0016,  0.0016],
        [ 0.0015,  0.0017,  0.0016,  0.0014,  0.0016,  0.0015,  0.0014,  0.0016,
          0.0016, -0.0140],
        [ 0.0016,  0.0018,  0.0016,  0.0014,  0.0015,  0.0015, -0.0143,  0.0017,
          0.0015,  0.0017],
        [ 0.0016,  0.0018,  0.0015,  0.0014,  0.0016,  0.0014,  0.0014,  0.0016,
         -0.0140,  0.0017],
        [ 0.0016,  0.0018, -0.0141,  0.0015,  0.0016,  0.0014,  0.0014,  0.0016,
          0.0016,  0.0017],
        [ 0.0015,  0.0019,  0.0016, -0.0142,  0.0016,  0.0014,  0.0014,  0.0016,
          0.0016,  0.0016],
        [ 0.0016,  0.0017,  0.0016,  0.0015,  0.0016,  0.0015,  0.0014, -0.0140,
          0.0016,  0.0016],
        [ 0.0016,  0.0017,  0.0016,  0.0014,  0.0015,  0.0015,  0.0014,  0.0016,
          0.0017, -0.0139],
        [ 0.0016,  0.0017,  0.0017,  0.0015,  0.0016,  0.0015,  0.0014,  0.0016,
          0.0015, -0.0140],
        [-0.0141,  0.0018,  0.0016,  0.0013,  0.0016,  0.0014,  0.0014,  0.0016,
          0.0016,  0.0017],
        [-0.0141,  0.0018,  0.0016,  0.0014,  0.0015,  0.0015,  0.0014,  0.0016,
          0.0017,  0.0017],
        [ 0.0016,  0.0017,  0.0015,  0.0014,  0.0016, -0.0142,  0.0015,  0.0016,
          0.0017,  0.0015],
        [ 0.0016,  0.0019, -0.0140,  0.0015,  0.0015,  0.0015,  0.0014,  0.0016,
          0.0015,  0.0016],
        [ 0.0015,  0.0018,  0.0017,  0.0015,  0.0015,  0.0015, -0.0142,  0.0015,
          0.0016,  0.0016],
        [-0.0141,  0.0019,  0.0017,  0.0014,  0.0015,  0.0015,  0.0014,  0.0016,
          0.0015,  0.0016],
        [ 0.0016,  0.0018,  0.0016,  0.0014,  0.0015,  0.0015,  0.0013,  0.0017,
          0.0016, -0.0140]])
2024-11-30 13:25:17,950 - INFO - reading batch[9] client 4
2024-11-30 13:25:17,982 - INFO - reading batch[10] client 1
2024-11-30 13:25:18,006 - INFO - reading batch[10] client 2
2024-11-30 13:25:18,026 - INFO - reading batch[10] client 3
2024-11-30 13:25:18,059 - INFO - reading batch[10] client 4
2024-11-30 13:25:18,089 - INFO - reading batch[11] client 1
2024-11-30 13:25:18,113 - INFO - reading batch[11] client 2
2024-11-30 13:25:18,147 - INFO - reading batch[11] client 3
2024-11-30 13:25:18,173 - INFO - reading batch[11] client 4
2024-11-30 13:25:18,206 - INFO - reading batch[12] client 1
2024-11-30 13:25:18,240 - INFO - reading batch[12] client 2
2024-11-30 13:25:18,258 - INFO - reading batch[12] client 3
2024-11-30 13:25:18,278 - INFO - reading batch[12] client 4
2024-11-30 13:25:18,306 - INFO - reading batch[13] client 1
2024-11-30 13:25:18,328 - INFO - reading batch[13] client 2
2024-11-30 13:25:18,360 - INFO - reading batch[13] client 3
2024-11-30 13:25:18,390 - INFO - reading batch[13] client 4
2024-11-30 13:25:18,420 - INFO - reading batch[14] client 1
2024-11-30 13:25:18,442 - INFO - reading batch[14] client 2
2024-11-30 13:25:18,473 - INFO - reading batch[14] client 3
2024-11-30 13:25:18,503 - INFO - reading batch[14] client 4
2024-11-30 13:25:18,535 - INFO - reading batch[15] client 1
2024-11-30 13:25:46,744 - INFO - reading batch[0] client 1
2024-11-30 13:25:46,768 - INFO - reading batch[0] client 2
2024-11-30 13:25:46,791 - INFO - reading batch[0] client 3
2024-11-30 13:25:46,820 - INFO - reading batch[0] client 4
2024-11-30 13:25:46,860 - INFO - reading batch[1] client 1
2024-11-30 13:25:46,891 - INFO - reading batch[1] client 2
2024-11-30 13:25:46,917 - INFO - reading batch[1] client 3
2024-11-30 13:25:46,947 - INFO - reading batch[1] client 4
2024-11-30 13:25:46,968 - INFO - reading batch[2] client 1
2024-11-30 13:25:46,988 - INFO - reading batch[2] client 2
2024-11-30 13:25:47,015 - INFO - reading batch[2] client 3
2024-11-30 13:25:47,043 - INFO - reading batch[2] client 4
2024-11-30 13:25:47,072 - INFO - reading batch[3] client 1
2024-11-30 13:25:47,094 - INFO - reading batch[3] client 2
2024-11-30 13:25:47,108 - INFO - reading batch[3] client 3
2024-11-30 13:25:47,132 - INFO - reading batch[3] client 4
2024-11-30 13:25:47,157 - INFO - reading batch[4] client 1
2024-11-30 13:25:47,183 - INFO - reading batch[4] client 2
2024-11-30 13:25:47,208 - INFO - reading batch[4] client 3
2024-11-30 13:25:47,221 - INFO - reading batch[4] client 4
2024-11-30 13:25:47,244 - INFO - reading batch[5] client 1
2024-11-30 13:25:47,266 - INFO - reading batch[5] client 2
2024-11-30 13:25:47,280 - INFO - reading batch[5] client 3
2024-11-30 13:25:47,302 - INFO - reading batch[5] client 4
2024-11-30 13:25:47,319 - INFO - Final partition
2024-11-30 13:25:47,320 - ERROR - loss function:2.306852102279663
2024-11-30 13:25:47,321 - INFO - reading batch[6] client 1
2024-11-30 13:25:47,340 - INFO - reading batch[6] client 2
2024-11-30 13:25:47,368 - INFO - reading batch[6] client 3
2024-11-30 13:25:47,390 - INFO - reading batch[6] client 4
2024-11-30 13:25:47,412 - INFO - reading batch[7] client 1
2024-11-30 13:25:47,437 - INFO - reading batch[7] client 2
2024-11-30 13:25:47,463 - INFO - reading batch[7] client 3
2024-11-30 13:25:47,481 - INFO - reading batch[7] client 4
2024-11-30 13:25:47,516 - INFO - reading batch[8] client 1
2024-11-30 13:25:47,539 - INFO - reading batch[8] client 2
2024-11-30 13:25:47,554 - INFO - reading batch[8] client 3
2024-11-30 13:25:47,577 - INFO - reading batch[8] client 4
2024-11-30 13:25:47,610 - INFO - reading batch[9] client 1
2024-11-30 13:25:47,633 - INFO - reading batch[9] client 2
2024-11-30 13:25:47,666 - INFO - reading batch[9] client 3
2024-11-30 13:25:47,700 - ERROR - backward on partition 4
2024-11-30 13:25:47,704 - CRITICAL - calculate backward $4 on client4
2024-11-30 13:25:47,727 - CRITICAL - new gradient:tensor([[-5.8503e-04,  2.8311e-04,  4.0015e-04,  ...,  5.0891e-05,
         -5.0585e-04, -7.1588e-04],
        [-2.3376e-04,  2.5374e-04, -1.2418e-04,  ..., -1.1627e-04,
          7.7601e-05,  1.7094e-04],
        [ 6.2359e-04, -5.1799e-04, -1.0531e-04,  ...,  3.8002e-04,
         -2.2928e-04,  4.3363e-04],
        ...,
        [-5.8927e-04,  2.7979e-04,  3.9531e-04,  ...,  5.3131e-05,
         -5.0201e-04, -7.1898e-04],
        [ 3.1475e-04,  5.8037e-04, -8.4409e-05,  ...,  8.0563e-04,
         -2.9541e-04, -6.1749e-04],
        [ 3.0889e-04,  5.8589e-04, -7.6284e-05,  ...,  8.0072e-04,
         -3.0032e-04, -6.1516e-04]]) 
 old gradient:tensor([[ 0.0017,  0.0016,  0.0015,  0.0013,  0.0017,  0.0015, -0.0140,  0.0016,
          0.0016,  0.0015],
        [ 0.0016,  0.0015,  0.0015,  0.0013, -0.0140,  0.0016,  0.0018,  0.0015,
          0.0017,  0.0015],
        [-0.0140,  0.0016,  0.0015,  0.0015,  0.0016,  0.0014,  0.0018,  0.0015,
          0.0017,  0.0014],
        [ 0.0015,  0.0014, -0.0141,  0.0014,  0.0016,  0.0015,  0.0018,  0.0016,
          0.0016,  0.0016],
        [ 0.0016,  0.0015,  0.0016,  0.0014,  0.0017,  0.0015,  0.0017,  0.0015,
          0.0018, -0.0142],
        [ 0.0016,  0.0015,  0.0016,  0.0014,  0.0015,  0.0016,  0.0016, -0.0141,
          0.0017,  0.0016],
        [ 0.0015,  0.0016,  0.0015,  0.0015,  0.0017, -0.0141,  0.0017,  0.0016,
          0.0016,  0.0014],
        [ 0.0016,  0.0015,  0.0016,  0.0014,  0.0016,  0.0016,  0.0017, -0.0142,
          0.0017,  0.0015],
        [ 0.0016,  0.0015,  0.0016,  0.0014,  0.0016,  0.0015,  0.0017,  0.0015,
          0.0017, -0.0142],
        [ 0.0016,  0.0016, -0.0141,  0.0014,  0.0017,  0.0015,  0.0017,  0.0015,
          0.0017,  0.0015],
        [ 0.0016,  0.0015,  0.0015,  0.0013, -0.0139,  0.0015,  0.0017,  0.0015,
          0.0017,  0.0015],
        [ 0.0016, -0.0143,  0.0016,  0.0015,  0.0016,  0.0014,  0.0018,  0.0016,
          0.0017,  0.0015],
        [ 0.0016,  0.0015,  0.0016,  0.0015,  0.0016,  0.0014,  0.0018,  0.0014,
         -0.0139,  0.0015],
        [ 0.0016,  0.0015,  0.0015,  0.0015,  0.0015, -0.0140,  0.0016,  0.0015,
          0.0017,  0.0015],
        [-0.0141,  0.0015,  0.0016,  0.0015,  0.0015,  0.0015,  0.0017,  0.0016,
          0.0018,  0.0014],
        [ 0.0016,  0.0015, -0.0141,  0.0014,  0.0016,  0.0015,  0.0017,  0.0015,
          0.0017,  0.0015],
        [ 0.0016,  0.0016,  0.0016,  0.0015,  0.0016, -0.0141,  0.0017,  0.0015,
          0.0017,  0.0014],
        [ 0.0017,  0.0015,  0.0015,  0.0013,  0.0017,  0.0015,  0.0017,  0.0015,
          0.0017, -0.0142],
        [ 0.0016, -0.0142,  0.0016,  0.0015,  0.0016,  0.0014,  0.0017,  0.0016,
          0.0017,  0.0014],
        [ 0.0016,  0.0015,  0.0014,  0.0014,  0.0017,  0.0015,  0.0017,  0.0015,
         -0.0138,  0.0015],
        [ 0.0016,  0.0015,  0.0016, -0.0142,  0.0016,  0.0015,  0.0017,  0.0015,
          0.0017,  0.0015],
        [ 0.0016, -0.0142,  0.0017,  0.0015,  0.0016,  0.0014,  0.0017,  0.0017,
          0.0016,  0.0015],
        [ 0.0016, -0.0142,  0.0016,  0.0015,  0.0016,  0.0014,  0.0017,  0.0016,
          0.0016,  0.0015],
        [ 0.0017,  0.0015, -0.0140,  0.0014,  0.0016,  0.0014,  0.0017,  0.0016,
          0.0016,  0.0014],
        [ 0.0016,  0.0015,  0.0015,  0.0015,  0.0017,  0.0014,  0.0018,  0.0014,
         -0.0139,  0.0015],
        [ 0.0016,  0.0015,  0.0015,  0.0013,  0.0018,  0.0014,  0.0017,  0.0016,
         -0.0140,  0.0015],
        [ 0.0017,  0.0015,  0.0016,  0.0014,  0.0016,  0.0014, -0.0140,  0.0015,
          0.0017,  0.0016],
        [ 0.0016,  0.0014, -0.0141,  0.0015,  0.0017,  0.0014,  0.0018,  0.0016,
          0.0017,  0.0015],
        [ 0.0016,  0.0016,  0.0015,  0.0014, -0.0139,  0.0016,  0.0017,  0.0015,
          0.0017,  0.0014],
        [ 0.0015,  0.0015,  0.0016,  0.0015, -0.0139,  0.0015,  0.0017,  0.0015,
          0.0017,  0.0014],
        [ 0.0016,  0.0015,  0.0015,  0.0014,  0.0017,  0.0014,  0.0018,  0.0014,
         -0.0139,  0.0016],
        [ 0.0017,  0.0015,  0.0015, -0.0143,  0.0015,  0.0015,  0.0017,  0.0016,
          0.0016,  0.0015],
        [ 0.0016, -0.0142,  0.0015,  0.0016,  0.0016,  0.0014,  0.0018,  0.0017,
          0.0017,  0.0014],
        [ 0.0017,  0.0016,  0.0015,  0.0014,  0.0017,  0.0015,  0.0017,  0.0014,
          0.0018, -0.0143],
        [ 0.0016,  0.0016, -0.0141,  0.0014,  0.0016,  0.0016,  0.0017,  0.0015,
          0.0017,  0.0014],
        [ 0.0015,  0.0015,  0.0015,  0.0015,  0.0017,  0.0015,  0.0017,  0.0015,
         -0.0139,  0.0014],
        [ 0.0017,  0.0016,  0.0016,  0.0014,  0.0017,  0.0014, -0.0140,  0.0015,
          0.0016,  0.0015],
        [-0.0140,  0.0015,  0.0016,  0.0014,  0.0015,  0.0015,  0.0017,  0.0015,
          0.0017,  0.0015],
        [ 0.0015,  0.0015,  0.0016, -0.0143,  0.0016,  0.0016,  0.0017,  0.0015,
          0.0017,  0.0015],
        [ 0.0016,  0.0016,  0.0016,  0.0014,  0.0016, -0.0142,  0.0017,  0.0015,
          0.0018,  0.0015],
        [ 0.0016,  0.0016,  0.0015,  0.0015,  0.0016,  0.0015, -0.0140,  0.0015,
          0.0016,  0.0015],
        [ 0.0017,  0.0015,  0.0016,  0.0014, -0.0141,  0.0015,  0.0017,  0.0017,
          0.0016,  0.0014],
        [ 0.0017,  0.0015,  0.0016,  0.0013,  0.0017,  0.0014, -0.0139,  0.0015,
          0.0017,  0.0014],
        [ 0.0016,  0.0016,  0.0015, -0.0142,  0.0016,  0.0016,  0.0017,  0.0015,
          0.0018,  0.0014],
        [ 0.0016,  0.0015,  0.0016,  0.0014,  0.0016, -0.0141,  0.0017,  0.0016,
          0.0016,  0.0015],
        [ 0.0016,  0.0016,  0.0015,  0.0015,  0.0017,  0.0014,  0.0017,  0.0016,
          0.0017, -0.0143],
        [ 0.0016, -0.0141,  0.0016,  0.0014,  0.0017,  0.0015,  0.0018,  0.0015,
          0.0016,  0.0015],
        [-0.0140,  0.0015,  0.0015,  0.0014,  0.0015,  0.0015,  0.0018,  0.0016,
          0.0017,  0.0014],
        [ 0.0017,  0.0016,  0.0015,  0.0014, -0.0140,  0.0016,  0.0016,  0.0015,
          0.0016,  0.0015],
        [ 0.0017,  0.0015,  0.0015,  0.0014,  0.0016,  0.0015, -0.0140,  0.0015,
          0.0017,  0.0015],
        [ 0.0016,  0.0015,  0.0015,  0.0014,  0.0016,  0.0015,  0.0017,  0.0015,
         -0.0138,  0.0015],
        [ 0.0015,  0.0016,  0.0015,  0.0015,  0.0016,  0.0014,  0.0018,  0.0015,
         -0.0139,  0.0015],
        [ 0.0016,  0.0015,  0.0016,  0.0014,  0.0017,  0.0014,  0.0017,  0.0015,
          0.0018, -0.0143],
        [ 0.0016,  0.0016,  0.0016,  0.0014,  0.0015, -0.0142,  0.0017,  0.0015,
          0.0017,  0.0014],
        [ 0.0016,  0.0016,  0.0015,  0.0014,  0.0016,  0.0014,  0.0018,  0.0015,
         -0.0139,  0.0014],
        [ 0.0017,  0.0015,  0.0015,  0.0014,  0.0017,  0.0014, -0.0139,  0.0015,
          0.0017,  0.0015],
        [ 0.0016,  0.0016,  0.0016,  0.0014,  0.0017,  0.0015, -0.0139,  0.0015,
          0.0017,  0.0014],
        [ 0.0017,  0.0016,  0.0015,  0.0014,  0.0016,  0.0016,  0.0017,  0.0015,
          0.0017, -0.0142],
        [ 0.0016, -0.0141,  0.0016,  0.0015,  0.0015,  0.0015,  0.0017,  0.0017,
          0.0016,  0.0015],
        [ 0.0016,  0.0016, -0.0141,  0.0013,  0.0017,  0.0014,  0.0017,  0.0016,
          0.0017,  0.0015],
        [ 0.0016,  0.0015,  0.0016,  0.0014,  0.0016,  0.0015,  0.0017, -0.0141,
          0.0017,  0.0015],
        [ 0.0017,  0.0015,  0.0016,  0.0014,  0.0016,  0.0015, -0.0140,  0.0015,
          0.0017,  0.0015],
        [ 0.0016,  0.0015,  0.0016,  0.0015,  0.0016, -0.0142,  0.0017,  0.0015,
          0.0016,  0.0015],
        [ 0.0016,  0.0016,  0.0015,  0.0014,  0.0015, -0.0141,  0.0016,  0.0015,
          0.0018,  0.0015]])
2024-11-30 13:25:47,727 - INFO - reading batch[9] client 4
2024-11-30 13:25:47,779 - INFO - reading batch[10] client 1
2024-11-30 13:25:47,824 - INFO - reading batch[10] client 2
2024-11-30 13:25:47,864 - INFO - reading batch[10] client 3
2024-11-30 13:25:47,898 - INFO - reading batch[10] client 4
2024-11-30 13:25:47,921 - INFO - reading batch[11] client 1
2024-11-30 13:25:47,939 - INFO - reading batch[11] client 2
2024-11-30 13:25:47,964 - INFO - reading batch[11] client 3
2024-11-30 13:25:47,997 - INFO - reading batch[11] client 4
2024-11-30 13:25:48,026 - INFO - reading batch[12] client 1
2024-11-30 13:25:48,048 - INFO - reading batch[12] client 2
2024-11-30 13:25:48,062 - INFO - reading batch[12] client 3
2024-11-30 13:25:48,079 - INFO - reading batch[12] client 4
2024-11-30 13:25:48,109 - INFO - reading batch[13] client 1
2024-11-30 13:25:48,129 - INFO - reading batch[13] client 2
2024-11-30 13:25:48,152 - INFO - reading batch[13] client 3
2024-11-30 13:25:48,175 - INFO - reading batch[13] client 4
2024-11-30 13:25:48,199 - INFO - reading batch[14] client 1
2024-11-30 13:25:48,217 - INFO - reading batch[14] client 2
2024-11-30 13:25:48,241 - INFO - reading batch[14] client 3
2024-11-30 13:25:48,265 - INFO - reading batch[14] client 4
2024-11-30 13:25:48,289 - INFO - reading batch[15] client 1
2024-11-30 13:25:48,313 - INFO - reading batch[15] client 2
2024-11-30 13:25:48,330 - INFO - reading batch[15] client 3
2024-11-30 13:25:48,348 - INFO - reading batch[15] client 4
2024-11-30 13:25:48,371 - INFO - reading batch[16] client 1
2024-11-30 13:25:48,399 - INFO - reading batch[16] client 2
2024-11-30 13:25:48,423 - INFO - reading batch[16] client 3
2024-11-30 13:25:48,447 - INFO - reading batch[16] client 4
2024-11-30 13:25:48,468 - INFO - reading batch[17] client 1
2024-11-30 13:25:48,492 - INFO - reading batch[17] client 2
2024-11-30 13:25:48,508 - ERROR - backward on partition 3
2024-11-30 13:25:48,512 - CRITICAL - calculate backward $3 on client3
2024-11-30 13:25:48,521 - CRITICAL - new gradient:tensor([[[[-7.2556e-05, -4.9163e-05, -1.3427e-04, -1.1662e-05],
          [ 3.8922e-05,  5.2800e-05,  1.5100e-05,  2.2175e-05],
          [ 8.1137e-05,  3.6265e-06,  2.3570e-05, -6.3557e-05],
          [-1.6024e-04,  7.4989e-05,  5.3458e-05, -1.1795e-04]],

         [[-1.3702e-05,  2.8965e-05, -5.1043e-05,  6.3592e-05],
          [-6.8251e-05,  1.2871e-04,  3.8701e-05,  9.7508e-05],
          [ 5.1820e-05,  6.8342e-06, -1.0667e-04, -6.3846e-05],
          [ 4.9053e-05,  1.8361e-05, -8.9248e-05,  1.0502e-04]],

         [[-7.2431e-06,  2.0461e-04,  1.0279e-04, -1.7815e-04],
          [-1.3836e-04, -4.8972e-05,  7.6304e-05,  1.8528e-05],
          [ 1.1626e-04,  1.6153e-05, -3.8432e-05, -1.1100e-04],
          [-1.9379e-05, -1.5111e-04,  1.5992e-04, -1.6297e-04]],

         ...,

         [[ 7.8457e-06,  8.6938e-05,  1.2718e-04, -3.2093e-05],
          [-4.3678e-05,  6.0375e-05, -5.7509e-05, -1.0381e-04],
          [ 1.1203e-04, -9.0145e-05,  5.7295e-05,  9.4699e-05],
          [ 7.7460e-05, -1.2335e-04, -1.0589e-04,  1.8595e-04]],

         [[-6.3466e-05,  3.0467e-06, -8.8760e-05, -1.0209e-04],
          [-1.6452e-04,  1.2657e-05,  1.2287e-04, -1.0509e-04],
          [ 7.9031e-06, -2.2019e-04, -1.5954e-04, -8.0865e-05],
          [-1.0141e-05, -4.5820e-05,  8.1561e-05, -3.5833e-05]],

         [[-2.7821e-04,  6.9382e-05, -4.7441e-05,  1.8897e-04],
          [ 5.3288e-05, -2.2300e-04, -3.7911e-06,  1.4485e-04],
          [-1.0216e-04,  4.6691e-05, -2.2991e-05, -2.6432e-05],
          [-1.2464e-05, -6.7348e-05,  2.8263e-05, -1.1437e-04]]],


        [[[ 1.0793e-04,  2.4637e-05, -3.5196e-05,  1.4592e-04],
          [ 1.1775e-04,  1.2536e-05, -8.1752e-05, -1.4940e-04],
          [ 6.5497e-05, -2.5389e-05,  1.5275e-04, -1.1443e-04],
          [-4.3119e-05, -8.1511e-05,  3.2310e-07, -1.7481e-04]],

         [[ 1.1266e-04, -6.5128e-05,  9.4565e-05,  7.3080e-05],
          [ 4.1224e-05,  1.1625e-04,  9.5650e-05,  2.2751e-04],
          [-1.6928e-04,  1.1654e-05, -8.5057e-05,  1.9879e-05],
          [-1.5195e-05, -1.2412e-04,  2.6385e-05, -9.8294e-05]],

         [[-5.4045e-05,  8.9830e-05,  3.6504e-05,  6.7479e-05],
          [-1.1518e-04,  2.6625e-05, -8.6072e-05,  3.5358e-05],
          [ 8.2055e-05, -1.0984e-05, -8.2173e-05,  6.4088e-05],
          [-6.1135e-07,  1.7857e-04,  1.2766e-04, -8.2982e-05]],

         ...,

         [[ 1.0988e-04, -5.3276e-05, -8.9215e-05,  8.8073e-05],
          [ 4.9375e-05,  4.7532e-05, -2.1743e-05, -6.8574e-05],
          [-1.3791e-05,  5.1322e-05,  7.5300e-05,  2.8963e-06],
          [-4.1692e-05,  2.9733e-05, -1.2700e-05,  6.6680e-05]],

         [[-2.3934e-04, -4.9790e-05, -1.1137e-06, -2.8155e-05],
          [ 1.0777e-05,  2.3472e-04,  4.3508e-05, -9.1089e-05],
          [-1.1087e-04,  3.5147e-05, -1.2251e-05,  1.1996e-04],
          [ 5.8680e-05, -1.4516e-04, -8.2973e-05, -1.3550e-04]],

         [[ 9.7973e-05,  6.7764e-05, -8.0917e-05, -2.1736e-05],
          [-4.1110e-05,  4.2795e-05,  1.6842e-05, -2.2270e-05],
          [ 3.9419e-05,  1.0313e-05,  1.0730e-04, -4.3843e-05],
          [ 1.2092e-05, -1.7241e-04,  6.1050e-05, -4.5010e-05]]],


        [[[ 7.7182e-05, -6.5418e-05, -9.6596e-05, -9.5708e-05],
          [ 3.3939e-05, -1.3950e-04, -1.9195e-05,  1.1556e-07],
          [ 4.7773e-05, -2.6576e-05, -2.2565e-04,  2.4262e-04],
          [-1.0314e-04,  3.4275e-06, -1.0684e-04, -1.9092e-05]],

         [[-1.7591e-04,  3.8699e-05, -6.2366e-05, -2.2991e-04],
          [ 1.1293e-04, -8.3461e-05,  1.3273e-04, -5.0134e-05],
          [ 1.0886e-04, -1.0338e-04,  1.7495e-04,  5.6888e-05],
          [ 6.0393e-05,  1.9344e-04,  3.7979e-05, -3.0746e-05]],

         [[-1.9670e-04, -4.7049e-05, -4.8476e-05,  1.5224e-04],
          [ 2.8198e-05,  1.6647e-04, -6.7182e-05,  1.8368e-05],
          [-1.0145e-04,  5.2736e-06, -5.3513e-05,  3.9125e-05],
          [ 1.2701e-04, -1.0129e-04,  2.5737e-05, -5.7006e-05]],

         ...,

         [[ 3.9793e-06,  1.3746e-04, -1.1555e-04,  2.0320e-04],
          [ 1.8499e-04,  1.3871e-04, -1.2736e-04,  2.1809e-06],
          [-6.6956e-05, -7.0083e-06,  4.0240e-05,  4.6704e-06],
          [-1.3785e-05,  8.5814e-05,  1.2907e-05, -1.0428e-04]],

         [[-7.3074e-05,  4.8994e-05,  7.7727e-05, -2.5962e-05],
          [-5.5371e-05, -1.4305e-04, -1.0844e-04,  1.5222e-04],
          [-4.3608e-05,  1.7276e-05,  1.1251e-05,  2.2187e-05],
          [ 1.0016e-04,  4.1303e-05, -7.3653e-05,  5.1550e-07]],

         [[-3.5168e-05,  1.3415e-05,  1.1296e-04,  3.9952e-05],
          [ 2.1401e-05,  1.4244e-04,  1.0330e-04,  7.3152e-05],
          [ 7.8746e-05,  1.8113e-04, -9.9614e-05, -6.5836e-05],
          [-6.4806e-05,  5.5321e-05, -8.5580e-05, -2.8842e-05]]],


        ...,


        [[[-1.1820e-04, -1.1744e-04, -6.2796e-07, -4.5963e-05],
          [-3.4200e-05,  1.3255e-04, -1.7027e-05,  1.2288e-04],
          [ 8.5096e-05,  7.0206e-06, -4.1158e-05, -1.7371e-04],
          [-2.3120e-05,  1.0210e-04, -3.5552e-05, -1.6692e-04]],

         [[ 8.5906e-06,  8.3493e-05, -1.8710e-05,  6.0964e-05],
          [ 2.6744e-05,  1.0139e-04,  6.1860e-06,  1.5587e-04],
          [ 4.5785e-05,  1.1722e-04, -2.7686e-05, -9.3912e-06],
          [-9.9522e-05, -7.4988e-05, -1.4234e-04,  4.5690e-05]],

         [[ 4.7398e-05,  1.3465e-05,  1.8332e-05, -3.9772e-04],
          [-1.5581e-04,  8.3473e-07,  1.1126e-04,  3.3427e-05],
          [ 4.0689e-05,  1.0087e-04, -2.1900e-05, -6.9775e-05],
          [-8.0820e-05, -7.6559e-05,  1.2592e-04, -1.8799e-04]],

         ...,

         [[ 1.7581e-04,  1.0673e-04, -2.1048e-05, -5.7053e-05],
          [-5.8505e-05,  1.0093e-04, -4.4541e-06, -4.4038e-05],
          [ 1.8562e-04, -4.7049e-05, -8.5946e-05,  2.7813e-05],
          [ 2.8814e-05, -1.3502e-05, -9.6344e-05,  1.6111e-04]],

         [[ 3.4215e-05, -4.2291e-05, -1.0814e-04, -3.4057e-05],
          [-1.0681e-04, -5.3778e-05, -1.2159e-05, -3.6111e-05],
          [-7.7672e-05, -3.3513e-04, -1.0535e-04, -4.6290e-05],
          [-1.2291e-04,  1.9077e-05,  1.3144e-04, -1.7727e-04]],

         [[-3.9748e-04,  1.4259e-04,  1.0587e-05,  1.8459e-04],
          [ 1.3075e-04, -2.0803e-04, -6.1339e-07,  1.0904e-04],
          [-1.6383e-04,  4.7971e-05,  1.5428e-05, -5.7539e-05],
          [ 8.3232e-05,  1.1697e-04,  5.3173e-05, -1.3429e-04]]],


        [[[ 1.6934e-04,  7.9911e-05, -1.6207e-05,  9.9762e-05],
          [-4.9631e-05, -7.8425e-05,  5.1188e-05,  9.5255e-06],
          [-3.8252e-05, -7.4809e-05, -2.1203e-04,  7.2843e-05],
          [-1.5729e-04, -2.2578e-05,  1.7621e-04,  9.7018e-05]],

         [[-7.5985e-05, -1.3274e-04, -2.7760e-04,  7.5924e-05],
          [-6.2650e-05, -3.9909e-05, -9.9962e-05, -2.1049e-04],
          [ 2.8944e-05, -1.5083e-04,  9.6151e-05, -5.1937e-05],
          [ 8.6336e-05,  9.0438e-05, -5.0197e-05, -9.4263e-05]],

         [[-2.3700e-05, -3.8767e-05,  9.3954e-05,  1.3498e-04],
          [ 1.7090e-04,  9.2999e-05,  4.8097e-05,  8.1098e-05],
          [ 1.2880e-04, -2.5826e-05,  6.2853e-05,  3.4469e-05],
          [-5.0331e-05, -7.2821e-05, -1.2819e-04, -2.1327e-04]],

         ...,

         [[-5.3644e-05,  5.4596e-05, -1.6332e-04, -2.0878e-04],
          [ 7.9818e-05, -1.1314e-04, -1.3361e-04, -2.9526e-05],
          [-7.0192e-05,  1.0858e-04, -6.5973e-05,  9.0902e-05],
          [-4.3811e-05, -1.2102e-04, -1.6081e-05, -6.1279e-05]],

         [[-5.4389e-05, -8.2369e-05, -7.8828e-05,  6.3016e-05],
          [-1.1047e-04,  9.1101e-05, -8.1311e-05,  1.8967e-04],
          [ 4.9835e-05,  3.6662e-05,  1.2845e-04, -5.6360e-05],
          [ 2.7860e-05, -2.2098e-05,  5.3243e-05,  1.6045e-05]],

         [[-4.1686e-05,  7.0681e-06,  1.0529e-04,  2.3200e-05],
          [ 1.2138e-04, -7.4433e-05,  1.3292e-04,  5.1259e-05],
          [ 8.6646e-06,  1.9386e-04, -1.7730e-04,  5.7842e-05],
          [-1.2118e-04,  1.0085e-04, -1.7171e-04, -5.9940e-05]]],


        [[[ 6.0328e-05,  6.5049e-05,  2.2471e-05,  8.2683e-05],
          [-8.5824e-05, -3.7153e-05,  1.0429e-04,  9.7227e-06],
          [-3.8067e-05, -8.8388e-05, -1.5955e-04,  1.0197e-04],
          [-1.5749e-04, -2.2035e-05,  2.5477e-04,  1.0817e-04]],

         [[-1.3986e-04, -1.2483e-04, -2.5202e-04,  1.2208e-04],
          [-1.1626e-04, -1.5403e-04, -4.2394e-05, -1.8744e-04],
          [ 4.9953e-05,  4.2851e-06,  1.3971e-04, -6.3311e-05],
          [ 7.3493e-05,  1.1147e-04,  4.3295e-05,  7.5985e-06]],

         [[-6.5966e-05, -6.4267e-05,  4.9099e-05, -2.2070e-05],
          [ 1.7469e-04, -1.0563e-05,  3.5076e-05,  1.2503e-04],
          [ 5.7272e-05, -6.9524e-05,  5.9762e-05, -7.1803e-05],
          [-6.2430e-05,  5.6071e-05, -8.6780e-05, -1.9943e-04]],

         ...,

         [[-3.8181e-05,  4.7832e-05, -2.5046e-04, -3.3481e-04],
          [ 1.6617e-04, -2.4272e-05, -5.3860e-05, -7.2587e-05],
          [-4.2353e-05,  5.1352e-05, -4.2591e-05, -1.0654e-05],
          [-6.1210e-05, -1.4618e-04, -8.3838e-05, -2.0256e-04]],

         [[ 4.7263e-05, -1.2040e-04, -1.6264e-04, -1.4738e-05],
          [-1.2853e-04,  2.7989e-05, -1.4847e-04,  1.9260e-04],
          [-1.5268e-05,  1.3913e-04,  1.9645e-04, -1.1715e-05],
          [-7.2131e-05,  1.0160e-05,  1.7697e-04, -3.3572e-05]],

         [[-8.4009e-05, -1.0705e-04,  1.5891e-04,  5.4797e-05],
          [ 1.3436e-04,  7.9316e-06,  1.7384e-04, -3.3578e-05],
          [ 1.0375e-04,  2.1536e-04, -8.8783e-05,  1.6125e-04],
          [ 1.4039e-05,  2.0955e-04, -2.0418e-04, -9.1896e-05]]]]) 
 old gradient:tensor([[-5.8503e-04,  2.8311e-04,  4.0015e-04,  ...,  5.0891e-05,
         -5.0585e-04, -7.1588e-04],
        [-2.3376e-04,  2.5374e-04, -1.2418e-04,  ..., -1.1627e-04,
          7.7601e-05,  1.7094e-04],
        [ 6.2359e-04, -5.1799e-04, -1.0531e-04,  ...,  3.8002e-04,
         -2.2928e-04,  4.3363e-04],
        ...,
        [-5.8927e-04,  2.7979e-04,  3.9531e-04,  ...,  5.3131e-05,
         -5.0201e-04, -7.1898e-04],
        [ 3.1475e-04,  5.8037e-04, -8.4409e-05,  ...,  8.0563e-04,
         -2.9541e-04, -6.1749e-04],
        [ 3.0889e-04,  5.8589e-04, -7.6284e-05,  ...,  8.0072e-04,
         -3.0032e-04, -6.1516e-04]])
2024-11-30 13:25:48,521 - INFO - reading batch[17] client 3
2024-11-30 13:25:48,553 - INFO - reading batch[17] client 4
2024-11-30 13:25:48,576 - INFO - reading batch[18] client 1
2024-11-30 13:25:48,595 - INFO - reading batch[18] client 2
2024-11-30 13:25:48,612 - INFO - reading batch[18] client 3
2024-11-30 13:25:48,631 - INFO - reading batch[18] client 4
2024-11-30 13:25:48,656 - INFO - reading batch[19] client 1
2024-11-30 13:25:48,688 - INFO - reading batch[19] client 2
2024-11-30 13:25:48,712 - INFO - reading batch[19] client 3
2024-11-30 13:25:48,737 - INFO - reading batch[19] client 4
2024-11-30 13:25:48,761 - INFO - reading batch[20] client 1
2024-11-30 13:25:48,789 - INFO - reading batch[20] client 2
2024-11-30 13:25:48,807 - INFO - reading batch[20] client 3
2024-11-30 13:25:48,835 - INFO - reading batch[20] client 4
2024-11-30 13:25:48,848 - INFO - Final partition
2024-11-30 13:25:48,849 - ERROR - loss function:2.307474374771118
2024-11-30 13:25:48,849 - INFO - reading batch[21] client 1
2024-11-30 13:25:48,872 - INFO - reading batch[21] client 2
2024-11-30 13:25:48,897 - INFO - reading batch[21] client 3
2024-11-30 13:25:48,926 - INFO - reading batch[21] client 4
2024-11-30 13:25:48,957 - INFO - reading batch[22] client 1
2024-11-30 13:25:48,979 - INFO - reading batch[22] client 2
2024-11-30 13:25:49,002 - INFO - reading batch[22] client 3
2024-11-30 13:25:49,019 - INFO - reading batch[22] client 4
2024-11-30 13:25:49,045 - INFO - reading batch[23] client 1
2024-11-30 13:25:49,064 - INFO - reading batch[23] client 2
2024-11-30 13:25:49,077 - INFO - Final partition
2024-11-30 13:25:49,077 - ERROR - loss function:2.3043830394744873
2024-11-30 13:25:49,077 - INFO - reading batch[23] client 3
2024-11-30 13:25:49,093 - INFO - Final partition
2024-11-30 13:25:49,093 - ERROR - loss function:2.3295304775238037
2024-11-30 13:25:49,093 - INFO - reading batch[23] client 4
2024-11-30 13:25:49,117 - INFO - reading batch[24] client 1
2024-11-30 13:25:49,135 - INFO - reading batch[24] client 2
2024-11-30 13:25:49,149 - INFO - reading batch[24] client 3
2024-11-30 13:25:49,171 - INFO - reading batch[24] client 4
2024-11-30 13:25:49,195 - INFO - reading batch[25] client 1
2024-11-30 13:25:49,219 - INFO - reading batch[25] client 2
2024-11-30 13:25:49,246 - INFO - reading batch[25] client 3
2024-11-30 13:25:49,276 - INFO - reading batch[25] client 4
2024-11-30 13:25:49,301 - INFO - reading batch[26] client 1
2024-11-30 13:25:49,327 - INFO - reading batch[26] client 2
2024-11-30 13:25:49,348 - INFO - reading batch[26] client 3
2024-11-30 13:25:49,375 - INFO - reading batch[26] client 4
2024-11-30 13:25:49,408 - INFO - reading batch[27] client 1
2024-11-30 13:25:49,422 - INFO - Final partition
2024-11-30 13:25:49,423 - ERROR - loss function:2.3032238483428955
2024-11-30 13:25:49,423 - INFO - reading batch[27] client 2
2024-11-30 13:25:49,453 - INFO - reading batch[27] client 3
2024-11-30 13:25:49,469 - INFO - reading batch[27] client 4
2024-11-30 13:25:49,491 - INFO - reading batch[28] client 1
2024-11-30 13:25:49,509 - INFO - reading batch[28] client 2
2024-11-30 13:25:49,529 - INFO - reading batch[28] client 3
2024-11-30 13:25:49,555 - INFO - reading batch[28] client 4
2024-11-30 13:25:49,582 - INFO - reading batch[29] client 1
2024-11-30 13:25:49,600 - INFO - reading batch[29] client 2
2024-11-30 13:25:49,624 - INFO - reading batch[29] client 3
2024-11-30 13:25:49,654 - INFO - reading batch[29] client 4
2024-11-30 13:25:49,681 - INFO - reading batch[30] client 1
2024-11-30 13:25:49,708 - INFO - reading batch[30] client 2
2024-11-30 13:25:49,732 - INFO - reading batch[30] client 3
2024-11-30 13:25:49,745 - INFO - reading batch[30] client 4
2024-11-30 13:25:49,768 - INFO - reading batch[31] client 1
2024-11-30 13:25:49,787 - INFO - reading batch[31] client 2
2024-11-30 13:25:49,801 - INFO - reading batch[31] client 3
2024-11-30 13:25:49,823 - INFO - reading batch[31] client 4
2024-11-30 13:25:49,855 - INFO - reading batch[32] client 1
2024-11-30 13:25:49,882 - INFO - reading batch[32] client 2
2024-11-30 13:25:49,907 - INFO - reading batch[32] client 3
2024-11-30 13:25:49,920 - ERROR - backward on partition 4
2024-11-30 13:25:49,921 - CRITICAL - calculate backward $4 on client4
2024-11-30 13:25:49,927 - CRITICAL - new gradient:tensor([[ 1.3837e-05, -1.9502e-05,  3.0335e-04,  ..., -1.4491e-04,
         -1.8899e-05, -1.2933e-04],
        [ 3.1631e-04,  5.7912e-04, -8.3369e-05,  ...,  8.0050e-04,
         -2.9668e-04, -6.1056e-04],
        [-2.2147e-04, -4.3592e-04, -4.3618e-04,  ..., -5.1617e-04,
          4.7885e-04,  3.5278e-04],
        ...,
        [ 3.1572e-04,  5.8128e-04, -7.9051e-05,  ...,  8.0811e-04,
         -3.0147e-04, -6.1889e-04],
        [-2.2297e-04, -4.3107e-04, -4.3246e-04,  ..., -5.1113e-04,
          4.7525e-04,  3.4505e-04],
        [-2.2341e-04, -4.2756e-04, -4.3638e-04,  ..., -5.1055e-04,
          4.7662e-04,  3.4431e-04]]) 
 old gradient:tensor([[ 0.0015,  0.0016,  0.0015,  0.0015,  0.0017,  0.0015,  0.0017,  0.0014,
         -0.0138,  0.0015],
        [ 0.0016,  0.0015,  0.0016,  0.0014,  0.0016, -0.0142,  0.0018,  0.0016,
          0.0017,  0.0015],
        [ 0.0016,  0.0015,  0.0015,  0.0014,  0.0017,  0.0015,  0.0017,  0.0015,
          0.0017, -0.0142],
        [ 0.0015,  0.0015,  0.0016,  0.0015,  0.0016, -0.0142,  0.0018,  0.0015,
          0.0017,  0.0015],
        [ 0.0016,  0.0015,  0.0015,  0.0015,  0.0016,  0.0015,  0.0017, -0.0141,
          0.0017,  0.0015],
        [ 0.0016,  0.0014, -0.0141,  0.0014,  0.0017,  0.0015,  0.0018,  0.0016,
          0.0017,  0.0015],
        [ 0.0016,  0.0015,  0.0016,  0.0014,  0.0016, -0.0142,  0.0018,  0.0015,
          0.0017,  0.0014],
        [-0.0140,  0.0016,  0.0015,  0.0014,  0.0016,  0.0014,  0.0017,  0.0014,
          0.0017,  0.0016],
        [ 0.0015,  0.0016,  0.0015,  0.0014,  0.0016, -0.0141,  0.0017,  0.0015,
          0.0017,  0.0015],
        [ 0.0016,  0.0015,  0.0015, -0.0142,  0.0015,  0.0015,  0.0017,  0.0015,
          0.0017,  0.0015],
        [ 0.0017,  0.0015,  0.0016,  0.0014,  0.0016,  0.0015,  0.0016, -0.0141,
          0.0018,  0.0015],
        [ 0.0016, -0.0141,  0.0016,  0.0015,  0.0016,  0.0015,  0.0017,  0.0016,
          0.0016,  0.0015],
        [ 0.0016,  0.0015,  0.0015,  0.0015,  0.0015,  0.0015,  0.0016, -0.0141,
          0.0017,  0.0015],
        [ 0.0016,  0.0015,  0.0016,  0.0014,  0.0016,  0.0015,  0.0017,  0.0015,
          0.0017, -0.0142],
        [-0.0139,  0.0015,  0.0016,  0.0014,  0.0016,  0.0016,  0.0017,  0.0014,
          0.0016,  0.0015],
        [ 0.0016,  0.0015,  0.0016,  0.0013, -0.0139,  0.0015,  0.0017,  0.0015,
          0.0016,  0.0015],
        [-0.0141,  0.0015,  0.0016,  0.0014,  0.0017,  0.0015,  0.0017,  0.0016,
          0.0018,  0.0014],
        [ 0.0016,  0.0015,  0.0016,  0.0015,  0.0016, -0.0140,  0.0016,  0.0015,
          0.0018,  0.0014],
        [ 0.0017,  0.0016,  0.0015,  0.0014,  0.0016,  0.0015,  0.0016,  0.0015,
          0.0017, -0.0141],
        [ 0.0015,  0.0016,  0.0016,  0.0014,  0.0015, -0.0141,  0.0017,  0.0015,
          0.0017,  0.0015],
        [ 0.0017,  0.0016,  0.0016,  0.0015,  0.0016,  0.0015, -0.0140,  0.0014,
          0.0016,  0.0015],
        [ 0.0017,  0.0015,  0.0016,  0.0014,  0.0016,  0.0015,  0.0017, -0.0142,
          0.0018,  0.0015],
        [ 0.0016,  0.0014, -0.0141,  0.0014,  0.0016,  0.0015,  0.0017,  0.0016,
          0.0016,  0.0016],
        [ 0.0016, -0.0142,  0.0016,  0.0015,  0.0016,  0.0015,  0.0018,  0.0016,
          0.0016,  0.0015],
        [ 0.0015,  0.0016,  0.0015,  0.0015,  0.0017,  0.0015,  0.0018,  0.0015,
         -0.0139,  0.0014],
        [-0.0139,  0.0015,  0.0016,  0.0014,  0.0016,  0.0016,  0.0017,  0.0015,
          0.0016,  0.0015],
        [ 0.0016,  0.0015,  0.0016,  0.0014,  0.0017,  0.0015,  0.0017,  0.0015,
          0.0018, -0.0142],
        [ 0.0016,  0.0015,  0.0016,  0.0014,  0.0015,  0.0016,  0.0016, -0.0142,
          0.0016,  0.0016],
        [ 0.0016,  0.0016, -0.0141,  0.0014,  0.0016,  0.0015,  0.0017,  0.0015,
          0.0017,  0.0015],
        [ 0.0016, -0.0142,  0.0016,  0.0015,  0.0016,  0.0014,  0.0017,  0.0016,
          0.0017,  0.0014],
        [ 0.0015,  0.0015,  0.0016,  0.0015,  0.0017,  0.0014,  0.0017,  0.0015,
         -0.0139,  0.0015],
        [ 0.0016,  0.0016,  0.0015,  0.0014,  0.0016,  0.0015,  0.0016,  0.0015,
          0.0017, -0.0142],
        [ 0.0016,  0.0016,  0.0015,  0.0015,  0.0016, -0.0142,  0.0017,  0.0014,
          0.0017,  0.0015],
        [ 0.0016,  0.0014,  0.0016, -0.0141,  0.0015,  0.0015,  0.0017,  0.0016,
          0.0017,  0.0016],
        [ 0.0016,  0.0015,  0.0015,  0.0014,  0.0017,  0.0014,  0.0018,  0.0015,
         -0.0139,  0.0013],
        [-0.0140,  0.0016,  0.0016,  0.0015,  0.0015,  0.0016,  0.0016,  0.0016,
          0.0017,  0.0014],
        [ 0.0016, -0.0141,  0.0017,  0.0014,  0.0015,  0.0014,  0.0017,  0.0016,
          0.0016,  0.0015],
        [ 0.0016,  0.0015,  0.0015,  0.0015,  0.0016,  0.0014,  0.0018,  0.0015,
         -0.0139,  0.0014],
        [ 0.0016,  0.0016,  0.0015,  0.0015,  0.0017,  0.0015, -0.0140,  0.0014,
          0.0017,  0.0016],
        [-0.0139,  0.0015,  0.0016,  0.0014,  0.0016,  0.0015,  0.0017,  0.0015,
          0.0017,  0.0015],
        [ 0.0017,  0.0015,  0.0016,  0.0013,  0.0016,  0.0014, -0.0139,  0.0015,
          0.0017,  0.0015],
        [ 0.0016,  0.0015,  0.0015,  0.0014,  0.0017,  0.0014, -0.0138,  0.0015,
          0.0018,  0.0015],
        [ 0.0016,  0.0016, -0.0141,  0.0014,  0.0016,  0.0014,  0.0017,  0.0015,
          0.0017,  0.0016],
        [ 0.0016,  0.0015,  0.0015,  0.0014, -0.0139,  0.0015,  0.0017,  0.0016,
          0.0017,  0.0013],
        [-0.0139,  0.0015,  0.0015,  0.0014,  0.0016,  0.0015,  0.0018,  0.0014,
          0.0016,  0.0016],
        [ 0.0015,  0.0015,  0.0016, -0.0141,  0.0016,  0.0015,  0.0017,  0.0015,
          0.0017,  0.0015],
        [ 0.0016,  0.0015,  0.0016,  0.0014,  0.0015,  0.0016,  0.0018, -0.0142,
          0.0017,  0.0015],
        [ 0.0016, -0.0142,  0.0016,  0.0015,  0.0016,  0.0015,  0.0017,  0.0016,
          0.0016,  0.0015],
        [ 0.0016, -0.0141,  0.0016,  0.0015,  0.0016,  0.0014,  0.0017,  0.0016,
          0.0017,  0.0014],
        [ 0.0015,  0.0016, -0.0141,  0.0015,  0.0016,  0.0015,  0.0018,  0.0014,
          0.0018,  0.0014],
        [ 0.0016,  0.0015,  0.0015,  0.0013,  0.0017,  0.0015, -0.0139,  0.0016,
          0.0017,  0.0015],
        [ 0.0016, -0.0142,  0.0016,  0.0014,  0.0015,  0.0015,  0.0017,  0.0017,
          0.0016,  0.0015],
        [ 0.0017,  0.0016,  0.0015,  0.0014,  0.0017,  0.0014, -0.0138,  0.0015,
          0.0017,  0.0015],
        [ 0.0016,  0.0015,  0.0016,  0.0015,  0.0016,  0.0014,  0.0017, -0.0141,
          0.0017,  0.0015],
        [ 0.0017,  0.0015,  0.0015,  0.0014,  0.0017,  0.0014,  0.0017,  0.0015,
          0.0017, -0.0142],
        [ 0.0016,  0.0015,  0.0016,  0.0014,  0.0016,  0.0014,  0.0019,  0.0015,
         -0.0140,  0.0015],
        [ 0.0016,  0.0014,  0.0015, -0.0142,  0.0015,  0.0016,  0.0017,  0.0014,
          0.0018,  0.0016],
        [ 0.0016,  0.0016,  0.0016,  0.0014,  0.0015,  0.0015,  0.0017, -0.0141,
          0.0017,  0.0016],
        [ 0.0016,  0.0015,  0.0015,  0.0014,  0.0017,  0.0014, -0.0139,  0.0016,
          0.0017,  0.0015],
        [ 0.0016,  0.0015,  0.0015,  0.0015,  0.0016,  0.0015,  0.0018,  0.0015,
         -0.0139,  0.0014],
        [ 0.0017,  0.0015,  0.0016,  0.0014, -0.0140,  0.0015,  0.0016,  0.0016,
          0.0017,  0.0014],
        [ 0.0015,  0.0016,  0.0016,  0.0014,  0.0016, -0.0142,  0.0016,  0.0015,
          0.0017,  0.0015],
        [ 0.0016,  0.0016,  0.0015,  0.0015,  0.0016,  0.0015,  0.0017,  0.0015,
          0.0017, -0.0142],
        [ 0.0016,  0.0015,  0.0016,  0.0014,  0.0016,  0.0015,  0.0017,  0.0014,
          0.0018, -0.0141]])
2024-11-30 13:25:49,927 - INFO - reading batch[32] client 4
2024-11-30 13:25:49,949 - INFO - reading batch[33] client 1
2024-11-30 13:25:49,971 - INFO - reading batch[33] client 2
2024-11-30 13:25:49,985 - INFO - reading batch[33] client 3
2024-11-30 13:25:50,010 - INFO - reading batch[33] client 4
2024-11-30 13:25:50,025 - INFO - Final partition
2024-11-30 13:25:50,025 - ERROR - loss function:2.3017265796661377
2024-11-30 13:25:50,026 - INFO - reading batch[34] client 1
2024-11-30 13:25:50,043 - INFO - reading batch[34] client 2
2024-11-30 13:25:50,066 - INFO - reading batch[34] client 3
2024-11-30 13:25:50,099 - INFO - reading batch[34] client 4
2024-11-30 13:25:50,125 - INFO - reading batch[35] client 1
2024-11-30 13:25:50,143 - INFO - reading batch[35] client 2
2024-11-30 13:25:50,169 - INFO - reading batch[35] client 3
2024-11-30 13:25:50,184 - ERROR - backward on partition 4
2024-11-30 13:25:50,185 - CRITICAL - calculate backward $4 on client4
2024-11-30 13:25:50,193 - CRITICAL - new gradient:tensor([[-5.7585e-04,  2.6958e-04,  6.9756e-04,  ..., -8.9737e-05,
         -5.2188e-04, -8.5417e-04],
        [ 9.1766e-05,  1.5338e-04, -5.1921e-04,  ...,  2.8553e-04,
          1.8183e-04, -2.6543e-04],
        [-4.5364e-04, -1.9268e-04, -5.5672e-04,  ..., -6.3291e-04,
          5.5400e-04,  5.2940e-04],
        ...,
        [ 7.6377e-05,  8.3544e-04, -2.0020e-04,  ...,  6.9417e-04,
         -2.2600e-04, -4.5859e-04],
        [-4.4854e-04, -8.6283e-04, -8.6857e-04,  ..., -1.0274e-03,
          9.5295e-04,  6.9238e-04],
        [-7.0140e-05, -6.2695e-04,  1.5560e-04,  ..., -8.7166e-04,
          2.7855e-04,  9.7950e-04]]) 
 old gradient:tensor([[ 0.0017,  0.0016,  0.0016,  0.0013,  0.0016,  0.0015, -0.0140,  0.0015,
          0.0017,  0.0016],
        [ 0.0016,  0.0015,  0.0016,  0.0013,  0.0016,  0.0016,  0.0017,  0.0014,
          0.0017, -0.0141],
        [ 0.0016,  0.0015,  0.0015,  0.0015, -0.0140,  0.0016,  0.0018,  0.0016,
          0.0016,  0.0014],
        [ 0.0015,  0.0016,  0.0016,  0.0015,  0.0016,  0.0014,  0.0018,  0.0015,
         -0.0138,  0.0014],
        [ 0.0017,  0.0015, -0.0139,  0.0014,  0.0016,  0.0014,  0.0017,  0.0014,
          0.0017,  0.0016],
        [ 0.0015,  0.0015,  0.0016,  0.0014,  0.0017, -0.0142,  0.0018,  0.0016,
          0.0017,  0.0014],
        [ 0.0016,  0.0016,  0.0016,  0.0014, -0.0139,  0.0016,  0.0016,  0.0014,
          0.0016,  0.0015],
        [ 0.0016,  0.0015,  0.0016,  0.0015,  0.0015,  0.0015,  0.0017, -0.0140,
          0.0016,  0.0015],
        [ 0.0015,  0.0016,  0.0016,  0.0013,  0.0016, -0.0141,  0.0018,  0.0016,
          0.0016,  0.0015],
        [ 0.0016,  0.0016,  0.0015,  0.0014,  0.0017,  0.0015,  0.0017,  0.0015,
         -0.0140,  0.0015],
        [ 0.0016,  0.0016,  0.0015,  0.0015,  0.0015,  0.0015,  0.0017, -0.0141,
          0.0016,  0.0016],
        [-0.0140,  0.0015,  0.0015,  0.0013,  0.0017,  0.0015,  0.0017,  0.0015,
          0.0017,  0.0016],
        [-0.0140,  0.0015,  0.0015,  0.0014,  0.0016,  0.0015,  0.0017,  0.0015,
          0.0018,  0.0015],
        [ 0.0016,  0.0016,  0.0015,  0.0014,  0.0016,  0.0015, -0.0139,  0.0015,
          0.0017,  0.0015],
        [ 0.0016,  0.0015,  0.0015,  0.0014,  0.0015,  0.0016,  0.0017, -0.0141,
          0.0016,  0.0016],
        [ 0.0016,  0.0015,  0.0015,  0.0014,  0.0016,  0.0015,  0.0018,  0.0015,
         -0.0139,  0.0015],
        [ 0.0017,  0.0015,  0.0015,  0.0014,  0.0016,  0.0015, -0.0140,  0.0015,
          0.0016,  0.0015],
        [ 0.0016,  0.0015,  0.0017,  0.0014,  0.0016, -0.0141,  0.0018,  0.0015,
          0.0017,  0.0014],
        [ 0.0016, -0.0141,  0.0017,  0.0015,  0.0016,  0.0015,  0.0017,  0.0016,
          0.0016,  0.0015],
        [ 0.0017,  0.0016, -0.0142,  0.0014,  0.0016,  0.0014,  0.0017,  0.0016,
          0.0017,  0.0015],
        [ 0.0016,  0.0015,  0.0016,  0.0014,  0.0015,  0.0015,  0.0017, -0.0141,
          0.0016,  0.0016],
        [ 0.0015,  0.0015,  0.0015,  0.0014,  0.0017,  0.0015,  0.0018,  0.0015,
         -0.0139,  0.0016],
        [ 0.0016,  0.0016,  0.0015,  0.0015,  0.0016, -0.0141,  0.0017,  0.0015,
          0.0017,  0.0016],
        [ 0.0016,  0.0015,  0.0016,  0.0015,  0.0016,  0.0015,  0.0017, -0.0141,
          0.0017,  0.0015],
        [ 0.0016,  0.0015,  0.0016,  0.0014,  0.0015,  0.0016,  0.0017, -0.0141,
          0.0017,  0.0016],
        [ 0.0016,  0.0016,  0.0015, -0.0142,  0.0015,  0.0015,  0.0018,  0.0015,
          0.0017,  0.0015],
        [ 0.0014,  0.0015,  0.0016, -0.0143,  0.0016,  0.0015,  0.0018,  0.0016,
          0.0018,  0.0015],
        [ 0.0016,  0.0015,  0.0016,  0.0013, -0.0139,  0.0015,  0.0018,  0.0015,
          0.0017,  0.0014],
        [ 0.0016,  0.0016,  0.0016,  0.0014,  0.0016, -0.0141,  0.0017,  0.0016,
          0.0016,  0.0014],
        [ 0.0016,  0.0015,  0.0016,  0.0015,  0.0016,  0.0014,  0.0017,  0.0015,
         -0.0140,  0.0015],
        [ 0.0016,  0.0016,  0.0016,  0.0015,  0.0016, -0.0142,  0.0017,  0.0015,
          0.0017,  0.0015],
        [ 0.0017,  0.0015,  0.0015, -0.0143,  0.0016,  0.0015,  0.0018,  0.0014,
          0.0017,  0.0015],
        [ 0.0016,  0.0015, -0.0141,  0.0014,  0.0016,  0.0015,  0.0018,  0.0015,
          0.0017,  0.0014],
        [ 0.0017,  0.0015, -0.0140,  0.0014,  0.0016,  0.0015,  0.0017,  0.0015,
          0.0016,  0.0016],
        [ 0.0016,  0.0016,  0.0016,  0.0014, -0.0140,  0.0016,  0.0017,  0.0015,
          0.0017,  0.0014],
        [ 0.0016,  0.0015,  0.0015,  0.0014,  0.0016,  0.0016,  0.0016, -0.0142,
          0.0017,  0.0015],
        [-0.0140,  0.0015,  0.0015,  0.0014,  0.0015,  0.0015,  0.0018,  0.0015,
          0.0017,  0.0015],
        [ 0.0016,  0.0016,  0.0015,  0.0015,  0.0016,  0.0015,  0.0017,  0.0015,
          0.0017, -0.0142],
        [ 0.0015, -0.0142,  0.0016,  0.0014,  0.0016,  0.0015,  0.0018,  0.0015,
          0.0017,  0.0015],
        [ 0.0016,  0.0015, -0.0141,  0.0014,  0.0017,  0.0015,  0.0017,  0.0016,
          0.0016,  0.0016],
        [ 0.0016,  0.0015,  0.0015,  0.0014,  0.0016,  0.0015,  0.0017,  0.0015,
          0.0017, -0.0141],
        [ 0.0016,  0.0016,  0.0016,  0.0014,  0.0017, -0.0141,  0.0017,  0.0015,
          0.0017,  0.0013],
        [ 0.0016,  0.0016,  0.0015,  0.0015,  0.0016,  0.0014, -0.0140,  0.0015,
          0.0018,  0.0015],
        [ 0.0016,  0.0015, -0.0141,  0.0014,  0.0016,  0.0014,  0.0017,  0.0016,
          0.0017,  0.0016],
        [ 0.0015,  0.0015,  0.0015,  0.0015,  0.0018,  0.0015,  0.0017,  0.0015,
          0.0017, -0.0143],
        [ 0.0015, -0.0142,  0.0016,  0.0015,  0.0016,  0.0014,  0.0017,  0.0016,
          0.0017,  0.0015],
        [-0.0140,  0.0014,  0.0016,  0.0014,  0.0016,  0.0015,  0.0017,  0.0015,
          0.0016,  0.0015],
        [ 0.0017,  0.0016,  0.0015,  0.0013,  0.0017,  0.0014, -0.0140,  0.0016,
          0.0017,  0.0015],
        [ 0.0016, -0.0142,  0.0016,  0.0015,  0.0016,  0.0014,  0.0017,  0.0016,
          0.0017,  0.0015],
        [ 0.0016,  0.0016, -0.0141,  0.0014,  0.0017,  0.0015,  0.0017,  0.0016,
          0.0017,  0.0014],
        [ 0.0017,  0.0015,  0.0016,  0.0014,  0.0016, -0.0142,  0.0017,  0.0015,
          0.0016,  0.0014],
        [ 0.0016,  0.0015,  0.0016,  0.0014,  0.0017,  0.0015,  0.0017,  0.0015,
          0.0018, -0.0142],
        [ 0.0016,  0.0015,  0.0015,  0.0014,  0.0017,  0.0015,  0.0017,  0.0016,
         -0.0139,  0.0014],
        [ 0.0016,  0.0016,  0.0016,  0.0015,  0.0016,  0.0015, -0.0139,  0.0014,
          0.0016,  0.0015],
        [ 0.0017,  0.0016,  0.0016,  0.0013,  0.0016,  0.0014, -0.0139,  0.0015,
          0.0017,  0.0015],
        [ 0.0016,  0.0015,  0.0016,  0.0014,  0.0016,  0.0015,  0.0017, -0.0140,
          0.0017,  0.0015],
        [ 0.0016,  0.0015,  0.0016,  0.0015,  0.0017,  0.0015,  0.0016, -0.0141,
          0.0017,  0.0014],
        [ 0.0017,  0.0016,  0.0015,  0.0013,  0.0017,  0.0014, -0.0139,  0.0014,
          0.0017,  0.0015],
        [ 0.0016,  0.0015, -0.0141,  0.0013,  0.0016,  0.0015,  0.0017,  0.0016,
          0.0016,  0.0015],
        [-0.0140,  0.0016,  0.0016,  0.0014,  0.0016,  0.0016,  0.0017,  0.0014,
          0.0017,  0.0016],
        [ 0.0016,  0.0015,  0.0016,  0.0014, -0.0141,  0.0015,  0.0018,  0.0015,
          0.0016,  0.0015],
        [ 0.0017,  0.0015,  0.0016,  0.0013, -0.0139,  0.0015,  0.0016,  0.0015,
          0.0017,  0.0014],
        [ 0.0016,  0.0016,  0.0015,  0.0014,  0.0016,  0.0015,  0.0017,  0.0015,
          0.0018, -0.0142],
        [ 0.0016,  0.0016, -0.0141,  0.0014,  0.0016,  0.0015,  0.0017,  0.0015,
          0.0016,  0.0015]])
2024-11-30 13:25:50,193 - INFO - reading batch[35] client 4
2024-11-30 13:25:50,221 - INFO - reading batch[36] client 1
2024-11-30 13:25:50,249 - INFO - reading batch[36] client 2
2024-11-30 13:25:50,263 - INFO - reading batch[36] client 3
2024-11-30 13:25:50,276 - ERROR - backward on partition 4
2024-11-30 13:25:50,277 - CRITICAL - calculate backward $4 on client4
2024-11-30 13:25:50,282 - CRITICAL - new gradient:tensor([[-4.1180e-04,  1.4783e-04,  6.5901e-04,  ...,  2.9289e-04,
         -1.3360e-04, -1.0797e-03],
        [-3.1861e-05,  7.9459e-04, -8.0602e-04,  ..., -1.2270e-04,
          3.3081e-04, -1.8339e-04],
        [-5.7211e-04,  4.4671e-04, -8.4635e-04,  ..., -1.0375e-03,
          7.0384e-04,  6.1544e-04],
        ...,
        [ 1.8913e-05,  4.0882e-04, -5.3071e-04,  ...,  5.9701e-04,
          2.3083e-05, -3.7877e-04],
        [ 1.6736e-04, -1.3827e-03, -9.7281e-04,  ..., -6.5599e-04,
          7.2617e-04,  1.1295e-03],
        [-2.9660e-04, -3.8148e-04,  2.7927e-05,  ..., -9.7612e-04,
          3.5493e-04,  1.1498e-03]]) 
 old gradient:tensor([[ 0.0016,  0.0015,  0.0015,  0.0014,  0.0015,  0.0015,  0.0017, -0.0140,
          0.0017,  0.0015],
        [ 0.0016,  0.0015,  0.0015, -0.0142,  0.0017,  0.0015,  0.0017,  0.0015,
          0.0017,  0.0015],
        [ 0.0015,  0.0015,  0.0016, -0.0142,  0.0016,  0.0015,  0.0018,  0.0015,
          0.0017,  0.0015],
        [-0.0140,  0.0015,  0.0015,  0.0014,  0.0016,  0.0016,  0.0018,  0.0015,
          0.0017,  0.0015],
        [ 0.0015,  0.0016,  0.0015,  0.0015,  0.0016,  0.0015,  0.0018,  0.0015,
         -0.0139,  0.0015],
        [ 0.0015, -0.0142,  0.0015,  0.0015,  0.0016,  0.0014,  0.0018,  0.0015,
          0.0017,  0.0016],
        [ 0.0016,  0.0015,  0.0016,  0.0014, -0.0140,  0.0015,  0.0018,  0.0015,
          0.0017,  0.0014],
        [ 0.0017,  0.0015,  0.0015,  0.0014,  0.0015,  0.0015,  0.0017, -0.0141,
          0.0017,  0.0015],
        [ 0.0017,  0.0015,  0.0016,  0.0014,  0.0016,  0.0014, -0.0140,  0.0016,
          0.0016,  0.0015],
        [ 0.0016, -0.0142,  0.0016,  0.0015,  0.0016,  0.0015,  0.0018,  0.0016,
          0.0016,  0.0015],
        [ 0.0015,  0.0016,  0.0016,  0.0014,  0.0016, -0.0141,  0.0016,  0.0015,
          0.0017,  0.0014],
        [ 0.0018,  0.0015,  0.0015,  0.0014,  0.0017,  0.0014, -0.0140,  0.0015,
          0.0017,  0.0015],
        [-0.0140,  0.0015,  0.0015,  0.0014,  0.0015,  0.0016,  0.0016,  0.0015,
          0.0017,  0.0016],
        [-0.0140,  0.0015,  0.0016,  0.0015,  0.0015,  0.0015,  0.0017,  0.0015,
          0.0018,  0.0014],
        [ 0.0015, -0.0142,  0.0015,  0.0014,  0.0016,  0.0015,  0.0018,  0.0015,
          0.0017,  0.0016],
        [ 0.0016,  0.0015,  0.0015,  0.0015,  0.0016,  0.0016,  0.0017,  0.0014,
         -0.0139,  0.0015],
        [-0.0141,  0.0015,  0.0015,  0.0015,  0.0016,  0.0014,  0.0018,  0.0015,
          0.0018,  0.0014],
        [ 0.0015,  0.0015,  0.0016, -0.0142,  0.0016,  0.0015,  0.0017,  0.0016,
          0.0017,  0.0015],
        [ 0.0016,  0.0015, -0.0141,  0.0014,  0.0016,  0.0015,  0.0018,  0.0015,
          0.0016,  0.0015],
        [ 0.0016,  0.0017,  0.0015,  0.0014,  0.0017,  0.0015, -0.0140,  0.0015,
          0.0017,  0.0015],
        [ 0.0016,  0.0016,  0.0016,  0.0014,  0.0017,  0.0015, -0.0139,  0.0014,
          0.0016,  0.0015],
        [ 0.0017,  0.0015,  0.0015,  0.0015,  0.0015,  0.0016,  0.0017, -0.0141,
          0.0017,  0.0015],
        [ 0.0015,  0.0015,  0.0016, -0.0142,  0.0016,  0.0014,  0.0018,  0.0016,
          0.0017,  0.0015],
        [ 0.0016, -0.0141,  0.0016,  0.0015,  0.0015,  0.0015,  0.0017,  0.0016,
          0.0016,  0.0015],
        [ 0.0016,  0.0015,  0.0015, -0.0142,  0.0017,  0.0015,  0.0017,  0.0015,
          0.0017,  0.0015],
        [ 0.0016,  0.0015,  0.0017, -0.0142,  0.0015,  0.0015,  0.0018,  0.0015,
          0.0016,  0.0015],
        [ 0.0016,  0.0016, -0.0140,  0.0014,  0.0016,  0.0015,  0.0017,  0.0014,
          0.0017,  0.0015],
        [ 0.0017,  0.0015,  0.0016,  0.0014,  0.0014,  0.0016,  0.0017, -0.0141,
          0.0017,  0.0016],
        [ 0.0016,  0.0015,  0.0016, -0.0142,  0.0015,  0.0015,  0.0018,  0.0016,
          0.0017,  0.0015],
        [-0.0140,  0.0016,  0.0016,  0.0014,  0.0016,  0.0015,  0.0016,  0.0015,
          0.0016,  0.0015],
        [ 0.0016,  0.0015,  0.0016, -0.0142,  0.0016,  0.0015,  0.0018,  0.0016,
          0.0016,  0.0015],
        [ 0.0016,  0.0016,  0.0016,  0.0014,  0.0017,  0.0014,  0.0016,  0.0015,
          0.0017, -0.0141],
        [ 0.0016,  0.0016,  0.0016,  0.0014,  0.0016, -0.0142,  0.0017,  0.0015,
          0.0017,  0.0014],
        [ 0.0016,  0.0015,  0.0016, -0.0143,  0.0016,  0.0014,  0.0017,  0.0016,
          0.0017,  0.0015],
        [ 0.0016,  0.0015,  0.0015,  0.0014,  0.0016,  0.0015,  0.0017,  0.0015,
         -0.0138,  0.0015],
        [ 0.0016, -0.0142,  0.0016,  0.0015,  0.0015,  0.0015,  0.0017,  0.0017,
          0.0016,  0.0015],
        [ 0.0016,  0.0015,  0.0016,  0.0015,  0.0016,  0.0015,  0.0017, -0.0141,
          0.0016,  0.0015],
        [ 0.0015,  0.0015,  0.0016, -0.0142,  0.0016,  0.0015,  0.0017,  0.0016,
          0.0017,  0.0015],
        [ 0.0017,  0.0015,  0.0016,  0.0014,  0.0016,  0.0016,  0.0017, -0.0141,
          0.0017,  0.0014],
        [ 0.0016,  0.0016,  0.0015,  0.0013,  0.0016,  0.0015,  0.0017,  0.0015,
          0.0018, -0.0142],
        [ 0.0016,  0.0016,  0.0015,  0.0014,  0.0016,  0.0015,  0.0017, -0.0140,
          0.0016,  0.0014],
        [ 0.0015,  0.0015, -0.0141,  0.0015,  0.0016,  0.0015,  0.0017,  0.0016,
          0.0017,  0.0016],
        [ 0.0016,  0.0015,  0.0015,  0.0014,  0.0015,  0.0016,  0.0017, -0.0141,
          0.0017,  0.0016],
        [ 0.0016,  0.0014, -0.0141,  0.0014,  0.0016,  0.0014,  0.0018,  0.0016,
          0.0017,  0.0016],
        [ 0.0016,  0.0016,  0.0015,  0.0015,  0.0017,  0.0015,  0.0017,  0.0015,
          0.0017, -0.0142],
        [ 0.0017,  0.0015,  0.0015,  0.0014,  0.0016,  0.0015,  0.0018,  0.0015,
          0.0017, -0.0142],
        [-0.0140,  0.0015,  0.0015,  0.0014,  0.0016,  0.0015,  0.0017,  0.0014,
          0.0018,  0.0016],
        [ 0.0016,  0.0016, -0.0141,  0.0014,  0.0017,  0.0014,  0.0016,  0.0015,
          0.0018,  0.0015],
        [ 0.0016, -0.0142,  0.0016,  0.0015,  0.0015,  0.0014,  0.0018,  0.0017,
          0.0016,  0.0015],
        [ 0.0016,  0.0015,  0.0016,  0.0014,  0.0016,  0.0015,  0.0017, -0.0141,
          0.0017,  0.0015],
        [ 0.0016, -0.0142,  0.0016,  0.0015,  0.0016,  0.0015,  0.0018,  0.0016,
          0.0017,  0.0015],
        [ 0.0017,  0.0015,  0.0015,  0.0014,  0.0015,  0.0015,  0.0017, -0.0142,
          0.0017,  0.0015],
        [ 0.0015,  0.0016,  0.0016,  0.0014,  0.0016,  0.0014,  0.0018,  0.0015,
         -0.0139,  0.0015],
        [ 0.0016,  0.0016,  0.0015,  0.0014,  0.0016, -0.0141,  0.0017,  0.0015,
          0.0017,  0.0015],
        [ 0.0015,  0.0016,  0.0016, -0.0142,  0.0016,  0.0014,  0.0018,  0.0016,
          0.0017,  0.0015],
        [ 0.0016,  0.0015,  0.0016,  0.0014,  0.0016, -0.0141,  0.0018,  0.0015,
          0.0017,  0.0014],
        [ 0.0017,  0.0016,  0.0015,  0.0013,  0.0016,  0.0016,  0.0017,  0.0014,
          0.0018, -0.0141],
        [ 0.0016,  0.0015,  0.0016,  0.0014,  0.0015,  0.0015,  0.0017, -0.0141,
          0.0017,  0.0015],
        [ 0.0016,  0.0015,  0.0015,  0.0015,  0.0016,  0.0015,  0.0016, -0.0141,
          0.0017,  0.0015],
        [ 0.0017,  0.0015,  0.0015,  0.0014, -0.0139,  0.0016,  0.0016,  0.0015,
          0.0016,  0.0015],
        [ 0.0016,  0.0015,  0.0016,  0.0014,  0.0015,  0.0016,  0.0017, -0.0142,
          0.0017,  0.0016],
        [ 0.0016, -0.0141,  0.0017,  0.0015,  0.0016,  0.0014,  0.0017,  0.0016,
          0.0016,  0.0014],
        [-0.0140,  0.0015,  0.0016,  0.0014,  0.0015,  0.0016,  0.0017,  0.0015,
          0.0017,  0.0014],
        [ 0.0015,  0.0015,  0.0016,  0.0015, -0.0140,  0.0015,  0.0018,  0.0015,
          0.0017,  0.0014]])
2024-11-30 13:25:50,283 - INFO - reading batch[36] client 4
2024-11-30 13:25:50,307 - INFO - reading batch[37] client 1
2024-11-30 13:25:50,330 - INFO - reading batch[37] client 2
2024-11-30 13:25:50,354 - INFO - reading batch[37] client 3
2024-11-30 13:25:50,381 - INFO - reading batch[37] client 4
2024-11-30 13:25:50,404 - INFO - reading batch[38] client 1
2024-11-30 13:25:50,423 - INFO - reading batch[38] client 2
2024-11-30 13:25:50,450 - INFO - reading batch[38] client 3
2024-11-30 13:25:50,463 - INFO - reading batch[38] client 4
2024-11-30 13:25:50,486 - INFO - reading batch[39] client 1
2024-11-30 13:25:50,507 - INFO - reading batch[39] client 2
2024-11-30 13:25:50,521 - INFO - reading batch[39] client 3
2024-11-30 13:25:50,547 - INFO - reading batch[39] client 4
2024-11-30 13:25:50,580 - INFO - reading batch[40] client 1
2024-11-30 13:25:50,602 - INFO - reading batch[40] client 2
2024-11-30 13:25:50,624 - INFO - reading batch[40] client 3
2024-11-30 13:25:50,646 - INFO - reading batch[40] client 4
2024-11-30 13:25:50,669 - INFO - reading batch[41] client 1
2024-11-30 13:25:50,693 - INFO - reading batch[41] client 2
2024-11-30 13:25:50,709 - INFO - Final partition
2024-11-30 13:25:50,709 - ERROR - loss function:2.2951130867004395
2024-11-30 13:25:50,709 - INFO - reading batch[41] client 3
2024-11-30 13:25:50,724 - INFO - reading batch[41] client 4
2024-11-30 13:25:50,746 - INFO - reading batch[42] client 1
2024-11-30 13:25:50,766 - INFO - reading batch[42] client 2
2024-11-30 13:25:50,784 - INFO - reading batch[42] client 3
2024-11-30 13:25:50,806 - INFO - reading batch[42] client 4
2024-11-30 13:25:50,830 - INFO - reading batch[43] client 1
2024-11-30 13:25:50,850 - INFO - reading batch[43] client 2
2024-11-30 13:25:50,876 - INFO - reading batch[43] client 3
2024-11-30 13:25:50,889 - ERROR - backward on partition 4
2024-11-30 13:25:50,890 - CRITICAL - calculate backward $4 on client4
2024-11-30 13:25:50,896 - CRITICAL - new gradient:tensor([[-2.3460e-04,  2.5067e-04, -1.1756e-04,  ..., -1.1240e-04,
          7.4814e-05,  1.6811e-04],
        [-5.8287e-04,  2.7908e-04,  3.9507e-04,  ...,  5.1696e-05,
         -5.0372e-04, -7.1513e-04],
        [ 6.2554e-04, -5.2222e-04, -1.0629e-04,  ...,  3.8245e-04,
         -2.3096e-04,  4.3852e-04],
        ...,
        [ 6.1965e-04, -5.1622e-04, -9.6455e-05,  ...,  3.7801e-04,
         -2.3320e-04,  4.3292e-04],
        [-2.3654e-04,  2.4709e-04, -1.2389e-04,  ..., -1.1857e-04,
          8.0303e-05,  1.7370e-04],
        [ 1.5828e-04, -2.0633e-04,  5.8788e-04,  ..., -3.5295e-04,
         -2.0181e-04,  6.3525e-04]]) 
 old gradient:tensor([[ 0.0017,  0.0015,  0.0015,  0.0014, -0.0139,  0.0015,  0.0017,  0.0015,
          0.0017,  0.0015],
        [ 0.0017,  0.0015,  0.0015,  0.0014,  0.0017,  0.0014, -0.0139,  0.0016,
          0.0016,  0.0015],
        [-0.0141,  0.0015,  0.0015,  0.0015,  0.0016,  0.0014,  0.0018,  0.0015,
          0.0019,  0.0014],
        [ 0.0015,  0.0015,  0.0015,  0.0014,  0.0016,  0.0015,  0.0018,  0.0015,
          0.0017, -0.0141],
        [ 0.0016, -0.0142,  0.0016,  0.0015,  0.0016,  0.0014,  0.0018,  0.0016,
          0.0017,  0.0015],
        [ 0.0017,  0.0015,  0.0016,  0.0014, -0.0139,  0.0014,  0.0016,  0.0015,
          0.0017,  0.0014],
        [-0.0140,  0.0015,  0.0016,  0.0015,  0.0015,  0.0015,  0.0017,  0.0016,
          0.0017,  0.0014],
        [ 0.0016, -0.0141,  0.0016,  0.0015,  0.0016,  0.0014,  0.0017,  0.0016,
          0.0016,  0.0015],
        [ 0.0016,  0.0016,  0.0016,  0.0014,  0.0017, -0.0142,  0.0017,  0.0015,
          0.0017,  0.0015],
        [ 0.0016,  0.0015, -0.0142,  0.0015,  0.0016,  0.0015,  0.0018,  0.0016,
          0.0017,  0.0015],
        [-0.0141,  0.0015,  0.0015,  0.0015,  0.0015,  0.0015,  0.0018,  0.0015,
          0.0018,  0.0014],
        [ 0.0016,  0.0017,  0.0016,  0.0014,  0.0016, -0.0141,  0.0017,  0.0015,
          0.0017,  0.0015],
        [ 0.0017,  0.0015,  0.0015,  0.0013,  0.0016,  0.0015,  0.0018,  0.0014,
          0.0018, -0.0141],
        [ 0.0016,  0.0016,  0.0015,  0.0014,  0.0016,  0.0015,  0.0016, -0.0141,
          0.0017,  0.0016],
        [ 0.0016,  0.0016,  0.0015,  0.0014, -0.0140,  0.0015,  0.0016,  0.0015,
          0.0017,  0.0015],
        [ 0.0015,  0.0016, -0.0141,  0.0014,  0.0017,  0.0016,  0.0018,  0.0014,
          0.0017,  0.0014],
        [ 0.0016,  0.0016, -0.0141,  0.0014,  0.0017,  0.0016,  0.0017,  0.0014,
          0.0017,  0.0015],
        [ 0.0016,  0.0015, -0.0140,  0.0014,  0.0017,  0.0014,  0.0018,  0.0015,
          0.0016,  0.0015],
        [ 0.0016,  0.0016,  0.0016,  0.0014,  0.0015, -0.0141,  0.0017,  0.0016,
          0.0017,  0.0014],
        [ 0.0016,  0.0015,  0.0015,  0.0015,  0.0016,  0.0014,  0.0017,  0.0016,
          0.0017, -0.0142],
        [ 0.0016,  0.0016,  0.0016,  0.0014,  0.0017, -0.0142,  0.0018,  0.0015,
          0.0017,  0.0014],
        [ 0.0016, -0.0142,  0.0016,  0.0015,  0.0016,  0.0014,  0.0017,  0.0016,
          0.0017,  0.0015],
        [ 0.0017,  0.0015,  0.0016,  0.0014,  0.0016,  0.0014,  0.0017, -0.0140,
          0.0018,  0.0014],
        [ 0.0016,  0.0015,  0.0015,  0.0015, -0.0139,  0.0016,  0.0017,  0.0015,
          0.0016,  0.0014],
        [ 0.0017,  0.0016,  0.0015,  0.0014,  0.0016,  0.0015, -0.0140,  0.0015,
          0.0017,  0.0015],
        [ 0.0017,  0.0015,  0.0015,  0.0014,  0.0016,  0.0014, -0.0137,  0.0015,
          0.0017,  0.0015],
        [ 0.0016,  0.0015,  0.0016,  0.0014,  0.0016,  0.0015,  0.0017, -0.0142,
          0.0017,  0.0016],
        [ 0.0016,  0.0015,  0.0016,  0.0015,  0.0016,  0.0014,  0.0018,  0.0014,
         -0.0139,  0.0015],
        [ 0.0016,  0.0016, -0.0141,  0.0015,  0.0015,  0.0016,  0.0017,  0.0015,
          0.0016,  0.0015],
        [ 0.0017,  0.0015,  0.0015,  0.0014,  0.0015,  0.0015,  0.0017, -0.0141,
          0.0017,  0.0015],
        [ 0.0016,  0.0015,  0.0015,  0.0013,  0.0017,  0.0014,  0.0018,  0.0016,
         -0.0138,  0.0015],
        [ 0.0016,  0.0016,  0.0015,  0.0014,  0.0016,  0.0014, -0.0140,  0.0015,
          0.0017,  0.0015],
        [ 0.0016,  0.0015,  0.0015,  0.0014,  0.0016,  0.0016,  0.0017,  0.0015,
          0.0017, -0.0142],
        [ 0.0015,  0.0015,  0.0015,  0.0014,  0.0017,  0.0014,  0.0017,  0.0015,
         -0.0138,  0.0015],
        [ 0.0016,  0.0016,  0.0015,  0.0014,  0.0016,  0.0015,  0.0018,  0.0015,
          0.0016, -0.0141],
        [ 0.0015,  0.0016,  0.0015,  0.0015,  0.0017,  0.0014,  0.0017,  0.0015,
         -0.0139,  0.0014],
        [ 0.0016,  0.0015,  0.0016, -0.0142,  0.0016,  0.0015,  0.0018,  0.0016,
          0.0017,  0.0015],
        [ 0.0017,  0.0016,  0.0015,  0.0014,  0.0016,  0.0015, -0.0139,  0.0015,
          0.0016,  0.0015],
        [ 0.0015,  0.0015,  0.0016, -0.0142,  0.0015,  0.0015,  0.0018,  0.0015,
          0.0017,  0.0015],
        [ 0.0016, -0.0142,  0.0015,  0.0015,  0.0016,  0.0015,  0.0018,  0.0015,
          0.0017,  0.0015],
        [ 0.0017,  0.0016,  0.0016,  0.0013,  0.0016,  0.0014, -0.0138,  0.0015,
          0.0017,  0.0015],
        [ 0.0017,  0.0015,  0.0015,  0.0014,  0.0016,  0.0014, -0.0138,  0.0015,
          0.0017,  0.0015],
        [ 0.0016,  0.0015, -0.0141,  0.0014,  0.0016,  0.0016,  0.0017,  0.0015,
          0.0017,  0.0015],
        [ 0.0017,  0.0016,  0.0015,  0.0014,  0.0017,  0.0014,  0.0017,  0.0015,
          0.0018, -0.0142],
        [ 0.0016,  0.0016,  0.0015,  0.0014,  0.0016, -0.0141,  0.0017,  0.0015,
          0.0017,  0.0014],
        [ 0.0016,  0.0016,  0.0015,  0.0014,  0.0016,  0.0016,  0.0017, -0.0141,
          0.0016,  0.0015],
        [ 0.0016,  0.0015,  0.0015,  0.0014,  0.0015,  0.0015,  0.0017, -0.0141,
          0.0016,  0.0016],
        [-0.0141,  0.0015,  0.0017,  0.0015,  0.0015,  0.0015,  0.0017,  0.0015,
          0.0017,  0.0014],
        [ 0.0016,  0.0016,  0.0016, -0.0142,  0.0018,  0.0015,  0.0017,  0.0014,
          0.0017,  0.0014],
        [ 0.0016,  0.0015,  0.0015,  0.0014,  0.0016,  0.0016,  0.0017,  0.0016,
         -0.0139,  0.0014],
        [ 0.0016,  0.0016,  0.0015,  0.0014,  0.0017,  0.0015,  0.0017,  0.0014,
          0.0018, -0.0142],
        [ 0.0016,  0.0015,  0.0015,  0.0015,  0.0017,  0.0015,  0.0017,  0.0015,
          0.0017, -0.0142],
        [-0.0140,  0.0015,  0.0016,  0.0014,  0.0015,  0.0015,  0.0017,  0.0015,
          0.0017,  0.0016],
        [ 0.0016, -0.0142,  0.0016,  0.0015,  0.0015,  0.0015,  0.0017,  0.0016,
          0.0016,  0.0015],
        [ 0.0015,  0.0016,  0.0016,  0.0014,  0.0016, -0.0141,  0.0018,  0.0015,
          0.0017,  0.0014],
        [ 0.0017,  0.0015,  0.0015,  0.0014,  0.0016,  0.0015, -0.0139,  0.0016,
          0.0017,  0.0015],
        [ 0.0016,  0.0015, -0.0141,  0.0013,  0.0017,  0.0016,  0.0018,  0.0015,
          0.0017,  0.0015],
        [-0.0140,  0.0015,  0.0016,  0.0015,  0.0015,  0.0015,  0.0017,  0.0015,
          0.0018,  0.0015],
        [ 0.0016,  0.0016,  0.0015,  0.0014,  0.0017,  0.0014,  0.0018,  0.0015,
         -0.0139,  0.0015],
        [ 0.0016,  0.0015,  0.0017,  0.0014,  0.0017, -0.0142,  0.0018,  0.0016,
          0.0017,  0.0013],
        [ 0.0016,  0.0015, -0.0142,  0.0014,  0.0016,  0.0015,  0.0018,  0.0015,
          0.0017,  0.0015],
        [-0.0140,  0.0015,  0.0015,  0.0015,  0.0016,  0.0015,  0.0017,  0.0015,
          0.0017,  0.0015],
        [ 0.0017,  0.0015,  0.0015,  0.0014, -0.0140,  0.0015,  0.0017,  0.0016,
          0.0017,  0.0013],
        [ 0.0015,  0.0015, -0.0141,  0.0015,  0.0017,  0.0014,  0.0017,  0.0016,
          0.0018,  0.0014]])
2024-11-30 13:25:50,896 - INFO - reading batch[43] client 4
2024-11-30 13:25:50,918 - INFO - reading batch[44] client 1
2024-11-30 13:25:50,941 - INFO - reading batch[44] client 2
2024-11-30 13:26:22,680 - INFO - reading batch[0] client 1
2024-11-30 13:26:22,703 - INFO - reading batch[0] client 2
2024-11-30 13:26:22,722 - INFO - reading batch[0] client 3
2024-11-30 13:26:22,747 - INFO - reading batch[0] client 4
2024-11-30 13:26:22,783 - INFO - reading batch[1] client 1
2024-11-30 13:26:22,817 - INFO - reading batch[1] client 2
2024-11-30 13:26:22,841 - INFO - reading batch[1] client 3
2024-11-30 13:26:22,864 - INFO - reading batch[1] client 4
2024-11-30 13:26:22,885 - INFO - reading batch[2] client 1
2024-11-30 13:26:22,904 - INFO - reading batch[2] client 2
2024-11-30 13:26:22,929 - INFO - reading batch[2] client 3
2024-11-30 13:26:22,956 - INFO - reading batch[2] client 4
2024-11-30 13:26:22,985 - INFO - reading batch[3] client 1
2024-11-30 13:26:23,011 - INFO - reading batch[3] client 2
2024-11-30 13:26:23,026 - INFO - reading batch[3] client 3
2024-11-30 13:26:23,052 - INFO - reading batch[3] client 4
2024-11-30 13:26:23,078 - INFO - reading batch[4] client 1
2024-11-30 13:26:23,104 - INFO - reading batch[4] client 2
2024-11-30 13:26:23,132 - INFO - reading batch[4] client 3
2024-11-30 13:26:23,150 - INFO - reading batch[4] client 4
2024-11-30 13:26:23,182 - INFO - reading batch[5] client 1
2024-11-30 13:26:23,203 - INFO - reading batch[5] client 2
2024-11-30 13:26:23,217 - INFO - reading batch[5] client 3
2024-11-30 13:26:23,247 - INFO - reading batch[5] client 4
2024-11-30 13:26:23,262 - INFO - Final partition
2024-11-30 13:26:23,263 - INFO - reading batch[6] client 1
2024-11-30 13:26:23,288 - INFO - reading batch[6] client 2
2024-11-30 13:26:23,314 - INFO - reading batch[6] client 3
2024-11-30 13:26:23,341 - INFO - reading batch[6] client 4
2024-11-30 13:26:23,370 - INFO - reading batch[7] client 1
2024-11-30 13:26:23,395 - INFO - reading batch[7] client 2
2024-11-30 13:26:23,421 - INFO - reading batch[7] client 3
2024-11-30 13:26:23,440 - INFO - reading batch[7] client 4
2024-11-30 13:26:23,465 - INFO - reading batch[8] client 1
2024-11-30 13:26:23,496 - INFO - reading batch[8] client 2
2024-11-30 13:26:23,514 - INFO - reading batch[8] client 3
2024-11-30 13:26:23,535 - INFO - reading batch[8] client 4
2024-11-30 13:26:23,573 - INFO - reading batch[9] client 1
2024-11-30 13:26:23,594 - INFO - reading batch[9] client 2
2024-11-30 13:26:23,643 - INFO - reading batch[9] client 3
2024-11-30 13:26:23,680 - ERROR - backward on partition 4
2024-11-30 13:26:23,681 - CRITICAL - calculate backward $4 on client4
2024-11-30 13:26:23,704 - CRITICAL - new gradient:tensor([[ 6.1407e-04,  1.6644e-04, -1.6553e-04,  ...,  5.2116e-05,
          2.1601e-04, -3.8596e-04],
        [-4.8807e-04, -6.7538e-04, -3.9925e-04,  ..., -1.7357e-04,
          2.9376e-04,  5.6823e-04],
        [ 6.1750e-04,  1.7176e-04, -1.6333e-04,  ...,  5.2613e-05,
          2.1443e-04, -3.8918e-04],
        ...,
        [ 6.1901e-04,  1.7896e-04, -1.7086e-04,  ...,  5.0035e-05,
          2.1100e-04, -3.9210e-04],
        [-4.4444e-04,  4.0928e-04,  3.3021e-04,  ...,  3.7306e-04,
          5.8383e-04,  6.9500e-05],
        [ 4.8428e-04, -1.7882e-05, -2.4253e-05,  ..., -8.2755e-05,
         -3.5804e-04, -3.2499e-04]]) 
 old gradient:tensor([[ 0.0019, -0.0142,  0.0017,  0.0014,  0.0015,  0.0015,  0.0015,  0.0013,
          0.0019,  0.0015],
        [ 0.0021,  0.0015,  0.0016,  0.0015,  0.0016, -0.0142,  0.0014,  0.0014,
          0.0017,  0.0015],
        [ 0.0018, -0.0142,  0.0018,  0.0013,  0.0015,  0.0015,  0.0014,  0.0014,
          0.0019,  0.0015],
        [ 0.0020,  0.0015, -0.0138,  0.0013,  0.0014,  0.0014,  0.0014,  0.0015,
          0.0019,  0.0014],
        [ 0.0020,  0.0015,  0.0019,  0.0013,  0.0015,  0.0014, -0.0143,  0.0014,
          0.0018,  0.0016],
        [ 0.0020,  0.0014,  0.0017,  0.0014,  0.0015,  0.0016,  0.0015,  0.0014,
          0.0017, -0.0141],
        [ 0.0018,  0.0015, -0.0139,  0.0014,  0.0015,  0.0015,  0.0015,  0.0014,
          0.0017,  0.0015],
        [ 0.0024,  0.0015,  0.0017,  0.0012,  0.0014,  0.0013, -0.0143,  0.0014,
          0.0019,  0.0014],
        [ 0.0019,  0.0014,  0.0017,  0.0014,  0.0017,  0.0015,  0.0015, -0.0142,
          0.0016,  0.0015],
        [ 0.0020,  0.0015,  0.0018,  0.0013, -0.0141,  0.0015,  0.0015,  0.0014,
          0.0017,  0.0015],
        [ 0.0018,  0.0015,  0.0017,  0.0015,  0.0015,  0.0015,  0.0014, -0.0142,
          0.0016,  0.0015],
        [ 0.0021,  0.0014,  0.0016, -0.0143,  0.0015,  0.0015,  0.0014,  0.0014,
          0.0018,  0.0015],
        [ 0.0021,  0.0015,  0.0018,  0.0012,  0.0016,  0.0014, -0.0144,  0.0014,
          0.0019,  0.0015],
        [ 0.0021,  0.0014, -0.0137,  0.0012,  0.0015,  0.0014,  0.0014,  0.0015,
          0.0018,  0.0016],
        [-0.0135,  0.0013,  0.0016,  0.0014,  0.0016,  0.0014,  0.0015,  0.0014,
          0.0018,  0.0015],
        [-0.0134,  0.0014,  0.0016,  0.0013,  0.0016,  0.0014,  0.0013,  0.0014,
          0.0019,  0.0015],
        [ 0.0019,  0.0015, -0.0139,  0.0014,  0.0015,  0.0015,  0.0014,  0.0015,
          0.0018,  0.0014],
        [-0.0134,  0.0013,  0.0016,  0.0013,  0.0017,  0.0014,  0.0014,  0.0015,
          0.0018,  0.0014],
        [ 0.0022,  0.0013,  0.0017,  0.0014,  0.0016,  0.0014,  0.0015,  0.0014,
         -0.0138,  0.0014],
        [ 0.0018,  0.0015,  0.0018,  0.0014,  0.0015,  0.0016,  0.0014, -0.0141,
          0.0017,  0.0015],
        [ 0.0018, -0.0141,  0.0017,  0.0014,  0.0015,  0.0016,  0.0015,  0.0015,
          0.0016,  0.0016],
        [ 0.0021,  0.0014,  0.0018,  0.0014,  0.0015,  0.0014,  0.0014,  0.0014,
          0.0018, -0.0142],
        [ 0.0019, -0.0142,  0.0017,  0.0014,  0.0015,  0.0015,  0.0015,  0.0014,
          0.0017,  0.0016],
        [ 0.0020,  0.0016,  0.0017,  0.0013, -0.0141,  0.0015,  0.0014,  0.0014,
          0.0018,  0.0015],
        [ 0.0020,  0.0014, -0.0138,  0.0012,  0.0015,  0.0015,  0.0013,  0.0014,
          0.0019,  0.0015],
        [ 0.0020,  0.0014,  0.0017, -0.0143,  0.0015,  0.0015,  0.0013,  0.0015,
          0.0018,  0.0015],
        [-0.0134,  0.0014,  0.0018,  0.0013,  0.0015,  0.0014,  0.0013,  0.0014,
          0.0019,  0.0014],
        [ 0.0021,  0.0015,  0.0018,  0.0014,  0.0015,  0.0014,  0.0014,  0.0013,
          0.0018, -0.0142],
        [-0.0135,  0.0014,  0.0017,  0.0013,  0.0015,  0.0015,  0.0014,  0.0014,
          0.0019,  0.0015],
        [ 0.0020,  0.0015,  0.0019,  0.0012,  0.0014,  0.0015,  0.0014, -0.0142,
          0.0017,  0.0015],
        [ 0.0020,  0.0015,  0.0018,  0.0014,  0.0014,  0.0015,  0.0015,  0.0014,
         -0.0140,  0.0015],
        [ 0.0022,  0.0014,  0.0018,  0.0013,  0.0014,  0.0015,  0.0013,  0.0014,
          0.0018, -0.0142],
        [ 0.0018, -0.0142,  0.0018,  0.0013,  0.0015,  0.0015,  0.0014,  0.0013,
          0.0019,  0.0015],
        [ 0.0019,  0.0014,  0.0017,  0.0014,  0.0016,  0.0016,  0.0015, -0.0142,
          0.0016,  0.0015],
        [ 0.0020,  0.0014,  0.0017,  0.0013,  0.0015,  0.0014,  0.0014,  0.0014,
         -0.0138,  0.0015],
        [ 0.0021,  0.0015,  0.0018,  0.0013,  0.0015,  0.0013, -0.0143,  0.0014,
          0.0018,  0.0015],
        [-0.0135,  0.0013,  0.0017,  0.0013,  0.0016,  0.0014,  0.0015,  0.0015,
          0.0018,  0.0014],
        [ 0.0021,  0.0015,  0.0017,  0.0014,  0.0015,  0.0015,  0.0015,  0.0014,
          0.0017, -0.0142],
        [ 0.0019,  0.0015,  0.0017,  0.0014,  0.0015,  0.0015,  0.0016,  0.0014,
         -0.0140,  0.0015],
        [ 0.0020,  0.0014,  0.0017,  0.0014,  0.0016,  0.0015,  0.0014,  0.0014,
         -0.0138,  0.0015],
        [ 0.0021,  0.0015,  0.0018,  0.0013, -0.0141,  0.0014,  0.0014,  0.0014,
          0.0017,  0.0014],
        [ 0.0020,  0.0014,  0.0018,  0.0013,  0.0014,  0.0015,  0.0014,  0.0014,
         -0.0138,  0.0015],
        [ 0.0021,  0.0014,  0.0017,  0.0014,  0.0016, -0.0142,  0.0014,  0.0014,
          0.0017,  0.0015],
        [ 0.0022,  0.0014,  0.0017, -0.0143,  0.0015,  0.0015,  0.0014,  0.0013,
          0.0018,  0.0015],
        [-0.0135,  0.0014,  0.0017,  0.0012,  0.0015,  0.0013,  0.0015,  0.0014,
          0.0019,  0.0015],
        [ 0.0020,  0.0015,  0.0017,  0.0013, -0.0141,  0.0014,  0.0014,  0.0014,
          0.0018,  0.0015],
        [-0.0133,  0.0014,  0.0016,  0.0013,  0.0016,  0.0014,  0.0013,  0.0014,
          0.0019,  0.0015],
        [ 0.0018,  0.0015,  0.0017,  0.0015,  0.0016,  0.0016,  0.0015, -0.0142,
          0.0016,  0.0015],
        [ 0.0021,  0.0014,  0.0018,  0.0014,  0.0016,  0.0014,  0.0013,  0.0013,
         -0.0138,  0.0015],
        [-0.0134,  0.0014,  0.0018,  0.0013,  0.0015,  0.0014,  0.0014,  0.0015,
          0.0017,  0.0014],
        [ 0.0019,  0.0013,  0.0015, -0.0141,  0.0017,  0.0015,  0.0015,  0.0014,
          0.0018,  0.0015],
        [ 0.0020,  0.0014,  0.0017,  0.0015,  0.0015,  0.0015,  0.0014, -0.0142,
          0.0017,  0.0015],
        [ 0.0019,  0.0014,  0.0017,  0.0014,  0.0016, -0.0142,  0.0014,  0.0014,
          0.0017,  0.0016],
        [ 0.0022,  0.0014,  0.0018, -0.0144,  0.0015,  0.0014,  0.0014,  0.0014,
          0.0018,  0.0015],
        [ 0.0019,  0.0014,  0.0017,  0.0015,  0.0016,  0.0015,  0.0015,  0.0014,
          0.0017, -0.0141],
        [ 0.0020, -0.0142,  0.0017,  0.0013,  0.0016,  0.0014,  0.0014,  0.0014,
          0.0018,  0.0015],
        [ 0.0022,  0.0014,  0.0019,  0.0013,  0.0016,  0.0013, -0.0143,  0.0015,
          0.0018,  0.0015],
        [ 0.0020,  0.0014,  0.0018,  0.0014,  0.0014,  0.0014,  0.0015,  0.0015,
          0.0018, -0.0142],
        [ 0.0020, -0.0142,  0.0017,  0.0013,  0.0015,  0.0015,  0.0014,  0.0014,
          0.0018,  0.0015],
        [ 0.0024,  0.0014,  0.0018,  0.0012,  0.0015,  0.0013,  0.0013,  0.0014,
         -0.0138,  0.0015],
        [-0.0136,  0.0014,  0.0017,  0.0014,  0.0016,  0.0014,  0.0015,  0.0014,
          0.0018,  0.0015],
        [ 0.0019, -0.0142,  0.0017,  0.0014,  0.0015,  0.0015,  0.0015,  0.0015,
          0.0017,  0.0016],
        [ 0.0018,  0.0014,  0.0018,  0.0014,  0.0016,  0.0015, -0.0141,  0.0014,
          0.0017,  0.0015],
        [-0.0134,  0.0013,  0.0016,  0.0013,  0.0017,  0.0013,  0.0014,  0.0014,
          0.0018,  0.0015]])
2024-11-30 13:26:23,704 - INFO - reading batch[9] client 4
2024-11-30 13:26:23,765 - INFO - reading batch[10] client 1
2024-11-30 13:26:23,802 - INFO - reading batch[10] client 2
2024-11-30 13:26:23,816 - INFO - reading batch[10] client 3
2024-11-30 13:26:23,841 - INFO - reading batch[10] client 4
2024-11-30 13:26:23,869 - INFO - reading batch[11] client 1
2024-11-30 13:26:23,887 - INFO - reading batch[11] client 2
2024-11-30 13:26:23,915 - INFO - reading batch[11] client 3
2024-11-30 13:26:23,944 - INFO - reading batch[11] client 4
2024-11-30 13:26:23,972 - INFO - reading batch[12] client 1
2024-11-30 13:26:23,999 - INFO - reading batch[12] client 2
2024-11-30 13:26:24,013 - INFO - reading batch[12] client 3
2024-11-30 13:26:24,031 - INFO - reading batch[12] client 4
2024-11-30 13:26:24,053 - INFO - reading batch[13] client 1
2024-11-30 13:26:24,072 - INFO - reading batch[13] client 2
2024-11-30 13:26:24,095 - INFO - reading batch[13] client 3
2024-11-30 13:26:24,123 - INFO - reading batch[13] client 4
2024-11-30 13:26:24,151 - INFO - reading batch[14] client 1
2024-11-30 13:26:24,169 - INFO - reading batch[14] client 2
2024-11-30 13:26:24,192 - INFO - reading batch[14] client 3
2024-11-30 13:26:24,221 - INFO - reading batch[14] client 4
2024-11-30 13:26:24,248 - INFO - reading batch[15] client 1
2024-11-30 13:26:24,273 - INFO - reading batch[15] client 2
2024-11-30 13:26:24,287 - INFO - reading batch[15] client 3
2024-11-30 13:26:24,303 - INFO - reading batch[15] client 4
2024-11-30 13:26:24,329 - INFO - reading batch[16] client 1
2024-11-30 13:26:24,357 - INFO - reading batch[16] client 2
2024-11-30 13:26:24,382 - INFO - reading batch[16] client 3
2024-11-30 13:26:24,414 - INFO - reading batch[16] client 4
2024-11-30 13:26:24,439 - INFO - reading batch[17] client 1
2024-11-30 13:26:24,462 - INFO - reading batch[17] client 2
2024-11-30 13:26:24,475 - ERROR - backward on partition 3
2024-11-30 13:26:24,479 - CRITICAL - calculate backward $3 on client3
2024-11-30 13:26:24,489 - CRITICAL - new gradient:tensor([[[[-4.2640e-05, -1.2691e-04,  2.1150e-04, -4.6298e-05],
          [-3.4812e-04, -1.4644e-04,  6.7869e-05,  4.4838e-06],
          [ 2.0128e-04, -3.1375e-05, -6.1680e-05,  4.7451e-05],
          [-1.4185e-04, -5.2737e-05,  2.2712e-05, -1.0112e-05]],

         [[-8.2511e-05,  8.5044e-05,  4.4724e-06, -1.7696e-04],
          [ 5.8847e-05, -1.4230e-04, -2.0181e-05, -9.2762e-05],
          [-1.0349e-04,  2.5551e-05,  1.2061e-04, -2.4917e-05],
          [ 9.2485e-05,  1.6871e-05, -5.0199e-05, -2.8961e-05]],

         [[-1.0845e-04, -1.6883e-05, -1.2296e-05,  8.8374e-05],
          [-1.4829e-04, -8.6313e-05,  7.0120e-05, -4.5541e-05],
          [ 6.7361e-05,  1.8785e-05,  2.1798e-04, -1.0777e-05],
          [-6.4054e-05,  1.3797e-04, -1.1852e-04, -3.7180e-05]],

         ...,

         [[-1.2981e-05,  3.0868e-05,  2.6658e-05, -1.1234e-04],
          [-2.3252e-04,  2.7017e-05,  1.1284e-04, -8.5385e-05],
          [ 1.2141e-06,  4.1985e-05,  2.9510e-05,  9.9191e-05],
          [-7.2647e-05, -1.1169e-04,  6.7812e-05,  9.4994e-05]],

         [[-6.9107e-05, -1.2867e-04, -1.5187e-05,  6.2551e-05],
          [ 6.2712e-06,  1.3290e-04,  9.0390e-05, -9.2003e-08],
          [ 5.9336e-05,  7.0731e-05,  1.2490e-04, -5.2920e-05],
          [-1.8294e-04, -1.7576e-04,  6.6268e-05, -1.0656e-04]],

         [[ 3.2724e-05,  1.6368e-04, -3.1211e-05, -1.9183e-05],
          [ 6.4505e-05, -1.6472e-05,  2.6019e-05,  7.5439e-06],
          [-2.6387e-05,  5.6515e-05,  3.0259e-04,  1.8557e-04],
          [-3.5577e-05,  1.3664e-04, -6.8507e-05,  5.8433e-06]]],


        [[[-3.5856e-05,  3.3403e-04, -1.1050e-04,  1.3032e-04],
          [-1.0652e-04, -7.9657e-05,  3.9014e-05,  4.9196e-05],
          [-6.8530e-05,  9.4021e-05,  9.7903e-05, -2.6534e-06],
          [-4.1950e-06,  2.2512e-04,  1.0670e-04,  7.6142e-05]],

         [[-6.8347e-05,  2.1272e-04,  1.3468e-05, -7.8530e-05],
          [-1.1726e-04,  8.6976e-05,  8.0568e-05,  5.2121e-05],
          [ 1.1005e-04,  1.8927e-04,  9.8936e-05,  9.1642e-05],
          [-1.0384e-04, -1.0979e-04,  6.2126e-05,  7.8192e-05]],

         [[ 1.0887e-04,  1.3345e-04, -4.7651e-05,  1.4584e-04],
          [-7.9094e-05, -8.3942e-05, -6.1419e-05,  1.0769e-04],
          [ 4.4253e-05,  4.8951e-05,  3.5128e-05,  1.8383e-04],
          [-5.5284e-05,  9.8461e-05,  1.1647e-04, -7.9777e-05]],

         ...,

         [[-1.4363e-04, -4.8277e-05, -1.0703e-04, -1.1804e-04],
          [ 1.2232e-04, -3.1003e-05, -5.7422e-06, -2.4160e-05],
          [ 4.8595e-06,  1.4769e-04, -5.2818e-05, -1.3463e-04],
          [ 2.2100e-04, -1.2554e-04, -9.2246e-05, -3.5414e-05]],

         [[-6.9787e-06,  8.0032e-06, -3.4549e-06,  1.9871e-04],
          [ 3.7569e-06,  7.2780e-05,  1.1916e-06,  5.2409e-05],
          [ 1.4974e-04,  7.7230e-06,  6.6136e-05, -1.6801e-04],
          [ 1.1471e-06, -1.5419e-04,  9.1287e-05,  7.6714e-05]],

         [[-9.3684e-05, -1.0970e-04,  2.0467e-04,  1.3708e-04],
          [ 2.3726e-04,  1.1836e-04, -1.8253e-04,  1.4390e-04],
          [-1.1067e-05, -1.5935e-04, -9.6756e-05, -5.1975e-05],
          [-2.9665e-05, -1.1567e-04, -1.5682e-04, -1.1131e-05]]],


        [[[ 5.9128e-05,  2.1516e-05,  1.3122e-04, -6.2857e-05],
          [-4.0803e-04, -6.6506e-05, -3.5348e-05, -1.0929e-05],
          [ 1.0860e-04, -4.6636e-05, -2.0729e-05,  2.3936e-05],
          [-7.4033e-05, -6.1586e-05,  1.0220e-05, -7.6920e-05]],

         [[-1.2531e-04,  1.2983e-04,  1.8292e-05, -2.5554e-04],
          [ 2.0229e-05, -1.4068e-04, -1.9573e-05, -2.1702e-04],
          [ 5.6568e-06, -2.7118e-05,  1.1390e-04, -9.8048e-05],
          [ 1.4961e-04,  1.5115e-04,  2.2444e-05, -1.3260e-04]],

         [[-3.3098e-05,  1.7380e-05, -2.4553e-05, -2.7645e-05],
          [-1.7329e-04, -1.3156e-04, -6.4178e-07, -4.3141e-05],
          [ 1.0966e-04, -2.9118e-06,  1.3724e-04, -7.9144e-05],
          [ 1.6081e-05,  1.3254e-04, -1.8731e-04,  3.1130e-05]],

         ...,

         [[ 7.2273e-06, -7.4731e-06,  2.8229e-05,  3.3999e-05],
          [-1.7975e-04,  5.8480e-05,  3.5460e-05, -7.4148e-05],
          [ 2.5672e-05,  1.2141e-04,  1.6171e-05,  6.8373e-05],
          [ 5.0685e-06, -1.1114e-04,  1.3532e-04,  9.4115e-05]],

         [[ 1.9879e-05, -8.1296e-05, -1.5433e-04,  4.0400e-05],
          [ 1.3171e-05,  1.0424e-04,  3.9564e-05,  7.2378e-05],
          [ 9.7007e-07,  1.1909e-04,  6.1945e-05,  7.2585e-06],
          [-2.1069e-04, -4.6403e-05, -1.9791e-05, -1.2333e-04]],

         [[ 2.3382e-05,  9.1959e-05,  6.8517e-05,  6.6409e-06],
          [ 1.0736e-04,  2.3819e-05,  5.9032e-05,  1.9536e-05],
          [-3.8861e-05,  2.6135e-06,  2.9319e-04,  1.7603e-04],
          [-4.2803e-05,  1.4476e-04, -4.2801e-06, -1.7724e-05]]],


        ...,


        [[[-5.2727e-05, -1.3567e-04,  1.4052e-04, -1.3360e-04],
          [-3.0778e-04, -5.5267e-05,  2.7814e-05,  8.7736e-06],
          [ 9.7282e-05, -5.5553e-05, -8.8097e-05,  1.4761e-05],
          [-6.0605e-05, -6.6994e-05, -7.3118e-05, -3.9155e-05]],

         [[-1.1984e-04,  9.0573e-05,  7.4057e-05, -1.5620e-04],
          [ 1.9349e-05, -1.2136e-04, -1.3884e-06, -1.5288e-04],
          [ 6.4755e-06, -2.1161e-05,  1.6862e-04, -8.8652e-05],
          [ 9.1660e-05,  1.5200e-04, -3.8468e-05, -6.7150e-05]],

         [[-2.9155e-05,  5.5179e-05, -8.0790e-05,  4.7465e-05],
          [-1.8182e-04,  5.5673e-05,  1.8631e-05, -2.3082e-05],
          [ 2.1677e-04,  3.2882e-05,  1.0670e-04, -1.5647e-04],
          [-1.3449e-04,  1.9249e-04, -2.3047e-04, -3.3274e-05]],

         ...,

         [[-6.1021e-05,  6.0676e-05, -4.3757e-05, -2.0748e-05],
          [-2.0207e-04,  1.2554e-05,  7.7716e-05, -1.1256e-04],
          [-1.1050e-05,  1.0593e-04,  4.6925e-05,  4.3239e-05],
          [ 5.2645e-05, -1.1870e-04, -4.3196e-06,  9.2546e-05]],

         [[ 4.4629e-05, -1.4216e-04, -9.3927e-05,  1.7744e-04],
          [-5.8656e-05,  1.1291e-04,  3.7393e-05,  7.8919e-05],
          [ 3.0605e-05,  5.0844e-05,  6.1832e-05,  4.7602e-05],
          [-1.9916e-04, -5.7111e-05,  9.5928e-05, -1.4767e-04]],

         [[ 2.5879e-05,  2.4202e-04,  7.4701e-05,  1.9258e-05],
          [ 1.2440e-04,  1.9495e-05,  2.7147e-05, -8.8291e-05],
          [-2.2546e-05,  1.3472e-05,  2.8719e-04,  8.5199e-05],
          [-9.9724e-06,  1.3446e-05, -2.2009e-06,  8.3819e-05]]],


        [[[ 1.9547e-04,  5.2651e-05, -4.9203e-05, -6.0234e-05],
          [ 1.0320e-05, -7.3709e-05,  6.9673e-06,  7.6906e-05],
          [-2.3868e-05,  1.1900e-04,  2.0602e-05,  1.8093e-04],
          [ 7.2325e-05, -3.1137e-05, -2.0465e-04,  2.3262e-05]],

         [[-2.0358e-04,  2.2588e-04,  1.5813e-04,  9.6053e-06],
          [-9.8532e-05, -5.0122e-05,  1.6112e-04,  9.1481e-05],
          [ 4.0895e-05,  2.8859e-04, -4.6204e-05,  7.4531e-05],
          [ 2.6034e-04,  6.6572e-05, -5.3669e-05,  5.3530e-05]],

         [[-2.3631e-05, -2.1962e-05, -1.3651e-05,  5.9940e-05],
          [ 7.4205e-05,  9.7808e-06,  1.4227e-04, -1.8374e-05],
          [-2.8912e-04,  2.0490e-04,  4.0879e-05,  7.4415e-05],
          [-9.9107e-05,  1.0474e-04,  4.0463e-05,  2.8245e-04]],

         ...,

         [[ 2.3568e-05,  1.2019e-04,  5.3390e-05, -3.6957e-05],
          [-6.7491e-05,  9.8198e-05,  1.6358e-04,  3.6097e-05],
          [-6.1232e-05,  3.4760e-05,  7.9425e-05, -4.6793e-05],
          [-9.2701e-05,  2.3019e-05, -9.3440e-05,  1.3367e-05]],

         [[ 1.0255e-04, -4.3397e-05,  1.4301e-05,  1.2093e-05],
          [ 2.5684e-04,  2.6208e-04,  1.8133e-05, -7.6384e-05],
          [-4.0830e-05,  1.4647e-04,  1.6049e-05, -2.1658e-04],
          [ 1.7122e-04, -1.7161e-05,  1.0040e-05,  3.3624e-05]],

         [[-1.1017e-04,  1.1796e-04, -8.5580e-05,  8.6901e-05],
          [ 3.1387e-05, -7.3032e-05,  1.9779e-05, -3.0366e-04],
          [-7.4349e-05,  1.1912e-04,  6.0616e-05,  1.3324e-04],
          [-1.3724e-04,  8.5309e-05, -1.6251e-04, -1.3507e-04]]],


        [[[-1.6118e-04, -1.1473e-04, -1.9435e-04,  1.0840e-04],
          [ 6.4809e-05,  1.7602e-04,  6.7366e-05,  1.6148e-04],
          [-4.7297e-05, -4.9761e-05, -4.8078e-05, -7.0501e-05],
          [-1.6952e-05, -1.9088e-04,  1.5555e-04, -1.9846e-05]],

         [[ 3.3112e-05, -1.4166e-04,  2.3615e-05, -1.9555e-04],
          [-5.4478e-05,  1.2459e-05,  1.7212e-04, -5.8240e-05],
          [-1.0992e-04,  1.6031e-04,  2.3699e-05, -3.0281e-05],
          [-1.1013e-04,  8.3704e-05, -3.9959e-05,  1.1207e-04]],

         [[-1.8011e-04,  9.8195e-05,  1.0933e-04, -1.2193e-04],
          [ 6.0959e-05,  8.2853e-05, -1.1130e-04,  1.3142e-05],
          [-3.8585e-05,  2.2181e-05,  5.7329e-06, -9.8223e-05],
          [ 4.2828e-06,  5.5370e-05,  1.1908e-05,  9.4731e-05]],

         ...,

         [[-7.3702e-05, -5.7394e-05,  8.9701e-06,  4.8541e-05],
          [-1.6756e-04, -1.3516e-04,  5.9161e-05,  1.5588e-04],
          [-1.7970e-04, -1.1651e-05, -2.3094e-04,  6.9498e-05],
          [-1.1094e-04,  1.6193e-04,  1.7671e-05,  9.6732e-05]],

         [[-3.9528e-05, -1.9509e-05, -1.7873e-04, -1.0040e-04],
          [ 3.9231e-06, -9.3896e-05, -2.2406e-05, -1.9156e-04],
          [ 1.7928e-05,  4.2769e-05, -7.8703e-05,  1.6071e-05],
          [-4.0757e-05,  8.8023e-06, -5.1357e-05,  2.2526e-05]],

         [[-5.4425e-05,  6.0449e-06, -1.2376e-04,  5.2135e-06],
          [-1.2403e-04,  2.3454e-05, -1.6998e-06, -3.0488e-05],
          [-1.8024e-04, -7.4466e-05, -4.2257e-05, -9.5810e-05],
          [ 9.8082e-05, -1.3084e-05,  2.5049e-05,  1.9199e-04]]]]) 
 old gradient:tensor([[ 6.1407e-04,  1.6644e-04, -1.6553e-04,  ...,  5.2116e-05,
          2.1601e-04, -3.8596e-04],
        [-4.8807e-04, -6.7538e-04, -3.9925e-04,  ..., -1.7357e-04,
          2.9376e-04,  5.6823e-04],
        [ 6.1750e-04,  1.7176e-04, -1.6333e-04,  ...,  5.2613e-05,
          2.1443e-04, -3.8918e-04],
        ...,
        [ 6.1901e-04,  1.7896e-04, -1.7086e-04,  ...,  5.0035e-05,
          2.1100e-04, -3.9210e-04],
        [-4.4444e-04,  4.0928e-04,  3.3021e-04,  ...,  3.7306e-04,
          5.8383e-04,  6.9500e-05],
        [ 4.8428e-04, -1.7882e-05, -2.4253e-05,  ..., -8.2755e-05,
         -3.5804e-04, -3.2499e-04]])
2024-11-30 13:26:24,489 - INFO - reading batch[17] client 3
2024-11-30 13:26:24,514 - INFO - reading batch[17] client 4
2024-11-30 13:26:24,542 - INFO - reading batch[18] client 1
2024-11-30 13:26:24,567 - INFO - reading batch[18] client 2
2024-11-30 13:26:24,584 - INFO - reading batch[18] client 3
2024-11-30 13:26:24,602 - INFO - reading batch[18] client 4
2024-11-30 13:26:24,628 - INFO - reading batch[19] client 1
2024-11-30 13:26:24,659 - INFO - reading batch[19] client 2
2024-11-30 13:26:24,685 - INFO - reading batch[19] client 3
2024-11-30 13:26:24,710 - INFO - reading batch[19] client 4
2024-11-30 13:26:24,737 - INFO - reading batch[20] client 1
2024-11-30 13:26:24,765 - INFO - reading batch[20] client 2
2024-11-30 13:26:24,779 - INFO - reading batch[20] client 3
2024-11-30 13:26:24,800 - INFO - reading batch[20] client 4
2024-11-30 13:26:24,812 - INFO - Final partition
2024-11-30 13:26:24,813 - INFO - reading batch[21] client 1
2024-11-30 13:26:24,838 - INFO - reading batch[21] client 2
2024-11-30 13:26:24,867 - INFO - reading batch[21] client 3
2024-11-30 13:26:24,892 - INFO - reading batch[21] client 4
2024-11-30 13:26:24,918 - INFO - reading batch[22] client 1
2024-11-30 13:26:24,939 - INFO - reading batch[22] client 2
2024-11-30 13:26:24,968 - INFO - reading batch[22] client 3
2024-11-30 13:26:24,981 - INFO - reading batch[22] client 4
2024-11-30 13:26:25,004 - INFO - reading batch[23] client 1
2024-11-30 13:26:25,023 - INFO - reading batch[23] client 2
2024-11-30 13:26:25,037 - INFO - Final partition
2024-11-30 13:26:25,038 - INFO - reading batch[23] client 3
2024-11-30 13:26:25,061 - INFO - Final partition
2024-11-30 13:26:25,062 - INFO - reading batch[23] client 4
2024-11-30 13:26:25,094 - INFO - reading batch[24] client 1
2024-11-30 13:26:25,120 - INFO - reading batch[24] client 2
2024-11-30 13:26:25,140 - INFO - reading batch[24] client 3
2024-11-30 13:26:25,165 - INFO - reading batch[24] client 4
2024-11-30 13:26:25,197 - INFO - reading batch[25] client 1
2024-11-30 13:26:25,223 - INFO - reading batch[25] client 2
2024-11-30 13:26:25,245 - INFO - reading batch[25] client 3
2024-11-30 13:26:25,278 - INFO - reading batch[25] client 4
2024-11-30 13:26:25,304 - INFO - reading batch[26] client 1
2024-11-30 13:26:25,322 - INFO - reading batch[26] client 2
2024-11-30 13:26:25,335 - INFO - reading batch[26] client 3
2024-11-30 13:26:25,357 - INFO - reading batch[26] client 4
2024-11-30 13:26:25,379 - INFO - reading batch[27] client 1
2024-11-30 13:26:25,395 - INFO - Final partition
2024-11-30 13:26:25,396 - INFO - reading batch[27] client 2
2024-11-30 13:26:25,430 - INFO - reading batch[27] client 3
2024-11-30 13:26:25,453 - INFO - reading batch[27] client 4
2024-11-30 13:26:25,485 - INFO - reading batch[28] client 1
2024-11-30 13:26:25,510 - INFO - reading batch[28] client 2
2024-11-30 13:26:25,524 - INFO - reading batch[28] client 3
2024-11-30 13:26:25,547 - INFO - reading batch[28] client 4
2024-11-30 13:26:25,570 - INFO - reading batch[29] client 1
2024-11-30 13:26:25,592 - INFO - reading batch[29] client 2
2024-11-30 13:26:25,619 - INFO - reading batch[29] client 3
2024-11-30 13:26:25,642 - INFO - reading batch[29] client 4
2024-11-30 13:26:25,663 - INFO - reading batch[30] client 1
2024-11-30 13:26:25,691 - INFO - reading batch[30] client 2
2024-11-30 13:26:25,718 - INFO - reading batch[30] client 3
2024-11-30 13:26:25,736 - INFO - reading batch[30] client 4
2024-11-30 13:26:25,758 - INFO - reading batch[31] client 1
2024-11-30 13:26:25,776 - INFO - reading batch[31] client 2
2024-11-30 13:26:25,790 - INFO - reading batch[31] client 3
2024-11-30 13:26:25,812 - INFO - reading batch[31] client 4
2024-11-30 13:26:25,837 - INFO - reading batch[32] client 1
2024-11-30 13:26:25,856 - INFO - reading batch[32] client 2
2024-11-30 13:26:25,879 - INFO - reading batch[32] client 3
2024-11-30 13:26:25,896 - ERROR - backward on partition 4
2024-11-30 13:26:25,897 - CRITICAL - calculate backward $4 on client4
2024-11-30 13:26:25,903 - CRITICAL - new gradient:tensor([[ 4.9432e-04, -2.0470e-05, -2.1049e-05,  ..., -8.1874e-05,
         -3.6382e-04, -3.3073e-04],
        [-4.8751e-04, -6.8145e-04, -3.9654e-04,  ..., -1.8060e-04,
          2.8648e-04,  5.7520e-04],
        [-4.9295e-04, -6.8075e-04, -3.9520e-04,  ..., -1.7845e-04,
          2.9148e-04,  5.7637e-04],
        ...,
        [-2.4555e-04,  2.4207e-04, -3.8371e-04,  ..., -2.2255e-04,
          2.2397e-04, -7.5322e-06],
        [ 4.8615e-04, -2.0165e-05, -1.3046e-05,  ..., -8.3101e-05,
         -3.5701e-04, -3.1947e-04],
        [-1.3319e-04,  1.0765e-04,  2.1771e-04,  ..., -7.2708e-04,
         -4.5460e-04,  6.0807e-04]]) 
 old gradient:tensor([[-0.0136,  0.0013,  0.0017,  0.0014,  0.0016,  0.0014,  0.0015,  0.0014,
          0.0018,  0.0015],
        [ 0.0020,  0.0015,  0.0017,  0.0014,  0.0015, -0.0142,  0.0015,  0.0015,
          0.0017,  0.0015],
        [ 0.0020,  0.0015,  0.0018,  0.0014,  0.0015, -0.0142,  0.0015,  0.0015,
          0.0017,  0.0014],
        [ 0.0019,  0.0014,  0.0017,  0.0015,  0.0016,  0.0015,  0.0015, -0.0142,
          0.0016,  0.0016],
        [ 0.0019,  0.0014,  0.0018,  0.0014,  0.0016,  0.0015,  0.0014, -0.0143,
          0.0017,  0.0015],
        [ 0.0020,  0.0014,  0.0017,  0.0015,  0.0016,  0.0014,  0.0014, -0.0141,
          0.0017,  0.0015],
        [ 0.0020,  0.0014,  0.0017,  0.0015,  0.0015,  0.0015,  0.0014, -0.0142,
          0.0018,  0.0014],
        [ 0.0021,  0.0014,  0.0017,  0.0013,  0.0014,  0.0014,  0.0014,  0.0014,
         -0.0138,  0.0015],
        [ 0.0020,  0.0014,  0.0017,  0.0014,  0.0017, -0.0142,  0.0014,  0.0014,
          0.0017,  0.0015],
        [ 0.0019,  0.0014, -0.0138,  0.0013,  0.0015,  0.0015,  0.0014,  0.0014,
          0.0017,  0.0015],
        [ 0.0020,  0.0014, -0.0138,  0.0013,  0.0015,  0.0014,  0.0014,  0.0014,
          0.0018,  0.0016],
        [ 0.0021,  0.0015,  0.0018,  0.0013, -0.0142,  0.0015,  0.0014,  0.0014,
          0.0018,  0.0015],
        [ 0.0019,  0.0014,  0.0018,  0.0015,  0.0015,  0.0016,  0.0014, -0.0143,
          0.0017,  0.0016],
        [-0.0136,  0.0013,  0.0016,  0.0014,  0.0017,  0.0015,  0.0016,  0.0014,
          0.0017,  0.0015],
        [ 0.0019, -0.0142,  0.0018,  0.0013,  0.0015,  0.0015,  0.0014,  0.0014,
          0.0019,  0.0015],
        [-0.0135,  0.0015,  0.0016,  0.0013,  0.0016,  0.0014,  0.0014,  0.0015,
          0.0018,  0.0014],
        [ 0.0019,  0.0015,  0.0017,  0.0013,  0.0017,  0.0015, -0.0142,  0.0015,
          0.0017,  0.0015],
        [ 0.0020,  0.0015, -0.0139,  0.0012,  0.0015,  0.0014,  0.0014,  0.0014,
          0.0019,  0.0016],
        [ 0.0019, -0.0141,  0.0017,  0.0013,  0.0014,  0.0016,  0.0015,  0.0015,
          0.0017,  0.0015],
        [ 0.0021,  0.0014,  0.0017, -0.0143,  0.0015,  0.0014,  0.0015,  0.0015,
          0.0019,  0.0014],
        [ 0.0019, -0.0142,  0.0018,  0.0014,  0.0015,  0.0014,  0.0014,  0.0013,
          0.0019,  0.0015],
        [ 0.0022,  0.0015,  0.0018, -0.0143,  0.0014,  0.0013,  0.0013,  0.0014,
          0.0018,  0.0016],
        [ 0.0019,  0.0015,  0.0017,  0.0014,  0.0016,  0.0015,  0.0014, -0.0142,
          0.0016,  0.0015],
        [ 0.0022,  0.0014,  0.0018, -0.0143,  0.0015,  0.0014,  0.0014,  0.0014,
          0.0018,  0.0015],
        [ 0.0023,  0.0014,  0.0019,  0.0012,  0.0014,  0.0013, -0.0143,  0.0015,
          0.0019,  0.0014],
        [ 0.0021,  0.0015,  0.0018,  0.0013,  0.0016,  0.0014, -0.0142,  0.0014,
          0.0018,  0.0014],
        [ 0.0020,  0.0014,  0.0017,  0.0013, -0.0140,  0.0015,  0.0014,  0.0014,
          0.0018,  0.0015],
        [ 0.0022,  0.0014,  0.0017, -0.0143,  0.0016,  0.0014,  0.0014,  0.0014,
          0.0018,  0.0015],
        [ 0.0021,  0.0016, -0.0140,  0.0012,  0.0014,  0.0015,  0.0014,  0.0014,
          0.0019,  0.0015],
        [ 0.0021,  0.0014,  0.0017, -0.0142,  0.0014,  0.0014,  0.0014,  0.0014,
          0.0019,  0.0015],
        [-0.0135,  0.0014,  0.0016,  0.0013,  0.0015,  0.0015,  0.0014,  0.0014,
          0.0019,  0.0015],
        [ 0.0022,  0.0015,  0.0019,  0.0012, -0.0141,  0.0014,  0.0013,  0.0014,
          0.0018,  0.0014],
        [-0.0132,  0.0013,  0.0018,  0.0012,  0.0016,  0.0013,  0.0014,  0.0014,
          0.0019,  0.0014],
        [ 0.0019,  0.0014,  0.0017, -0.0142,  0.0016,  0.0015,  0.0015,  0.0015,
          0.0017,  0.0015],
        [ 0.0018, -0.0142,  0.0017,  0.0014,  0.0015,  0.0015,  0.0016,  0.0015,
          0.0016,  0.0016],
        [ 0.0021,  0.0015, -0.0139,  0.0012,  0.0014,  0.0014,  0.0014,  0.0015,
          0.0020,  0.0015],
        [ 0.0021,  0.0015,  0.0018,  0.0013, -0.0142,  0.0014,  0.0014,  0.0015,
          0.0018,  0.0014],
        [ 0.0018,  0.0015,  0.0017,  0.0015,  0.0015,  0.0016,  0.0015, -0.0142,
          0.0016,  0.0015],
        [ 0.0022,  0.0014,  0.0018,  0.0015,  0.0015,  0.0014,  0.0014,  0.0014,
          0.0017, -0.0142],
        [ 0.0020,  0.0014,  0.0016, -0.0143,  0.0016,  0.0014,  0.0015,  0.0015,
          0.0017,  0.0015],
        [ 0.0018, -0.0142,  0.0016,  0.0014,  0.0015,  0.0015,  0.0016,  0.0015,
          0.0016,  0.0016],
        [ 0.0019,  0.0015, -0.0140,  0.0012,  0.0015,  0.0016,  0.0014,  0.0015,
          0.0018,  0.0015],
        [ 0.0021,  0.0015, -0.0139,  0.0013,  0.0014,  0.0014,  0.0013,  0.0014,
          0.0019,  0.0016],
        [ 0.0022,  0.0014,  0.0017,  0.0013,  0.0015,  0.0014,  0.0014,  0.0014,
         -0.0138,  0.0015],
        [ 0.0020,  0.0014,  0.0018,  0.0015,  0.0015,  0.0015,  0.0014,  0.0014,
          0.0017, -0.0141],
        [ 0.0022,  0.0013,  0.0017,  0.0014,  0.0016,  0.0014, -0.0142,  0.0014,
          0.0018,  0.0015],
        [ 0.0021,  0.0015,  0.0018,  0.0013,  0.0016,  0.0015,  0.0013,  0.0014,
          0.0018, -0.0141],
        [ 0.0019,  0.0015,  0.0018,  0.0014,  0.0015,  0.0014,  0.0014,  0.0014,
          0.0017, -0.0141],
        [-0.0136,  0.0013,  0.0016,  0.0014,  0.0017,  0.0014,  0.0015,  0.0014,
          0.0018,  0.0016],
        [ 0.0020,  0.0013,  0.0017,  0.0014,  0.0016,  0.0014,  0.0014,  0.0014,
         -0.0138,  0.0015],
        [ 0.0021,  0.0015,  0.0019,  0.0012,  0.0015,  0.0014, -0.0143,  0.0014,
          0.0018,  0.0015],
        [ 0.0021,  0.0014,  0.0018,  0.0014,  0.0015,  0.0014,  0.0014,  0.0014,
          0.0017, -0.0142],
        [ 0.0022,  0.0014,  0.0018,  0.0012, -0.0142,  0.0015,  0.0014,  0.0014,
          0.0018,  0.0015],
        [ 0.0019, -0.0142,  0.0017,  0.0014,  0.0016,  0.0014,  0.0015,  0.0014,
          0.0019,  0.0015],
        [ 0.0023,  0.0014,  0.0018, -0.0143,  0.0015,  0.0014,  0.0013,  0.0014,
          0.0018,  0.0015],
        [ 0.0019,  0.0015,  0.0017,  0.0014,  0.0015,  0.0015,  0.0014,  0.0015,
          0.0017, -0.0141],
        [ 0.0020,  0.0015, -0.0139,  0.0013,  0.0014,  0.0015,  0.0014,  0.0015,
          0.0019,  0.0015],
        [ 0.0021,  0.0014,  0.0016,  0.0014,  0.0016, -0.0142,  0.0014,  0.0014,
          0.0018,  0.0015],
        [ 0.0022,  0.0015,  0.0017,  0.0012, -0.0141,  0.0015,  0.0013,  0.0014,
          0.0017,  0.0015],
        [ 0.0021,  0.0015,  0.0018,  0.0013,  0.0015,  0.0015,  0.0014,  0.0015,
         -0.0139,  0.0014],
        [-0.0136,  0.0013,  0.0017,  0.0014,  0.0017,  0.0014,  0.0014,  0.0013,
          0.0018,  0.0015],
        [ 0.0022,  0.0014,  0.0018,  0.0014,  0.0014,  0.0014,  0.0014,  0.0014,
         -0.0138,  0.0015],
        [-0.0135,  0.0014,  0.0018,  0.0013,  0.0014,  0.0014,  0.0015,  0.0013,
          0.0019,  0.0015],
        [ 0.0019,  0.0014,  0.0016, -0.0142,  0.0016,  0.0016,  0.0015,  0.0015,
          0.0017,  0.0015]])
2024-11-30 13:26:25,903 - INFO - reading batch[32] client 4
2024-11-30 13:26:25,927 - INFO - reading batch[33] client 1
2024-11-30 13:26:25,959 - INFO - reading batch[33] client 2
2024-11-30 13:26:25,977 - INFO - reading batch[33] client 3
2024-11-30 13:26:25,999 - INFO - reading batch[33] client 4
2024-11-30 13:26:26,012 - INFO - Final partition
2024-11-30 13:26:26,013 - INFO - reading batch[34] client 1
2024-11-30 13:26:26,038 - INFO - reading batch[34] client 2
2024-11-30 13:26:26,069 - INFO - reading batch[34] client 3
2024-11-30 13:26:26,099 - INFO - reading batch[34] client 4
2024-11-30 13:26:26,127 - INFO - reading batch[35] client 1
2024-11-30 13:26:26,146 - INFO - reading batch[35] client 2
2024-11-30 13:26:26,175 - INFO - reading batch[35] client 3
2024-11-30 13:26:26,188 - ERROR - backward on partition 4
2024-11-30 13:26:26,189 - CRITICAL - calculate backward $4 on client4
2024-11-30 13:26:26,195 - CRITICAL - new gradient:tensor([[ 9.8060e-04, -3.4649e-05, -3.7966e-05,  ..., -1.6170e-04,
         -7.2676e-04, -6.5554e-04],
        [-1.2442e-05, -3.2888e-04, -6.5652e-04,  ...,  5.6404e-06,
         -3.8048e-04,  1.2579e-04],
        [-9.6222e-04, -2.7475e-04, -4.7692e-05,  ...,  2.0069e-04,
          8.8510e-04,  6.6947e-04],
        ...,
        [-3.9525e-04,  3.4356e-04, -1.6025e-04,  ..., -9.5455e-04,
         -2.1632e-04,  6.2104e-04],
        [ 3.6351e-04,  3.7708e-04,  5.2194e-04,  ...,  1.4912e-04,
         -2.1630e-05,  5.1102e-05],
        [ 3.5514e-04,  8.3731e-05,  1.9151e-04,  ..., -8.1345e-04,
         -8.2096e-04,  2.8118e-04]]) 
 old gradient:tensor([[-0.0134,  0.0014,  0.0016,  0.0013,  0.0016,  0.0014,  0.0014,  0.0014,
          0.0019,  0.0015],
        [ 0.0020,  0.0015, -0.0138,  0.0013,  0.0014,  0.0015,  0.0014,  0.0016,
          0.0017,  0.0015],
        [ 0.0022,  0.0015,  0.0017,  0.0012,  0.0015,  0.0013, -0.0144,  0.0014,
          0.0020,  0.0015],
        [ 0.0020,  0.0014,  0.0017,  0.0014, -0.0141,  0.0015,  0.0014,  0.0014,
          0.0017,  0.0016],
        [ 0.0020, -0.0142,  0.0017,  0.0013,  0.0015,  0.0014,  0.0014,  0.0014,
          0.0019,  0.0015],
        [ 0.0019,  0.0015, -0.0138,  0.0013,  0.0015,  0.0015,  0.0014,  0.0014,
          0.0018,  0.0015],
        [ 0.0020,  0.0014,  0.0018,  0.0013,  0.0016,  0.0014, -0.0142,  0.0014,
          0.0017,  0.0014],
        [ 0.0020,  0.0014,  0.0020,  0.0012,  0.0015,  0.0014, -0.0143,  0.0014,
          0.0019,  0.0014],
        [-0.0135,  0.0014,  0.0016,  0.0013,  0.0016,  0.0014,  0.0015,  0.0014,
          0.0017,  0.0015],
        [ 0.0022,  0.0015, -0.0138,  0.0012,  0.0013,  0.0014,  0.0014,  0.0014,
          0.0019,  0.0014],
        [-0.0135,  0.0014,  0.0017,  0.0014,  0.0015,  0.0014,  0.0015,  0.0014,
          0.0018,  0.0015],
        [ 0.0020,  0.0013,  0.0017,  0.0014,  0.0016, -0.0141,  0.0015,  0.0014,
          0.0018,  0.0015],
        [ 0.0023,  0.0013,  0.0018, -0.0143,  0.0015,  0.0014,  0.0014,  0.0014,
          0.0018,  0.0014],
        [ 0.0019,  0.0015,  0.0017,  0.0014, -0.0141,  0.0015,  0.0014,  0.0015,
          0.0018,  0.0015],
        [ 0.0021,  0.0014,  0.0018,  0.0014,  0.0015,  0.0014,  0.0014,  0.0014,
          0.0019, -0.0142],
        [ 0.0021,  0.0014,  0.0017,  0.0014,  0.0016,  0.0015,  0.0014,  0.0014,
          0.0017, -0.0142],
        [ 0.0019, -0.0142,  0.0017,  0.0014,  0.0015,  0.0016,  0.0016,  0.0015,
          0.0017,  0.0015],
        [-0.0135,  0.0013,  0.0017,  0.0013,  0.0015,  0.0015,  0.0014,  0.0014,
          0.0019,  0.0015],
        [-0.0135,  0.0014,  0.0017,  0.0014,  0.0016,  0.0014,  0.0015,  0.0014,
          0.0018,  0.0015],
        [ 0.0020,  0.0014,  0.0018,  0.0013, -0.0140,  0.0014,  0.0014,  0.0014,
          0.0017,  0.0015],
        [ 0.0021,  0.0013,  0.0018,  0.0014,  0.0015,  0.0014,  0.0014,  0.0014,
         -0.0138,  0.0014],
        [ 0.0020,  0.0014,  0.0017,  0.0014,  0.0017, -0.0142,  0.0015,  0.0014,
          0.0017,  0.0015],
        [ 0.0018,  0.0015,  0.0016,  0.0015,  0.0016,  0.0016,  0.0015, -0.0142,
          0.0016,  0.0015],
        [-0.0136,  0.0013,  0.0016,  0.0014,  0.0017,  0.0015,  0.0016,  0.0014,
          0.0017,  0.0014],
        [ 0.0021,  0.0014,  0.0018,  0.0013, -0.0142,  0.0014,  0.0013,  0.0015,
          0.0018,  0.0015],
        [-0.0136,  0.0015,  0.0019,  0.0013,  0.0015,  0.0014,  0.0014,  0.0015,
          0.0017,  0.0014],
        [ 0.0021,  0.0014,  0.0017, -0.0143,  0.0015,  0.0014,  0.0014,  0.0015,
          0.0018,  0.0014],
        [ 0.0020,  0.0014,  0.0017,  0.0014,  0.0016,  0.0015,  0.0014, -0.0142,
          0.0017,  0.0015],
        [ 0.0020,  0.0015, -0.0139,  0.0013,  0.0014,  0.0015,  0.0013,  0.0014,
          0.0019,  0.0016],
        [ 0.0019,  0.0015,  0.0017,  0.0014, -0.0141,  0.0015,  0.0015,  0.0014,
          0.0018,  0.0015],
        [ 0.0022,  0.0013,  0.0017,  0.0014,  0.0015,  0.0014,  0.0014,  0.0013,
         -0.0138,  0.0014],
        [ 0.0021,  0.0014,  0.0018,  0.0014,  0.0015,  0.0015,  0.0014,  0.0014,
          0.0018, -0.0142],
        [ 0.0022,  0.0015, -0.0139,  0.0012,  0.0014,  0.0014,  0.0014,  0.0014,
          0.0019,  0.0015],
        [ 0.0020,  0.0015,  0.0016, -0.0143,  0.0014,  0.0015,  0.0014,  0.0015,
          0.0019,  0.0015],
        [ 0.0020,  0.0014, -0.0138,  0.0013,  0.0014,  0.0014,  0.0015,  0.0016,
          0.0018,  0.0015],
        [ 0.0020,  0.0014,  0.0018,  0.0013,  0.0016,  0.0014,  0.0015,  0.0014,
         -0.0138,  0.0015],
        [-0.0133,  0.0015,  0.0016,  0.0013,  0.0015,  0.0013,  0.0013,  0.0014,
          0.0020,  0.0015],
        [ 0.0022,  0.0013,  0.0017,  0.0014,  0.0015, -0.0142,  0.0014,  0.0014,
          0.0018,  0.0015],
        [ 0.0019, -0.0141,  0.0017,  0.0013,  0.0014,  0.0015,  0.0015,  0.0015,
          0.0017,  0.0015],
        [ 0.0018, -0.0142,  0.0017,  0.0014,  0.0015,  0.0015,  0.0014,  0.0013,
          0.0019,  0.0015],
        [ 0.0018, -0.0142,  0.0017,  0.0014,  0.0015,  0.0015,  0.0015,  0.0014,
          0.0018,  0.0016],
        [ 0.0022,  0.0015,  0.0018,  0.0013,  0.0015,  0.0013, -0.0143,  0.0015,
          0.0018,  0.0015],
        [ 0.0022,  0.0015,  0.0018,  0.0012,  0.0014,  0.0014, -0.0143,  0.0015,
          0.0019,  0.0014],
        [ 0.0020,  0.0015,  0.0018,  0.0013,  0.0016,  0.0014, -0.0142,  0.0014,
          0.0018,  0.0015],
        [-0.0134,  0.0015,  0.0016,  0.0012,  0.0014,  0.0015,  0.0014,  0.0015,
          0.0019,  0.0014],
        [ 0.0020,  0.0015,  0.0017,  0.0014,  0.0015,  0.0014,  0.0015,  0.0015,
          0.0016, -0.0142],
        [ 0.0021,  0.0014,  0.0017,  0.0013,  0.0015,  0.0014, -0.0142,  0.0014,
          0.0019,  0.0016],
        [-0.0135,  0.0015,  0.0016,  0.0013,  0.0015,  0.0014,  0.0013,  0.0015,
          0.0020,  0.0014],
        [ 0.0019,  0.0015,  0.0017,  0.0013,  0.0015,  0.0016,  0.0014, -0.0141,
          0.0017,  0.0015],
        [ 0.0018,  0.0015,  0.0016,  0.0014,  0.0015,  0.0016,  0.0015, -0.0142,
          0.0016,  0.0015],
        [ 0.0020,  0.0015,  0.0017,  0.0014,  0.0015,  0.0014,  0.0014, -0.0143,
          0.0017,  0.0015],
        [-0.0135,  0.0014,  0.0017,  0.0013,  0.0015,  0.0014,  0.0014,  0.0015,
          0.0019,  0.0014],
        [ 0.0020,  0.0014,  0.0017, -0.0143,  0.0016,  0.0015,  0.0014,  0.0013,
          0.0018,  0.0016],
        [ 0.0019,  0.0014,  0.0017, -0.0143,  0.0016,  0.0015,  0.0016,  0.0014,
          0.0017,  0.0016],
        [ 0.0020,  0.0014,  0.0018,  0.0014,  0.0016,  0.0015,  0.0014, -0.0143,
          0.0017,  0.0015],
        [ 0.0022,  0.0015,  0.0017,  0.0013,  0.0016,  0.0013, -0.0143,  0.0014,
          0.0019,  0.0015],
        [ 0.0021, -0.0141,  0.0018,  0.0013,  0.0015,  0.0015,  0.0015,  0.0015,
          0.0017,  0.0014],
        [ 0.0019,  0.0015,  0.0018,  0.0013, -0.0141,  0.0015,  0.0015,  0.0015,
          0.0016,  0.0015],
        [ 0.0021,  0.0014,  0.0017, -0.0143,  0.0015,  0.0014,  0.0014,  0.0015,
          0.0018,  0.0015],
        [ 0.0019,  0.0016,  0.0016,  0.0014,  0.0015,  0.0016,  0.0015, -0.0142,
          0.0016,  0.0016],
        [ 0.0020,  0.0014,  0.0017,  0.0014,  0.0016, -0.0141,  0.0015,  0.0014,
          0.0017,  0.0014],
        [ 0.0020,  0.0014,  0.0018, -0.0143,  0.0016,  0.0014,  0.0014,  0.0015,
          0.0018,  0.0015],
        [ 0.0020,  0.0014,  0.0017,  0.0014, -0.0142,  0.0014,  0.0014,  0.0015,
          0.0018,  0.0015],
        [-0.0135,  0.0013,  0.0017,  0.0013,  0.0017,  0.0013,  0.0015,  0.0014,
          0.0018,  0.0014]])
2024-11-30 13:26:26,195 - INFO - reading batch[35] client 4
2024-11-30 13:26:26,217 - INFO - reading batch[36] client 1
2024-11-30 13:26:26,244 - INFO - reading batch[36] client 2
2024-11-30 13:26:26,259 - INFO - reading batch[36] client 3
2024-11-30 13:26:26,272 - ERROR - backward on partition 4
2024-11-30 13:26:26,273 - CRITICAL - calculate backward $4 on client4
2024-11-30 13:26:26,283 - CRITICAL - new gradient:tensor([[ 1.4623e-03,  3.1700e-04, -3.0057e-04,  ...,  2.5338e-05,
         -1.3963e-03, -1.1108e-03],
        [ 4.7650e-04, -3.4130e-04, -6.7497e-04,  ..., -7.4786e-05,
         -7.4501e-04, -2.0047e-04],
        [-1.4440e-03,  1.3075e-04,  3.0604e-04,  ...,  5.7729e-04,
          1.5018e-03,  7.7528e-04],
        ...,
        [ 2.2111e-04,  5.1719e-04, -3.2560e-04,  ..., -9.0209e-04,
         -5.0460e-07,  2.3262e-04],
        [ 9.8103e-04,  5.5147e-04,  3.5376e-04,  ...,  1.9993e-04,
          1.8990e-04, -3.3871e-04],
        [-1.4602e-04, -6.0044e-04, -2.0006e-04,  ..., -9.9369e-04,
         -5.3119e-04,  8.6599e-04]]) 
 old gradient:tensor([[ 0.0019,  0.0015, -0.0139,  0.0014,  0.0015,  0.0015,  0.0014,  0.0014,
          0.0018,  0.0015],
        [-0.0135,  0.0014,  0.0016,  0.0013,  0.0015,  0.0014,  0.0014,  0.0014,
          0.0018,  0.0015],
        [ 0.0022,  0.0014,  0.0021,  0.0012,  0.0014,  0.0013, -0.0144,  0.0014,
          0.0019,  0.0015],
        [ 0.0019,  0.0016,  0.0017,  0.0014,  0.0015,  0.0016,  0.0014, -0.0142,
          0.0016,  0.0015],
        [ 0.0021,  0.0014,  0.0018,  0.0013,  0.0016,  0.0014, -0.0143,  0.0014,
          0.0018,  0.0014],
        [ 0.0021,  0.0014,  0.0017,  0.0013,  0.0015, -0.0143,  0.0014,  0.0014,
          0.0018,  0.0016],
        [ 0.0019,  0.0015,  0.0017,  0.0014,  0.0016, -0.0142,  0.0014,  0.0015,
          0.0017,  0.0015],
        [ 0.0021,  0.0013,  0.0018,  0.0014, -0.0140,  0.0014,  0.0014,  0.0014,
          0.0017,  0.0015],
        [ 0.0021,  0.0014,  0.0018,  0.0013,  0.0016,  0.0013, -0.0142,  0.0014,
          0.0018,  0.0015],
        [ 0.0019,  0.0014,  0.0017, -0.0143,  0.0016,  0.0015,  0.0015,  0.0014,
          0.0017,  0.0016],
        [ 0.0019,  0.0013,  0.0017,  0.0014,  0.0016,  0.0015,  0.0014,  0.0014,
         -0.0138,  0.0015],
        [ 0.0020,  0.0015, -0.0140,  0.0012,  0.0015,  0.0015,  0.0014,  0.0015,
          0.0018,  0.0014],
        [-0.0135,  0.0014,  0.0017,  0.0012,  0.0015,  0.0015,  0.0014,  0.0014,
          0.0019,  0.0015],
        [ 0.0021,  0.0014,  0.0017,  0.0013,  0.0014,  0.0014,  0.0014,  0.0014,
         -0.0137,  0.0015],
        [ 0.0019,  0.0015,  0.0017,  0.0015,  0.0015,  0.0016,  0.0015, -0.0142,
          0.0016,  0.0015],
        [ 0.0021,  0.0015, -0.0138,  0.0013,  0.0013,  0.0015,  0.0013,  0.0015,
          0.0019,  0.0014],
        [ 0.0022,  0.0014,  0.0018,  0.0014,  0.0015,  0.0014,  0.0013,  0.0014,
          0.0017, -0.0141],
        [ 0.0019,  0.0014,  0.0017,  0.0015,  0.0016,  0.0015,  0.0015,  0.0014,
          0.0017, -0.0141],
        [ 0.0022,  0.0013,  0.0017, -0.0143,  0.0015,  0.0014,  0.0014,  0.0014,
          0.0018,  0.0015],
        [ 0.0021,  0.0016, -0.0139,  0.0013,  0.0014,  0.0014,  0.0014,  0.0016,
          0.0018,  0.0015],
        [ 0.0020,  0.0014,  0.0018,  0.0013,  0.0015,  0.0014, -0.0142,  0.0014,
          0.0019,  0.0015],
        [ 0.0019,  0.0015,  0.0017,  0.0013,  0.0016,  0.0015,  0.0014,  0.0015,
          0.0017, -0.0141],
        [ 0.0019,  0.0015,  0.0017, -0.0142,  0.0015,  0.0014,  0.0014,  0.0015,
          0.0018,  0.0015],
        [ 0.0021,  0.0014,  0.0018,  0.0013,  0.0016,  0.0014, -0.0143,  0.0014,
          0.0018,  0.0014],
        [-0.0136,  0.0014,  0.0017,  0.0014,  0.0016,  0.0015,  0.0014,  0.0013,
          0.0018,  0.0015],
        [ 0.0018,  0.0015,  0.0016, -0.0141,  0.0014,  0.0015,  0.0015,  0.0015,
          0.0017,  0.0015],
        [ 0.0022,  0.0015,  0.0018,  0.0012,  0.0016,  0.0014, -0.0143,  0.0014,
          0.0019,  0.0015],
        [ 0.0018,  0.0015,  0.0017,  0.0015,  0.0015,  0.0015,  0.0015, -0.0142,
          0.0017,  0.0016],
        [ 0.0021,  0.0015, -0.0140,  0.0013,  0.0014,  0.0013,  0.0014,  0.0014,
          0.0019,  0.0015],
        [-0.0136,  0.0013,  0.0017,  0.0014,  0.0016,  0.0015,  0.0015,  0.0014,
          0.0017,  0.0015],
        [-0.0133,  0.0014,  0.0017,  0.0013,  0.0014,  0.0013,  0.0013,  0.0014,
          0.0020,  0.0015],
        [ 0.0021,  0.0014,  0.0018,  0.0013,  0.0016,  0.0014, -0.0142,  0.0014,
          0.0018,  0.0015],
        [ 0.0022,  0.0015,  0.0017,  0.0013,  0.0015,  0.0013,  0.0014,  0.0014,
         -0.0138,  0.0014],
        [ 0.0019, -0.0142,  0.0017,  0.0014,  0.0015,  0.0015,  0.0015,  0.0015,
          0.0017,  0.0016],
        [ 0.0021,  0.0014,  0.0018,  0.0013,  0.0015,  0.0015,  0.0014,  0.0014,
          0.0017, -0.0142],
        [ 0.0019,  0.0014,  0.0018,  0.0013, -0.0140,  0.0015,  0.0014,  0.0014,
          0.0017,  0.0015],
        [ 0.0020,  0.0014,  0.0016, -0.0142,  0.0015,  0.0014,  0.0014,  0.0015,
          0.0018,  0.0015],
        [ 0.0021,  0.0014,  0.0018,  0.0013, -0.0141,  0.0015,  0.0013,  0.0014,
          0.0018,  0.0015],
        [ 0.0018, -0.0141,  0.0017,  0.0013,  0.0015,  0.0015,  0.0016,  0.0015,
          0.0017,  0.0015],
        [ 0.0021,  0.0015,  0.0017, -0.0143,  0.0016,  0.0015,  0.0014,  0.0014,
          0.0017,  0.0015],
        [ 0.0020,  0.0014,  0.0018,  0.0013,  0.0015,  0.0015,  0.0013,  0.0014,
         -0.0138,  0.0015],
        [ 0.0020,  0.0015, -0.0139,  0.0013,  0.0014,  0.0014,  0.0015,  0.0015,
          0.0019,  0.0015],
        [-0.0134,  0.0014,  0.0018,  0.0014,  0.0015,  0.0013,  0.0015,  0.0013,
          0.0018,  0.0014],
        [ 0.0018,  0.0015,  0.0017,  0.0014,  0.0014,  0.0016,  0.0015, -0.0142,
          0.0018,  0.0015],
        [ 0.0021,  0.0014,  0.0018, -0.0143,  0.0015,  0.0014,  0.0014,  0.0014,
          0.0018,  0.0015],
        [ 0.0020,  0.0015,  0.0017,  0.0014,  0.0016,  0.0015,  0.0015, -0.0142,
          0.0016,  0.0015],
        [ 0.0021,  0.0016, -0.0140,  0.0013,  0.0014,  0.0014,  0.0014,  0.0015,
          0.0017,  0.0015],
        [ 0.0021,  0.0014,  0.0018, -0.0142,  0.0015,  0.0014,  0.0014,  0.0014,
          0.0017,  0.0015],
        [-0.0134,  0.0014,  0.0017,  0.0013,  0.0015,  0.0014,  0.0014,  0.0014,
          0.0019,  0.0015],
        [ 0.0023,  0.0014,  0.0017,  0.0013,  0.0015,  0.0013, -0.0143,  0.0014,
          0.0018,  0.0015],
        [ 0.0019,  0.0014,  0.0018,  0.0014,  0.0016,  0.0015,  0.0015,  0.0014,
          0.0017, -0.0141],
        [ 0.0020,  0.0014,  0.0019,  0.0014,  0.0015,  0.0014,  0.0013,  0.0014,
         -0.0138,  0.0015],
        [ 0.0018,  0.0015,  0.0017,  0.0015,  0.0015,  0.0015,  0.0015, -0.0142,
          0.0016,  0.0016],
        [-0.0134,  0.0014,  0.0018,  0.0014,  0.0015,  0.0014,  0.0015,  0.0014,
          0.0017,  0.0014],
        [ 0.0018, -0.0142,  0.0017,  0.0013,  0.0015,  0.0015,  0.0015,  0.0015,
          0.0017,  0.0016],
        [ 0.0021,  0.0015,  0.0018,  0.0013,  0.0015, -0.0143,  0.0013,  0.0015,
          0.0017,  0.0015],
        [ 0.0020,  0.0015,  0.0019,  0.0012, -0.0141,  0.0015,  0.0014,  0.0014,
          0.0018,  0.0015],
        [ 0.0019,  0.0015,  0.0018,  0.0013,  0.0016,  0.0015, -0.0141,  0.0015,
          0.0016,  0.0015],
        [ 0.0019,  0.0014,  0.0016,  0.0014,  0.0016,  0.0016,  0.0015, -0.0142,
          0.0016,  0.0015],
        [ 0.0020,  0.0014,  0.0018,  0.0014, -0.0141,  0.0014,  0.0013,  0.0014,
          0.0018,  0.0014],
        [ 0.0019,  0.0013,  0.0017,  0.0014,  0.0016, -0.0141,  0.0015,  0.0014,
          0.0016,  0.0015],
        [ 0.0019, -0.0142,  0.0017,  0.0014,  0.0015,  0.0015,  0.0014,  0.0014,
          0.0019,  0.0016],
        [ 0.0018, -0.0142,  0.0017,  0.0014,  0.0015,  0.0015,  0.0015,  0.0014,
          0.0018,  0.0016],
        [ 0.0021,  0.0015,  0.0017,  0.0013,  0.0015, -0.0143,  0.0014,  0.0015,
          0.0018,  0.0014]])
2024-11-30 13:26:26,283 - INFO - reading batch[36] client 4
2024-11-30 13:26:26,310 - INFO - reading batch[37] client 1
2024-11-30 13:26:26,329 - INFO - reading batch[37] client 2
2024-11-30 13:26:26,350 - INFO - reading batch[37] client 3
2024-11-30 13:26:26,375 - INFO - reading batch[37] client 4
2024-11-30 13:26:26,400 - INFO - reading batch[38] client 1
2024-11-30 13:26:26,423 - INFO - reading batch[38] client 2
2024-11-30 13:26:26,446 - INFO - reading batch[38] client 3
2024-11-30 13:26:26,458 - INFO - reading batch[38] client 4
2024-11-30 13:26:26,481 - INFO - reading batch[39] client 1
2024-11-30 13:26:26,503 - INFO - reading batch[39] client 2
2024-11-30 13:26:26,519 - INFO - reading batch[39] client 3
2024-11-30 13:26:26,550 - INFO - reading batch[39] client 4
2024-11-30 13:26:26,578 - INFO - reading batch[40] client 1
2024-11-30 13:26:26,598 - INFO - reading batch[40] client 2
2024-11-30 13:26:26,623 - INFO - reading batch[40] client 3
2024-11-30 13:26:26,650 - INFO - reading batch[40] client 4
2024-11-30 13:26:26,677 - INFO - reading batch[41] client 1
2024-11-30 13:26:26,695 - INFO - reading batch[41] client 2
2024-11-30 13:26:26,710 - INFO - Final partition
2024-11-30 13:26:26,710 - INFO - reading batch[41] client 3
2024-11-30 13:26:26,728 - INFO - reading batch[41] client 4
2024-11-30 13:26:26,759 - INFO - reading batch[42] client 1
2024-11-30 13:26:26,785 - INFO - reading batch[42] client 2
2024-11-30 13:26:26,803 - INFO - reading batch[42] client 3
2024-11-30 13:26:26,829 - INFO - reading batch[42] client 4
2024-11-30 13:26:26,856 - INFO - reading batch[43] client 1
2024-11-30 13:26:26,874 - INFO - reading batch[43] client 2
2024-11-30 13:26:26,898 - INFO - reading batch[43] client 3
2024-11-30 13:26:26,915 - ERROR - backward on partition 4
2024-11-30 13:26:26,915 - CRITICAL - calculate backward $4 on client4
2024-11-30 13:26:26,921 - CRITICAL - new gradient:tensor([[ 4.8518e-04, -1.3609e-05, -1.7676e-05,  ..., -7.8048e-05,
         -3.7041e-04, -3.2803e-04],
        [-4.6474e-04,  4.1224e-04,  3.4257e-04,  ...,  3.7654e-04,
          5.9396e-04,  8.7774e-05],
        [-2.5879e-04,  2.3872e-04, -3.7773e-04,  ..., -2.2031e-04,
          2.3431e-04, -1.8477e-08],
        ...,
        [-6.8412e-05, -3.5792e-04,  1.5743e-05,  ..., -1.8978e-04,
          4.9807e-04,  2.1997e-04],
        [-4.6741e-04,  4.0972e-04,  3.4171e-04,  ...,  3.7642e-04,
          5.9124e-04,  8.4116e-05],
        [-4.9287e-04, -6.7987e-04, -3.9554e-04,  ..., -1.7895e-04,
          2.8867e-04,  5.7722e-04]]) 
 old gradient:tensor([[-0.0135,  0.0015,  0.0016,  0.0013,  0.0016,  0.0014,  0.0013,  0.0015,
          0.0018,  0.0014],
        [ 0.0022,  0.0015,  0.0017,  0.0012,  0.0016,  0.0014, -0.0144,  0.0014,
          0.0019,  0.0015],
        [ 0.0023,  0.0014,  0.0019,  0.0014,  0.0014,  0.0014,  0.0013,  0.0014,
         -0.0138,  0.0014],
        [-0.0136,  0.0014,  0.0017,  0.0014,  0.0016,  0.0014,  0.0014,  0.0014,
          0.0017,  0.0015],
        [ 0.0020,  0.0014,  0.0017,  0.0014,  0.0016,  0.0015,  0.0015,  0.0014,
          0.0016, -0.0142],
        [ 0.0017, -0.0142,  0.0017,  0.0014,  0.0015,  0.0016,  0.0016,  0.0015,
          0.0017,  0.0016],
        [ 0.0022,  0.0015,  0.0017,  0.0013,  0.0016,  0.0014, -0.0142,  0.0014,
          0.0018,  0.0014],
        [ 0.0021,  0.0013,  0.0018,  0.0013,  0.0016,  0.0014,  0.0014,  0.0014,
         -0.0138,  0.0014],
        [ 0.0020,  0.0015,  0.0019,  0.0013,  0.0014,  0.0014,  0.0015,  0.0015,
          0.0018, -0.0142],
        [ 0.0019,  0.0014,  0.0019,  0.0013,  0.0015,  0.0014, -0.0142,  0.0015,
          0.0018,  0.0015],
        [ 0.0020,  0.0013,  0.0017, -0.0142,  0.0015,  0.0015,  0.0014,  0.0014,
          0.0018,  0.0015],
        [ 0.0018, -0.0142,  0.0017,  0.0014,  0.0015,  0.0016,  0.0015,  0.0015,
          0.0016,  0.0016],
        [ 0.0021,  0.0014,  0.0016,  0.0014,  0.0015, -0.0142,  0.0014,  0.0014,
          0.0018,  0.0015],
        [ 0.0020,  0.0014,  0.0018,  0.0014,  0.0017, -0.0142,  0.0014,  0.0014,
          0.0017,  0.0014],
        [ 0.0020,  0.0014,  0.0017,  0.0014,  0.0016, -0.0143,  0.0013,  0.0015,
          0.0019,  0.0015],
        [ 0.0021,  0.0014,  0.0018,  0.0012,  0.0015,  0.0014, -0.0142,  0.0014,
          0.0018,  0.0015],
        [ 0.0020,  0.0013,  0.0018,  0.0014, -0.0141,  0.0015,  0.0014,  0.0014,
          0.0018,  0.0016],
        [-0.0134,  0.0013,  0.0016,  0.0013,  0.0016,  0.0014,  0.0014,  0.0014,
          0.0018,  0.0015],
        [ 0.0020,  0.0014,  0.0017,  0.0013,  0.0016,  0.0014, -0.0143,  0.0015,
          0.0018,  0.0015],
        [ 0.0020,  0.0015,  0.0017, -0.0143,  0.0015,  0.0015,  0.0014,  0.0014,
          0.0018,  0.0015],
        [ 0.0022,  0.0015,  0.0015, -0.0144,  0.0016,  0.0014,  0.0014,  0.0015,
          0.0019,  0.0015],
        [ 0.0023,  0.0016, -0.0138,  0.0012,  0.0013,  0.0014,  0.0013,  0.0014,
          0.0020,  0.0014],
        [ 0.0020,  0.0014,  0.0018,  0.0012,  0.0016,  0.0015, -0.0143,  0.0014,
          0.0019,  0.0015],
        [-0.0135,  0.0014,  0.0016,  0.0014,  0.0015,  0.0014,  0.0015,  0.0013,
          0.0018,  0.0014],
        [ 0.0021,  0.0014,  0.0018,  0.0014, -0.0141,  0.0015,  0.0013,  0.0014,
          0.0018,  0.0014],
        [ 0.0021,  0.0015, -0.0139,  0.0012,  0.0013,  0.0014,  0.0013,  0.0015,
          0.0020,  0.0014],
        [ 0.0021,  0.0014, -0.0138,  0.0013,  0.0016,  0.0014,  0.0014,  0.0014,
          0.0019,  0.0014],
        [ 0.0020,  0.0014, -0.0138,  0.0013,  0.0015,  0.0015,  0.0016,  0.0014,
          0.0017,  0.0014],
        [ 0.0020,  0.0015, -0.0139,  0.0014,  0.0014,  0.0015,  0.0014,  0.0014,
          0.0018,  0.0015],
        [ 0.0020,  0.0014,  0.0018,  0.0014,  0.0017,  0.0013, -0.0142,  0.0014,
          0.0017,  0.0015],
        [ 0.0020,  0.0014,  0.0018,  0.0013,  0.0015,  0.0015,  0.0014,  0.0014,
          0.0018, -0.0141],
        [-0.0135,  0.0014,  0.0017,  0.0014,  0.0015,  0.0014,  0.0014,  0.0015,
          0.0018,  0.0014],
        [ 0.0019, -0.0142,  0.0017,  0.0014,  0.0016,  0.0015,  0.0015,  0.0013,
          0.0019,  0.0015],
        [ 0.0020,  0.0013,  0.0018,  0.0014,  0.0015,  0.0015,  0.0014,  0.0015,
          0.0016, -0.0142],
        [ 0.0021,  0.0015,  0.0019,  0.0013, -0.0141,  0.0015,  0.0014,  0.0014,
          0.0017,  0.0014],
        [ 0.0018,  0.0015,  0.0017,  0.0013,  0.0015,  0.0016,  0.0015, -0.0141,
          0.0017,  0.0015],
        [ 0.0022,  0.0014,  0.0018,  0.0013,  0.0015,  0.0014,  0.0013,  0.0014,
         -0.0138,  0.0015],
        [ 0.0019, -0.0142,  0.0017,  0.0013,  0.0015,  0.0015,  0.0014,  0.0014,
          0.0018,  0.0016],
        [ 0.0020,  0.0014,  0.0017,  0.0015,  0.0016,  0.0015,  0.0014, -0.0142,
          0.0017,  0.0015],
        [-0.0135,  0.0013,  0.0016,  0.0014,  0.0016,  0.0014,  0.0015,  0.0014,
          0.0018,  0.0015],
        [ 0.0018, -0.0142,  0.0017,  0.0014,  0.0016,  0.0015,  0.0015,  0.0015,
          0.0017,  0.0016],
        [ 0.0018, -0.0142,  0.0018,  0.0014,  0.0015,  0.0015,  0.0014,  0.0013,
          0.0019,  0.0015],
        [ 0.0018,  0.0014,  0.0017,  0.0015,  0.0016,  0.0016,  0.0015, -0.0142,
          0.0016,  0.0015],
        [ 0.0020,  0.0014,  0.0016,  0.0014,  0.0017, -0.0142,  0.0014,  0.0015,
          0.0018,  0.0014],
        [ 0.0021,  0.0015, -0.0139,  0.0013,  0.0015,  0.0015,  0.0014,  0.0014,
          0.0018,  0.0015],
        [ 0.0020,  0.0015,  0.0018,  0.0012, -0.0140,  0.0015,  0.0014,  0.0014,
          0.0018,  0.0015],
        [ 0.0018,  0.0014,  0.0018,  0.0014, -0.0141,  0.0015,  0.0015,  0.0014,
          0.0016,  0.0015],
        [ 0.0022,  0.0014,  0.0017,  0.0013,  0.0015,  0.0014,  0.0013,  0.0014,
         -0.0137,  0.0015],
        [ 0.0018,  0.0015,  0.0017,  0.0014,  0.0016,  0.0016,  0.0014, -0.0142,
          0.0016,  0.0015],
        [ 0.0021,  0.0014,  0.0018,  0.0014,  0.0015,  0.0014,  0.0014,  0.0014,
          0.0018, -0.0141],
        [ 0.0021,  0.0014, -0.0138,  0.0013,  0.0014,  0.0014,  0.0013,  0.0014,
          0.0020,  0.0015],
        [ 0.0019,  0.0014,  0.0017,  0.0015,  0.0015, -0.0142,  0.0014,  0.0015,
          0.0018,  0.0015],
        [ 0.0021,  0.0015,  0.0018,  0.0013,  0.0015,  0.0014,  0.0015,  0.0015,
          0.0017, -0.0142],
        [ 0.0019,  0.0014,  0.0018,  0.0014,  0.0016, -0.0142,  0.0015,  0.0014,
          0.0018,  0.0015],
        [ 0.0022,  0.0015,  0.0017,  0.0013,  0.0015,  0.0014,  0.0014,  0.0014,
         -0.0138,  0.0015],
        [ 0.0018, -0.0142,  0.0017,  0.0014,  0.0015,  0.0015,  0.0015,  0.0015,
          0.0017,  0.0016],
        [ 0.0018, -0.0142,  0.0017,  0.0015,  0.0015,  0.0015,  0.0015,  0.0013,
          0.0018,  0.0016],
        [-0.0136,  0.0013,  0.0018,  0.0013,  0.0016,  0.0014,  0.0015,  0.0014,
          0.0018,  0.0015],
        [ 0.0020,  0.0014, -0.0139,  0.0013,  0.0015,  0.0015,  0.0014,  0.0015,
          0.0019,  0.0014],
        [ 0.0020,  0.0015,  0.0017,  0.0013,  0.0016, -0.0142,  0.0013,  0.0015,
          0.0018,  0.0015],
        [ 0.0019,  0.0014,  0.0017,  0.0015,  0.0015,  0.0015,  0.0014,  0.0014,
          0.0018, -0.0140],
        [ 0.0019,  0.0014,  0.0016,  0.0015,  0.0017,  0.0016,  0.0014, -0.0142,
          0.0016,  0.0015],
        [ 0.0021,  0.0015,  0.0018,  0.0013,  0.0016,  0.0015, -0.0143,  0.0014,
          0.0017,  0.0014],
        [ 0.0021,  0.0015,  0.0017,  0.0014,  0.0015, -0.0142,  0.0015,  0.0015,
          0.0017,  0.0014]])
2024-11-30 13:26:26,921 - INFO - reading batch[43] client 4
2024-11-30 13:26:26,948 - INFO - reading batch[44] client 1
2024-11-30 13:26:26,972 - INFO - reading batch[44] client 2
2024-11-30 13:26:26,985 - INFO - reading batch[44] client 3
2024-11-30 13:26:27,004 - INFO - Final partition
2024-11-30 13:26:27,005 - INFO - reading batch[44] client 4
2024-11-30 13:26:27,030 - INFO - reading batch[45] client 1
2024-11-30 13:26:27,056 - INFO - reading batch[45] client 2
2024-11-30 13:26:27,084 - INFO - reading batch[45] client 3
2024-11-30 13:26:27,108 - INFO - reading batch[45] client 4
2024-11-30 13:26:27,121 - INFO - Final partition
2024-11-30 13:26:27,122 - INFO - reading batch[46] client 1
2024-11-30 13:26:27,156 - INFO - reading batch[46] client 2
2024-11-30 13:26:27,190 - INFO - reading batch[46] client 3
2024-11-30 13:26:27,208 - INFO - reading batch[46] client 4
2024-11-30 13:26:27,235 - INFO - reading batch[47] client 1
2024-11-30 13:26:27,253 - INFO - reading batch[47] client 2
2024-11-30 13:26:27,267 - INFO - reading batch[47] client 3
2024-11-30 13:26:27,292 - INFO - reading batch[47] client 4
2024-11-30 13:26:27,317 - INFO - reading batch[48] client 1
2024-11-30 13:26:27,339 - INFO - reading batch[48] client 2
2024-11-30 13:26:27,369 - INFO - reading batch[48] client 3
2024-11-30 13:26:27,394 - INFO - reading batch[48] client 4
2024-11-30 13:26:27,426 - INFO - reading batch[49] client 1
2024-11-30 13:26:27,449 - INFO - reading batch[49] client 2
2024-11-30 13:26:27,478 - INFO - reading batch[49] client 3
2024-11-30 13:26:27,503 - INFO - reading batch[49] client 4
2024-11-30 13:26:27,527 - INFO - reading batch[50] client 1
2024-11-30 13:26:27,553 - INFO - reading batch[50] client 2
2024-11-30 13:26:27,567 - INFO - reading batch[50] client 3
2024-11-30 13:26:27,585 - INFO - reading batch[50] client 4
2024-11-30 13:26:27,611 - INFO - reading batch[51] client 1
2024-11-30 13:26:27,631 - INFO - reading batch[51] client 2
2024-11-30 13:26:27,654 - INFO - reading batch[51] client 3
2024-11-30 13:26:27,687 - INFO - reading batch[51] client 4
2024-11-30 13:26:27,711 - INFO - reading batch[52] client 1
2024-11-30 13:26:27,729 - INFO - reading batch[52] client 2
2024-11-30 13:26:27,748 - INFO - reading batch[52] client 3
2024-11-30 13:26:27,772 - INFO - reading batch[52] client 4
2024-11-30 13:26:27,805 - INFO - reading batch[53] client 1
2024-11-30 13:26:27,823 - INFO - reading batch[53] client 2
2024-11-30 13:26:27,849 - INFO - reading batch[53] client 3
2024-11-30 13:26:27,866 - INFO - reading batch[53] client 4
2024-11-30 13:26:27,893 - INFO - reading batch[54] client 1
2024-11-30 13:26:27,915 - INFO - reading batch[54] client 2
2024-11-30 13:26:27,947 - INFO - reading batch[54] client 3
2024-11-30 13:26:27,975 - INFO - reading batch[54] client 4
2024-11-30 13:26:27,998 - INFO - reading batch[55] client 1
2024-11-30 13:26:28,015 - INFO - reading batch[55] client 2
2024-11-30 13:26:28,029 - INFO - reading batch[55] client 3
2024-11-30 13:26:28,048 - ERROR - backward on partition 4
2024-11-30 13:26:28,048 - CRITICAL - calculate backward $4 on client4
2024-11-30 13:26:28,055 - CRITICAL - new gradient:tensor([[-2.7548e-04, -7.2489e-04,  2.4295e-04,  ...,  5.3934e-04,
         -4.6596e-04, -4.4788e-04],
        [-2.4619e-04,  2.4927e-04, -3.8439e-04,  ..., -2.2933e-04,
          2.1971e-04, -2.3135e-06],
        [-6.7528e-05, -3.5792e-04,  2.1228e-05,  ..., -1.9441e-04,
          5.0357e-04,  2.2918e-04],
        ...,
        [-4.7577e-04,  4.0599e-04,  3.4418e-04,  ...,  3.8003e-04,
          6.0341e-04,  9.7100e-05],
        [-1.2547e-04,  4.0388e-04,  5.3934e-04,  ...,  2.2619e-04,
          3.3092e-04,  3.7487e-04],
        [-5.0163e-04, -6.7456e-04, -3.8875e-04,  ..., -1.7586e-04,
          2.9711e-04,  5.8766e-04]]) 
 old gradient:tensor([[ 0.0020,  0.0015,  0.0018,  0.0013,  0.0014,  0.0015,  0.0014,  0.0014,
          0.0018, -0.0141],
        [ 0.0022,  0.0014,  0.0017,  0.0013,  0.0015,  0.0014,  0.0013,  0.0014,
         -0.0137,  0.0016],
        [ 0.0019,  0.0014,  0.0017,  0.0015,  0.0016,  0.0015,  0.0015, -0.0143,
          0.0017,  0.0016],
        [ 0.0018,  0.0015,  0.0017,  0.0015,  0.0016,  0.0016,  0.0015, -0.0142,
          0.0016,  0.0015],
        [ 0.0019, -0.0142,  0.0017,  0.0013,  0.0015,  0.0014,  0.0015,  0.0015,
          0.0017,  0.0016],
        [ 0.0021,  0.0014,  0.0017,  0.0014,  0.0014,  0.0014,  0.0014,  0.0014,
         -0.0138,  0.0015],
        [ 0.0022,  0.0014,  0.0018,  0.0015,  0.0014,  0.0015,  0.0014,  0.0013,
          0.0018, -0.0141],
        [ 0.0019,  0.0015, -0.0139,  0.0013,  0.0014,  0.0015,  0.0014,  0.0014,
          0.0018,  0.0015],
        [ 0.0022,  0.0015, -0.0140,  0.0013,  0.0014,  0.0014,  0.0013,  0.0015,
          0.0020,  0.0014],
        [-0.0133,  0.0015,  0.0016,  0.0013,  0.0015,  0.0013,  0.0013,  0.0015,
          0.0019,  0.0014],
        [ 0.0019,  0.0014,  0.0017,  0.0015,  0.0016, -0.0141,  0.0014,  0.0014,
          0.0017,  0.0015],
        [ 0.0019,  0.0014,  0.0017,  0.0014,  0.0016, -0.0142,  0.0016,  0.0014,
          0.0017,  0.0015],
        [ 0.0020,  0.0014,  0.0016,  0.0015,  0.0017,  0.0015,  0.0015, -0.0142,
          0.0016,  0.0014],
        [ 0.0021,  0.0014, -0.0138,  0.0013,  0.0014,  0.0015,  0.0014,  0.0015,
          0.0017,  0.0015],
        [ 0.0020,  0.0014,  0.0017,  0.0013,  0.0014,  0.0014,  0.0015,  0.0015,
         -0.0138,  0.0015],
        [ 0.0018, -0.0142,  0.0017,  0.0014,  0.0015,  0.0015,  0.0015,  0.0014,
          0.0018,  0.0016],
        [ 0.0019,  0.0014,  0.0017,  0.0015,  0.0016,  0.0015,  0.0015, -0.0142,
          0.0016,  0.0015],
        [ 0.0023,  0.0016,  0.0016,  0.0012, -0.0143,  0.0015,  0.0013,  0.0015,
          0.0019,  0.0015],
        [ 0.0019,  0.0015,  0.0017,  0.0015,  0.0015,  0.0015,  0.0014, -0.0142,
          0.0017,  0.0016],
        [ 0.0020,  0.0015,  0.0018,  0.0013,  0.0015,  0.0014, -0.0143,  0.0014,
          0.0019,  0.0015],
        [ 0.0020,  0.0014,  0.0018,  0.0014,  0.0015,  0.0014,  0.0014,  0.0015,
         -0.0138,  0.0015],
        [-0.0134,  0.0014,  0.0016,  0.0013,  0.0017,  0.0013,  0.0014,  0.0014,
          0.0019,  0.0015],
        [ 0.0019,  0.0015,  0.0016, -0.0142,  0.0014,  0.0015,  0.0016,  0.0015,
          0.0018,  0.0015],
        [ 0.0023,  0.0013,  0.0018,  0.0014,  0.0015,  0.0014,  0.0014,  0.0013,
         -0.0138,  0.0014],
        [-0.0135,  0.0015,  0.0017,  0.0013,  0.0015,  0.0014,  0.0014,  0.0015,
          0.0019,  0.0014],
        [ 0.0019,  0.0015,  0.0017,  0.0015,  0.0016,  0.0015,  0.0014, -0.0142,
          0.0017,  0.0015],
        [ 0.0021,  0.0014,  0.0017, -0.0143,  0.0016,  0.0014,  0.0014,  0.0015,
          0.0018,  0.0015],
        [ 0.0021,  0.0014,  0.0016, -0.0142,  0.0015,  0.0014,  0.0014,  0.0014,
          0.0018,  0.0015],
        [ 0.0021,  0.0015,  0.0018,  0.0013, -0.0141,  0.0014,  0.0013,  0.0014,
          0.0018,  0.0015],
        [ 0.0022,  0.0016, -0.0139,  0.0011,  0.0013,  0.0014,  0.0013,  0.0015,
          0.0019,  0.0015],
        [ 0.0022,  0.0015,  0.0018,  0.0013,  0.0015,  0.0014,  0.0013,  0.0014,
         -0.0139,  0.0014],
        [ 0.0020,  0.0014,  0.0016, -0.0142,  0.0015,  0.0015,  0.0015,  0.0015,
          0.0018,  0.0015],
        [ 0.0020,  0.0013,  0.0018,  0.0014,  0.0015,  0.0015,  0.0014,  0.0014,
          0.0018, -0.0141],
        [ 0.0020,  0.0014,  0.0017, -0.0142,  0.0016,  0.0014,  0.0015,  0.0014,
          0.0017,  0.0015],
        [ 0.0020,  0.0015,  0.0017,  0.0012,  0.0015,  0.0015,  0.0014,  0.0015,
         -0.0138,  0.0015],
        [ 0.0021,  0.0014,  0.0017,  0.0013,  0.0015,  0.0014,  0.0014, -0.0142,
          0.0018,  0.0016],
        [-0.0133,  0.0014,  0.0016,  0.0013,  0.0015,  0.0013,  0.0013,  0.0015,
          0.0019,  0.0015],
        [ 0.0021,  0.0015,  0.0018,  0.0012,  0.0015,  0.0014, -0.0143,  0.0014,
          0.0018,  0.0015],
        [ 0.0022,  0.0015,  0.0018,  0.0012,  0.0014,  0.0014, -0.0144,  0.0015,
          0.0019,  0.0015],
        [ 0.0019,  0.0014,  0.0016,  0.0014,  0.0016, -0.0141,  0.0015,  0.0014,
          0.0017,  0.0016],
        [ 0.0020,  0.0014,  0.0017,  0.0014,  0.0016,  0.0014,  0.0014,  0.0014,
         -0.0139,  0.0015],
        [ 0.0017, -0.0142,  0.0016,  0.0014,  0.0016,  0.0015,  0.0016,  0.0015,
          0.0016,  0.0016],
        [ 0.0019,  0.0014,  0.0017,  0.0014,  0.0016, -0.0142,  0.0015,  0.0015,
          0.0017,  0.0015],
        [ 0.0021,  0.0014,  0.0018,  0.0013,  0.0016,  0.0013, -0.0142,  0.0014,
          0.0019,  0.0015],
        [ 0.0019,  0.0015,  0.0018,  0.0014, -0.0141,  0.0015,  0.0014,  0.0015,
          0.0017,  0.0015],
        [ 0.0018,  0.0014,  0.0016,  0.0016,  0.0016,  0.0016,  0.0015, -0.0142,
          0.0016,  0.0015],
        [ 0.0019,  0.0015,  0.0017,  0.0014,  0.0014,  0.0015,  0.0014,  0.0016,
         -0.0138,  0.0015],
        [-0.0135,  0.0014,  0.0016,  0.0014,  0.0016,  0.0013,  0.0015,  0.0014,
          0.0018,  0.0015],
        [ 0.0021,  0.0015, -0.0137,  0.0013,  0.0013,  0.0014,  0.0014,  0.0014,
          0.0018,  0.0015],
        [ 0.0023,  0.0014,  0.0017,  0.0013, -0.0141,  0.0014,  0.0013,  0.0013,
          0.0018,  0.0015],
        [ 0.0019, -0.0142,  0.0017,  0.0013,  0.0015,  0.0015,  0.0015,  0.0015,
          0.0017,  0.0015],
        [ 0.0021,  0.0016, -0.0139,  0.0012,  0.0013,  0.0014,  0.0013,  0.0015,
          0.0020,  0.0015],
        [ 0.0021,  0.0015,  0.0018,  0.0014,  0.0014,  0.0014,  0.0014,  0.0014,
          0.0018, -0.0141],
        [ 0.0021,  0.0015,  0.0017,  0.0012,  0.0016,  0.0014, -0.0142,  0.0014,
          0.0019,  0.0015],
        [ 0.0021,  0.0014,  0.0017,  0.0014,  0.0016, -0.0143,  0.0014,  0.0014,
          0.0018,  0.0015],
        [ 0.0018, -0.0142,  0.0017,  0.0014,  0.0015,  0.0015,  0.0015,  0.0014,
          0.0018,  0.0016],
        [ 0.0020,  0.0015,  0.0018,  0.0014,  0.0014,  0.0015,  0.0015,  0.0015,
          0.0017, -0.0142],
        [ 0.0019, -0.0142,  0.0018,  0.0014,  0.0015,  0.0015,  0.0014,  0.0013,
          0.0019,  0.0015],
        [ 0.0023,  0.0016,  0.0019,  0.0012,  0.0014,  0.0013, -0.0143,  0.0014,
          0.0019,  0.0014],
        [ 0.0021,  0.0014,  0.0016, -0.0143,  0.0015,  0.0014,  0.0015,  0.0014,
          0.0018,  0.0015],
        [ 0.0021,  0.0015,  0.0017,  0.0013,  0.0015,  0.0014, -0.0143,  0.0014,
          0.0019,  0.0015],
        [ 0.0023,  0.0015,  0.0018,  0.0013,  0.0015,  0.0013, -0.0144,  0.0014,
          0.0019,  0.0015],
        [ 0.0022,  0.0015,  0.0017,  0.0013, -0.0142,  0.0015,  0.0015,  0.0015,
          0.0017,  0.0015],
        [ 0.0023,  0.0015,  0.0016,  0.0013,  0.0015, -0.0143,  0.0013,  0.0015,
          0.0018,  0.0015]])
2024-11-30 13:26:28,055 - INFO - reading batch[55] client 4
2024-11-30 13:26:28,078 - INFO - reading batch[56] client 1
2024-11-30 13:26:28,100 - INFO - reading batch[56] client 2
2024-11-30 13:26:28,125 - INFO - reading batch[56] client 3
2024-11-30 13:26:28,157 - INFO - reading batch[56] client 4
2024-11-30 13:26:28,185 - INFO - reading batch[57] client 1
2024-11-30 13:26:28,208 - INFO - reading batch[57] client 2
2024-11-30 13:26:28,227 - INFO - reading batch[57] client 3
2024-11-30 13:26:28,247 - INFO - reading batch[57] client 4
2024-11-30 13:26:28,271 - INFO - reading batch[58] client 1
2024-11-30 13:26:28,289 - INFO - reading batch[58] client 2
2024-11-30 13:26:28,312 - INFO - reading batch[58] client 3
2024-11-30 13:26:28,325 - INFO - reading batch[58] client 4
2024-11-30 13:26:28,339 - INFO - Final partition
2024-11-30 13:26:28,340 - INFO - reading batch[59] client 1
2024-11-30 13:26:28,365 - INFO - reading batch[59] client 2
2024-11-30 13:26:28,384 - ERROR - backward on partition 3
2024-11-30 13:26:28,388 - CRITICAL - calculate backward $3 on client3
2024-11-30 13:26:28,399 - CRITICAL - new gradient:tensor([[[[-3.0937e-04, -7.3478e-05, -4.4328e-04,  4.9103e-05],
          [ 2.0228e-04,  3.0424e-04,  1.5702e-04,  5.0181e-04],
          [-1.6904e-04, -1.1732e-04, -1.2854e-04, -5.1306e-04],
          [-2.2493e-04, -1.2888e-04,  2.6001e-04,  3.3883e-04]],

         [[ 2.6513e-05, -3.3389e-04,  4.6391e-05, -1.7334e-04],
          [-1.5170e-04,  4.6208e-05,  3.0154e-04, -3.0108e-04],
          [ 1.3418e-04,  3.2338e-04, -9.2588e-05, -4.9314e-05],
          [-1.6278e-04,  6.1465e-06, -2.7421e-04, -1.2077e-04]],

         [[-6.3403e-05,  1.0856e-04, -1.6103e-04, -2.1658e-04],
          [ 1.7901e-04,  1.5519e-05, -1.8887e-04, -2.6609e-04],
          [-3.2689e-04,  2.1879e-04,  4.4798e-05, -2.1482e-04],
          [ 3.7020e-04,  4.3630e-05, -7.2500e-05,  7.0839e-05]],

         ...,

         [[ 3.2571e-06, -2.1734e-04, -1.2561e-04, -8.4241e-05],
          [-3.9715e-04, -4.9771e-04,  3.3841e-04,  8.5906e-05],
          [-5.8723e-04, -1.0648e-04, -2.2998e-04,  8.2342e-05],
          [-1.9658e-04,  4.7388e-04,  1.4175e-04, -3.0674e-05]],

         [[ 5.9442e-05,  2.8234e-04, -1.5658e-04,  5.5259e-05],
          [ 7.5515e-05, -2.2725e-04, -3.6791e-05, -1.7419e-04],
          [ 1.2092e-04, -3.5208e-04, -1.9636e-05,  6.7043e-05],
          [ 5.8168e-05, -1.6658e-05, -8.5301e-05,  1.0965e-05]],

         [[-2.7214e-05,  2.2974e-04, -2.0030e-04, -4.1721e-05],
          [-3.2910e-04, -2.3880e-04,  2.2530e-05, -1.0357e-04],
          [-3.2015e-04, -2.6218e-04, -2.9906e-04, -2.5883e-04],
          [ 2.2399e-04,  1.7515e-04,  7.5194e-05,  4.5027e-05]]],


        [[[-1.0880e-04,  1.4251e-04, -1.5027e-04,  3.5083e-05],
          [ 1.1565e-04,  6.3972e-05,  2.1519e-04,  2.2157e-04],
          [-2.0187e-04,  2.3952e-04, -4.7557e-05, -1.7207e-04],
          [-1.7968e-04,  1.1797e-04,  2.5329e-04,  1.1450e-04]],

         [[-2.5371e-06,  7.3018e-06,  2.7674e-04, -1.7728e-04],
          [-3.6524e-04,  1.3469e-04,  2.6912e-04,  3.7230e-05],
          [ 9.3495e-06,  1.2276e-04, -1.9761e-05, -8.5859e-05],
          [-1.1357e-04, -1.7445e-04, -5.3235e-05,  1.2064e-04]],

         [[ 1.1155e-05,  2.1664e-04, -5.3565e-06,  7.1583e-05],
          [ 5.5671e-05,  3.5903e-06, -1.2108e-04,  1.7555e-05],
          [-2.6362e-04,  6.5338e-05,  8.0060e-05, -7.7237e-05],
          [ 5.9654e-05, -2.0713e-05,  1.2135e-04, -7.2352e-05]],

         ...,

         [[-1.0423e-05, -1.2941e-04, -2.0582e-04, -5.8327e-05],
          [-1.1970e-04, -1.9607e-04,  1.3294e-04,  8.0981e-05],
          [-2.1715e-04, -6.3451e-05, -3.6733e-05, -8.4480e-06],
          [ 8.5803e-05,  1.5162e-04,  1.1449e-05,  5.9684e-06]],

         [[-8.8544e-05,  6.7965e-06, -2.0176e-04,  1.1854e-04],
          [ 3.6401e-05, -1.5985e-04, -6.0866e-05,  3.8183e-05],
          [ 3.9036e-04, -5.5387e-05,  1.1657e-04,  9.9319e-05],
          [-8.2492e-05, -4.2001e-04,  4.0309e-06,  1.0738e-05]],

         [[-2.1073e-04, -2.3058e-04,  1.3576e-04, -9.4522e-05],
          [ 3.4334e-05,  4.2262e-05, -1.7618e-04,  2.3563e-05],
          [-5.5167e-05, -3.3650e-05, -2.5455e-04, -1.5851e-04],
          [ 1.3193e-04, -1.5714e-04, -2.3334e-04,  2.4391e-04]]],


        [[[ 2.7116e-04,  3.9907e-04, -2.9558e-04, -2.3324e-04],
          [ 1.0347e-04, -2.0559e-04,  1.5484e-04,  1.1097e-04],
          [-1.0382e-04,  3.1466e-04,  1.3546e-04,  5.3302e-04],
          [-2.5466e-04,  1.1450e-04, -2.5564e-04,  2.1679e-05]],

         [[-5.6221e-04,  6.9089e-04,  2.6186e-04, -1.9472e-04],
          [-3.5246e-04,  1.2070e-04,  2.1961e-04,  3.0049e-04],
          [ 5.2490e-04,  6.5280e-04, -7.2391e-05,  2.3566e-04],
          [ 4.3107e-04, -8.8250e-05,  1.4717e-04,  1.2951e-04]],

         [[-1.0441e-04, -8.6776e-05,  2.3471e-05,  1.5943e-04],
          [ 1.5653e-05, -2.1778e-04,  1.4671e-04,  1.8162e-04],
          [-4.2232e-04,  2.5079e-04,  2.5022e-04,  3.6621e-04],
          [-9.5204e-05,  2.3042e-04,  1.1994e-04,  4.3096e-04]],

         ...,

         [[ 8.2936e-05,  7.7379e-05, -8.1021e-05, -3.4959e-04],
          [ 7.0758e-05,  2.4277e-04,  3.2514e-04,  1.3183e-04],
          [-1.4461e-04,  1.0666e-04,  1.5141e-04,  2.8615e-04],
          [ 3.5410e-05, -2.2502e-04, -1.9919e-04,  2.2759e-04]],

         [[ 4.3980e-04,  4.3762e-05, -1.6043e-06,  2.9146e-04],
          [ 4.6536e-04,  6.2753e-04, -1.2876e-04, -4.1357e-04],
          [-6.5871e-05,  2.9555e-04, -2.1861e-04, -4.1223e-04],
          [ 4.1104e-04, -1.2746e-04,  4.8345e-05,  1.6251e-04]],

         [[-8.3715e-05, -2.6188e-04,  1.0462e-04,  4.4170e-04],
          [-2.9599e-05,  6.3501e-06,  2.3660e-04, -6.2592e-04],
          [-2.9085e-04,  2.3295e-05,  6.7130e-05,  2.5462e-04],
          [-3.5342e-04,  4.2019e-04, -2.9100e-04, -1.2702e-04]]],


        ...,


        [[[-2.8178e-04, -4.9696e-05,  3.6824e-04, -7.9160e-05],
          [-1.0488e-04, -3.4692e-05, -5.3849e-05,  3.7765e-05],
          [ 1.0699e-04, -1.1250e-04, -1.3329e-05, -1.8280e-04],
          [ 1.4618e-04, -5.6031e-06, -8.1997e-05,  8.5638e-05]],

         [[-1.2665e-04, -1.6698e-04, -1.8227e-04,  1.3760e-04],
          [ 4.7392e-04, -7.5451e-05, -3.5159e-04, -1.4355e-05],
          [-2.8722e-04, -5.6488e-05,  3.1957e-04, -1.3239e-04],
          [ 1.0394e-04,  2.6544e-04,  1.4194e-04,  1.0564e-04]],

         [[-1.4833e-05,  1.7433e-05,  1.3927e-04, -1.5932e-04],
          [-3.4566e-04,  3.6019e-05,  1.9257e-04, -1.1417e-04],
          [ 2.3229e-04, -9.7049e-05,  2.5631e-04, -4.3564e-04],
          [-1.1153e-04,  1.4250e-04, -3.9122e-04, -2.3103e-04]],

         ...,

         [[ 1.6093e-05, -1.3460e-04,  2.0225e-04,  1.1198e-04],
          [ 2.7197e-04,  7.7545e-05, -9.4167e-05, -2.7440e-04],
          [ 2.4792e-04,  1.6209e-04, -2.2942e-05,  2.0822e-04],
          [ 1.4747e-04, -2.2822e-04, -5.6563e-05, -1.1091e-06]],

         [[-6.6836e-05, -1.2976e-04, -2.9735e-05,  9.5527e-05],
          [-9.8819e-05, -1.4624e-04,  1.6039e-04,  2.3739e-04],
          [ 9.6768e-05,  5.5174e-05, -4.3471e-05, -7.7798e-05],
          [-1.6160e-04,  1.7712e-04, -3.6542e-05, -1.0786e-04]],

         [[ 1.1768e-04,  4.0517e-04, -3.8118e-06, -5.6465e-06],
          [ 1.3787e-04,  9.8027e-05,  6.5254e-05,  2.6209e-05],
          [-8.1587e-07,  1.4922e-04,  1.5470e-04,  7.5741e-05],
          [ 4.8949e-05, -8.9755e-05,  9.0999e-05, -1.8007e-04]]],


        [[[-9.8540e-06, -2.1061e-04, -1.7039e-04,  4.4927e-06],
          [-3.1740e-04,  1.5826e-04,  2.4499e-04,  4.4815e-05],
          [ 5.9017e-05,  5.6808e-05, -1.5034e-04, -2.2641e-04],
          [-7.6121e-06, -1.6549e-04,  2.6861e-04, -1.7748e-04]],

         [[ 1.2449e-04, -1.9119e-04,  1.7299e-04, -1.6050e-04],
          [-4.0003e-05, -2.1368e-04,  9.5270e-05, -1.5791e-04],
          [-1.5573e-04,  1.3629e-04,  1.0112e-04, -4.7531e-05],
          [-5.3342e-05,  2.3305e-04, -1.1318e-04,  1.8662e-04]],

         [[-1.7720e-04, -3.6051e-05, -9.3033e-05, -1.2011e-04],
          [ 1.9260e-04,  5.6491e-05, -1.1392e-04,  8.5079e-05],
          [ 1.5878e-04,  7.0923e-05,  1.2789e-04, -1.5191e-04],
          [-1.8496e-05,  2.2427e-04, -1.1051e-04,  9.0986e-05]],

         ...,

         [[ 8.6234e-06, -1.3170e-04, -1.1544e-04,  1.0403e-05],
          [-1.3831e-04, -1.5343e-04, -9.3308e-05, -2.6700e-05],
          [-5.1077e-04, -2.7277e-04, -2.3096e-04, -1.7001e-05],
          [ 1.4383e-05,  1.0192e-04,  1.1635e-04,  1.6678e-04]],

         [[-5.6628e-05, -3.8110e-05, -3.7685e-05,  1.6849e-04],
          [ 4.3614e-05, -7.6116e-05, -1.4068e-04, -1.9143e-04],
          [ 4.4180e-05, -8.7282e-06,  1.9153e-05,  1.4002e-04],
          [-3.1231e-04,  8.4785e-05,  5.8901e-05,  1.3632e-05]],

         [[-7.7952e-05,  1.4903e-04, -1.8077e-04,  7.8760e-05],
          [-8.6974e-05,  1.1762e-04,  9.0714e-05,  8.9544e-06],
          [-2.5522e-04, -1.1106e-05,  9.6185e-05,  6.9869e-05],
          [ 4.9382e-05, -1.4302e-04,  5.5921e-05, -2.4537e-06]]],


        [[[-3.0226e-05,  3.3364e-05, -2.4637e-05,  1.1491e-04],
          [ 3.9215e-04, -8.9386e-05,  1.8775e-04,  2.9044e-04],
          [-5.3347e-06,  8.9013e-05,  7.2391e-05, -4.2761e-05],
          [-1.9494e-04, -1.6885e-05,  1.6128e-04,  2.7160e-05]],

         [[-3.2339e-05, -2.7490e-05, -2.4183e-05, -1.7527e-04],
          [-8.8005e-06,  2.7599e-04, -2.5053e-04,  1.5758e-04],
          [-9.8249e-05,  6.8446e-05, -1.0414e-05, -6.8742e-05],
          [-1.3600e-04,  1.0523e-04, -6.4655e-05,  2.1509e-04]],

         [[-3.5923e-05,  6.7427e-05,  2.2294e-04,  6.6679e-06],
          [ 2.1464e-04, -4.9261e-06,  4.1282e-06, -5.5774e-05],
          [-1.8485e-04,  1.8026e-05,  1.7864e-04,  9.8264e-05],
          [-1.0312e-04,  4.7617e-05,  6.2183e-06,  1.2273e-04]],

         ...,

         [[-1.0925e-04, -6.8087e-05,  4.3122e-05, -8.1079e-05],
          [ 1.9080e-04, -7.9018e-05,  8.8583e-06,  2.4578e-04],
          [-1.5325e-04,  2.7324e-04,  2.0660e-06,  3.3301e-04],
          [ 8.1973e-05, -1.7890e-04, -1.1958e-04, -7.8101e-05]],

         [[-1.0651e-04,  3.4728e-05,  2.7499e-05,  1.9663e-04],
          [ 1.7583e-04, -3.4355e-04, -2.5690e-04, -6.0700e-05],
          [ 1.3466e-04, -9.6932e-06,  9.9009e-05, -1.9923e-04],
          [-4.2343e-05, -1.1401e-04, -1.4181e-05,  2.5063e-04]],

         [[-9.8678e-05, -9.9083e-05, -2.4271e-05,  3.6357e-04],
          [ 6.8850e-06,  9.7663e-05, -1.3447e-04,  8.8407e-05],
          [-1.1459e-04, -1.4909e-04, -1.6491e-04, -1.0900e-04],
          [ 9.1174e-05, -3.4947e-04,  1.2338e-05,  3.4998e-04]]]]) 
 old gradient:tensor([[ 1.4623e-03,  3.1700e-04, -3.0057e-04,  ...,  2.5338e-05,
         -1.3963e-03, -1.1108e-03],
        [ 4.7650e-04, -3.4130e-04, -6.7497e-04,  ..., -7.4786e-05,
         -7.4501e-04, -2.0047e-04],
        [-1.4440e-03,  1.3075e-04,  3.0604e-04,  ...,  5.7729e-04,
          1.5018e-03,  7.7528e-04],
        ...,
        [ 2.2111e-04,  5.1719e-04, -3.2560e-04,  ..., -9.0209e-04,
         -5.0460e-07,  2.3262e-04],
        [ 9.8103e-04,  5.5147e-04,  3.5376e-04,  ...,  1.9993e-04,
          1.8990e-04, -3.3871e-04],
        [-1.4602e-04, -6.0044e-04, -2.0006e-04,  ..., -9.9369e-04,
         -5.3119e-04,  8.6599e-04]])
2024-11-30 13:26:28,399 - INFO - reading batch[59] client 3
2024-11-30 13:26:28,428 - INFO - reading batch[59] client 4
2024-11-30 13:26:28,459 - INFO - reading batch[60] client 1
2024-11-30 13:26:28,481 - INFO - reading batch[60] client 2
2024-11-30 13:26:28,506 - INFO - reading batch[60] client 3
2024-11-30 13:26:28,529 - INFO - reading batch[60] client 4
2024-11-30 13:26:28,555 - INFO - reading batch[61] client 1
2024-11-30 13:26:28,588 - INFO - reading batch[61] client 2
2024-11-30 13:26:28,606 - INFO - reading batch[61] client 3
2024-11-30 13:26:28,621 - INFO - Final partition
2024-11-30 13:26:28,621 - INFO - reading batch[61] client 4
2024-11-30 13:26:28,650 - INFO - reading batch[62] client 1
2024-11-30 13:26:28,667 - ERROR - backward on partition 2
2024-11-30 13:26:28,690 - CRITICAL - calculate backward $2 on client2
2024-11-30 13:26:28,721 - CRITICAL - new gradient:tensor([[[[-4.3132e-06, -7.8498e-06, -1.0301e-06,  ..., -1.1088e-05,
           -1.5858e-05,  1.3170e-06],
          [ 3.1083e-06, -2.5201e-06, -9.7403e-06,  ..., -6.9557e-06,
            8.2261e-06,  6.4444e-07],
          [ 4.2562e-06,  2.4655e-05, -1.2463e-06,  ..., -1.0933e-05,
           -3.3934e-06, -5.7296e-06],
          ...,
          [ 8.2662e-06,  8.7005e-07,  4.1776e-05,  ..., -3.3900e-05,
            4.7980e-06, -9.6050e-06],
          [-6.5352e-06, -3.9165e-06,  1.4616e-06,  ...,  2.4440e-06,
           -1.9445e-05,  1.2280e-05],
          [ 1.0403e-05,  1.4550e-06,  4.1323e-07,  ..., -4.6799e-06,
            6.1640e-06, -8.7462e-07]],

         [[ 4.1427e-06,  1.1388e-05,  4.1739e-06,  ..., -3.2958e-07,
           -9.8806e-06,  8.6546e-06],
          [-1.3006e-05, -3.3248e-06, -2.1051e-06,  ..., -2.2456e-05,
            2.9268e-06, -1.4486e-05],
          [-4.5860e-07, -5.9139e-06,  1.6225e-05,  ...,  1.0113e-06,
           -2.7610e-06,  3.8630e-06],
          ...,
          [ 3.2199e-07,  3.3143e-05,  2.5467e-05,  ...,  6.2375e-06,
            3.9944e-06,  8.9329e-06],
          [-6.3715e-06, -4.2746e-06, -2.4327e-05,  ...,  3.2892e-05,
           -2.1277e-05,  1.6212e-05],
          [-3.4960e-06, -6.8220e-06, -1.7186e-05,  ..., -3.3817e-06,
           -1.2438e-05,  9.0184e-06]],

         [[-2.4369e-06,  4.0157e-06,  2.9303e-06,  ..., -4.8317e-06,
            2.6834e-06,  3.5004e-06],
          [-9.0494e-06, -4.2809e-07, -3.4591e-05,  ...,  1.9221e-05,
           -2.0808e-05,  5.6278e-06],
          [-1.3356e-05,  3.8086e-07, -1.3792e-05,  ...,  8.0974e-06,
           -1.1301e-05,  4.5127e-06],
          ...,
          [-2.8611e-06,  1.4389e-07, -1.3049e-05,  ..., -3.1967e-08,
           -2.0425e-05,  2.0347e-05],
          [-4.8492e-06,  1.6399e-05, -1.5926e-05,  ..., -5.8162e-06,
            2.1278e-05, -9.3976e-06],
          [-9.3632e-07,  3.1177e-06, -7.0154e-06,  ...,  1.6292e-06,
           -2.5621e-06,  5.8942e-06]],

         ...,

         [[ 2.4610e-06, -1.7933e-06, -2.5447e-06,  ...,  2.3632e-07,
           -1.0811e-05,  1.3185e-06],
          [-5.9974e-06, -1.3160e-07, -1.7193e-05,  ..., -9.2300e-07,
           -1.6380e-05,  1.2160e-05],
          [ 5.4796e-06,  1.7702e-05, -8.5692e-06,  ...,  8.2421e-06,
           -1.7416e-06, -6.6391e-06],
          ...,
          [ 1.0435e-05, -3.1624e-05,  1.6600e-06,  ..., -9.2482e-07,
           -8.5353e-06, -5.5417e-06],
          [-6.5725e-06, -3.1116e-06, -1.1924e-05,  ..., -3.4821e-05,
           -9.6763e-06, -2.0657e-05],
          [-4.6944e-06, -8.4468e-06, -2.4406e-05,  ...,  2.3666e-05,
            9.9809e-06, -3.2890e-06]],

         [[ 2.9095e-06,  4.2655e-07, -5.8573e-06,  ..., -6.7193e-06,
            4.1843e-06, -2.8113e-06],
          [ 5.8401e-06,  1.2659e-05, -4.4507e-06,  ...,  1.6620e-05,
            6.5566e-07,  5.3211e-06],
          [ 9.5270e-07,  2.1115e-06, -2.0673e-05,  ..., -7.2894e-06,
            8.5506e-06, -1.4488e-05],
          ...,
          [ 5.0938e-06, -1.9290e-05, -3.5311e-05,  ..., -2.7777e-05,
            1.5464e-06, -1.7110e-06],
          [-2.9283e-06, -2.7177e-05, -2.4597e-05,  ..., -3.7543e-07,
           -4.5376e-06,  1.4677e-05],
          [ 2.2705e-06,  8.0048e-06, -7.7098e-06,  ...,  5.4640e-06,
            1.8079e-06,  7.3025e-06]],

         [[ 1.2726e-07,  1.8545e-06, -2.0016e-05,  ...,  1.6159e-06,
           -1.0891e-05, -5.4744e-06],
          [ 6.0545e-06,  1.7958e-05, -1.6582e-06,  ...,  1.4285e-05,
            8.2213e-06, -4.1850e-06],
          [-6.3388e-06, -1.1874e-05,  2.1575e-05,  ..., -2.9140e-05,
            8.5170e-06,  1.9772e-06],
          ...,
          [ 4.4150e-06,  5.5027e-06,  6.8987e-06,  ..., -5.5761e-06,
           -1.2088e-05, -1.8645e-05],
          [ 1.3462e-05,  3.6358e-06,  2.9815e-05,  ..., -7.6001e-06,
            1.1043e-05,  5.9194e-06],
          [ 3.1284e-06, -2.2550e-06, -1.1187e-05,  ..., -1.3268e-05,
            2.4293e-06,  5.1156e-06]]],


        [[[ 7.0173e-06,  3.2695e-06,  2.2509e-06,  ...,  1.1107e-05,
            6.5006e-06,  2.2409e-06],
          [-1.9951e-05,  6.4204e-06,  7.2084e-06,  ..., -2.9203e-05,
            6.9573e-06,  8.6246e-06],
          [-4.0087e-06,  3.4084e-05, -1.8413e-05,  ..., -3.8400e-05,
           -2.1032e-05, -1.0720e-05],
          ...,
          [-2.6723e-06,  9.0736e-06, -1.4704e-05,  ..., -1.8486e-05,
            1.7677e-05, -4.5433e-06],
          [-5.1115e-06, -6.2967e-06,  1.9355e-05,  ..., -5.4875e-06,
           -8.6756e-06,  1.7812e-06],
          [ 5.0113e-06, -1.7552e-06, -3.5763e-06,  ...,  4.6382e-06,
           -7.2387e-06,  7.3467e-06]],

         [[-5.0231e-06,  7.3104e-06, -1.2831e-05,  ..., -7.2281e-06,
           -4.6128e-06, -2.9827e-07],
          [ 1.4994e-05,  2.9406e-05,  7.8310e-06,  ...,  2.4273e-07,
            4.8748e-06, -6.1882e-06],
          [ 2.6611e-06,  1.3344e-05, -5.2254e-06,  ...,  8.4527e-06,
            2.6703e-05, -5.3671e-06],
          ...,
          [-7.0858e-06,  1.8720e-05,  3.4165e-05,  ...,  4.5147e-05,
           -1.3308e-05,  6.0967e-06],
          [-9.6366e-06, -9.5366e-06,  2.2435e-06,  ..., -1.2558e-05,
           -1.4808e-05, -9.1815e-07],
          [-6.2557e-06,  2.3568e-06,  5.1325e-06,  ..., -1.0216e-05,
           -2.1946e-06,  6.0370e-06]],

         [[ 2.9317e-06,  4.9716e-06, -4.3850e-06,  ...,  5.1719e-06,
           -5.8648e-06,  4.2211e-06],
          [ 5.1859e-06, -1.2475e-06,  6.7536e-06,  ...,  1.4264e-05,
           -4.1404e-05, -5.6414e-06],
          [ 1.4794e-05, -4.1853e-07,  5.4534e-06,  ..., -3.2889e-06,
            2.1813e-05, -9.5895e-06],
          ...,
          [-2.0185e-05, -9.7593e-06, -5.9979e-06,  ..., -1.0692e-06,
            5.3108e-06,  3.4110e-06],
          [-3.8727e-06,  1.0058e-05,  7.6073e-06,  ..., -2.8013e-05,
           -1.8508e-05, -5.7553e-06],
          [ 6.3663e-06, -9.1505e-06,  4.7408e-06,  ...,  2.0374e-05,
            9.5472e-06, -3.3316e-06]],

         ...,

         [[ 9.9108e-06,  9.3231e-06, -1.2393e-05,  ..., -9.5848e-06,
           -4.3422e-06,  4.7937e-06],
          [ 4.5390e-06,  2.6272e-05,  9.7669e-06,  ..., -2.1165e-06,
            2.6490e-05,  5.2039e-06],
          [ 2.6820e-06, -1.1017e-05, -2.7289e-05,  ..., -1.8743e-05,
           -1.4021e-05, -1.2104e-05],
          ...,
          [-2.0495e-05, -1.3323e-05,  7.0651e-06,  ...,  4.0952e-05,
            2.5971e-05, -9.7421e-06],
          [ 6.2991e-06,  6.0568e-06,  8.2165e-06,  ...,  1.8018e-05,
            5.1601e-06,  4.2694e-06],
          [ 4.1223e-06, -3.3365e-08, -4.7880e-06,  ..., -8.4724e-06,
           -7.8529e-06,  7.6447e-06]],

         [[-2.0514e-06, -2.7442e-07, -4.1968e-06,  ...,  1.1921e-06,
            2.3627e-06,  4.0448e-06],
          [ 5.0860e-06, -9.2254e-06,  2.4924e-05,  ...,  1.3524e-05,
            7.1146e-06,  5.4797e-06],
          [ 1.5933e-05, -2.8935e-05, -5.7474e-05,  ..., -1.0501e-05,
           -7.8900e-06, -6.0313e-06],
          ...,
          [ 6.6648e-06,  9.1546e-06,  2.8482e-06,  ..., -1.1182e-06,
            7.9779e-06, -6.0200e-07],
          [-1.0517e-06, -7.8809e-07,  1.7913e-06,  ..., -2.9416e-05,
           -9.9135e-06,  7.7634e-06],
          [ 2.2879e-06,  5.9480e-06,  7.5481e-06,  ...,  1.2498e-05,
            4.2011e-06, -1.6062e-06]],

         [[-4.6937e-06, -3.1173e-07, -1.2225e-05,  ...,  9.0242e-06,
           -4.4921e-06,  2.9192e-06],
          [ 6.5376e-06,  7.0987e-06, -1.0823e-05,  ...,  2.3456e-06,
            9.1806e-06, -1.0983e-05],
          [ 1.0253e-06,  4.0464e-06, -2.1146e-05,  ..., -7.5813e-06,
           -2.8795e-05,  3.8867e-06],
          ...,
          [-1.5682e-06,  6.3680e-06, -2.1730e-05,  ..., -1.3455e-05,
           -1.7785e-06,  5.3070e-06],
          [-1.4894e-05, -4.8403e-07, -6.9215e-06,  ...,  1.9515e-05,
            8.3848e-07, -3.2339e-06],
          [-1.3482e-06,  2.1336e-06, -3.8250e-06,  ..., -6.8213e-06,
           -3.3895e-06, -3.3688e-07]]],


        [[[ 1.9242e-06, -3.4289e-06,  1.0280e-05,  ...,  5.2230e-06,
            7.0631e-06,  1.6930e-07],
          [-2.2964e-06, -2.1788e-05, -9.2710e-06,  ..., -2.0207e-05,
            5.7885e-06, -3.5297e-07],
          [-7.0610e-06, -5.2912e-07, -3.8026e-06,  ...,  6.3504e-06,
           -5.9127e-06,  6.4699e-06],
          ...,
          [-3.3371e-07,  1.7858e-05,  1.5776e-05,  ..., -3.5322e-05,
           -6.8785e-06,  1.9375e-05],
          [ 2.9208e-06,  1.6254e-05, -9.9992e-06,  ..., -5.4380e-06,
           -1.3457e-05,  2.5204e-06],
          [-7.7439e-07, -1.1053e-05,  1.2606e-05,  ..., -1.6844e-05,
           -1.4941e-05,  1.6463e-06]],

         [[ 7.5380e-07,  4.2852e-06, -7.0966e-06,  ..., -2.0560e-05,
           -1.4372e-05, -4.4410e-07],
          [-1.6920e-05,  1.2775e-05,  5.3853e-06,  ...,  2.1252e-05,
           -1.5804e-05, -7.6110e-06],
          [-6.9201e-06, -1.1981e-06,  2.3556e-05,  ..., -4.3691e-05,
            6.6829e-06, -9.2905e-06],
          ...,
          [-1.1236e-06, -4.1020e-06, -1.7713e-05,  ..., -2.8511e-05,
            4.4709e-06,  1.5727e-05],
          [-4.1486e-07, -2.3880e-05,  8.4689e-06,  ...,  8.5312e-06,
            1.5042e-05, -2.6845e-06],
          [-1.2197e-06,  2.3554e-06, -1.7823e-05,  ..., -3.1231e-05,
           -1.2536e-05, -7.3575e-06]],

         [[-4.1708e-06, -1.5982e-06,  2.3831e-06,  ...,  3.3705e-06,
           -1.4688e-05, -9.3466e-06],
          [-9.9281e-06, -2.3769e-06, -1.6185e-05,  ..., -5.0449e-06,
            5.6114e-06,  4.1019e-06],
          [-1.1766e-06,  2.2714e-06,  1.6734e-05,  ..., -2.1567e-05,
           -1.0090e-05,  3.6548e-06],
          ...,
          [-9.3104e-06,  1.8076e-05, -1.2931e-05,  ..., -3.0576e-05,
            9.8086e-07,  2.0991e-05],
          [ 3.3605e-06,  8.2781e-06, -2.5999e-05,  ...,  3.0374e-06,
           -7.2280e-06,  1.8967e-06],
          [ 3.0150e-07,  9.8351e-06, -5.7826e-06,  ..., -2.7844e-06,
            7.7727e-06, -6.5799e-06]],

         ...,

         [[ 2.9864e-06, -6.5490e-07,  1.0587e-05,  ..., -3.7625e-06,
            1.1768e-05, -2.9133e-06],
          [-3.8799e-06,  1.3562e-06,  3.0947e-06,  ...,  3.1811e-05,
           -2.0618e-05,  4.5587e-06],
          [ 4.6971e-06,  1.1553e-05, -2.2766e-05,  ...,  1.0560e-05,
            1.0710e-05, -1.1202e-05],
          ...,
          [ 2.1892e-07,  4.0589e-05, -8.5241e-06,  ...,  1.9824e-05,
           -4.2811e-07,  4.5427e-07],
          [-9.7825e-06,  2.4167e-06, -2.2091e-05,  ..., -1.0698e-05,
            1.1297e-05, -4.1683e-06],
          [ 1.0453e-06, -6.7225e-06, -8.7533e-06,  ...,  1.2079e-05,
            4.6337e-06, -1.1808e-05]],

         [[-1.7295e-06, -1.3895e-06, -2.8879e-06,  ..., -5.3645e-06,
           -2.3536e-07, -3.5071e-06],
          [-1.0121e-05,  4.3384e-06,  2.8528e-06,  ..., -1.1446e-06,
            1.6309e-06, -2.1807e-06],
          [ 2.5066e-05,  1.7414e-05, -2.2270e-05,  ...,  2.2578e-06,
           -4.3071e-05, -3.4524e-06],
          ...,
          [-1.4378e-05, -1.1764e-05, -2.8231e-05,  ..., -1.1792e-06,
           -2.1877e-05, -2.3843e-07],
          [-6.9942e-06,  1.4500e-05, -2.3885e-05,  ...,  3.3075e-05,
            3.0803e-05, -8.7314e-06],
          [ 1.5109e-06,  1.3362e-05,  4.3713e-06,  ..., -3.0845e-05,
           -2.2590e-05,  9.2039e-06]],

         [[-2.7975e-07, -2.0032e-06, -1.4502e-05,  ...,  2.3127e-06,
           -8.4382e-06, -4.6085e-06],
          [-4.0690e-07,  6.3907e-06,  4.1588e-06,  ...,  9.7213e-06,
            5.1563e-06,  6.4269e-06],
          [ 6.9955e-07,  1.8652e-05,  1.3573e-05,  ..., -1.0738e-05,
            4.3835e-06,  3.8616e-07],
          ...,
          [-8.7335e-06,  5.3332e-06, -1.9954e-05,  ...,  1.7161e-05,
           -1.2065e-05, -1.9183e-05],
          [ 2.3210e-06, -1.2125e-06,  6.2189e-08,  ...,  1.4628e-05,
            7.4457e-06, -9.2624e-06],
          [-9.8444e-07,  5.6000e-06,  8.5696e-06,  ..., -1.0837e-06,
           -1.3370e-05, -3.7542e-06]]],


        ...,


        [[[-5.6821e-06, -6.0321e-06,  7.8079e-06,  ...,  1.5087e-05,
           -3.1687e-06, -5.1945e-06],
          [ 1.3090e-06,  5.5080e-07, -2.3644e-05,  ..., -1.8921e-05,
           -1.5506e-05,  8.7839e-06],
          [ 1.5480e-06, -2.9876e-05,  1.7672e-05,  ...,  4.2805e-05,
           -2.0097e-05, -3.3839e-06],
          ...,
          [ 1.8824e-05,  1.4209e-06,  1.1531e-05,  ..., -2.2437e-05,
           -2.6021e-05, -1.7061e-05],
          [ 1.4931e-06, -1.7588e-05, -6.4131e-06,  ...,  3.0594e-06,
           -1.4360e-06, -1.7600e-06],
          [-1.2827e-06, -1.4430e-05,  4.6912e-06,  ...,  1.1561e-05,
           -9.4752e-06,  3.9846e-06]],

         [[ 9.3543e-06, -1.2483e-05,  2.7008e-07,  ..., -5.2500e-06,
           -1.5515e-06,  8.7379e-06],
          [ 1.8654e-06,  1.1036e-05,  2.5385e-05,  ..., -1.3316e-05,
           -1.9854e-05, -6.0329e-06],
          [-1.1756e-05,  1.3643e-05,  1.9640e-05,  ...,  4.8334e-06,
            3.1851e-05,  1.5318e-05],
          ...,
          [ 1.7489e-06, -2.2453e-05,  7.1696e-06,  ..., -2.1800e-06,
            9.8223e-06,  1.3082e-05],
          [ 4.8763e-06, -7.3571e-06, -8.8228e-07,  ..., -1.4895e-05,
           -7.1757e-06,  2.5901e-06],
          [-1.3801e-05,  3.4773e-06, -5.1446e-06,  ..., -5.9225e-06,
            4.1913e-06,  5.9545e-06]],

         [[-3.8572e-06, -2.0249e-06, -1.8502e-05,  ..., -1.2819e-05,
            4.9782e-06,  6.1203e-07],
          [ 1.5590e-06, -1.4996e-05, -7.4014e-07,  ..., -7.5170e-06,
           -3.6766e-06,  1.6224e-05],
          [-5.1983e-06, -7.5511e-06,  4.7277e-05,  ..., -7.0668e-06,
           -8.6626e-06, -3.1252e-06],
          ...,
          [-2.1749e-06, -1.1132e-05, -3.2275e-05,  ...,  7.8605e-06,
            3.5433e-06, -2.5401e-06],
          [ 9.1894e-06,  4.6401e-05,  4.9869e-06,  ..., -6.3751e-06,
            1.3018e-05,  1.3206e-05],
          [ 5.0851e-06,  2.5571e-06,  7.1049e-06,  ..., -1.4330e-05,
           -1.2102e-05, -2.5354e-07]],

         ...,

         [[ 9.7581e-07,  1.7026e-06, -1.5788e-05,  ...,  2.3521e-05,
            3.4199e-07, -1.0957e-05],
          [-8.6949e-07,  1.0027e-05,  2.1978e-05,  ..., -3.2979e-05,
           -1.0494e-05,  2.1621e-05],
          [ 1.4226e-05,  1.4457e-06, -1.6297e-05,  ...,  1.8300e-05,
            1.5827e-05,  6.3469e-06],
          ...,
          [-6.2737e-06,  5.5562e-05, -2.4336e-05,  ...,  2.7555e-05,
            6.6069e-06,  1.7756e-05],
          [-8.8477e-07, -3.3375e-06, -1.4629e-05,  ..., -2.1263e-05,
            2.9387e-06,  4.1717e-07],
          [ 5.2617e-06, -1.6384e-05, -1.5504e-05,  ...,  6.4166e-06,
           -4.2974e-06, -4.4118e-06]],

         [[ 2.1608e-06,  6.9829e-06, -2.9695e-07,  ...,  3.1214e-06,
           -7.7229e-06, -1.1654e-06],
          [ 7.3046e-06, -3.0753e-06, -1.0631e-05,  ...,  1.6759e-05,
            6.3324e-06, -2.3774e-06],
          [ 8.7688e-06, -8.4689e-06, -4.8944e-05,  ..., -3.3983e-05,
           -1.1146e-05, -5.3697e-06],
          ...,
          [ 1.7925e-05, -5.1971e-06, -3.3533e-05,  ..., -1.8594e-06,
           -1.1190e-05, -9.4653e-06],
          [ 2.6572e-06, -8.6901e-06, -1.8400e-06,  ..., -1.2438e-05,
            1.5071e-05, -8.9543e-06],
          [-4.4468e-06,  9.1719e-06, -4.9863e-06,  ...,  1.2614e-06,
            5.0824e-06,  1.2145e-05]],

         [[ 2.0283e-06, -9.0387e-06, -1.0896e-05,  ..., -4.6637e-06,
           -1.2447e-06,  8.4905e-07],
          [ 1.8489e-06,  1.4653e-05,  6.3242e-06,  ...,  4.7629e-06,
            8.7417e-06, -1.1342e-05],
          [ 3.8972e-06,  1.4897e-05,  3.1291e-05,  ..., -9.3981e-06,
           -4.4734e-06,  3.0398e-06],
          ...,
          [ 3.7053e-06, -1.5012e-05,  5.5485e-06,  ...,  6.6989e-06,
           -1.0928e-05,  3.4960e-07],
          [ 8.0517e-06,  2.8089e-05, -1.1580e-05,  ..., -4.4144e-05,
            3.8978e-05, -1.4085e-05],
          [ 7.7448e-08, -7.8497e-06, -4.9760e-06,  ...,  6.9925e-06,
           -2.3375e-06,  4.7663e-06]]],


        [[[ 9.1844e-07,  1.3861e-05, -1.3117e-05,  ..., -2.3679e-05,
            1.7267e-07, -2.8725e-06],
          [-1.6931e-05,  2.8803e-05,  1.5441e-05,  ..., -6.6168e-06,
            8.2923e-06,  4.6802e-06],
          [ 2.6309e-06, -3.0465e-05, -3.2141e-05,  ..., -2.0378e-05,
            2.5076e-05, -4.4322e-06],
          ...,
          [ 2.8190e-07,  1.3213e-05,  1.3411e-05,  ...,  7.3901e-06,
            2.5810e-05,  1.7426e-05],
          [ 7.7005e-06, -7.3935e-06, -9.2385e-06,  ...,  5.3163e-07,
            1.5385e-05, -2.6338e-06],
          [-5.9729e-06,  1.5435e-05,  6.0690e-06,  ..., -6.7859e-06,
            5.6300e-06,  2.1290e-06]],

         [[-5.6640e-06, -9.4820e-06, -1.6596e-05,  ..., -7.7187e-06,
            1.5455e-06,  6.5560e-06],
          [-4.3702e-06, -3.6571e-05,  6.3220e-06,  ...,  3.3219e-05,
            2.3385e-05,  4.4738e-07],
          [-4.6941e-06, -1.9102e-05, -3.5930e-05,  ...,  9.7922e-06,
           -3.0758e-06,  1.0325e-06],
          ...,
          [ 8.2739e-07, -9.5505e-07, -2.6404e-06,  ..., -1.3972e-05,
           -2.5792e-05, -6.6280e-06],
          [-1.0248e-05,  1.5971e-05,  1.6062e-05,  ...,  4.1853e-06,
           -4.9680e-06,  1.6203e-06],
          [-1.3287e-06, -1.7111e-05, -2.3195e-05,  ..., -6.2945e-06,
            9.1769e-06, -3.7569e-06]],

         [[ 6.4432e-08, -1.2353e-06,  1.5730e-05,  ...,  5.4836e-06,
            1.2335e-05,  4.5559e-07],
          [-2.1624e-06, -4.8927e-06,  1.4594e-05,  ..., -1.7548e-05,
            8.2050e-06, -6.3112e-06],
          [-6.8110e-06, -1.5231e-06, -6.6013e-06,  ..., -2.1259e-05,
           -5.7525e-06, -7.5180e-06],
          ...,
          [-8.2743e-06, -1.3955e-05,  3.5914e-05,  ..., -3.9262e-06,
           -1.5949e-05, -4.3413e-06],
          [ 2.3994e-07, -1.4571e-05,  1.6186e-05,  ..., -7.9587e-06,
            1.4997e-05, -5.5248e-06],
          [-7.3873e-08, -2.3007e-06,  1.2874e-05,  ...,  1.7921e-05,
           -1.7728e-05, -5.0413e-06]],

         ...,

         [[-1.2262e-05, -2.5064e-05, -3.9537e-07,  ...,  5.2106e-07,
            7.0287e-06, -6.6199e-06],
          [ 4.1269e-06, -2.4579e-05,  1.1964e-05,  ..., -9.3497e-06,
           -1.6139e-06,  3.3125e-06],
          [-2.2984e-07, -1.1781e-05, -4.1601e-05,  ...,  7.4483e-06,
            1.7071e-05,  1.6204e-06],
          ...,
          [ 2.1221e-06,  9.4260e-06,  2.1623e-05,  ...,  1.6364e-05,
           -1.2398e-05,  1.8816e-05],
          [ 1.5612e-05, -1.3338e-05,  1.5278e-05,  ..., -1.8907e-05,
            1.3752e-05,  6.5181e-06],
          [ 2.5780e-06,  8.7186e-06, -2.4857e-06,  ..., -7.7126e-06,
           -1.7856e-05,  2.3461e-06]],

         [[-6.2330e-06,  2.6935e-06, -2.0475e-06,  ..., -3.7557e-06,
            2.8539e-06,  8.5848e-06],
          [-2.7886e-06, -1.4170e-05, -5.1257e-06,  ...,  2.0123e-05,
            4.4791e-06, -8.5360e-07],
          [ 5.3538e-06,  1.7357e-05, -2.5424e-06,  ...,  1.6908e-06,
           -1.5629e-06, -7.6947e-06],
          ...,
          [ 3.8068e-06,  3.7418e-06, -1.4700e-05,  ...,  1.0368e-05,
            1.2858e-05,  7.9062e-06],
          [ 6.0649e-06, -1.0208e-05, -8.1353e-06,  ..., -3.1776e-05,
            1.1031e-05,  1.4376e-05],
          [ 9.3832e-06,  2.3402e-07,  9.5854e-06,  ..., -2.0441e-06,
           -1.0883e-06,  1.8520e-06]],

         [[-8.6084e-06, -1.9953e-05,  7.2465e-06,  ..., -4.4582e-06,
            4.0488e-06,  9.4349e-07],
          [-9.1428e-06,  2.2867e-06,  8.3447e-07,  ...,  5.5774e-06,
           -1.4123e-05,  2.9443e-07],
          [ 1.3549e-05, -5.4158e-07,  1.1163e-05,  ..., -3.9628e-06,
           -4.0793e-06, -5.0108e-06],
          ...,
          [-1.6882e-05,  3.0271e-05, -2.7687e-06,  ..., -3.9392e-06,
           -3.1628e-06, -9.8675e-06],
          [-2.6669e-06, -1.8886e-05,  9.5347e-06,  ...,  3.9210e-06,
            1.4090e-05, -3.7238e-06],
          [ 5.4672e-07,  1.0672e-05,  2.1477e-05,  ...,  1.2234e-05,
            9.1738e-06,  5.1587e-06]]],


        [[[ 1.8140e-06,  1.0427e-05, -5.5825e-06,  ...,  8.3494e-06,
           -5.2019e-06, -6.0748e-06],
          [-1.2572e-07, -1.5814e-06, -9.4650e-06,  ...,  1.1091e-05,
            3.9648e-05, -2.5612e-06],
          [ 1.4301e-05, -9.8717e-06, -1.5284e-05,  ...,  1.5420e-05,
            7.6753e-06,  2.9126e-07],
          ...,
          [ 6.7986e-06,  1.6740e-05,  2.1723e-05,  ..., -3.9165e-05,
           -2.4740e-05, -3.9428e-06],
          [ 1.5603e-05, -1.4253e-05,  1.1284e-05,  ...,  8.1843e-06,
            5.0072e-06,  2.1789e-06],
          [ 2.4854e-06,  4.6000e-06, -2.2264e-06,  ..., -8.0517e-06,
            8.5054e-06,  1.9473e-07]],

         [[ 6.2655e-06, -2.7644e-06, -2.6788e-06,  ..., -3.1849e-06,
            7.3904e-06, -5.6177e-06],
          [-2.4817e-06, -2.5969e-05,  1.1387e-05,  ..., -2.1352e-05,
            1.6873e-05,  2.5336e-06],
          [-1.1493e-05, -7.8742e-06, -1.4199e-05,  ..., -1.2530e-05,
           -7.1160e-06,  3.2899e-06],
          ...,
          [ 2.0894e-05,  2.4933e-06, -3.0370e-05,  ...,  1.6156e-05,
            3.4599e-05,  4.1126e-06],
          [-1.8740e-05, -1.4289e-05, -3.1876e-05,  ...,  6.9503e-06,
           -1.4323e-05, -9.6816e-07],
          [ 4.0305e-06,  1.4051e-06,  1.1077e-06,  ..., -6.4439e-06,
            1.8205e-06,  5.4160e-06]],

         [[-1.0077e-06,  6.5187e-06, -8.9126e-06,  ..., -1.2675e-05,
            1.8447e-06, -3.6224e-06],
          [ 1.3614e-05, -3.3754e-06, -2.2903e-05,  ..., -2.0066e-05,
           -8.2120e-06,  7.2616e-06],
          [ 3.9624e-06, -2.0242e-05,  6.1757e-06,  ...,  1.8515e-05,
            1.6004e-05,  1.5241e-05],
          ...,
          [ 4.2577e-06,  1.0038e-05, -7.7179e-06,  ..., -2.0023e-05,
           -3.7643e-05,  1.8576e-05],
          [ 8.2301e-06,  7.9769e-07,  6.4949e-07,  ...,  2.2023e-06,
            7.3606e-06,  2.7306e-06],
          [ 1.0740e-06,  4.4002e-06,  4.8504e-06,  ...,  1.1075e-05,
           -5.6292e-06, -6.9426e-07]],

         ...,

         [[ 7.7417e-06, -1.8722e-05,  4.9334e-06,  ...,  4.9510e-06,
            3.5108e-06,  2.4693e-06],
          [ 6.1195e-06, -1.8462e-05,  4.2046e-06,  ..., -3.2491e-06,
           -2.5092e-06,  7.3476e-07],
          [-1.1436e-05,  7.6561e-06,  1.3442e-05,  ..., -1.9879e-05,
            1.1853e-05,  5.3542e-06],
          ...,
          [-1.3941e-05,  7.7446e-06, -5.3177e-06,  ..., -6.2232e-06,
            9.3934e-07,  1.1781e-05],
          [ 7.1980e-07,  7.1442e-06, -5.0123e-05,  ...,  1.6630e-05,
            1.3414e-06, -6.7705e-06],
          [-3.2172e-06,  8.5758e-06, -7.9871e-06,  ...,  7.7484e-06,
           -2.3757e-06, -3.6906e-06]],

         [[-6.0521e-06, -1.1673e-05, -6.5226e-06,  ..., -2.9849e-05,
            5.8319e-06,  1.8020e-06],
          [-2.5277e-06, -2.5122e-05,  1.1691e-05,  ...,  1.3833e-05,
           -3.5914e-06,  1.1751e-05],
          [ 2.0556e-05,  2.7393e-05,  3.4455e-05,  ..., -1.7230e-05,
           -6.4699e-06,  9.6900e-06],
          ...,
          [-1.3273e-05,  9.0580e-07,  8.3617e-07,  ...,  3.8811e-06,
            1.0929e-05, -4.1962e-06],
          [-5.8576e-06, -4.3105e-06,  2.4326e-05,  ..., -2.4704e-05,
           -5.5102e-06,  2.5873e-06],
          [ 1.4838e-06,  1.4800e-05,  1.7590e-05,  ...,  1.8635e-05,
            8.6495e-06,  6.6195e-06]],

         [[-5.7550e-06, -1.1512e-05, -3.6307e-06,  ..., -3.4405e-06,
            2.1877e-06,  9.1514e-06],
          [-4.3674e-06, -5.5136e-06,  5.2358e-06,  ...,  2.2321e-06,
           -7.3613e-06, -1.1657e-05],
          [-7.2996e-06, -2.0465e-05,  2.4085e-05,  ..., -1.0602e-05,
           -1.3241e-05,  6.0603e-07],
          ...,
          [ 6.9958e-06,  2.2220e-06,  2.0205e-06,  ..., -2.4246e-05,
           -3.5335e-06,  5.2493e-06],
          [-4.3203e-06,  1.5498e-05, -1.7784e-06,  ...,  5.9460e-06,
            1.6387e-05, -6.5222e-06],
          [ 9.1452e-06, -7.4849e-07, -3.2505e-07,  ...,  9.1768e-07,
            8.3573e-06,  7.2983e-06]]]]) 
 old gradient:tensor([[[[-4.2640e-05, -1.2691e-04,  2.1150e-04, -4.6298e-05],
          [-3.4812e-04, -1.4644e-04,  6.7869e-05,  4.4838e-06],
          [ 2.0128e-04, -3.1375e-05, -6.1680e-05,  4.7451e-05],
          [-1.4185e-04, -5.2737e-05,  2.2712e-05, -1.0112e-05]],

         [[-8.2511e-05,  8.5044e-05,  4.4724e-06, -1.7696e-04],
          [ 5.8847e-05, -1.4230e-04, -2.0181e-05, -9.2762e-05],
          [-1.0349e-04,  2.5551e-05,  1.2061e-04, -2.4917e-05],
          [ 9.2485e-05,  1.6871e-05, -5.0199e-05, -2.8961e-05]],

         [[-1.0845e-04, -1.6883e-05, -1.2296e-05,  8.8374e-05],
          [-1.4829e-04, -8.6313e-05,  7.0120e-05, -4.5541e-05],
          [ 6.7361e-05,  1.8785e-05,  2.1798e-04, -1.0777e-05],
          [-6.4054e-05,  1.3797e-04, -1.1852e-04, -3.7180e-05]],

         ...,

         [[-1.2981e-05,  3.0868e-05,  2.6658e-05, -1.1234e-04],
          [-2.3252e-04,  2.7017e-05,  1.1284e-04, -8.5385e-05],
          [ 1.2141e-06,  4.1985e-05,  2.9510e-05,  9.9191e-05],
          [-7.2647e-05, -1.1169e-04,  6.7812e-05,  9.4994e-05]],

         [[-6.9107e-05, -1.2867e-04, -1.5187e-05,  6.2551e-05],
          [ 6.2712e-06,  1.3290e-04,  9.0390e-05, -9.2003e-08],
          [ 5.9336e-05,  7.0731e-05,  1.2490e-04, -5.2920e-05],
          [-1.8294e-04, -1.7576e-04,  6.6268e-05, -1.0656e-04]],

         [[ 3.2724e-05,  1.6368e-04, -3.1211e-05, -1.9183e-05],
          [ 6.4505e-05, -1.6472e-05,  2.6019e-05,  7.5439e-06],
          [-2.6387e-05,  5.6515e-05,  3.0259e-04,  1.8557e-04],
          [-3.5577e-05,  1.3664e-04, -6.8507e-05,  5.8433e-06]]],


        [[[-3.5856e-05,  3.3403e-04, -1.1050e-04,  1.3032e-04],
          [-1.0652e-04, -7.9657e-05,  3.9014e-05,  4.9196e-05],
          [-6.8530e-05,  9.4021e-05,  9.7903e-05, -2.6534e-06],
          [-4.1950e-06,  2.2512e-04,  1.0670e-04,  7.6142e-05]],

         [[-6.8347e-05,  2.1272e-04,  1.3468e-05, -7.8530e-05],
          [-1.1726e-04,  8.6976e-05,  8.0568e-05,  5.2121e-05],
          [ 1.1005e-04,  1.8927e-04,  9.8936e-05,  9.1642e-05],
          [-1.0384e-04, -1.0979e-04,  6.2126e-05,  7.8192e-05]],

         [[ 1.0887e-04,  1.3345e-04, -4.7651e-05,  1.4584e-04],
          [-7.9094e-05, -8.3942e-05, -6.1419e-05,  1.0769e-04],
          [ 4.4253e-05,  4.8951e-05,  3.5128e-05,  1.8383e-04],
          [-5.5284e-05,  9.8461e-05,  1.1647e-04, -7.9777e-05]],

         ...,

         [[-1.4363e-04, -4.8277e-05, -1.0703e-04, -1.1804e-04],
          [ 1.2232e-04, -3.1003e-05, -5.7422e-06, -2.4160e-05],
          [ 4.8595e-06,  1.4769e-04, -5.2818e-05, -1.3463e-04],
          [ 2.2100e-04, -1.2554e-04, -9.2246e-05, -3.5414e-05]],

         [[-6.9787e-06,  8.0032e-06, -3.4549e-06,  1.9871e-04],
          [ 3.7569e-06,  7.2780e-05,  1.1916e-06,  5.2409e-05],
          [ 1.4974e-04,  7.7230e-06,  6.6136e-05, -1.6801e-04],
          [ 1.1471e-06, -1.5419e-04,  9.1287e-05,  7.6714e-05]],

         [[-9.3684e-05, -1.0970e-04,  2.0467e-04,  1.3708e-04],
          [ 2.3726e-04,  1.1836e-04, -1.8253e-04,  1.4390e-04],
          [-1.1067e-05, -1.5935e-04, -9.6756e-05, -5.1975e-05],
          [-2.9665e-05, -1.1567e-04, -1.5682e-04, -1.1131e-05]]],


        [[[ 5.9128e-05,  2.1516e-05,  1.3122e-04, -6.2857e-05],
          [-4.0803e-04, -6.6506e-05, -3.5348e-05, -1.0929e-05],
          [ 1.0860e-04, -4.6636e-05, -2.0729e-05,  2.3936e-05],
          [-7.4033e-05, -6.1586e-05,  1.0220e-05, -7.6920e-05]],

         [[-1.2531e-04,  1.2983e-04,  1.8292e-05, -2.5554e-04],
          [ 2.0229e-05, -1.4068e-04, -1.9573e-05, -2.1702e-04],
          [ 5.6568e-06, -2.7118e-05,  1.1390e-04, -9.8048e-05],
          [ 1.4961e-04,  1.5115e-04,  2.2444e-05, -1.3260e-04]],

         [[-3.3098e-05,  1.7380e-05, -2.4553e-05, -2.7645e-05],
          [-1.7329e-04, -1.3156e-04, -6.4178e-07, -4.3141e-05],
          [ 1.0966e-04, -2.9118e-06,  1.3724e-04, -7.9144e-05],
          [ 1.6081e-05,  1.3254e-04, -1.8731e-04,  3.1130e-05]],

         ...,

         [[ 7.2273e-06, -7.4731e-06,  2.8229e-05,  3.3999e-05],
          [-1.7975e-04,  5.8480e-05,  3.5460e-05, -7.4148e-05],
          [ 2.5672e-05,  1.2141e-04,  1.6171e-05,  6.8373e-05],
          [ 5.0685e-06, -1.1114e-04,  1.3532e-04,  9.4115e-05]],

         [[ 1.9879e-05, -8.1296e-05, -1.5433e-04,  4.0400e-05],
          [ 1.3171e-05,  1.0424e-04,  3.9564e-05,  7.2378e-05],
          [ 9.7007e-07,  1.1909e-04,  6.1945e-05,  7.2585e-06],
          [-2.1069e-04, -4.6403e-05, -1.9791e-05, -1.2333e-04]],

         [[ 2.3382e-05,  9.1959e-05,  6.8517e-05,  6.6409e-06],
          [ 1.0736e-04,  2.3819e-05,  5.9032e-05,  1.9536e-05],
          [-3.8861e-05,  2.6135e-06,  2.9319e-04,  1.7603e-04],
          [-4.2803e-05,  1.4476e-04, -4.2801e-06, -1.7724e-05]]],


        ...,


        [[[-5.2727e-05, -1.3567e-04,  1.4052e-04, -1.3360e-04],
          [-3.0778e-04, -5.5267e-05,  2.7814e-05,  8.7736e-06],
          [ 9.7282e-05, -5.5553e-05, -8.8097e-05,  1.4761e-05],
          [-6.0605e-05, -6.6994e-05, -7.3118e-05, -3.9155e-05]],

         [[-1.1984e-04,  9.0573e-05,  7.4057e-05, -1.5620e-04],
          [ 1.9349e-05, -1.2136e-04, -1.3884e-06, -1.5288e-04],
          [ 6.4755e-06, -2.1161e-05,  1.6862e-04, -8.8652e-05],
          [ 9.1660e-05,  1.5200e-04, -3.8468e-05, -6.7150e-05]],

         [[-2.9155e-05,  5.5179e-05, -8.0790e-05,  4.7465e-05],
          [-1.8182e-04,  5.5673e-05,  1.8631e-05, -2.3082e-05],
          [ 2.1677e-04,  3.2882e-05,  1.0670e-04, -1.5647e-04],
          [-1.3449e-04,  1.9249e-04, -2.3047e-04, -3.3274e-05]],

         ...,

         [[-6.1021e-05,  6.0676e-05, -4.3757e-05, -2.0748e-05],
          [-2.0207e-04,  1.2554e-05,  7.7716e-05, -1.1256e-04],
          [-1.1050e-05,  1.0593e-04,  4.6925e-05,  4.3239e-05],
          [ 5.2645e-05, -1.1870e-04, -4.3196e-06,  9.2546e-05]],

         [[ 4.4629e-05, -1.4216e-04, -9.3927e-05,  1.7744e-04],
          [-5.8656e-05,  1.1291e-04,  3.7393e-05,  7.8919e-05],
          [ 3.0605e-05,  5.0844e-05,  6.1832e-05,  4.7602e-05],
          [-1.9916e-04, -5.7111e-05,  9.5928e-05, -1.4767e-04]],

         [[ 2.5879e-05,  2.4202e-04,  7.4701e-05,  1.9258e-05],
          [ 1.2440e-04,  1.9495e-05,  2.7147e-05, -8.8291e-05],
          [-2.2546e-05,  1.3472e-05,  2.8719e-04,  8.5199e-05],
          [-9.9724e-06,  1.3446e-05, -2.2009e-06,  8.3819e-05]]],


        [[[ 1.9547e-04,  5.2651e-05, -4.9203e-05, -6.0234e-05],
          [ 1.0320e-05, -7.3709e-05,  6.9673e-06,  7.6906e-05],
          [-2.3868e-05,  1.1900e-04,  2.0602e-05,  1.8093e-04],
          [ 7.2325e-05, -3.1137e-05, -2.0465e-04,  2.3262e-05]],

         [[-2.0358e-04,  2.2588e-04,  1.5813e-04,  9.6053e-06],
          [-9.8532e-05, -5.0122e-05,  1.6112e-04,  9.1481e-05],
          [ 4.0895e-05,  2.8859e-04, -4.6204e-05,  7.4531e-05],
          [ 2.6034e-04,  6.6572e-05, -5.3669e-05,  5.3530e-05]],

         [[-2.3631e-05, -2.1962e-05, -1.3651e-05,  5.9940e-05],
          [ 7.4205e-05,  9.7808e-06,  1.4227e-04, -1.8374e-05],
          [-2.8912e-04,  2.0490e-04,  4.0879e-05,  7.4415e-05],
          [-9.9107e-05,  1.0474e-04,  4.0463e-05,  2.8245e-04]],

         ...,

         [[ 2.3568e-05,  1.2019e-04,  5.3390e-05, -3.6957e-05],
          [-6.7491e-05,  9.8198e-05,  1.6358e-04,  3.6097e-05],
          [-6.1232e-05,  3.4760e-05,  7.9425e-05, -4.6793e-05],
          [-9.2701e-05,  2.3019e-05, -9.3440e-05,  1.3367e-05]],

         [[ 1.0255e-04, -4.3397e-05,  1.4301e-05,  1.2093e-05],
          [ 2.5684e-04,  2.6208e-04,  1.8133e-05, -7.6384e-05],
          [-4.0830e-05,  1.4647e-04,  1.6049e-05, -2.1658e-04],
          [ 1.7122e-04, -1.7161e-05,  1.0040e-05,  3.3624e-05]],

         [[-1.1017e-04,  1.1796e-04, -8.5580e-05,  8.6901e-05],
          [ 3.1387e-05, -7.3032e-05,  1.9779e-05, -3.0366e-04],
          [-7.4349e-05,  1.1912e-04,  6.0616e-05,  1.3324e-04],
          [-1.3724e-04,  8.5309e-05, -1.6251e-04, -1.3507e-04]]],


        [[[-1.6118e-04, -1.1473e-04, -1.9435e-04,  1.0840e-04],
          [ 6.4809e-05,  1.7602e-04,  6.7366e-05,  1.6148e-04],
          [-4.7297e-05, -4.9761e-05, -4.8078e-05, -7.0501e-05],
          [-1.6952e-05, -1.9088e-04,  1.5555e-04, -1.9846e-05]],

         [[ 3.3112e-05, -1.4166e-04,  2.3615e-05, -1.9555e-04],
          [-5.4478e-05,  1.2459e-05,  1.7212e-04, -5.8240e-05],
          [-1.0992e-04,  1.6031e-04,  2.3699e-05, -3.0281e-05],
          [-1.1013e-04,  8.3704e-05, -3.9959e-05,  1.1207e-04]],

         [[-1.8011e-04,  9.8195e-05,  1.0933e-04, -1.2193e-04],
          [ 6.0959e-05,  8.2853e-05, -1.1130e-04,  1.3142e-05],
          [-3.8585e-05,  2.2181e-05,  5.7329e-06, -9.8223e-05],
          [ 4.2828e-06,  5.5370e-05,  1.1908e-05,  9.4731e-05]],

         ...,

         [[-7.3702e-05, -5.7394e-05,  8.9701e-06,  4.8541e-05],
          [-1.6756e-04, -1.3516e-04,  5.9161e-05,  1.5588e-04],
          [-1.7970e-04, -1.1651e-05, -2.3094e-04,  6.9498e-05],
          [-1.1094e-04,  1.6193e-04,  1.7671e-05,  9.6732e-05]],

         [[-3.9528e-05, -1.9509e-05, -1.7873e-04, -1.0040e-04],
          [ 3.9231e-06, -9.3896e-05, -2.2406e-05, -1.9156e-04],
          [ 1.7928e-05,  4.2769e-05, -7.8703e-05,  1.6071e-05],
          [-4.0757e-05,  8.8023e-06, -5.1357e-05,  2.2526e-05]],

         [[-5.4425e-05,  6.0449e-06, -1.2376e-04,  5.2135e-06],
          [-1.2403e-04,  2.3454e-05, -1.6998e-06, -3.0488e-05],
          [-1.8024e-04, -7.4466e-05, -4.2257e-05, -9.5810e-05],
          [ 9.8082e-05, -1.3084e-05,  2.5049e-05,  1.9199e-04]]]])
2024-11-30 13:26:28,722 - INFO - reading batch[62] client 2
2024-11-30 13:26:28,748 - INFO - reading batch[62] client 3
2024-11-30 13:26:28,780 - INFO - reading batch[62] client 4
2024-11-30 13:26:28,805 - INFO - reading batch[63] client 1
2024-11-30 13:26:28,828 - INFO - reading batch[63] client 2
2024-11-30 13:26:28,843 - INFO - reading batch[63] client 3
2024-11-30 13:26:28,861 - INFO - reading batch[63] client 4
2024-11-30 13:26:28,889 - INFO - reading batch[64] client 1
2024-11-30 13:26:28,907 - INFO - reading batch[64] client 2
2024-11-30 13:26:28,934 - INFO - reading batch[64] client 3
2024-11-30 13:26:28,963 - INFO - reading batch[64] client 4
2024-11-30 13:26:28,988 - INFO - reading batch[65] client 1
2024-11-30 13:26:29,020 - INFO - reading batch[65] client 2
2024-11-30 13:26:29,033 - ERROR - backward on partition 3
2024-11-30 13:26:29,036 - CRITICAL - calculate backward $3 on client3
2024-11-30 13:26:29,050 - CRITICAL - new gradient:tensor([[[[-1.9122e-04, -3.9535e-05, -4.1852e-04,  4.1352e-05],
          [ 4.8413e-05,  1.5822e-04,  8.9168e-06,  4.2759e-04],
          [-8.1231e-05,  9.8776e-05, -2.1538e-04, -4.7079e-04],
          [-1.0345e-04, -2.1559e-04,  1.7819e-04,  3.6645e-04]],

         [[ 2.0298e-04, -4.2855e-04,  1.8044e-04, -2.3574e-04],
          [-2.1822e-04,  5.2954e-05,  3.2633e-04, -2.0791e-04],
          [-5.8295e-05,  3.7595e-04, -5.0356e-05, -2.3491e-04],
          [-1.1351e-04,  1.1539e-04, -2.0001e-04, -1.7174e-05]],

         [[-2.3754e-04,  2.0299e-04, -4.0353e-05, -1.7982e-04],
          [ 2.1451e-04,  1.4141e-04, -2.1551e-04, -2.9838e-04],
          [-4.3069e-04,  1.0897e-04,  7.5895e-05, -1.0284e-04],
          [ 2.5270e-04, -2.6984e-05, -1.3160e-04,  9.8417e-05]],

         ...,

         [[ 2.1031e-05, -3.4686e-04, -7.2458e-05,  4.6787e-05],
          [-5.0363e-04, -3.9008e-04,  4.5334e-04,  1.5467e-04],
          [-4.3413e-04, -4.8066e-05, -1.2693e-04,  1.7053e-04],
          [-1.3163e-05,  2.9845e-04,  3.0320e-04, -6.1915e-05]],

         [[ 1.4609e-04,  3.3160e-04, -2.6485e-04,  5.8350e-07],
          [-6.5997e-06, -3.0961e-04, -5.4465e-05, -2.8448e-05],
          [ 3.1263e-04, -1.5455e-04, -8.7007e-07, -8.2600e-06],
          [-1.8807e-05,  6.2033e-05, -9.4002e-05, -5.9259e-05]],

         [[ 9.6346e-05, -9.2170e-06, -1.7166e-04, -1.2603e-04],
          [-3.0257e-04, -2.3739e-04, -1.1107e-04, -1.6655e-04],
          [-3.9454e-04, -5.8533e-05, -2.0280e-04, -1.7700e-04],
          [ 1.4509e-04,  8.4435e-05, -4.6818e-05,  1.5142e-04]]],


        [[[-2.5094e-04,  1.1125e-04, -1.5045e-04, -3.1120e-05],
          [ 9.6751e-05,  1.2164e-04,  2.3104e-04,  9.5604e-05],
          [-2.1536e-04,  4.3397e-05,  1.2183e-04, -6.0320e-05],
          [-1.7339e-04,  1.0188e-04,  2.4950e-04,  5.8956e-05]],

         [[-5.9351e-05,  4.8510e-05,  4.7121e-05, -2.3434e-05],
          [-4.1160e-04,  1.4686e-04,  4.1859e-04,  3.0225e-04],
          [ 1.0937e-04,  1.7107e-04, -2.8124e-05, -1.6408e-04],
          [-1.9172e-04, -1.5681e-04, -2.9531e-05, -2.1958e-05]],

         [[ 1.2787e-04,  1.0943e-04,  1.3446e-04,  2.1686e-04],
          [ 8.2676e-05, -1.1658e-04, -3.6698e-05,  1.0843e-04],
          [-2.5572e-04, -4.4649e-05,  8.2956e-06,  1.2277e-04],
          [ 4.5409e-05, -1.0210e-04,  1.7333e-05, -1.0380e-04]],

         ...,

         [[ 1.5686e-06, -7.8144e-05, -2.5186e-04, -1.6423e-04],
          [-1.6127e-04, -2.1722e-04,  1.9673e-04,  7.4066e-05],
          [-1.6443e-04, -2.1036e-05,  1.2480e-04,  1.4529e-04],
          [ 2.5740e-04,  9.6807e-05,  1.1564e-04, -2.2596e-05]],

         [[-7.9499e-05,  1.0533e-04, -9.4569e-05,  4.0403e-05],
          [ 2.9342e-05, -5.6224e-05, -4.1013e-05, -5.8544e-05],
          [ 4.3387e-04, -6.0663e-05,  1.3079e-04, -1.2505e-04],
          [ 2.4742e-05, -2.5775e-04, -4.3394e-05, -1.3166e-06]],

         [[-2.2060e-04, -2.6944e-04, -1.8701e-05, -4.9732e-05],
          [ 2.2722e-05,  1.3623e-04, -1.7308e-04,  1.4627e-04],
          [-8.9197e-05, -2.2033e-04, -1.7092e-04, -1.4189e-04],
          [-6.4212e-05, -1.0124e-04, -1.1950e-04,  7.7166e-05]]],


        [[[ 1.2856e-04,  3.6256e-04, -3.3051e-04, -9.7855e-05],
          [ 2.7591e-04, -2.8291e-04,  4.2039e-05,  8.8466e-05],
          [-1.1186e-04,  4.4667e-05,  8.9231e-05,  4.1315e-04],
          [ 3.7506e-04,  1.9589e-04, -2.0649e-05, -2.1861e-04]],

         [[-2.1116e-04,  7.0797e-04,  1.4793e-04, -1.2354e-05],
          [-3.9342e-04,  1.2743e-04,  2.1971e-04,  6.5129e-05],
          [ 3.5866e-04,  2.3883e-04,  2.2991e-04,  3.1646e-04],
          [ 1.0681e-04, -2.5465e-04,  5.3986e-05,  5.7872e-05]],

         [[-6.3266e-05,  3.5032e-05, -2.6145e-05,  1.1762e-04],
          [ 2.1965e-04, -1.9167e-04,  4.2488e-04,  2.7074e-04],
          [-6.2695e-05,  1.4923e-04, -2.9109e-05,  7.3785e-05],
          [-2.3784e-04,  2.7133e-04,  6.2906e-05,  1.7846e-04]],

         ...,

         [[-1.2635e-04,  2.3663e-04,  9.9976e-05, -2.2222e-04],
          [ 1.1585e-04,  1.7631e-04, -9.7565e-05,  1.2351e-04],
          [-4.8747e-04,  3.6975e-04,  5.1485e-05, -4.7064e-05],
          [ 9.5492e-05, -8.7274e-05, -1.4685e-04, -1.2293e-05]],

         [[ 6.3844e-05, -1.3377e-04,  1.7362e-04,  2.8978e-04],
          [ 2.6353e-04,  6.1627e-04, -7.7913e-05, -3.6033e-04],
          [-1.6238e-04,  4.2866e-05, -4.4562e-05, -4.4016e-04],
          [ 4.7959e-04, -1.0945e-06,  1.3154e-04,  2.3448e-04]],

         [[-3.3503e-04,  1.8366e-04, -1.4150e-04,  2.2179e-04],
          [ 1.8649e-04, -7.3105e-05, -2.1612e-04, -7.5332e-04],
          [-2.1058e-04,  1.0438e-04,  2.5957e-04,  6.8620e-06],
          [-1.9915e-04,  2.5686e-04, -3.8326e-04, -3.2160e-04]]],


        ...,


        [[[-1.0995e-04, -9.7205e-06,  3.4083e-04, -1.9158e-04],
          [-1.7443e-04,  4.5824e-06, -2.1234e-05,  8.5069e-05],
          [ 1.0559e-04, -3.5606e-05, -2.2222e-04,  9.7684e-06],
          [ 1.6267e-04, -1.7120e-04, -7.5472e-05,  2.6620e-05]],

         [[-2.6032e-04, -2.0615e-04, -2.4464e-04,  6.1137e-05],
          [ 2.9577e-04, -2.4022e-05, -3.6875e-04, -1.9057e-04],
          [-2.3721e-04, -3.0036e-04,  4.2820e-04, -7.8703e-05],
          [ 2.4944e-05,  1.7689e-04,  1.0897e-04,  1.5639e-04]],

         [[-1.2880e-04, -3.3847e-06,  1.3456e-06,  1.5568e-05],
          [-2.9230e-04, -2.1925e-06,  1.3211e-04, -2.7319e-04],
          [ 3.2849e-04,  2.1265e-05,  1.7248e-04, -4.8157e-04],
          [-7.5942e-05,  1.6964e-05, -3.3329e-04, -1.7675e-04]],

         ...,

         [[ 1.3142e-04,  1.3321e-05,  3.0720e-04,  5.7660e-05],
          [ 4.0703e-05, -6.0320e-05, -1.3024e-04, -2.3090e-04],
          [ 2.7121e-04,  2.2009e-04, -7.9196e-05,  1.8122e-04],
          [ 1.1136e-04, -2.8462e-04, -1.5201e-05,  2.5869e-05]],

         [[ 2.8661e-05, -1.2366e-04,  1.5841e-05, -1.6516e-07],
          [ 3.5853e-05,  2.1223e-06,  2.2331e-04,  1.3000e-04],
          [-1.5608e-04,  7.0902e-05, -5.1509e-05, -8.6512e-06],
          [-2.2946e-04,  1.7457e-04,  4.1886e-06, -3.5371e-05]],

         [[ 2.7263e-04,  3.1495e-04,  1.0286e-04,  5.4785e-05],
          [ 1.5816e-04, -4.4618e-05,  1.7024e-04, -7.9089e-06],
          [ 8.2617e-05,  2.7224e-05,  2.1846e-04,  2.1236e-04],
          [ 1.0353e-04, -4.6513e-05,  9.5681e-05,  1.0029e-04]]],


        [[[ 4.2607e-05, -1.7560e-04, -1.0687e-04, -1.3915e-04],
          [-1.8365e-04,  4.3187e-05,  1.8415e-04,  8.3830e-05],
          [ 1.8577e-04, -1.7988e-04, -1.3056e-04, -2.2180e-04],
          [-1.2935e-04, -1.4509e-04,  2.0722e-04, -2.8918e-05]],

         [[ 2.1707e-04, -1.9561e-04,  1.8676e-04, -2.2740e-04],
          [-1.7748e-04, -6.3426e-05,  5.8958e-05, -2.0642e-04],
          [-1.1728e-04,  1.7856e-04,  3.0596e-05, -1.2185e-04],
          [-1.0913e-04,  7.7934e-05, -7.4717e-05,  6.7912e-05]],

         [[-8.3238e-05, -8.5509e-05, -7.5623e-05, -1.6450e-04],
          [ 2.1464e-04,  4.2125e-05, -1.3597e-04,  5.9947e-05],
          [ 2.0494e-05,  1.0051e-05,  3.3538e-04,  4.7819e-05],
          [ 1.2063e-04,  3.4300e-04, -9.0938e-06,  9.3067e-05]],

         ...,

         [[-3.6448e-05, -1.4453e-04, -4.7823e-06,  4.7494e-05],
          [-2.4058e-04, -9.1263e-05,  1.8614e-05,  2.5912e-05],
          [-4.2293e-04, -3.2810e-04, -2.3836e-04, -7.3219e-05],
          [-6.0602e-05,  6.5901e-05,  1.8090e-04,  8.3677e-05]],

         [[-1.4936e-04,  8.0962e-05, -6.9193e-05,  8.8655e-05],
          [ 6.1724e-05, -4.4941e-05, -1.6473e-04, -1.7883e-04],
          [-2.1938e-05,  6.3728e-05,  1.1190e-04,  7.5690e-05],
          [-3.2840e-04,  1.8836e-05,  7.6376e-05, -5.4562e-05]],

         [[ 3.1880e-06,  2.0420e-04, -2.8358e-04,  1.0297e-04],
          [-2.2018e-04, -9.0542e-06, -3.8656e-05,  6.7945e-05],
          [-1.3534e-04,  2.4329e-06,  1.6500e-04,  3.8675e-06],
          [ 1.8177e-04, -5.1908e-05, -5.9779e-05,  9.6137e-05]]],


        [[[ 1.0571e-05,  5.1594e-05, -1.3573e-04,  1.4899e-04],
          [ 1.9722e-04, -4.2910e-05,  2.5104e-04,  2.7195e-04],
          [-1.3277e-04,  4.1396e-05,  9.8833e-05, -1.0796e-04],
          [-7.1324e-05,  3.4793e-05,  2.0567e-04,  1.4195e-04]],

         [[-1.4704e-04, -2.4878e-04,  3.9303e-05,  1.7110e-05],
          [ 6.5109e-05,  3.5269e-04, -3.8576e-04,  8.6782e-05],
          [-1.2837e-04, -7.2713e-06, -4.2040e-06,  1.3001e-04],
          [-1.9401e-04, -4.4859e-05,  4.8478e-05,  2.0643e-04]],

         [[ 4.8442e-05,  2.1147e-04,  2.3172e-04,  1.5973e-05],
          [ 8.0689e-06, -7.9090e-06, -1.1912e-04,  3.5676e-05],
          [-1.0704e-04,  1.2343e-04,  1.9105e-04,  8.0210e-05],
          [ 4.6145e-05,  5.9278e-05, -6.3445e-05, -1.1049e-05]],

         ...,

         [[-2.3925e-04, -1.2935e-04,  2.3031e-05,  2.7196e-05],
          [ 3.0229e-04, -7.3125e-05, -3.4274e-05,  3.5878e-04],
          [-2.9151e-04,  2.2580e-04, -1.2478e-04,  2.2118e-04],
          [ 1.2435e-04,  2.2362e-05, -2.0936e-04, -2.4164e-04]],

         [[ 3.4797e-05, -9.3276e-05,  1.0870e-04,  3.5035e-04],
          [ 1.3082e-04, -2.9785e-04, -1.1914e-04, -9.5335e-05],
          [ 8.9315e-05, -2.0604e-04,  7.7867e-05, -1.0736e-04],
          [-2.5598e-05,  5.1575e-05,  4.8871e-05,  2.5476e-04]],

         [[-4.0614e-05, -5.3586e-05, -1.5000e-05,  5.0161e-04],
          [ 1.5879e-04, -2.3276e-05, -2.6968e-04,  1.0203e-04],
          [-1.0447e-04, -3.0213e-04, -1.6920e-04, -5.1027e-05],
          [ 1.0588e-04, -3.7830e-04,  2.7847e-07,  2.0481e-04]]]]) 
 old gradient:tensor([[ 1.4623e-03,  3.1700e-04, -3.0057e-04,  ...,  2.5338e-05,
         -1.3963e-03, -1.1108e-03],
        [ 4.7650e-04, -3.4130e-04, -6.7497e-04,  ..., -7.4786e-05,
         -7.4501e-04, -2.0047e-04],
        [-1.4440e-03,  1.3075e-04,  3.0604e-04,  ...,  5.7729e-04,
          1.5018e-03,  7.7528e-04],
        ...,
        [ 2.2111e-04,  5.1719e-04, -3.2560e-04,  ..., -9.0209e-04,
         -5.0460e-07,  2.3262e-04],
        [ 9.8103e-04,  5.5147e-04,  3.5376e-04,  ...,  1.9993e-04,
          1.8990e-04, -3.3871e-04],
        [-1.4602e-04, -6.0044e-04, -2.0006e-04,  ..., -9.9369e-04,
         -5.3119e-04,  8.6599e-04]])
2024-11-30 13:26:29,050 - INFO - reading batch[65] client 3
2024-11-30 13:26:29,083 - INFO - reading batch[65] client 4
2024-11-30 13:26:29,109 - INFO - reading batch[66] client 1
2024-11-30 13:26:29,136 - INFO - reading batch[66] client 2
2024-11-30 13:26:29,162 - INFO - reading batch[66] client 3
2024-11-30 13:26:29,181 - ERROR - backward on partition 4
2024-11-30 13:26:29,182 - CRITICAL - calculate backward $4 on client4
2024-11-30 13:26:29,192 - CRITICAL - new gradient:tensor([[ 4.8780e-04,  3.4667e-04, -2.7305e-04,  ...,  1.8466e-04,
         -6.7063e-04, -4.6133e-04],
        [-2.7650e-04, -7.2083e-04,  2.4407e-04,  ...,  5.4003e-04,
         -4.5592e-04, -4.4798e-04],
        [-1.4329e-04,  1.1042e-04,  2.2355e-04,  ..., -7.3185e-04,
         -4.4106e-04,  6.2599e-04],
        ...,
        [-6.5923e-05, -3.4974e-04,  2.3742e-05,  ..., -1.9102e-04,
          5.0525e-04,  2.3001e-04],
        [-4.9245e-04, -6.7249e-04, -3.9634e-04,  ..., -1.7936e-04,
          3.0191e-04,  5.7984e-04],
        [-4.9806e-04, -6.8159e-04, -3.9047e-04,  ..., -1.8067e-04,
          2.9640e-04,  5.8618e-04]]) 
 old gradient:tensor([[ 0.0019,  0.0014, -0.0140,  0.0014,  0.0016,  0.0015,  0.0015,  0.0014,
          0.0017,  0.0015],
        [ 0.0021,  0.0014,  0.0018,  0.0013,  0.0015,  0.0015,  0.0013,  0.0014,
          0.0018, -0.0141],
        [ 0.0019,  0.0015,  0.0017, -0.0142,  0.0014,  0.0015,  0.0015,  0.0015,
          0.0017,  0.0016],
        [-0.0136,  0.0014,  0.0017,  0.0013,  0.0015,  0.0015,  0.0016,  0.0014,
          0.0018,  0.0014],
        [ 0.0022,  0.0015,  0.0017,  0.0014,  0.0014,  0.0014,  0.0013,  0.0014,
          0.0017, -0.0142],
        [ 0.0019, -0.0142,  0.0017,  0.0013,  0.0015,  0.0015,  0.0015,  0.0015,
          0.0018,  0.0016],
        [ 0.0021,  0.0015,  0.0018,  0.0013,  0.0016,  0.0014, -0.0143,  0.0014,
          0.0017,  0.0015],
        [ 0.0020,  0.0015,  0.0018,  0.0013,  0.0015,  0.0014, -0.0143,  0.0015,
          0.0018,  0.0015],
        [ 0.0021,  0.0016, -0.0138,  0.0012,  0.0013,  0.0014,  0.0014,  0.0015,
          0.0020,  0.0014],
        [ 0.0019,  0.0015,  0.0018,  0.0014,  0.0015,  0.0015,  0.0015,  0.0015,
          0.0017, -0.0142],
        [ 0.0020,  0.0014,  0.0017,  0.0014,  0.0016, -0.0142,  0.0014,  0.0015,
          0.0018,  0.0015],
        [ 0.0022,  0.0014,  0.0017,  0.0013,  0.0014, -0.0142,  0.0014,  0.0014,
          0.0018,  0.0016],
        [ 0.0018,  0.0015,  0.0018,  0.0015,  0.0016,  0.0015,  0.0015, -0.0142,
          0.0016,  0.0015],
        [ 0.0021,  0.0015,  0.0018,  0.0012,  0.0015,  0.0014, -0.0143,  0.0014,
          0.0018,  0.0015],
        [ 0.0020,  0.0015,  0.0018,  0.0014,  0.0015,  0.0015,  0.0015,  0.0014,
          0.0016, -0.0141],
        [ 0.0019,  0.0015,  0.0017,  0.0014,  0.0016,  0.0015,  0.0015, -0.0142,
          0.0016,  0.0015],
        [ 0.0020,  0.0015,  0.0017, -0.0143,  0.0015,  0.0015,  0.0014,  0.0014,
          0.0018,  0.0016],
        [ 0.0021,  0.0015,  0.0018,  0.0013, -0.0141,  0.0015,  0.0014,  0.0015,
          0.0017,  0.0015],
        [ 0.0021,  0.0015, -0.0139,  0.0013,  0.0014,  0.0014,  0.0014,  0.0015,
          0.0018,  0.0015],
        [ 0.0020,  0.0014,  0.0016,  0.0014,  0.0016, -0.0143,  0.0015,  0.0014,
          0.0018,  0.0015],
        [ 0.0019, -0.0142,  0.0017,  0.0014,  0.0015,  0.0015,  0.0015,  0.0015,
          0.0017,  0.0016],
        [ 0.0020,  0.0014,  0.0019,  0.0013, -0.0140,  0.0014,  0.0013,  0.0014,
          0.0018,  0.0015],
        [ 0.0019,  0.0015,  0.0018,  0.0013,  0.0016,  0.0014, -0.0142,  0.0015,
          0.0019,  0.0015],
        [ 0.0018,  0.0015,  0.0017,  0.0014,  0.0016,  0.0016,  0.0014, -0.0142,
          0.0017,  0.0015],
        [ 0.0022,  0.0014,  0.0018,  0.0014,  0.0015,  0.0015,  0.0013,  0.0014,
          0.0017, -0.0142],
        [ 0.0018, -0.0141,  0.0017,  0.0014,  0.0015,  0.0015,  0.0014,  0.0014,
          0.0019,  0.0015],
        [ 0.0022,  0.0014,  0.0017, -0.0143,  0.0015,  0.0015,  0.0015,  0.0014,
          0.0017,  0.0015],
        [ 0.0022,  0.0015,  0.0018,  0.0012,  0.0014,  0.0014, -0.0144,  0.0014,
          0.0019,  0.0015],
        [ 0.0021,  0.0015,  0.0017,  0.0013,  0.0015,  0.0014,  0.0015,  0.0014,
         -0.0138,  0.0014],
        [ 0.0020,  0.0015, -0.0136,  0.0013,  0.0014,  0.0014,  0.0013,  0.0015,
          0.0017,  0.0015],
        [ 0.0018,  0.0015,  0.0016,  0.0014,  0.0015,  0.0016,  0.0015, -0.0141,
          0.0017,  0.0016],
        [ 0.0021,  0.0014,  0.0018,  0.0012,  0.0015,  0.0015,  0.0015,  0.0013,
         -0.0138,  0.0015],
        [-0.0135,  0.0014,  0.0017,  0.0013,  0.0016,  0.0013,  0.0014,  0.0015,
          0.0018,  0.0014],
        [ 0.0019,  0.0014,  0.0017,  0.0014,  0.0016, -0.0142,  0.0014,  0.0014,
          0.0018,  0.0015],
        [ 0.0021,  0.0014, -0.0138,  0.0013,  0.0014,  0.0015,  0.0013,  0.0015,
          0.0018,  0.0015],
        [ 0.0018,  0.0015,  0.0017,  0.0014,  0.0016,  0.0016,  0.0015, -0.0142,
          0.0016,  0.0015],
        [ 0.0019,  0.0015,  0.0019,  0.0013,  0.0015,  0.0015,  0.0015, -0.0142,
          0.0017,  0.0015],
        [ 0.0022,  0.0014,  0.0019,  0.0013,  0.0014,  0.0015,  0.0013,  0.0014,
          0.0018, -0.0142],
        [ 0.0021,  0.0015,  0.0018,  0.0013, -0.0141,  0.0015,  0.0014,  0.0014,
          0.0017,  0.0015],
        [ 0.0018,  0.0015,  0.0017,  0.0015,  0.0015,  0.0015,  0.0014, -0.0142,
          0.0016,  0.0015],
        [ 0.0019,  0.0013,  0.0017,  0.0014,  0.0017, -0.0141,  0.0015,  0.0014,
          0.0017,  0.0015],
        [ 0.0021,  0.0013,  0.0017, -0.0142,  0.0016,  0.0015,  0.0015,  0.0015,
          0.0017,  0.0015],
        [ 0.0021,  0.0014,  0.0017,  0.0013,  0.0016,  0.0015, -0.0143,  0.0014,
          0.0018,  0.0015],
        [ 0.0020,  0.0015, -0.0139,  0.0013,  0.0014,  0.0014,  0.0014,  0.0015,
          0.0019,  0.0015],
        [-0.0135,  0.0013,  0.0018,  0.0014,  0.0015,  0.0014,  0.0014,  0.0014,
          0.0018,  0.0014],
        [ 0.0020,  0.0015,  0.0019,  0.0013,  0.0015,  0.0014, -0.0143,  0.0014,
          0.0018,  0.0014],
        [ 0.0018,  0.0015,  0.0016,  0.0015,  0.0016,  0.0016,  0.0014, -0.0142,
          0.0017,  0.0016],
        [ 0.0020,  0.0015,  0.0018,  0.0013, -0.0141,  0.0014,  0.0013,  0.0014,
          0.0019,  0.0015],
        [ 0.0022,  0.0014,  0.0018,  0.0012,  0.0015,  0.0014,  0.0014,  0.0013,
         -0.0139,  0.0015],
        [ 0.0021,  0.0015,  0.0016,  0.0013,  0.0015,  0.0015,  0.0014,  0.0014,
         -0.0137,  0.0016],
        [ 0.0022,  0.0014,  0.0018,  0.0013,  0.0015,  0.0014,  0.0013,  0.0014,
          0.0018, -0.0141],
        [ 0.0019,  0.0014,  0.0017,  0.0014,  0.0016,  0.0015,  0.0015,  0.0014,
          0.0017, -0.0141],
        [ 0.0021,  0.0015,  0.0017, -0.0143,  0.0015,  0.0014,  0.0014,  0.0015,
          0.0018,  0.0015],
        [ 0.0022,  0.0014,  0.0018,  0.0014,  0.0015,  0.0015,  0.0014,  0.0014,
          0.0018, -0.0142],
        [ 0.0020,  0.0014,  0.0016, -0.0142,  0.0015,  0.0015,  0.0014,  0.0014,
          0.0018,  0.0016],
        [ 0.0021,  0.0014,  0.0017,  0.0014,  0.0016, -0.0142,  0.0014,  0.0013,
          0.0017,  0.0015],
        [ 0.0018,  0.0014,  0.0018,  0.0014, -0.0139,  0.0015,  0.0015,  0.0014,
          0.0016,  0.0015],
        [ 0.0018,  0.0015,  0.0017,  0.0015,  0.0016,  0.0016,  0.0015, -0.0142,
          0.0015,  0.0015],
        [ 0.0019, -0.0142,  0.0017,  0.0013,  0.0015,  0.0015,  0.0015,  0.0015,
          0.0019,  0.0016],
        [ 0.0022,  0.0016, -0.0139,  0.0012,  0.0014,  0.0014,  0.0014,  0.0015,
          0.0019,  0.0014],
        [ 0.0021,  0.0014,  0.0018,  0.0013,  0.0014,  0.0014,  0.0014,  0.0014,
         -0.0137,  0.0015],
        [ 0.0018,  0.0015,  0.0017,  0.0015,  0.0014,  0.0015,  0.0015, -0.0142,
          0.0017,  0.0016],
        [ 0.0021,  0.0014,  0.0017,  0.0014,  0.0015, -0.0142,  0.0014,  0.0015,
          0.0017,  0.0016],
        [ 0.0021,  0.0014,  0.0017,  0.0013,  0.0016, -0.0143,  0.0013,  0.0014,
          0.0019,  0.0015]])
2024-11-30 13:26:29,192 - INFO - reading batch[66] client 4
2024-11-30 13:26:29,216 - INFO - reading batch[67] client 1
2024-11-30 13:26:29,243 - INFO - reading batch[67] client 2
2024-11-30 13:26:29,256 - ERROR - backward on partition 3
2024-11-30 13:26:29,259 - CRITICAL - calculate backward $3 on client3
2024-11-30 13:26:29,267 - CRITICAL - new gradient:tensor([[[[-4.0237e-04, -9.7657e-05, -8.1028e-04,  1.2242e-04],
          [ 1.1225e-04,  2.8902e-04, -5.2046e-05,  9.1198e-04],
          [-1.0648e-04,  1.9944e-04, -4.5830e-04, -9.3576e-04],
          [-2.1045e-04, -4.2299e-04,  3.7539e-04,  6.5670e-04]],

         [[ 4.0834e-04, -8.7803e-04,  3.6529e-04, -4.9275e-04],
          [-4.1532e-04,  3.9883e-05,  6.3896e-04, -4.3968e-04],
          [-1.7462e-04,  8.0184e-04, -8.8465e-05, -4.4106e-04],
          [-1.9385e-04,  2.9793e-04, -3.6657e-04,  1.3867e-05]],

         [[-5.2038e-04,  4.0396e-04, -1.1448e-04, -3.0451e-04],
          [ 4.1800e-04,  2.5512e-04, -4.6841e-04, -5.2254e-04],
          [-8.2250e-04,  2.6441e-04,  1.7492e-04, -1.9652e-04],
          [ 4.6624e-04, -5.4313e-05, -2.7428e-04,  1.7346e-04]],

         ...,

         [[ 1.2455e-05, -6.4776e-04, -1.9424e-04,  9.6780e-05],
          [-9.5884e-04, -7.5906e-04,  8.9702e-04,  2.8424e-04],
          [-8.1147e-04, -1.3744e-04, -2.6604e-04,  3.0088e-04],
          [-3.3984e-05,  6.2508e-04,  6.0329e-04, -1.4538e-04]],

         [[ 2.3670e-04,  6.3963e-04, -5.1459e-04,  1.3152e-05],
          [-1.7283e-05, -6.3230e-04, -8.0474e-05, -9.8907e-05],
          [ 6.1425e-04, -2.5732e-04,  3.7744e-05,  3.7942e-06],
          [-6.7805e-05,  4.8441e-05, -1.8924e-04, -1.5346e-04]],

         [[ 1.9227e-04,  1.4018e-05, -2.8545e-04, -2.8316e-04],
          [-5.7019e-04, -4.8336e-04, -2.5231e-04, -3.7338e-04],
          [-7.5095e-04, -1.0810e-04, -3.7597e-04, -3.1650e-04],
          [ 2.8114e-04,  1.3486e-04, -1.1728e-04,  2.8116e-04]]],


        [[[-5.0149e-04,  2.4045e-04, -2.9311e-04, -5.6149e-05],
          [ 1.9493e-04,  2.6021e-04,  4.7701e-04,  1.9283e-04],
          [-4.4744e-04,  8.5220e-05,  2.4805e-04, -1.2167e-04],
          [-3.5340e-04,  1.9243e-04,  5.0539e-04,  1.2623e-04]],

         [[-1.2914e-04,  8.9257e-05,  9.5347e-05, -3.6143e-05],
          [-8.2829e-04,  2.7362e-04,  8.4166e-04,  5.8886e-04],
          [ 2.1551e-04,  3.5608e-04, -4.3096e-05, -3.0821e-04],
          [-3.7772e-04, -3.3044e-04, -5.3691e-05, -3.2266e-05]],

         [[ 2.5563e-04,  2.0301e-04,  2.7090e-04,  4.1813e-04],
          [ 1.6188e-04, -2.2983e-04, -6.3986e-05,  2.0932e-04],
          [-5.1708e-04, -7.9198e-05,  2.7436e-05,  2.4870e-04],
          [ 1.0747e-04, -2.0608e-04,  3.4688e-05, -2.1098e-04]],

         ...,

         [[ 7.3993e-06, -1.5326e-04, -5.1741e-04, -3.1829e-04],
          [-3.2235e-04, -4.1700e-04,  3.8052e-04,  1.4042e-04],
          [-3.2648e-04, -4.2931e-05,  2.4506e-04,  2.9554e-04],
          [ 5.1917e-04,  1.8847e-04,  2.3842e-04, -6.2617e-05]],

         [[-1.5969e-04,  2.0991e-04, -1.9042e-04,  8.3661e-05],
          [ 5.3822e-05, -1.2300e-04, -8.0995e-05, -1.1148e-04],
          [ 8.8071e-04, -1.2413e-04,  2.4946e-04, -2.5281e-04],
          [ 3.7763e-05, -5.0075e-04, -7.6321e-05,  6.5245e-06]],

         [[-4.3433e-04, -5.2965e-04, -5.7800e-05, -8.1945e-05],
          [ 4.6019e-05,  2.6385e-04, -3.4675e-04,  3.0939e-04],
          [-1.9420e-04, -4.4004e-04, -3.4658e-04, -2.8319e-04],
          [-1.2106e-04, -2.0699e-04, -2.4104e-04,  1.7276e-04]]],


        [[[ 2.5378e-04,  6.9803e-04, -6.9566e-04, -1.9241e-04],
          [ 5.7018e-04, -5.8792e-04,  7.0420e-05,  1.8203e-04],
          [-2.0967e-04,  1.0101e-04,  2.0244e-04,  8.2755e-04],
          [ 7.6903e-04,  3.5960e-04, -2.2537e-05, -3.9852e-04]],

         [[-4.3961e-04,  1.4732e-03,  2.5660e-04, -5.7736e-05],
          [-7.8550e-04,  2.2792e-04,  4.4275e-04,  1.2086e-04],
          [ 7.2380e-04,  4.4766e-04,  5.0192e-04,  6.7155e-04],
          [ 2.1590e-04, -5.2527e-04,  1.0599e-04,  1.0976e-04]],

         [[-1.0653e-04,  2.6194e-05, -3.2741e-05,  1.8161e-04],
          [ 4.7803e-04, -4.0603e-04,  8.4723e-04,  5.5750e-04],
          [-9.3488e-05,  2.9984e-04, -6.0341e-05,  1.5694e-04],
          [-5.0288e-04,  5.0985e-04,  1.6759e-04,  3.4887e-04]],

         ...,

         [[-2.6460e-04,  5.1846e-04,  1.8724e-04, -4.7845e-04],
          [ 1.9777e-04,  3.3004e-04, -1.4344e-04,  2.5113e-04],
          [-9.9866e-04,  7.4707e-04,  9.6856e-05, -1.1087e-04],
          [ 1.9744e-04, -2.1674e-04, -2.6531e-04, -1.3753e-05]],

         [[ 1.0659e-04, -2.8983e-04,  3.4400e-04,  5.7963e-04],
          [ 5.3837e-04,  1.2105e-03, -1.1736e-04, -7.2955e-04],
          [-2.9919e-04,  9.0913e-05, -1.0999e-04, -8.6569e-04],
          [ 9.5306e-04, -4.6946e-05,  2.9264e-04,  4.2333e-04]],

         [[-6.8579e-04,  3.7033e-04, -3.0496e-04,  4.5434e-04],
          [ 3.6929e-04, -1.1418e-04, -4.5219e-04, -1.5255e-03],
          [-4.6264e-04,  1.7355e-04,  5.0567e-04, -1.5520e-05],
          [-4.0705e-04,  5.5113e-04, -7.5457e-04, -6.2990e-04]]],


        ...,


        [[[-1.8060e-04, -1.5052e-06,  6.6585e-04, -3.6325e-04],
          [-3.6774e-04,  5.6177e-05, -6.5696e-05,  1.8140e-04],
          [ 1.9427e-04, -7.6830e-05, -4.5036e-04, -1.4943e-06],
          [ 3.4382e-04, -3.1499e-04, -1.6847e-04,  3.9066e-05]],

         [[-5.1422e-04, -3.9661e-04, -4.9060e-04,  1.0425e-04],
          [ 5.7616e-04, -5.8726e-05, -7.4158e-04, -3.8852e-04],
          [-4.4869e-04, -6.2643e-04,  8.8048e-04, -1.5471e-04],
          [ 5.6146e-05,  3.6222e-04,  2.0760e-04,  2.9993e-04]],

         [[-2.5184e-04, -2.6052e-05, -2.3108e-05,  3.0622e-05],
          [-5.8726e-04, -2.7286e-05,  2.4572e-04, -5.7594e-04],
          [ 6.5016e-04,  4.2181e-05,  3.8460e-04, -9.5642e-04],
          [-2.0030e-04,  3.5458e-05, -6.6573e-04, -3.5449e-04]],

         ...,

         [[ 2.7105e-04, -1.1893e-05,  5.8373e-04,  1.2911e-04],
          [ 4.1818e-05, -1.0418e-04, -2.4325e-04, -4.8682e-04],
          [ 5.6179e-04,  4.3332e-04, -1.4481e-04,  3.5688e-04],
          [ 2.5334e-04, -5.5496e-04, -6.2631e-05,  5.7704e-05]],

         [[ 7.8912e-05, -2.2178e-04,  6.8357e-05, -1.9382e-05],
          [ 9.5463e-05,  9.1045e-07,  4.4865e-04,  2.6802e-04],
          [-3.3006e-04,  1.0793e-04, -1.1743e-04, -1.0506e-05],
          [-4.4775e-04,  3.4318e-04,  1.3276e-05, -8.7605e-05]],

         [[ 5.1155e-04,  6.3672e-04,  1.9859e-04,  1.2936e-04],
          [ 2.8420e-04, -9.8285e-05,  3.8089e-04, -3.5852e-05],
          [ 1.7445e-04,  3.0697e-05,  4.3318e-04,  4.3769e-04],
          [ 1.8515e-04, -8.8489e-05,  2.1124e-04,  1.7167e-04]]],


        [[[ 7.8370e-05, -3.9735e-04, -1.9966e-04, -3.0579e-04],
          [-3.9164e-04,  1.0298e-04,  4.0795e-04,  1.3626e-04],
          [ 3.5978e-04, -3.4230e-04, -2.7472e-04, -4.3178e-04],
          [-2.7415e-04, -3.3718e-04,  3.4917e-04, -8.3358e-05]],

         [[ 3.9108e-04, -4.0359e-04,  3.8285e-04, -4.5555e-04],
          [-3.3987e-04, -1.0828e-04,  1.2615e-04, -4.1471e-04],
          [-1.8770e-04,  3.3773e-04,  9.4004e-05, -2.0168e-04],
          [-2.0044e-04,  1.5462e-04, -2.0710e-04,  2.4136e-04]],

         [[-1.4945e-04, -1.5202e-04, -8.9571e-05, -3.5383e-04],
          [ 4.6726e-04,  9.0665e-05, -2.8228e-04,  1.1564e-04],
          [ 4.2071e-05,  3.4679e-05,  6.5792e-04,  3.8553e-05],
          [ 2.1673e-04,  6.2165e-04,  1.0203e-05,  1.7331e-04]],

         ...,

         [[ 2.3029e-05, -2.8339e-04, -3.1705e-05,  1.3610e-04],
          [-5.0532e-04, -2.1606e-04, -1.4502e-05,  8.0089e-05],
          [-8.5750e-04, -6.4769e-04, -4.9402e-04, -1.3185e-04],
          [-1.5250e-04,  1.5833e-04,  3.6465e-04,  1.8876e-04]],

         [[-2.5253e-04,  1.3018e-04, -8.8213e-05,  1.1764e-04],
          [ 1.3426e-04, -3.6581e-05, -2.1331e-04, -3.9609e-04],
          [-9.2318e-05,  4.8436e-05,  2.3721e-04,  1.7578e-04],
          [-6.9797e-04,  7.5141e-05,  1.2521e-04, -1.1141e-04]],

         [[-1.9932e-05,  4.2548e-04, -5.4132e-04,  1.9404e-04],
          [-3.9498e-04, -1.3142e-05, -9.7747e-05,  1.2121e-04],
          [-1.8653e-04, -2.4531e-05,  3.2654e-04,  2.5132e-05],
          [ 3.0954e-04, -1.3610e-04, -1.4633e-04,  2.0682e-04]]],


        [[[ 1.7525e-05,  9.7092e-05, -2.6446e-04,  3.0782e-04],
          [ 4.0041e-04, -9.1506e-05,  4.9674e-04,  5.5286e-04],
          [-2.5822e-04,  7.6353e-05,  1.9108e-04, -2.1816e-04],
          [-1.4438e-04,  6.7709e-05,  4.1879e-04,  2.7863e-04]],

         [[-2.9321e-04, -5.0301e-04,  7.5680e-05,  3.0672e-05],
          [ 1.3452e-04,  7.0178e-04, -7.6941e-04,  1.6775e-04],
          [-2.6112e-04, -1.4277e-05, -1.1868e-05,  2.5937e-04],
          [-3.8181e-04, -8.2865e-05,  1.0132e-04,  4.1736e-04]],

         [[ 9.1830e-05,  4.2020e-04,  4.6168e-04,  3.8644e-05],
          [ 1.5058e-05, -1.6989e-05, -2.3846e-04,  8.0215e-05],
          [-2.0962e-04,  2.4708e-04,  3.8368e-04,  1.6756e-04],
          [ 8.5810e-05,  1.1778e-04, -1.2145e-04, -2.7670e-05]],

         ...,

         [[-4.7600e-04, -2.4851e-04,  4.5890e-05,  5.4629e-05],
          [ 6.0874e-04, -1.4963e-04, -7.4480e-05,  7.0999e-04],
          [-5.7747e-04,  4.4785e-04, -2.5713e-04,  4.3563e-04],
          [ 2.4250e-04,  5.1156e-05, -4.1781e-04, -4.9260e-04]],

         [[ 6.1993e-05, -1.8783e-04,  2.2463e-04,  6.9622e-04],
          [ 2.6070e-04, -5.9432e-04, -2.4206e-04, -1.9850e-04],
          [ 1.7125e-04, -4.0954e-04,  1.5939e-04, -2.0504e-04],
          [-5.3699e-05,  9.6030e-05,  9.8152e-05,  5.0526e-04]],

         [[-8.0689e-05, -1.0121e-04, -2.5572e-05,  1.0009e-03],
          [ 3.2039e-04, -4.9656e-05, -5.4927e-04,  1.9918e-04],
          [-2.0938e-04, -6.0155e-04, -3.3541e-04, -9.5107e-05],
          [ 2.0600e-04, -7.5843e-04, -4.8483e-06,  4.0939e-04]]]]) 
 old gradient:tensor([[ 1.4623e-03,  3.1700e-04, -3.0057e-04,  ...,  2.5338e-05,
         -1.3963e-03, -1.1108e-03],
        [ 4.7650e-04, -3.4130e-04, -6.7497e-04,  ..., -7.4786e-05,
         -7.4501e-04, -2.0047e-04],
        [-1.4440e-03,  1.3075e-04,  3.0604e-04,  ...,  5.7729e-04,
          1.5018e-03,  7.7528e-04],
        ...,
        [ 2.2111e-04,  5.1719e-04, -3.2560e-04,  ..., -9.0209e-04,
         -5.0460e-07,  2.3262e-04],
        [ 9.8103e-04,  5.5147e-04,  3.5376e-04,  ...,  1.9993e-04,
          1.8990e-04, -3.3871e-04],
        [-1.4602e-04, -6.0044e-04, -2.0006e-04,  ..., -9.9369e-04,
         -5.3119e-04,  8.6599e-04]])
2024-11-30 13:26:29,268 - INFO - reading batch[67] client 3
2024-11-30 13:26:29,289 - INFO - reading batch[67] client 4
2024-11-30 13:26:29,312 - INFO - reading batch[68] client 1
2024-11-30 13:26:29,339 - INFO - reading batch[68] client 2
2024-11-30 13:26:29,352 - INFO - reading batch[68] client 3
2024-11-30 13:26:29,366 - INFO - reading batch[68] client 4
2024-11-30 13:26:29,380 - ERROR - backward on partition 1
2024-11-30 13:26:29,404 - CRITICAL - calculate backward $1 on client1
2024-11-30 13:26:29,438 - CRITICAL - new gradient:tensor([[[[-3.8375e-06, -3.1160e-06,  1.1158e-06,  ..., -1.8227e-06,
            1.5360e-06,  0.0000e+00],
          [ 1.9156e-06, -4.3149e-06,  7.6309e-06,  ...,  2.5354e-06,
            1.5251e-06,  0.0000e+00],
          [-1.3918e-06,  3.9709e-06, -1.1175e-06,  ..., -5.9182e-08,
           -9.1011e-06,  0.0000e+00],
          ...,
          [ 2.9057e-06,  1.0926e-07, -6.1082e-06,  ..., -1.8587e-06,
            1.9166e-07,  0.0000e+00],
          [-3.8413e-08,  2.6328e-06,  3.1019e-06,  ..., -2.2014e-06,
           -2.2561e-07,  0.0000e+00],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00]]],


        [[[ 1.8853e-06,  1.9355e-06, -4.4939e-06,  ..., -2.2955e-06,
           -2.4818e-06,  0.0000e+00],
          [-1.1272e-06,  5.3833e-06, -7.4727e-07,  ...,  1.5377e-06,
           -9.0320e-07,  0.0000e+00],
          [ 1.9597e-06, -5.1642e-06, -1.8798e-05,  ..., -2.7075e-06,
           -6.1322e-07,  0.0000e+00],
          ...,
          [ 3.2238e-06, -1.5270e-06, -3.2449e-07,  ...,  2.2969e-07,
           -2.3932e-07,  0.0000e+00],
          [-7.8938e-07, -1.2777e-06, -6.1137e-06,  ...,  4.1141e-07,
           -1.9574e-06,  0.0000e+00],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00]]],


        [[[-8.2326e-07,  3.4297e-06, -3.2611e-06,  ..., -2.9418e-06,
            2.8323e-06,  0.0000e+00],
          [ 6.4282e-07, -1.9306e-06,  1.1761e-06,  ..., -1.8433e-06,
           -2.3970e-06,  0.0000e+00],
          [-3.6956e-06,  4.9494e-06,  6.9507e-07,  ...,  1.6671e-06,
           -1.8187e-06,  0.0000e+00],
          ...,
          [-1.0419e-08,  3.0740e-07, -8.9430e-06,  ..., -2.4532e-06,
           -1.8353e-06,  0.0000e+00],
          [ 6.0865e-07, -2.8637e-07,  5.1730e-06,  ...,  5.1768e-08,
           -5.1027e-06,  0.0000e+00],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00]]],


        ...,


        [[[-1.7187e-06,  3.5066e-06, -3.1961e-06,  ..., -8.8933e-07,
           -1.0133e-07,  0.0000e+00],
          [ 1.5583e-06, -1.1319e-06,  5.9364e-06,  ..., -2.2439e-06,
           -4.4031e-07,  0.0000e+00],
          [ 1.5429e-06, -2.2949e-06, -3.3140e-06,  ...,  3.8892e-06,
            2.2725e-06,  0.0000e+00],
          ...,
          [-2.9006e-06, -4.4464e-06,  9.5784e-06,  ...,  3.8163e-06,
            6.5110e-07,  0.0000e+00],
          [-2.2230e-06, -1.7134e-06, -1.2987e-07,  ..., -3.8535e-06,
            1.6328e-06,  0.0000e+00],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00]]],


        [[[ 5.2460e-06, -5.7116e-06,  2.5941e-06,  ...,  6.0535e-07,
            3.9374e-06,  0.0000e+00],
          [ 1.7919e-06,  2.6108e-06, -1.1641e-05,  ..., -1.2177e-06,
            2.2449e-06,  0.0000e+00],
          [-5.0309e-07,  4.0186e-06, -1.3830e-05,  ..., -2.2206e-06,
            1.5925e-06,  0.0000e+00],
          ...,
          [-2.1230e-06,  2.8341e-06,  2.2954e-06,  ...,  4.9287e-06,
            2.0252e-06,  0.0000e+00],
          [ 1.0942e-06,  1.6223e-06, -1.6751e-06,  ..., -3.7621e-06,
            3.8865e-06,  0.0000e+00],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00]]],


        [[[-5.2509e-06,  3.4071e-06, -4.5714e-06,  ...,  4.8112e-06,
            1.9513e-07,  0.0000e+00],
          [ 3.0157e-06,  3.6166e-06, -5.8141e-06,  ...,  5.3436e-06,
            7.5961e-07,  0.0000e+00],
          [-2.0526e-07, -8.5197e-06, -6.5164e-07,  ...,  1.6857e-06,
            4.2138e-06,  0.0000e+00],
          ...,
          [ 1.1582e-06, -2.3767e-06, -1.2009e-06,  ...,  1.8627e-06,
            3.9288e-06,  0.0000e+00],
          [-7.2076e-06, -1.1588e-06,  7.0437e-07,  ..., -2.8019e-06,
            3.1343e-06,  0.0000e+00],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00]]]]) 
 old gradient:tensor([[[[-4.3132e-06, -7.8498e-06, -1.0301e-06,  ..., -1.1088e-05,
           -1.5858e-05,  1.3170e-06],
          [ 3.1083e-06, -2.5201e-06, -9.7403e-06,  ..., -6.9557e-06,
            8.2261e-06,  6.4444e-07],
          [ 4.2562e-06,  2.4655e-05, -1.2463e-06,  ..., -1.0933e-05,
           -3.3934e-06, -5.7296e-06],
          ...,
          [ 8.2662e-06,  8.7005e-07,  4.1776e-05,  ..., -3.3900e-05,
            4.7980e-06, -9.6050e-06],
          [-6.5352e-06, -3.9165e-06,  1.4616e-06,  ...,  2.4440e-06,
           -1.9445e-05,  1.2280e-05],
          [ 1.0403e-05,  1.4550e-06,  4.1323e-07,  ..., -4.6799e-06,
            6.1640e-06, -8.7462e-07]],

         [[ 4.1427e-06,  1.1388e-05,  4.1739e-06,  ..., -3.2958e-07,
           -9.8806e-06,  8.6546e-06],
          [-1.3006e-05, -3.3248e-06, -2.1051e-06,  ..., -2.2456e-05,
            2.9268e-06, -1.4486e-05],
          [-4.5860e-07, -5.9139e-06,  1.6225e-05,  ...,  1.0113e-06,
           -2.7610e-06,  3.8630e-06],
          ...,
          [ 3.2199e-07,  3.3143e-05,  2.5467e-05,  ...,  6.2375e-06,
            3.9944e-06,  8.9329e-06],
          [-6.3715e-06, -4.2746e-06, -2.4327e-05,  ...,  3.2892e-05,
           -2.1277e-05,  1.6212e-05],
          [-3.4960e-06, -6.8220e-06, -1.7186e-05,  ..., -3.3817e-06,
           -1.2438e-05,  9.0184e-06]],

         [[-2.4369e-06,  4.0157e-06,  2.9303e-06,  ..., -4.8317e-06,
            2.6834e-06,  3.5004e-06],
          [-9.0494e-06, -4.2809e-07, -3.4591e-05,  ...,  1.9221e-05,
           -2.0808e-05,  5.6278e-06],
          [-1.3356e-05,  3.8086e-07, -1.3792e-05,  ...,  8.0974e-06,
           -1.1301e-05,  4.5127e-06],
          ...,
          [-2.8611e-06,  1.4389e-07, -1.3049e-05,  ..., -3.1967e-08,
           -2.0425e-05,  2.0347e-05],
          [-4.8492e-06,  1.6399e-05, -1.5926e-05,  ..., -5.8162e-06,
            2.1278e-05, -9.3976e-06],
          [-9.3632e-07,  3.1177e-06, -7.0154e-06,  ...,  1.6292e-06,
           -2.5621e-06,  5.8942e-06]],

         ...,

         [[ 2.4610e-06, -1.7933e-06, -2.5447e-06,  ...,  2.3632e-07,
           -1.0811e-05,  1.3185e-06],
          [-5.9974e-06, -1.3160e-07, -1.7193e-05,  ..., -9.2300e-07,
           -1.6380e-05,  1.2160e-05],
          [ 5.4796e-06,  1.7702e-05, -8.5692e-06,  ...,  8.2421e-06,
           -1.7416e-06, -6.6391e-06],
          ...,
          [ 1.0435e-05, -3.1624e-05,  1.6600e-06,  ..., -9.2482e-07,
           -8.5353e-06, -5.5417e-06],
          [-6.5725e-06, -3.1116e-06, -1.1924e-05,  ..., -3.4821e-05,
           -9.6763e-06, -2.0657e-05],
          [-4.6944e-06, -8.4468e-06, -2.4406e-05,  ...,  2.3666e-05,
            9.9809e-06, -3.2890e-06]],

         [[ 2.9095e-06,  4.2655e-07, -5.8573e-06,  ..., -6.7193e-06,
            4.1843e-06, -2.8113e-06],
          [ 5.8401e-06,  1.2659e-05, -4.4507e-06,  ...,  1.6620e-05,
            6.5566e-07,  5.3211e-06],
          [ 9.5270e-07,  2.1115e-06, -2.0673e-05,  ..., -7.2894e-06,
            8.5506e-06, -1.4488e-05],
          ...,
          [ 5.0938e-06, -1.9290e-05, -3.5311e-05,  ..., -2.7777e-05,
            1.5464e-06, -1.7110e-06],
          [-2.9283e-06, -2.7177e-05, -2.4597e-05,  ..., -3.7543e-07,
           -4.5376e-06,  1.4677e-05],
          [ 2.2705e-06,  8.0048e-06, -7.7098e-06,  ...,  5.4640e-06,
            1.8079e-06,  7.3025e-06]],

         [[ 1.2726e-07,  1.8545e-06, -2.0016e-05,  ...,  1.6159e-06,
           -1.0891e-05, -5.4744e-06],
          [ 6.0545e-06,  1.7958e-05, -1.6582e-06,  ...,  1.4285e-05,
            8.2213e-06, -4.1850e-06],
          [-6.3388e-06, -1.1874e-05,  2.1575e-05,  ..., -2.9140e-05,
            8.5170e-06,  1.9772e-06],
          ...,
          [ 4.4150e-06,  5.5027e-06,  6.8987e-06,  ..., -5.5761e-06,
           -1.2088e-05, -1.8645e-05],
          [ 1.3462e-05,  3.6358e-06,  2.9815e-05,  ..., -7.6001e-06,
            1.1043e-05,  5.9194e-06],
          [ 3.1284e-06, -2.2550e-06, -1.1187e-05,  ..., -1.3268e-05,
            2.4293e-06,  5.1156e-06]]],


        [[[ 7.0173e-06,  3.2695e-06,  2.2509e-06,  ...,  1.1107e-05,
            6.5006e-06,  2.2409e-06],
          [-1.9951e-05,  6.4204e-06,  7.2084e-06,  ..., -2.9203e-05,
            6.9573e-06,  8.6246e-06],
          [-4.0087e-06,  3.4084e-05, -1.8413e-05,  ..., -3.8400e-05,
           -2.1032e-05, -1.0720e-05],
          ...,
          [-2.6723e-06,  9.0736e-06, -1.4704e-05,  ..., -1.8486e-05,
            1.7677e-05, -4.5433e-06],
          [-5.1115e-06, -6.2967e-06,  1.9355e-05,  ..., -5.4875e-06,
           -8.6756e-06,  1.7812e-06],
          [ 5.0113e-06, -1.7552e-06, -3.5763e-06,  ...,  4.6382e-06,
           -7.2387e-06,  7.3467e-06]],

         [[-5.0231e-06,  7.3104e-06, -1.2831e-05,  ..., -7.2281e-06,
           -4.6128e-06, -2.9827e-07],
          [ 1.4994e-05,  2.9406e-05,  7.8310e-06,  ...,  2.4273e-07,
            4.8748e-06, -6.1882e-06],
          [ 2.6611e-06,  1.3344e-05, -5.2254e-06,  ...,  8.4527e-06,
            2.6703e-05, -5.3671e-06],
          ...,
          [-7.0858e-06,  1.8720e-05,  3.4165e-05,  ...,  4.5147e-05,
           -1.3308e-05,  6.0967e-06],
          [-9.6366e-06, -9.5366e-06,  2.2435e-06,  ..., -1.2558e-05,
           -1.4808e-05, -9.1815e-07],
          [-6.2557e-06,  2.3568e-06,  5.1325e-06,  ..., -1.0216e-05,
           -2.1946e-06,  6.0370e-06]],

         [[ 2.9317e-06,  4.9716e-06, -4.3850e-06,  ...,  5.1719e-06,
           -5.8648e-06,  4.2211e-06],
          [ 5.1859e-06, -1.2475e-06,  6.7536e-06,  ...,  1.4264e-05,
           -4.1404e-05, -5.6414e-06],
          [ 1.4794e-05, -4.1853e-07,  5.4534e-06,  ..., -3.2889e-06,
            2.1813e-05, -9.5895e-06],
          ...,
          [-2.0185e-05, -9.7593e-06, -5.9979e-06,  ..., -1.0692e-06,
            5.3108e-06,  3.4110e-06],
          [-3.8727e-06,  1.0058e-05,  7.6073e-06,  ..., -2.8013e-05,
           -1.8508e-05, -5.7553e-06],
          [ 6.3663e-06, -9.1505e-06,  4.7408e-06,  ...,  2.0374e-05,
            9.5472e-06, -3.3316e-06]],

         ...,

         [[ 9.9108e-06,  9.3231e-06, -1.2393e-05,  ..., -9.5848e-06,
           -4.3422e-06,  4.7937e-06],
          [ 4.5390e-06,  2.6272e-05,  9.7669e-06,  ..., -2.1165e-06,
            2.6490e-05,  5.2039e-06],
          [ 2.6820e-06, -1.1017e-05, -2.7289e-05,  ..., -1.8743e-05,
           -1.4021e-05, -1.2104e-05],
          ...,
          [-2.0495e-05, -1.3323e-05,  7.0651e-06,  ...,  4.0952e-05,
            2.5971e-05, -9.7421e-06],
          [ 6.2991e-06,  6.0568e-06,  8.2165e-06,  ...,  1.8018e-05,
            5.1601e-06,  4.2694e-06],
          [ 4.1223e-06, -3.3365e-08, -4.7880e-06,  ..., -8.4724e-06,
           -7.8529e-06,  7.6447e-06]],

         [[-2.0514e-06, -2.7442e-07, -4.1968e-06,  ...,  1.1921e-06,
            2.3627e-06,  4.0448e-06],
          [ 5.0860e-06, -9.2254e-06,  2.4924e-05,  ...,  1.3524e-05,
            7.1146e-06,  5.4797e-06],
          [ 1.5933e-05, -2.8935e-05, -5.7474e-05,  ..., -1.0501e-05,
           -7.8900e-06, -6.0313e-06],
          ...,
          [ 6.6648e-06,  9.1546e-06,  2.8482e-06,  ..., -1.1182e-06,
            7.9779e-06, -6.0200e-07],
          [-1.0517e-06, -7.8809e-07,  1.7913e-06,  ..., -2.9416e-05,
           -9.9135e-06,  7.7634e-06],
          [ 2.2879e-06,  5.9480e-06,  7.5481e-06,  ...,  1.2498e-05,
            4.2011e-06, -1.6062e-06]],

         [[-4.6937e-06, -3.1173e-07, -1.2225e-05,  ...,  9.0242e-06,
           -4.4921e-06,  2.9192e-06],
          [ 6.5376e-06,  7.0987e-06, -1.0823e-05,  ...,  2.3456e-06,
            9.1806e-06, -1.0983e-05],
          [ 1.0253e-06,  4.0464e-06, -2.1146e-05,  ..., -7.5813e-06,
           -2.8795e-05,  3.8867e-06],
          ...,
          [-1.5682e-06,  6.3680e-06, -2.1730e-05,  ..., -1.3455e-05,
           -1.7785e-06,  5.3070e-06],
          [-1.4894e-05, -4.8403e-07, -6.9215e-06,  ...,  1.9515e-05,
            8.3848e-07, -3.2339e-06],
          [-1.3482e-06,  2.1336e-06, -3.8250e-06,  ..., -6.8213e-06,
           -3.3895e-06, -3.3688e-07]]],


        [[[ 1.9242e-06, -3.4289e-06,  1.0280e-05,  ...,  5.2230e-06,
            7.0631e-06,  1.6930e-07],
          [-2.2964e-06, -2.1788e-05, -9.2710e-06,  ..., -2.0207e-05,
            5.7885e-06, -3.5297e-07],
          [-7.0610e-06, -5.2912e-07, -3.8026e-06,  ...,  6.3504e-06,
           -5.9127e-06,  6.4699e-06],
          ...,
          [-3.3371e-07,  1.7858e-05,  1.5776e-05,  ..., -3.5322e-05,
           -6.8785e-06,  1.9375e-05],
          [ 2.9208e-06,  1.6254e-05, -9.9992e-06,  ..., -5.4380e-06,
           -1.3457e-05,  2.5204e-06],
          [-7.7439e-07, -1.1053e-05,  1.2606e-05,  ..., -1.6844e-05,
           -1.4941e-05,  1.6463e-06]],

         [[ 7.5380e-07,  4.2852e-06, -7.0966e-06,  ..., -2.0560e-05,
           -1.4372e-05, -4.4410e-07],
          [-1.6920e-05,  1.2775e-05,  5.3853e-06,  ...,  2.1252e-05,
           -1.5804e-05, -7.6110e-06],
          [-6.9201e-06, -1.1981e-06,  2.3556e-05,  ..., -4.3691e-05,
            6.6829e-06, -9.2905e-06],
          ...,
          [-1.1236e-06, -4.1020e-06, -1.7713e-05,  ..., -2.8511e-05,
            4.4709e-06,  1.5727e-05],
          [-4.1486e-07, -2.3880e-05,  8.4689e-06,  ...,  8.5312e-06,
            1.5042e-05, -2.6845e-06],
          [-1.2197e-06,  2.3554e-06, -1.7823e-05,  ..., -3.1231e-05,
           -1.2536e-05, -7.3575e-06]],

         [[-4.1708e-06, -1.5982e-06,  2.3831e-06,  ...,  3.3705e-06,
           -1.4688e-05, -9.3466e-06],
          [-9.9281e-06, -2.3769e-06, -1.6185e-05,  ..., -5.0449e-06,
            5.6114e-06,  4.1019e-06],
          [-1.1766e-06,  2.2714e-06,  1.6734e-05,  ..., -2.1567e-05,
           -1.0090e-05,  3.6548e-06],
          ...,
          [-9.3104e-06,  1.8076e-05, -1.2931e-05,  ..., -3.0576e-05,
            9.8086e-07,  2.0991e-05],
          [ 3.3605e-06,  8.2781e-06, -2.5999e-05,  ...,  3.0374e-06,
           -7.2280e-06,  1.8967e-06],
          [ 3.0150e-07,  9.8351e-06, -5.7826e-06,  ..., -2.7844e-06,
            7.7727e-06, -6.5799e-06]],

         ...,

         [[ 2.9864e-06, -6.5490e-07,  1.0587e-05,  ..., -3.7625e-06,
            1.1768e-05, -2.9133e-06],
          [-3.8799e-06,  1.3562e-06,  3.0947e-06,  ...,  3.1811e-05,
           -2.0618e-05,  4.5587e-06],
          [ 4.6971e-06,  1.1553e-05, -2.2766e-05,  ...,  1.0560e-05,
            1.0710e-05, -1.1202e-05],
          ...,
          [ 2.1892e-07,  4.0589e-05, -8.5241e-06,  ...,  1.9824e-05,
           -4.2811e-07,  4.5427e-07],
          [-9.7825e-06,  2.4167e-06, -2.2091e-05,  ..., -1.0698e-05,
            1.1297e-05, -4.1683e-06],
          [ 1.0453e-06, -6.7225e-06, -8.7533e-06,  ...,  1.2079e-05,
            4.6337e-06, -1.1808e-05]],

         [[-1.7295e-06, -1.3895e-06, -2.8879e-06,  ..., -5.3645e-06,
           -2.3536e-07, -3.5071e-06],
          [-1.0121e-05,  4.3384e-06,  2.8528e-06,  ..., -1.1446e-06,
            1.6309e-06, -2.1807e-06],
          [ 2.5066e-05,  1.7414e-05, -2.2270e-05,  ...,  2.2578e-06,
           -4.3071e-05, -3.4524e-06],
          ...,
          [-1.4378e-05, -1.1764e-05, -2.8231e-05,  ..., -1.1792e-06,
           -2.1877e-05, -2.3843e-07],
          [-6.9942e-06,  1.4500e-05, -2.3885e-05,  ...,  3.3075e-05,
            3.0803e-05, -8.7314e-06],
          [ 1.5109e-06,  1.3362e-05,  4.3713e-06,  ..., -3.0845e-05,
           -2.2590e-05,  9.2039e-06]],

         [[-2.7975e-07, -2.0032e-06, -1.4502e-05,  ...,  2.3127e-06,
           -8.4382e-06, -4.6085e-06],
          [-4.0690e-07,  6.3907e-06,  4.1588e-06,  ...,  9.7213e-06,
            5.1563e-06,  6.4269e-06],
          [ 6.9955e-07,  1.8652e-05,  1.3573e-05,  ..., -1.0738e-05,
            4.3835e-06,  3.8616e-07],
          ...,
          [-8.7335e-06,  5.3332e-06, -1.9954e-05,  ...,  1.7161e-05,
           -1.2065e-05, -1.9183e-05],
          [ 2.3210e-06, -1.2125e-06,  6.2189e-08,  ...,  1.4628e-05,
            7.4457e-06, -9.2624e-06],
          [-9.8444e-07,  5.6000e-06,  8.5696e-06,  ..., -1.0837e-06,
           -1.3370e-05, -3.7542e-06]]],


        ...,


        [[[-5.6821e-06, -6.0321e-06,  7.8079e-06,  ...,  1.5087e-05,
           -3.1687e-06, -5.1945e-06],
          [ 1.3090e-06,  5.5080e-07, -2.3644e-05,  ..., -1.8921e-05,
           -1.5506e-05,  8.7839e-06],
          [ 1.5480e-06, -2.9876e-05,  1.7672e-05,  ...,  4.2805e-05,
           -2.0097e-05, -3.3839e-06],
          ...,
          [ 1.8824e-05,  1.4209e-06,  1.1531e-05,  ..., -2.2437e-05,
           -2.6021e-05, -1.7061e-05],
          [ 1.4931e-06, -1.7588e-05, -6.4131e-06,  ...,  3.0594e-06,
           -1.4360e-06, -1.7600e-06],
          [-1.2827e-06, -1.4430e-05,  4.6912e-06,  ...,  1.1561e-05,
           -9.4752e-06,  3.9846e-06]],

         [[ 9.3543e-06, -1.2483e-05,  2.7008e-07,  ..., -5.2500e-06,
           -1.5515e-06,  8.7379e-06],
          [ 1.8654e-06,  1.1036e-05,  2.5385e-05,  ..., -1.3316e-05,
           -1.9854e-05, -6.0329e-06],
          [-1.1756e-05,  1.3643e-05,  1.9640e-05,  ...,  4.8334e-06,
            3.1851e-05,  1.5318e-05],
          ...,
          [ 1.7489e-06, -2.2453e-05,  7.1696e-06,  ..., -2.1800e-06,
            9.8223e-06,  1.3082e-05],
          [ 4.8763e-06, -7.3571e-06, -8.8228e-07,  ..., -1.4895e-05,
           -7.1757e-06,  2.5901e-06],
          [-1.3801e-05,  3.4773e-06, -5.1446e-06,  ..., -5.9225e-06,
            4.1913e-06,  5.9545e-06]],

         [[-3.8572e-06, -2.0249e-06, -1.8502e-05,  ..., -1.2819e-05,
            4.9782e-06,  6.1203e-07],
          [ 1.5590e-06, -1.4996e-05, -7.4014e-07,  ..., -7.5170e-06,
           -3.6766e-06,  1.6224e-05],
          [-5.1983e-06, -7.5511e-06,  4.7277e-05,  ..., -7.0668e-06,
           -8.6626e-06, -3.1252e-06],
          ...,
          [-2.1749e-06, -1.1132e-05, -3.2275e-05,  ...,  7.8605e-06,
            3.5433e-06, -2.5401e-06],
          [ 9.1894e-06,  4.6401e-05,  4.9869e-06,  ..., -6.3751e-06,
            1.3018e-05,  1.3206e-05],
          [ 5.0851e-06,  2.5571e-06,  7.1049e-06,  ..., -1.4330e-05,
           -1.2102e-05, -2.5354e-07]],

         ...,

         [[ 9.7581e-07,  1.7026e-06, -1.5788e-05,  ...,  2.3521e-05,
            3.4199e-07, -1.0957e-05],
          [-8.6949e-07,  1.0027e-05,  2.1978e-05,  ..., -3.2979e-05,
           -1.0494e-05,  2.1621e-05],
          [ 1.4226e-05,  1.4457e-06, -1.6297e-05,  ...,  1.8300e-05,
            1.5827e-05,  6.3469e-06],
          ...,
          [-6.2737e-06,  5.5562e-05, -2.4336e-05,  ...,  2.7555e-05,
            6.6069e-06,  1.7756e-05],
          [-8.8477e-07, -3.3375e-06, -1.4629e-05,  ..., -2.1263e-05,
            2.9387e-06,  4.1717e-07],
          [ 5.2617e-06, -1.6384e-05, -1.5504e-05,  ...,  6.4166e-06,
           -4.2974e-06, -4.4118e-06]],

         [[ 2.1608e-06,  6.9829e-06, -2.9695e-07,  ...,  3.1214e-06,
           -7.7229e-06, -1.1654e-06],
          [ 7.3046e-06, -3.0753e-06, -1.0631e-05,  ...,  1.6759e-05,
            6.3324e-06, -2.3774e-06],
          [ 8.7688e-06, -8.4689e-06, -4.8944e-05,  ..., -3.3983e-05,
           -1.1146e-05, -5.3697e-06],
          ...,
          [ 1.7925e-05, -5.1971e-06, -3.3533e-05,  ..., -1.8594e-06,
           -1.1190e-05, -9.4653e-06],
          [ 2.6572e-06, -8.6901e-06, -1.8400e-06,  ..., -1.2438e-05,
            1.5071e-05, -8.9543e-06],
          [-4.4468e-06,  9.1719e-06, -4.9863e-06,  ...,  1.2614e-06,
            5.0824e-06,  1.2145e-05]],

         [[ 2.0283e-06, -9.0387e-06, -1.0896e-05,  ..., -4.6637e-06,
           -1.2447e-06,  8.4905e-07],
          [ 1.8489e-06,  1.4653e-05,  6.3242e-06,  ...,  4.7629e-06,
            8.7417e-06, -1.1342e-05],
          [ 3.8972e-06,  1.4897e-05,  3.1291e-05,  ..., -9.3981e-06,
           -4.4734e-06,  3.0398e-06],
          ...,
          [ 3.7053e-06, -1.5012e-05,  5.5485e-06,  ...,  6.6989e-06,
           -1.0928e-05,  3.4960e-07],
          [ 8.0517e-06,  2.8089e-05, -1.1580e-05,  ..., -4.4144e-05,
            3.8978e-05, -1.4085e-05],
          [ 7.7448e-08, -7.8497e-06, -4.9760e-06,  ...,  6.9925e-06,
           -2.3375e-06,  4.7663e-06]]],


        [[[ 9.1844e-07,  1.3861e-05, -1.3117e-05,  ..., -2.3679e-05,
            1.7267e-07, -2.8725e-06],
          [-1.6931e-05,  2.8803e-05,  1.5441e-05,  ..., -6.6168e-06,
            8.2923e-06,  4.6802e-06],
          [ 2.6309e-06, -3.0465e-05, -3.2141e-05,  ..., -2.0378e-05,
            2.5076e-05, -4.4322e-06],
          ...,
          [ 2.8190e-07,  1.3213e-05,  1.3411e-05,  ...,  7.3901e-06,
            2.5810e-05,  1.7426e-05],
          [ 7.7005e-06, -7.3935e-06, -9.2385e-06,  ...,  5.3163e-07,
            1.5385e-05, -2.6338e-06],
          [-5.9729e-06,  1.5435e-05,  6.0690e-06,  ..., -6.7859e-06,
            5.6300e-06,  2.1290e-06]],

         [[-5.6640e-06, -9.4820e-06, -1.6596e-05,  ..., -7.7187e-06,
            1.5455e-06,  6.5560e-06],
          [-4.3702e-06, -3.6571e-05,  6.3220e-06,  ...,  3.3219e-05,
            2.3385e-05,  4.4738e-07],
          [-4.6941e-06, -1.9102e-05, -3.5930e-05,  ...,  9.7922e-06,
           -3.0758e-06,  1.0325e-06],
          ...,
          [ 8.2739e-07, -9.5505e-07, -2.6404e-06,  ..., -1.3972e-05,
           -2.5792e-05, -6.6280e-06],
          [-1.0248e-05,  1.5971e-05,  1.6062e-05,  ...,  4.1853e-06,
           -4.9680e-06,  1.6203e-06],
          [-1.3287e-06, -1.7111e-05, -2.3195e-05,  ..., -6.2945e-06,
            9.1769e-06, -3.7569e-06]],

         [[ 6.4432e-08, -1.2353e-06,  1.5730e-05,  ...,  5.4836e-06,
            1.2335e-05,  4.5559e-07],
          [-2.1624e-06, -4.8927e-06,  1.4594e-05,  ..., -1.7548e-05,
            8.2050e-06, -6.3112e-06],
          [-6.8110e-06, -1.5231e-06, -6.6013e-06,  ..., -2.1259e-05,
           -5.7525e-06, -7.5180e-06],
          ...,
          [-8.2743e-06, -1.3955e-05,  3.5914e-05,  ..., -3.9262e-06,
           -1.5949e-05, -4.3413e-06],
          [ 2.3994e-07, -1.4571e-05,  1.6186e-05,  ..., -7.9587e-06,
            1.4997e-05, -5.5248e-06],
          [-7.3873e-08, -2.3007e-06,  1.2874e-05,  ...,  1.7921e-05,
           -1.7728e-05, -5.0413e-06]],

         ...,

         [[-1.2262e-05, -2.5064e-05, -3.9537e-07,  ...,  5.2106e-07,
            7.0287e-06, -6.6199e-06],
          [ 4.1269e-06, -2.4579e-05,  1.1964e-05,  ..., -9.3497e-06,
           -1.6139e-06,  3.3125e-06],
          [-2.2984e-07, -1.1781e-05, -4.1601e-05,  ...,  7.4483e-06,
            1.7071e-05,  1.6204e-06],
          ...,
          [ 2.1221e-06,  9.4260e-06,  2.1623e-05,  ...,  1.6364e-05,
           -1.2398e-05,  1.8816e-05],
          [ 1.5612e-05, -1.3338e-05,  1.5278e-05,  ..., -1.8907e-05,
            1.3752e-05,  6.5181e-06],
          [ 2.5780e-06,  8.7186e-06, -2.4857e-06,  ..., -7.7126e-06,
           -1.7856e-05,  2.3461e-06]],

         [[-6.2330e-06,  2.6935e-06, -2.0475e-06,  ..., -3.7557e-06,
            2.8539e-06,  8.5848e-06],
          [-2.7886e-06, -1.4170e-05, -5.1257e-06,  ...,  2.0123e-05,
            4.4791e-06, -8.5360e-07],
          [ 5.3538e-06,  1.7357e-05, -2.5424e-06,  ...,  1.6908e-06,
           -1.5629e-06, -7.6947e-06],
          ...,
          [ 3.8068e-06,  3.7418e-06, -1.4700e-05,  ...,  1.0368e-05,
            1.2858e-05,  7.9062e-06],
          [ 6.0649e-06, -1.0208e-05, -8.1353e-06,  ..., -3.1776e-05,
            1.1031e-05,  1.4376e-05],
          [ 9.3832e-06,  2.3402e-07,  9.5854e-06,  ..., -2.0441e-06,
           -1.0883e-06,  1.8520e-06]],

         [[-8.6084e-06, -1.9953e-05,  7.2465e-06,  ..., -4.4582e-06,
            4.0488e-06,  9.4349e-07],
          [-9.1428e-06,  2.2867e-06,  8.3447e-07,  ...,  5.5774e-06,
           -1.4123e-05,  2.9443e-07],
          [ 1.3549e-05, -5.4158e-07,  1.1163e-05,  ..., -3.9628e-06,
           -4.0793e-06, -5.0108e-06],
          ...,
          [-1.6882e-05,  3.0271e-05, -2.7687e-06,  ..., -3.9392e-06,
           -3.1628e-06, -9.8675e-06],
          [-2.6669e-06, -1.8886e-05,  9.5347e-06,  ...,  3.9210e-06,
            1.4090e-05, -3.7238e-06],
          [ 5.4672e-07,  1.0672e-05,  2.1477e-05,  ...,  1.2234e-05,
            9.1738e-06,  5.1587e-06]]],


        [[[ 1.8140e-06,  1.0427e-05, -5.5825e-06,  ...,  8.3494e-06,
           -5.2019e-06, -6.0748e-06],
          [-1.2572e-07, -1.5814e-06, -9.4650e-06,  ...,  1.1091e-05,
            3.9648e-05, -2.5612e-06],
          [ 1.4301e-05, -9.8717e-06, -1.5284e-05,  ...,  1.5420e-05,
            7.6753e-06,  2.9126e-07],
          ...,
          [ 6.7986e-06,  1.6740e-05,  2.1723e-05,  ..., -3.9165e-05,
           -2.4740e-05, -3.9428e-06],
          [ 1.5603e-05, -1.4253e-05,  1.1284e-05,  ...,  8.1843e-06,
            5.0072e-06,  2.1789e-06],
          [ 2.4854e-06,  4.6000e-06, -2.2264e-06,  ..., -8.0517e-06,
            8.5054e-06,  1.9473e-07]],

         [[ 6.2655e-06, -2.7644e-06, -2.6788e-06,  ..., -3.1849e-06,
            7.3904e-06, -5.6177e-06],
          [-2.4817e-06, -2.5969e-05,  1.1387e-05,  ..., -2.1352e-05,
            1.6873e-05,  2.5336e-06],
          [-1.1493e-05, -7.8742e-06, -1.4199e-05,  ..., -1.2530e-05,
           -7.1160e-06,  3.2899e-06],
          ...,
          [ 2.0894e-05,  2.4933e-06, -3.0370e-05,  ...,  1.6156e-05,
            3.4599e-05,  4.1126e-06],
          [-1.8740e-05, -1.4289e-05, -3.1876e-05,  ...,  6.9503e-06,
           -1.4323e-05, -9.6816e-07],
          [ 4.0305e-06,  1.4051e-06,  1.1077e-06,  ..., -6.4439e-06,
            1.8205e-06,  5.4160e-06]],

         [[-1.0077e-06,  6.5187e-06, -8.9126e-06,  ..., -1.2675e-05,
            1.8447e-06, -3.6224e-06],
          [ 1.3614e-05, -3.3754e-06, -2.2903e-05,  ..., -2.0066e-05,
           -8.2120e-06,  7.2616e-06],
          [ 3.9624e-06, -2.0242e-05,  6.1757e-06,  ...,  1.8515e-05,
            1.6004e-05,  1.5241e-05],
          ...,
          [ 4.2577e-06,  1.0038e-05, -7.7179e-06,  ..., -2.0023e-05,
           -3.7643e-05,  1.8576e-05],
          [ 8.2301e-06,  7.9769e-07,  6.4949e-07,  ...,  2.2023e-06,
            7.3606e-06,  2.7306e-06],
          [ 1.0740e-06,  4.4002e-06,  4.8504e-06,  ...,  1.1075e-05,
           -5.6292e-06, -6.9426e-07]],

         ...,

         [[ 7.7417e-06, -1.8722e-05,  4.9334e-06,  ...,  4.9510e-06,
            3.5108e-06,  2.4693e-06],
          [ 6.1195e-06, -1.8462e-05,  4.2046e-06,  ..., -3.2491e-06,
           -2.5092e-06,  7.3476e-07],
          [-1.1436e-05,  7.6561e-06,  1.3442e-05,  ..., -1.9879e-05,
            1.1853e-05,  5.3542e-06],
          ...,
          [-1.3941e-05,  7.7446e-06, -5.3177e-06,  ..., -6.2232e-06,
            9.3934e-07,  1.1781e-05],
          [ 7.1980e-07,  7.1442e-06, -5.0123e-05,  ...,  1.6630e-05,
            1.3414e-06, -6.7705e-06],
          [-3.2172e-06,  8.5758e-06, -7.9871e-06,  ...,  7.7484e-06,
           -2.3757e-06, -3.6906e-06]],

         [[-6.0521e-06, -1.1673e-05, -6.5226e-06,  ..., -2.9849e-05,
            5.8319e-06,  1.8020e-06],
          [-2.5277e-06, -2.5122e-05,  1.1691e-05,  ...,  1.3833e-05,
           -3.5914e-06,  1.1751e-05],
          [ 2.0556e-05,  2.7393e-05,  3.4455e-05,  ..., -1.7230e-05,
           -6.4699e-06,  9.6900e-06],
          ...,
          [-1.3273e-05,  9.0580e-07,  8.3617e-07,  ...,  3.8811e-06,
            1.0929e-05, -4.1962e-06],
          [-5.8576e-06, -4.3105e-06,  2.4326e-05,  ..., -2.4704e-05,
           -5.5102e-06,  2.5873e-06],
          [ 1.4838e-06,  1.4800e-05,  1.7590e-05,  ...,  1.8635e-05,
            8.6495e-06,  6.6195e-06]],

         [[-5.7550e-06, -1.1512e-05, -3.6307e-06,  ..., -3.4405e-06,
            2.1877e-06,  9.1514e-06],
          [-4.3674e-06, -5.5136e-06,  5.2358e-06,  ...,  2.2321e-06,
           -7.3613e-06, -1.1657e-05],
          [-7.2996e-06, -2.0465e-05,  2.4085e-05,  ..., -1.0602e-05,
           -1.3241e-05,  6.0603e-07],
          ...,
          [ 6.9958e-06,  2.2220e-06,  2.0205e-06,  ..., -2.4246e-05,
           -3.5335e-06,  5.2493e-06],
          [-4.3203e-06,  1.5498e-05, -1.7784e-06,  ...,  5.9460e-06,
            1.6387e-05, -6.5222e-06],
          [ 9.1452e-06, -7.4849e-07, -3.2505e-07,  ...,  9.1768e-07,
            8.3573e-06,  7.2983e-06]]]])
2024-11-30 13:26:29,439 - INFO - reading batch[69] client 1
2024-11-30 13:26:29,458 - INFO - reading batch[69] client 2
2024-11-30 13:26:29,481 - INFO - reading batch[69] client 3
2024-11-30 13:26:29,506 - INFO - reading batch[69] client 4
2024-11-30 13:26:29,535 - INFO - reading batch[70] client 1
2024-11-30 13:26:29,559 - INFO - reading batch[70] client 2
2024-11-30 13:26:29,573 - INFO - reading batch[70] client 3
2024-11-30 13:26:29,603 - INFO - reading batch[70] client 4
2024-11-30 13:26:29,626 - INFO - reading batch[71] client 1
2024-11-30 13:26:29,648 - INFO - reading batch[71] client 2
2024-11-30 13:26:29,669 - INFO - reading batch[71] client 3
2024-11-30 13:26:29,688 - INFO - reading batch[71] client 4
2024-11-30 13:26:29,711 - INFO - reading batch[72] client 1
2024-11-30 13:26:29,738 - INFO - reading batch[72] client 2
2024-11-30 13:26:29,762 - INFO - reading batch[72] client 3
2024-11-30 13:26:29,779 - ERROR - backward on partition 4
2024-11-30 13:26:29,780 - CRITICAL - calculate backward $4 on client4
2024-11-30 13:26:29,791 - CRITICAL - new gradient:tensor([[ 4.7585e-04,  3.5115e-04, -2.6226e-04,  ...,  1.8658e-04,
         -6.6210e-04, -4.4688e-04],
        [ 4.8125e-04, -1.4271e-05, -1.6878e-05,  ..., -7.8828e-05,
         -3.6404e-04, -3.2006e-04],
        [ 6.1370e-04,  1.7284e-04, -1.6660e-04,  ...,  5.3469e-05,
          2.1576e-04, -3.8560e-04],
        ...,
        [-4.6841e-04,  4.0791e-04,  3.4233e-04,  ...,  3.7434e-04,
          5.9351e-04,  8.9621e-05],
        [-2.4158e-04,  2.4694e-04, -3.8535e-04,  ..., -2.2538e-04,
          2.1047e-04, -9.2601e-06],
        [-4.6965e-04,  3.9863e-04,  3.3986e-04,  ...,  3.7730e-04,
          6.0462e-04,  9.1546e-05]]) 
 old gradient:tensor([[ 0.0020,  0.0015, -0.0139,  0.0013,  0.0014,  0.0014,  0.0014,  0.0015,
          0.0018,  0.0016],
        [-0.0133,  0.0014,  0.0016,  0.0013,  0.0015,  0.0013,  0.0014,  0.0014,
          0.0019,  0.0015],
        [ 0.0019, -0.0142,  0.0017,  0.0014,  0.0015,  0.0015,  0.0014,  0.0014,
          0.0019,  0.0016],
        [ 0.0021,  0.0014,  0.0017,  0.0013,  0.0015,  0.0015,  0.0015,  0.0014,
         -0.0139,  0.0015],
        [ 0.0019,  0.0015,  0.0017,  0.0013,  0.0014,  0.0016,  0.0015, -0.0141,
          0.0017,  0.0015],
        [ 0.0023,  0.0014,  0.0018,  0.0013,  0.0016,  0.0013, -0.0143,  0.0014,
          0.0017,  0.0015],
        [-0.0135,  0.0014,  0.0018,  0.0013,  0.0015,  0.0014,  0.0015,  0.0015,
          0.0018,  0.0014],
        [ 0.0021,  0.0015,  0.0018,  0.0013, -0.0142,  0.0015,  0.0014,  0.0014,
          0.0018,  0.0014],
        [ 0.0020,  0.0014,  0.0017,  0.0014,  0.0016,  0.0015,  0.0015, -0.0142,
          0.0017,  0.0015],
        [-0.0138,  0.0014,  0.0016,  0.0015,  0.0016,  0.0015,  0.0016,  0.0014,
          0.0017,  0.0015],
        [-0.0136,  0.0014,  0.0016,  0.0013,  0.0017,  0.0014,  0.0016,  0.0014,
          0.0018,  0.0015],
        [ 0.0019,  0.0015,  0.0017, -0.0142,  0.0015,  0.0015,  0.0015,  0.0015,
          0.0017,  0.0015],
        [ 0.0020,  0.0014,  0.0018,  0.0014,  0.0015,  0.0014,  0.0014,  0.0015,
         -0.0138,  0.0015],
        [ 0.0022,  0.0015,  0.0018, -0.0144,  0.0014,  0.0014,  0.0013,  0.0014,
          0.0018,  0.0015],
        [ 0.0021,  0.0014,  0.0018,  0.0013,  0.0016, -0.0143,  0.0013,  0.0014,
          0.0018,  0.0015],
        [ 0.0019, -0.0142,  0.0017,  0.0013,  0.0015,  0.0015,  0.0015,  0.0015,
          0.0017,  0.0016],
        [-0.0136,  0.0013,  0.0017,  0.0014,  0.0016,  0.0014,  0.0016,  0.0013,
          0.0018,  0.0015],
        [ 0.0019,  0.0014,  0.0017,  0.0014, -0.0141,  0.0015,  0.0014,  0.0015,
          0.0018,  0.0015],
        [ 0.0020,  0.0014,  0.0019,  0.0013,  0.0015,  0.0014, -0.0143,  0.0014,
          0.0019,  0.0015],
        [ 0.0021,  0.0014,  0.0018, -0.0143,  0.0017,  0.0014,  0.0014,  0.0015,
          0.0017,  0.0015],
        [ 0.0021,  0.0015, -0.0139,  0.0012,  0.0012,  0.0015,  0.0013,  0.0015,
          0.0020,  0.0015],
        [ 0.0022,  0.0015,  0.0018,  0.0012,  0.0015,  0.0013, -0.0143,  0.0014,
          0.0018,  0.0015],
        [ 0.0022,  0.0015,  0.0018,  0.0013,  0.0016,  0.0013, -0.0143,  0.0014,
          0.0018,  0.0014],
        [ 0.0018,  0.0015,  0.0017,  0.0014,  0.0016,  0.0015,  0.0015, -0.0142,
          0.0017,  0.0015],
        [ 0.0019,  0.0015,  0.0017,  0.0015,  0.0016,  0.0015,  0.0015, -0.0142,
          0.0015,  0.0014],
        [ 0.0017, -0.0142,  0.0016,  0.0014,  0.0016,  0.0015,  0.0016,  0.0015,
          0.0016,  0.0016],
        [ 0.0020,  0.0015,  0.0018,  0.0012,  0.0016,  0.0014, -0.0143,  0.0015,
          0.0018,  0.0014],
        [ 0.0019, -0.0142,  0.0017,  0.0014,  0.0014,  0.0015,  0.0015,  0.0015,
          0.0017,  0.0016],
        [ 0.0023,  0.0016,  0.0017,  0.0013,  0.0014,  0.0014,  0.0012,  0.0014,
         -0.0137,  0.0015],
        [ 0.0020, -0.0142,  0.0017,  0.0013,  0.0015,  0.0015,  0.0015,  0.0015,
          0.0016,  0.0015],
        [-0.0134,  0.0014,  0.0017,  0.0013,  0.0015,  0.0014,  0.0013,  0.0015,
          0.0019,  0.0014],
        [-0.0133,  0.0014,  0.0018,  0.0013,  0.0015,  0.0014,  0.0013,  0.0014,
          0.0019,  0.0014],
        [ 0.0019,  0.0015,  0.0017,  0.0016,  0.0016,  0.0014,  0.0014, -0.0142,
          0.0017,  0.0015],
        [ 0.0018,  0.0015,  0.0017,  0.0015,  0.0015,  0.0015,  0.0015, -0.0142,
          0.0016,  0.0016],
        [ 0.0019,  0.0015,  0.0017, -0.0143,  0.0015,  0.0014,  0.0015,  0.0015,
          0.0018,  0.0015],
        [ 0.0020,  0.0015, -0.0140,  0.0013,  0.0014,  0.0015,  0.0013,  0.0015,
          0.0019,  0.0016],
        [ 0.0018,  0.0014,  0.0017,  0.0015,  0.0014,  0.0014,  0.0014, -0.0141,
          0.0018,  0.0015],
        [ 0.0022,  0.0015,  0.0019,  0.0012,  0.0015,  0.0014, -0.0143,  0.0014,
          0.0018,  0.0015],
        [ 0.0018, -0.0142,  0.0016,  0.0014,  0.0015,  0.0016,  0.0016,  0.0015,
          0.0016,  0.0016],
        [ 0.0021,  0.0015, -0.0139,  0.0012,  0.0015,  0.0013,  0.0014,  0.0015,
          0.0019,  0.0014],
        [ 0.0018, -0.0142,  0.0017,  0.0014,  0.0016,  0.0015,  0.0016,  0.0015,
          0.0017,  0.0016],
        [ 0.0019, -0.0141,  0.0017,  0.0014,  0.0015,  0.0015,  0.0015,  0.0015,
          0.0016,  0.0015],
        [ 0.0020,  0.0015,  0.0017,  0.0013,  0.0014,  0.0015,  0.0015, -0.0142,
          0.0017,  0.0016],
        [ 0.0021,  0.0015,  0.0018,  0.0014,  0.0014,  0.0014,  0.0014,  0.0014,
          0.0017, -0.0141],
        [ 0.0020,  0.0014,  0.0017,  0.0013,  0.0015, -0.0142,  0.0014,  0.0014,
          0.0018,  0.0016],
        [-0.0134,  0.0015,  0.0019,  0.0013,  0.0014,  0.0014,  0.0014,  0.0014,
          0.0019,  0.0014],
        [ 0.0021,  0.0014,  0.0018,  0.0013, -0.0141,  0.0014,  0.0013,  0.0014,
          0.0019,  0.0014],
        [ 0.0021,  0.0015,  0.0018,  0.0013,  0.0015,  0.0014, -0.0142,  0.0014,
          0.0018,  0.0015],
        [ 0.0020,  0.0014,  0.0017,  0.0013,  0.0015,  0.0014,  0.0014,  0.0014,
          0.0019, -0.0141],
        [-0.0135,  0.0014,  0.0018,  0.0013,  0.0016,  0.0014,  0.0014,  0.0014,
          0.0017,  0.0015],
        [ 0.0021,  0.0015, -0.0140,  0.0012,  0.0014,  0.0016,  0.0014,  0.0015,
          0.0018,  0.0015],
        [ 0.0019, -0.0141,  0.0017,  0.0013,  0.0014,  0.0015,  0.0015,  0.0015,
          0.0017,  0.0016],
        [ 0.0018, -0.0142,  0.0017,  0.0014,  0.0015,  0.0015,  0.0015,  0.0014,
          0.0018,  0.0016],
        [ 0.0020,  0.0014,  0.0017,  0.0014,  0.0015, -0.0142,  0.0014,  0.0015,
          0.0017,  0.0016],
        [ 0.0020,  0.0015,  0.0018,  0.0013,  0.0016,  0.0015, -0.0142,  0.0015,
          0.0017,  0.0015],
        [ 0.0019,  0.0016,  0.0017,  0.0014,  0.0014,  0.0016,  0.0015, -0.0142,
          0.0016,  0.0016],
        [ 0.0019, -0.0142,  0.0017,  0.0013,  0.0015,  0.0014,  0.0014,  0.0014,
          0.0019,  0.0015],
        [ 0.0018, -0.0142,  0.0017,  0.0013,  0.0015,  0.0015,  0.0015,  0.0015,
          0.0017,  0.0015],
        [ 0.0020,  0.0014,  0.0017,  0.0014,  0.0015,  0.0014,  0.0015,  0.0015,
         -0.0138,  0.0015],
        [ 0.0019,  0.0015,  0.0017,  0.0014,  0.0015,  0.0014,  0.0015,  0.0014,
          0.0016, -0.0141],
        [ 0.0020,  0.0014,  0.0016, -0.0142,  0.0016,  0.0015,  0.0015,  0.0016,
          0.0017,  0.0015],
        [ 0.0021,  0.0015,  0.0018,  0.0012,  0.0015,  0.0014, -0.0143,  0.0014,
          0.0018,  0.0015],
        [ 0.0021,  0.0015,  0.0016,  0.0013,  0.0015,  0.0014,  0.0014,  0.0015,
         -0.0138,  0.0015],
        [ 0.0021,  0.0013,  0.0020,  0.0013,  0.0015,  0.0013, -0.0142,  0.0015,
          0.0018,  0.0014]])
2024-11-30 13:26:29,791 - INFO - reading batch[72] client 4
2024-11-30 13:26:29,816 - INFO - reading batch[73] client 1
2024-11-30 13:26:29,835 - INFO - reading batch[73] client 2
2024-11-30 13:26:29,854 - INFO - reading batch[73] client 3
2024-11-30 13:26:29,877 - INFO - reading batch[73] client 4
2024-11-30 13:26:29,904 - INFO - reading batch[74] client 1
2024-11-30 13:26:29,921 - INFO - reading batch[74] client 2
2024-11-30 13:26:29,948 - INFO - reading batch[74] client 3
2024-11-30 13:26:29,980 - INFO - reading batch[74] client 4
2024-11-30 13:26:30,009 - INFO - reading batch[75] client 1
2024-11-30 13:26:30,038 - INFO - reading batch[75] client 2
2024-11-30 13:26:30,054 - INFO - reading batch[75] client 3
2024-11-30 13:26:30,067 - ERROR - backward on partition 4
2024-11-30 13:26:30,068 - CRITICAL - calculate backward $4 on client4
2024-11-30 13:26:30,074 - CRITICAL - new gradient:tensor([[ 0.0011,  0.0005, -0.0004,  ...,  0.0002, -0.0004, -0.0008],
        [ 0.0002,  0.0002, -0.0004,  ..., -0.0003, -0.0001, -0.0003],
        [ 0.0012,  0.0003, -0.0003,  ...,  0.0001,  0.0004, -0.0008],
        ...,
        [-0.0006,  0.0008,  0.0009,  ...,  0.0006,  0.0009,  0.0005],
        [-0.0004,  0.0004, -0.0002,  ..., -0.0010, -0.0002,  0.0006],
        [-0.0006,  0.0008,  0.0009,  ...,  0.0006,  0.0009,  0.0005]]) 
 old gradient:tensor([[ 0.0021, -0.0142,  0.0018,  0.0014,  0.0015,  0.0014,  0.0014,  0.0013,
          0.0019,  0.0015],
        [ 0.0021,  0.0014,  0.0017,  0.0013,  0.0015,  0.0014,  0.0014,  0.0014,
         -0.0138,  0.0015],
        [ 0.0019, -0.0142,  0.0017,  0.0014,  0.0015,  0.0015,  0.0015,  0.0015,
          0.0017,  0.0016],
        [ 0.0021,  0.0015,  0.0015, -0.0142,  0.0014,  0.0014,  0.0014,  0.0015,
          0.0019,  0.0015],
        [ 0.0021,  0.0014,  0.0017,  0.0014,  0.0016,  0.0013, -0.0143,  0.0014,
          0.0019,  0.0015],
        [ 0.0020, -0.0142,  0.0017,  0.0013,  0.0015,  0.0014,  0.0015,  0.0015,
          0.0018,  0.0016],
        [-0.0134,  0.0014,  0.0018,  0.0013,  0.0014,  0.0013,  0.0014,  0.0015,
          0.0018,  0.0014],
        [ 0.0021,  0.0015,  0.0018,  0.0014, -0.0141,  0.0014,  0.0014,  0.0014,
          0.0017,  0.0014],
        [ 0.0020,  0.0015,  0.0017,  0.0015,  0.0016,  0.0014,  0.0016,  0.0014,
          0.0016, -0.0142],
        [ 0.0019,  0.0015,  0.0018,  0.0014,  0.0015,  0.0015,  0.0015, -0.0142,
          0.0016,  0.0015],
        [ 0.0020,  0.0014,  0.0019,  0.0013,  0.0015,  0.0014, -0.0142,  0.0015,
          0.0017,  0.0015],
        [-0.0134,  0.0014,  0.0017,  0.0013,  0.0015,  0.0013,  0.0015,  0.0014,
          0.0019,  0.0015],
        [-0.0134,  0.0014,  0.0016,  0.0014,  0.0015,  0.0013,  0.0014,  0.0014,
          0.0019,  0.0015],
        [ 0.0019,  0.0015,  0.0018,  0.0014,  0.0016, -0.0142,  0.0015,  0.0014,
          0.0017,  0.0015],
        [ 0.0020,  0.0014,  0.0017,  0.0014,  0.0016, -0.0142,  0.0014,  0.0014,
          0.0018,  0.0015],
        [ 0.0021,  0.0014,  0.0019,  0.0014,  0.0016,  0.0013, -0.0142,  0.0015,
          0.0017,  0.0014],
        [ 0.0020,  0.0014,  0.0018,  0.0014,  0.0015,  0.0015,  0.0014,  0.0015,
         -0.0139,  0.0015],
        [ 0.0018, -0.0142,  0.0017,  0.0014,  0.0015,  0.0015,  0.0015,  0.0014,
          0.0018,  0.0016],
        [ 0.0022,  0.0015,  0.0018,  0.0012,  0.0015,  0.0014, -0.0144,  0.0015,
          0.0018,  0.0014],
        [ 0.0020,  0.0014,  0.0017,  0.0014,  0.0015,  0.0015,  0.0014,  0.0015,
          0.0018, -0.0142],
        [ 0.0021,  0.0015,  0.0017,  0.0013, -0.0141,  0.0014,  0.0014,  0.0014,
          0.0017,  0.0015],
        [ 0.0023,  0.0015, -0.0139,  0.0012,  0.0013,  0.0015,  0.0014,  0.0015,
          0.0019,  0.0014],
        [ 0.0022,  0.0015,  0.0017,  0.0013,  0.0015,  0.0013,  0.0014,  0.0014,
         -0.0139,  0.0015],
        [ 0.0022,  0.0013,  0.0017,  0.0015,  0.0015,  0.0014,  0.0013,  0.0014,
          0.0018, -0.0142],
        [-0.0135,  0.0014,  0.0018,  0.0014,  0.0016,  0.0013,  0.0014,  0.0014,
          0.0017,  0.0014],
        [ 0.0019,  0.0015,  0.0018,  0.0014, -0.0140,  0.0015,  0.0014,  0.0015,
          0.0016,  0.0015],
        [-0.0134,  0.0014,  0.0016,  0.0013,  0.0015,  0.0013,  0.0015,  0.0014,
          0.0018,  0.0015],
        [ 0.0024,  0.0015, -0.0140,  0.0012,  0.0014,  0.0015,  0.0013,  0.0014,
          0.0020,  0.0014],
        [ 0.0022,  0.0015,  0.0017,  0.0013,  0.0016, -0.0143,  0.0014,  0.0014,
          0.0018,  0.0015],
        [ 0.0019,  0.0014,  0.0017,  0.0015,  0.0015,  0.0015,  0.0014, -0.0142,
          0.0017,  0.0015],
        [ 0.0021,  0.0014,  0.0018,  0.0014,  0.0014,  0.0014,  0.0015,  0.0014,
         -0.0138,  0.0015],
        [ 0.0023,  0.0014,  0.0018,  0.0013,  0.0014,  0.0014,  0.0015,  0.0015,
         -0.0139,  0.0015],
        [-0.0136,  0.0014,  0.0016,  0.0014,  0.0017,  0.0014,  0.0015,  0.0013,
          0.0018,  0.0016],
        [ 0.0020,  0.0014,  0.0018,  0.0013,  0.0016,  0.0014, -0.0142,  0.0014,
          0.0017,  0.0015],
        [ 0.0020,  0.0013, -0.0137,  0.0014,  0.0015,  0.0015,  0.0013,  0.0014,
          0.0018,  0.0015],
        [ 0.0020,  0.0014, -0.0141,  0.0012,  0.0016,  0.0014,  0.0015,  0.0015,
          0.0019,  0.0015],
        [ 0.0020,  0.0015,  0.0019,  0.0014, -0.0142,  0.0015,  0.0013,  0.0014,
          0.0017,  0.0015],
        [ 0.0020,  0.0014,  0.0018,  0.0013,  0.0015,  0.0014,  0.0014,  0.0014,
          0.0018, -0.0141],
        [ 0.0019, -0.0142,  0.0017,  0.0014,  0.0015,  0.0014,  0.0014,  0.0014,
          0.0019,  0.0015],
        [ 0.0020,  0.0015,  0.0016, -0.0143,  0.0015,  0.0015,  0.0015,  0.0015,
          0.0018,  0.0015],
        [ 0.0019,  0.0015,  0.0017,  0.0013,  0.0015,  0.0015,  0.0015, -0.0141,
          0.0016,  0.0015],
        [ 0.0018, -0.0142,  0.0017,  0.0014,  0.0015,  0.0015,  0.0015,  0.0014,
          0.0018,  0.0016],
        [ 0.0020,  0.0014,  0.0017,  0.0014,  0.0015,  0.0015,  0.0014,  0.0015,
         -0.0139,  0.0015],
        [ 0.0021,  0.0015, -0.0140,  0.0014,  0.0014,  0.0015,  0.0014,  0.0015,
          0.0017,  0.0015],
        [ 0.0023,  0.0016, -0.0139,  0.0012,  0.0014,  0.0013,  0.0013,  0.0014,
          0.0020,  0.0014],
        [ 0.0020,  0.0014,  0.0018,  0.0014,  0.0014,  0.0014,  0.0014,  0.0015,
         -0.0139,  0.0015],
        [ 0.0020,  0.0015,  0.0018,  0.0013, -0.0140,  0.0014,  0.0014,  0.0014,
          0.0017,  0.0015],
        [ 0.0019, -0.0142,  0.0017,  0.0015,  0.0016,  0.0015,  0.0015,  0.0014,
          0.0017,  0.0016],
        [ 0.0021,  0.0016,  0.0017,  0.0014, -0.0142,  0.0014,  0.0014,  0.0014,
          0.0018,  0.0015],
        [ 0.0020,  0.0013,  0.0017,  0.0014,  0.0015,  0.0014,  0.0015,  0.0014,
         -0.0139,  0.0015],
        [ 0.0020,  0.0016, -0.0139,  0.0012,  0.0014,  0.0015,  0.0014,  0.0015,
          0.0018,  0.0015],
        [ 0.0021,  0.0015,  0.0017,  0.0014,  0.0014,  0.0014,  0.0015,  0.0015,
         -0.0138,  0.0015],
        [ 0.0022,  0.0015,  0.0018,  0.0012, -0.0143,  0.0014,  0.0013,  0.0015,
          0.0019,  0.0014],
        [ 0.0020,  0.0014,  0.0017, -0.0142,  0.0016,  0.0014,  0.0015,  0.0015,
          0.0017,  0.0015],
        [ 0.0020,  0.0014,  0.0017,  0.0014,  0.0016, -0.0143,  0.0014,  0.0015,
          0.0017,  0.0015],
        [ 0.0020,  0.0015,  0.0017,  0.0013,  0.0016, -0.0143,  0.0014,  0.0015,
          0.0019,  0.0015],
        [ 0.0019,  0.0015,  0.0017,  0.0014,  0.0016,  0.0014,  0.0015,  0.0015,
          0.0016, -0.0141],
        [ 0.0022,  0.0014,  0.0018,  0.0013, -0.0141,  0.0014,  0.0013,  0.0014,
          0.0018,  0.0014],
        [ 0.0020,  0.0014,  0.0017,  0.0014,  0.0016, -0.0142,  0.0014,  0.0015,
          0.0018,  0.0015],
        [ 0.0022,  0.0015,  0.0018,  0.0013,  0.0015,  0.0014, -0.0143,  0.0014,
          0.0018,  0.0015],
        [ 0.0019,  0.0015,  0.0017,  0.0015,  0.0015,  0.0015,  0.0014, -0.0142,
          0.0016,  0.0016],
        [ 0.0019,  0.0015,  0.0017,  0.0013, -0.0141,  0.0015,  0.0015,  0.0015,
          0.0017,  0.0015],
        [ 0.0019,  0.0015,  0.0016, -0.0143,  0.0015,  0.0015,  0.0015,  0.0016,
          0.0017,  0.0015],
        [ 0.0021,  0.0015,  0.0017,  0.0014, -0.0141,  0.0014,  0.0014,  0.0014,
          0.0018,  0.0014]])
2024-11-30 13:26:30,074 - INFO - reading batch[75] client 4
2024-11-30 13:26:30,103 - INFO - reading batch[76] client 1
2024-11-30 13:26:30,126 - INFO - reading batch[76] client 2
2024-11-30 13:26:30,150 - INFO - reading batch[76] client 3
2024-11-30 13:26:30,176 - INFO - reading batch[76] client 4
2024-11-30 13:26:30,201 - INFO - reading batch[77] client 1
2024-11-30 13:26:30,221 - INFO - reading batch[77] client 2
2024-11-30 13:26:30,235 - INFO - reading batch[77] client 3
2024-11-30 13:26:30,249 - INFO - reading batch[77] client 4
2024-11-30 13:26:30,272 - INFO - reading batch[78] client 1
2024-11-30 13:26:30,295 - INFO - reading batch[78] client 2
2024-11-30 13:26:30,323 - INFO - reading batch[78] client 3
2024-11-30 13:26:30,346 - INFO - reading batch[78] client 4
2024-11-30 13:26:30,359 - INFO - Final partition
2024-11-30 13:26:30,360 - INFO - reading batch[79] client 1
2024-11-30 13:26:30,390 - INFO - reading batch[79] client 2
2024-11-30 13:26:30,411 - INFO - reading batch[79] client 3
2024-11-30 13:26:30,437 - INFO - reading batch[79] client 4
2024-11-30 13:26:30,460 - INFO - reading batch[80] client 1
2024-11-30 13:26:30,483 - INFO - reading batch[80] client 2
2024-11-30 13:26:30,506 - INFO - reading batch[80] client 3
2024-11-30 13:26:30,527 - INFO - reading batch[80] client 4
2024-11-30 13:26:30,551 - INFO - reading batch[81] client 1
2024-11-30 13:26:30,569 - INFO - reading batch[81] client 2
2024-11-30 13:26:30,581 - ERROR - backward on partition 3
2024-11-30 13:26:30,584 - CRITICAL - calculate backward $3 on client3
2024-11-30 13:26:30,593 - CRITICAL - new gradient:tensor([[[[-8.8578e-05, -5.9900e-05, -2.5094e-04,  1.3103e-04],
          [ 1.4279e-04,  1.0002e-04,  6.3677e-05,  6.2708e-05],
          [-6.5452e-05, -7.4625e-05,  3.0518e-05, -1.0906e-04],
          [-9.9273e-05, -1.8741e-04,  1.3545e-04,  4.6222e-06]],

         [[ 5.9681e-05, -2.2742e-04,  3.5946e-05, -1.6998e-04],
          [-3.2052e-05,  9.8501e-05,  1.6639e-04,  3.7985e-05],
          [-8.2103e-05,  3.1030e-04, -4.5018e-06, -7.6695e-05],
          [-8.5290e-05,  7.4470e-05, -1.5139e-04,  1.4816e-04]],

         [[-2.0288e-04,  9.8318e-05,  8.7070e-05, -8.0248e-05],
          [-9.0785e-07,  1.3714e-04, -1.1598e-04,  1.5658e-05],
          [-2.2707e-05, -1.6492e-05,  2.6622e-05, -1.2163e-04],
          [-9.9174e-06,  1.2875e-04,  5.1997e-05,  1.2618e-04]],

         ...,

         [[-1.9326e-06, -1.5971e-04, -9.0448e-05, -2.5147e-05],
          [-1.2666e-04, -5.4358e-05,  6.2143e-05,  1.5332e-04],
          [-2.5906e-04, -2.1237e-05, -2.8164e-04,  1.1606e-04],
          [-1.3648e-04,  2.1608e-04,  6.1150e-05,  1.4940e-04]],

         [[-3.3009e-05,  3.9571e-05, -7.2234e-05, -1.4094e-04],
          [ 4.6946e-05, -7.4410e-05, -3.1606e-05, -1.6614e-04],
          [ 8.7813e-06,  1.2519e-06, -6.5078e-05, -2.2439e-05],
          [-6.6811e-05,  1.0481e-04, -1.0068e-04,  1.0409e-04]],

         [[-1.1335e-04, -1.1492e-04, -1.2527e-04, -3.8521e-05],
          [-1.4965e-04, -9.1718e-06, -1.3609e-04, -1.0985e-04],
          [-2.0227e-04, -6.7528e-05, -5.2827e-06, -7.5181e-05],
          [ 3.5422e-05,  3.2689e-05, -8.6643e-05,  1.2805e-04]]],


        [[[ 1.2767e-04, -2.3658e-05,  1.7335e-05, -4.5140e-06],
          [ 9.7648e-05, -1.8357e-04,  2.1358e-05,  1.5266e-05],
          [-1.8292e-05,  6.4474e-05,  9.9945e-05,  3.0201e-04],
          [ 8.3267e-05,  6.8377e-05, -2.1893e-04, -2.9360e-05]],

         [[-1.2000e-04,  2.6956e-04, -3.0604e-05, -4.8882e-05],
          [-1.6336e-04, -5.4436e-05,  7.1205e-05,  7.2308e-05],
          [ 4.9981e-05,  2.7489e-04,  3.6004e-05,  9.0965e-05],
          [ 1.6889e-04, -9.1480e-05,  1.1539e-04,  4.0839e-05]],

         [[-5.8733e-05, -5.7009e-06, -2.7357e-05, -1.7256e-05],
          [ 5.2596e-05, -1.1043e-04,  1.2953e-04,  7.3354e-05],
          [-1.9303e-04,  3.0695e-05,  7.6868e-05,  8.7160e-05],
          [-6.6836e-05,  1.1583e-04,  6.9126e-05,  1.4370e-04]],

         ...,

         [[-1.0502e-04, -4.2782e-05, -2.3404e-05, -1.0070e-04],
          [-3.3940e-05,  1.4422e-04,  1.0302e-04,  4.9868e-07],
          [-3.9420e-05, -9.5184e-06,  1.1013e-04,  5.8871e-05],
          [-1.1711e-04, -6.4696e-05, -6.0373e-05, -1.0819e-06]],

         [[ 1.4100e-04,  1.8470e-05,  4.6325e-05,  6.2188e-05],
          [ 1.8877e-04,  3.5561e-04, -3.9732e-05, -1.4070e-04],
          [ 1.2720e-05,  1.1460e-04, -5.5840e-05, -1.5835e-04],
          [ 2.5210e-04,  2.8873e-05,  2.4437e-05,  3.2249e-05]],

         [[-1.2173e-04,  1.3413e-04, -3.2669e-05,  4.1134e-05],
          [-4.0449e-05, -7.2251e-05, -1.6964e-05, -2.5795e-04],
          [-1.9860e-04,  8.3161e-05,  1.8708e-04,  1.2994e-04],
          [-7.6029e-05,  2.7557e-04, -4.9503e-05, -1.3246e-04]]],


        [[[-2.1654e-04,  1.0997e-04,  1.0950e-04, -3.3211e-06],
          [-8.5370e-05,  8.1994e-05, -1.5969e-04, -4.9683e-05],
          [-2.7769e-05, -9.5239e-05, -7.0152e-05, -9.4444e-05],
          [ 1.0100e-04, -6.6043e-05,  1.3968e-04,  1.5782e-04]],

         [[-1.4051e-04,  3.5804e-05, -2.6486e-04,  2.1511e-05],
          [ 2.5014e-04, -6.2796e-05,  1.0342e-04,  2.0959e-04],
          [-9.8992e-05, -3.3981e-05,  3.3303e-04, -7.4769e-05],
          [ 4.8542e-05, -3.7052e-05,  6.9707e-05,  2.1642e-04]],

         [[-1.7758e-04,  1.9730e-05, -1.2045e-04, -9.5097e-07],
          [-2.3931e-04, -1.9258e-05,  4.4820e-05, -2.1676e-05],
          [ 1.8252e-04, -4.8659e-05, -8.1322e-05, -1.9236e-04],
          [-8.2754e-05, -1.8126e-05,  7.1119e-05, -1.4109e-04]],

         ...,

         [[ 1.1097e-05, -2.9086e-05, -3.1153e-05,  1.3107e-05],
          [ 1.2269e-04,  7.3965e-05, -9.9826e-05, -3.1306e-04],
          [ 1.7366e-04, -8.5388e-05, -3.6550e-05,  1.9173e-05],
          [ 9.0187e-05, -1.4435e-04, -2.5302e-05,  6.3392e-05]],

         [[ 6.9837e-05, -1.9412e-05,  2.4195e-05, -1.5976e-04],
          [ 2.5397e-05,  4.8903e-05,  2.3364e-04,  1.5270e-04],
          [ 5.3299e-05, -3.5910e-05, -1.1148e-04, -1.3344e-05],
          [ 8.7147e-05,  1.2168e-04,  1.0949e-04, -1.1943e-04]],

         [[ 8.4903e-05,  1.5782e-05,  1.5203e-05, -1.1579e-04],
          [ 1.7170e-05,  3.3343e-05,  1.3134e-06, -1.1529e-04],
          [ 4.7120e-05,  1.0911e-04, -4.2058e-06, -2.0452e-05],
          [-2.8055e-05,  1.6993e-04,  1.8253e-06, -1.1500e-04]]],


        ...,


        [[[ 1.5134e-04,  5.9176e-05, -8.2706e-05,  8.6618e-05],
          [-1.0291e-04,  7.4531e-05,  1.0623e-04, -2.6869e-04],
          [-1.4429e-04, -1.1505e-04, -1.2063e-04,  6.7711e-05],
          [ 1.5879e-04, -3.0942e-06, -1.2415e-04,  2.3890e-05]],

         [[ 1.6541e-04,  1.0682e-04,  2.0120e-06,  5.8059e-05],
          [ 1.4047e-04, -1.6862e-05, -1.1767e-04, -1.6810e-04],
          [ 1.7547e-04, -4.3058e-05, -4.6700e-05, -7.4616e-05],
          [-6.5717e-05, -2.9394e-05, -3.8071e-05, -3.2313e-05]],

         [[ 5.6799e-05,  1.2340e-05, -1.9142e-04,  1.5046e-04],
          [-8.8290e-05,  1.0737e-04, -8.8439e-05,  8.8035e-05],
          [-1.2591e-04, -2.5116e-04, -1.7244e-04,  8.4702e-05],
          [-4.8337e-05, -1.0137e-05,  1.4377e-04, -2.9979e-05]],

         ...,

         [[-7.5692e-05, -4.3553e-05, -6.1672e-05,  1.3585e-04],
          [ 2.2211e-05, -1.2307e-05, -7.8015e-05, -6.9759e-05],
          [ 2.5628e-04,  8.9200e-05,  9.5616e-05, -1.2622e-04],
          [-2.3520e-04, -3.0272e-06,  4.5681e-05, -1.8188e-05]],

         [[-6.3780e-06, -4.9423e-05,  8.6021e-05, -1.2219e-04],
          [-6.1931e-05,  1.3558e-04,  1.7153e-04, -5.8040e-05],
          [-2.0061e-05,  1.1022e-04, -2.4140e-04,  1.3686e-04],
          [-2.0027e-05,  9.4388e-06, -1.5808e-06, -6.8529e-05]],

         [[ 2.7586e-05, -3.5100e-05,  2.0362e-04, -9.9016e-05],
          [ 1.0757e-04, -2.1199e-04, -2.4497e-05,  1.6009e-04],
          [ 1.0875e-04, -1.0292e-04, -6.3956e-05,  2.8214e-05],
          [ 6.2952e-06,  6.4977e-05,  1.0582e-04,  2.3575e-05]]],


        [[[ 7.9110e-05,  1.5717e-05, -2.0204e-05, -1.5576e-04],
          [ 4.4352e-05, -1.0668e-04,  3.6665e-05,  8.3134e-05],
          [ 2.7177e-05,  3.7716e-05, -7.3196e-06,  2.3385e-04],
          [ 7.0427e-05, -3.4658e-05, -1.7357e-04, -1.1900e-04]],

         [[-1.9277e-04,  2.4185e-04,  5.3527e-05, -9.9314e-05],
          [-8.9258e-05, -3.5592e-05,  7.9319e-05,  1.5019e-04],
          [ 6.2324e-05,  2.4363e-04, -4.6021e-06,  9.9704e-05],
          [ 1.3087e-04, -8.6231e-05,  4.0387e-05,  1.1481e-04]],

         [[-9.5959e-05,  1.8116e-05,  5.5121e-05,  6.1617e-05],
          [ 5.9822e-05, -1.7399e-04,  2.2019e-04,  1.0712e-04],
          [-9.8864e-05,  1.2791e-04, -3.0069e-05, -1.7642e-05],
          [-6.7277e-05,  3.0875e-05, -3.8056e-05,  1.8985e-04]],

         ...,

         [[-1.2014e-04,  3.9629e-05, -2.8564e-05,  1.9276e-05],
          [-1.6523e-06,  3.8059e-06,  5.6741e-05, -2.8266e-05],
          [-7.9547e-05, -4.4096e-05,  7.4095e-05,  8.6620e-05],
          [ 1.1833e-05, -1.2284e-04, -1.4971e-04,  2.2831e-05]],

         [[ 1.7409e-04,  4.0131e-06,  6.4182e-06,  4.2721e-05],
          [ 2.8238e-04,  3.3485e-04, -8.4663e-05, -1.7418e-04],
          [-1.0708e-04,  6.9430e-05, -1.9950e-04, -1.6313e-04],
          [ 2.6170e-04,  4.7870e-05, -4.7681e-05,  8.5140e-05]],

         [[-1.3033e-04,  1.3754e-04, -7.8873e-05,  1.0294e-04],
          [-1.3380e-04, -9.9312e-05,  2.1218e-05, -3.8742e-04],
          [-1.1554e-04,  3.1374e-05,  1.6330e-04,  1.1547e-04],
          [-2.0544e-04,  2.4873e-04, -1.3901e-04, -6.2261e-05]]],


        [[[-9.1610e-05,  3.0881e-04, -1.5556e-04,  4.2639e-05],
          [-1.5248e-04, -1.5909e-05,  4.6321e-05,  8.5726e-05],
          [-1.5706e-04,  1.3488e-04,  1.5064e-04, -8.8131e-05],
          [ 9.2074e-05,  2.3590e-04,  8.9705e-05,  9.9399e-05]],

         [[-1.0328e-04,  1.7263e-04, -7.2642e-05, -4.7550e-05],
          [-1.0895e-04,  8.9068e-05,  8.1956e-05,  9.2116e-05],
          [ 1.7384e-04,  1.0583e-04,  4.5269e-06,  1.5735e-04],
          [-1.1059e-04, -1.4159e-04,  5.3347e-05,  1.1415e-04]],

         [[ 1.5474e-04,  9.9565e-05,  7.9763e-07,  1.3016e-04],
          [-8.5548e-05, -1.5425e-04, -6.8675e-05,  1.6079e-04],
          [ 4.5683e-05,  1.3971e-05,  4.6208e-05,  1.8785e-04],
          [ 2.1570e-05,  1.2692e-04,  9.3390e-05, -1.4918e-04]],

         ...,

         [[-1.5862e-04, -3.2713e-05, -7.4199e-05, -1.7566e-04],
          [ 1.4567e-04,  9.3458e-05,  3.5535e-06,  4.4414e-05],
          [ 7.0066e-06,  9.3847e-05, -1.2944e-05, -1.5460e-04],
          [ 2.1942e-04, -1.8398e-04, -1.5303e-04,  1.9125e-05]],

         [[ 1.7009e-05, -3.1349e-05,  1.3073e-05,  1.3089e-04],
          [ 4.5749e-05,  1.4769e-04,  3.1093e-05,  3.0071e-05],
          [ 1.2975e-04, -3.1715e-05,  3.9263e-05, -1.8219e-04],
          [-8.6119e-05, -2.0567e-04,  1.1653e-04,  8.1131e-05]],

         [[-7.8373e-06, -8.2646e-05,  1.9910e-04,  9.8541e-05],
          [ 2.4698e-04,  1.5717e-04, -1.8720e-04,  2.0610e-05],
          [ 2.8678e-05, -2.2382e-04, -1.8141e-04, -2.1076e-05],
          [-1.1265e-04, -1.3411e-04, -1.9441e-04,  7.0672e-05]]]]) 
 old gradient:tensor([[ 4.8518e-04, -1.3609e-05, -1.7676e-05,  ..., -7.8048e-05,
         -3.7041e-04, -3.2803e-04],
        [-4.6474e-04,  4.1224e-04,  3.4257e-04,  ...,  3.7654e-04,
          5.9396e-04,  8.7774e-05],
        [-2.5879e-04,  2.3872e-04, -3.7773e-04,  ..., -2.2031e-04,
          2.3431e-04, -1.8477e-08],
        ...,
        [-6.8412e-05, -3.5792e-04,  1.5743e-05,  ..., -1.8978e-04,
          4.9807e-04,  2.1997e-04],
        [-4.6741e-04,  4.0972e-04,  3.4171e-04,  ...,  3.7642e-04,
          5.9124e-04,  8.4116e-05],
        [-4.9287e-04, -6.7987e-04, -3.9554e-04,  ..., -1.7895e-04,
          2.8867e-04,  5.7722e-04]])
2024-11-30 13:26:30,593 - INFO - reading batch[81] client 3
2024-11-30 13:26:30,606 - INFO - reading batch[81] client 4
2024-11-30 13:26:30,631 - INFO - reading batch[82] client 1
2024-11-30 13:26:30,657 - INFO - reading batch[82] client 2
2024-11-30 13:26:30,690 - INFO - reading batch[82] client 3
2024-11-30 13:26:30,714 - INFO - reading batch[82] client 4
2024-11-30 13:26:30,748 - INFO - reading batch[83] client 1
2024-11-30 13:26:30,770 - INFO - reading batch[83] client 2
2024-11-30 13:26:30,786 - INFO - reading batch[83] client 3
2024-11-30 13:26:30,816 - INFO - reading batch[83] client 4
2024-11-30 13:26:30,839 - INFO - reading batch[84] client 1
2024-11-30 13:26:30,862 - INFO - reading batch[84] client 2
2024-11-30 13:26:30,888 - INFO - reading batch[84] client 3
2024-11-30 13:26:30,907 - INFO - reading batch[84] client 4
2024-11-30 13:26:30,930 - INFO - reading batch[85] client 1
2024-11-30 13:26:30,955 - INFO - reading batch[85] client 2
2024-11-30 13:26:30,982 - INFO - reading batch[85] client 3
2024-11-30 13:26:31,010 - INFO - reading batch[85] client 4
2024-11-30 13:26:31,042 - INFO - reading batch[86] client 1
2024-11-30 13:26:31,066 - INFO - reading batch[86] client 2
2024-11-30 13:26:31,080 - INFO - reading batch[86] client 3
2024-11-30 13:26:31,107 - INFO - reading batch[86] client 4
2024-11-30 13:26:31,137 - INFO - reading batch[87] client 1
2024-11-30 13:26:31,157 - INFO - reading batch[87] client 2
2024-11-30 13:26:31,208 - INFO - reading batch[87] client 3
2024-11-30 13:26:31,233 - INFO - reading batch[87] client 4
2024-11-30 13:26:31,255 - INFO - reading batch[88] client 1
2024-11-30 13:26:31,283 - INFO - reading batch[88] client 2
2024-11-30 13:26:31,301 - INFO - reading batch[88] client 3
2024-11-30 13:26:31,319 - INFO - reading batch[88] client 4
2024-11-30 13:26:31,344 - INFO - reading batch[89] client 1
2024-11-30 13:26:31,364 - INFO - reading batch[89] client 2
2024-11-30 13:26:31,388 - INFO - reading batch[89] client 3
2024-11-30 13:26:31,412 - INFO - reading batch[89] client 4
2024-11-30 13:26:31,430 - INFO - Final partition
2024-11-30 13:26:31,431 - INFO - reading batch[90] client 1
2024-11-30 13:26:31,458 - INFO - reading batch[90] client 2
2024-11-30 13:26:31,477 - INFO - reading batch[90] client 3
2024-11-30 13:26:31,501 - INFO - reading batch[90] client 4
2024-11-30 13:26:31,524 - INFO - reading batch[91] client 1
2024-11-30 13:26:31,543 - INFO - reading batch[91] client 2
2024-11-30 13:26:31,577 - INFO - reading batch[91] client 3
2024-11-30 13:26:31,594 - INFO - reading batch[91] client 4
2024-11-30 13:26:31,622 - INFO - reading batch[92] client 1
2024-11-30 13:26:31,648 - INFO - reading batch[92] client 2
2024-11-30 13:26:31,671 - INFO - reading batch[92] client 3
2024-11-30 13:26:31,697 - INFO - reading batch[92] client 4
2024-11-30 13:26:31,720 - INFO - reading batch[93] client 1
2024-11-30 13:26:31,748 - INFO - reading batch[93] client 2
2024-11-30 13:26:31,763 - INFO - Final partition
2024-11-30 13:26:31,764 - INFO - reading batch[93] client 3
2024-11-30 13:26:31,786 - INFO - Final partition
2024-11-30 13:26:31,787 - INFO - reading batch[93] client 4
2024-11-30 13:26:31,820 - INFO - reading batch[94] client 1
2024-11-30 13:26:31,842 - INFO - reading batch[94] client 2
2024-11-30 13:26:31,861 - INFO - reading batch[94] client 3
2024-11-30 13:26:31,893 - INFO - reading batch[94] client 4
2024-11-30 13:26:31,920 - INFO - reading batch[95] client 1
2024-11-30 13:26:31,943 - INFO - reading batch[95] client 2
2024-11-30 13:26:31,965 - INFO - reading batch[95] client 3
2024-11-30 13:26:31,981 - ERROR - backward on partition 4
2024-11-30 13:26:31,981 - CRITICAL - calculate backward $4 on client4
2024-11-30 13:26:31,988 - CRITICAL - new gradient:tensor([[-1.2738e-04,  3.9750e-04,  5.3539e-04,  ...,  2.3444e-04,
          3.4166e-04,  3.7007e-04],
        [-1.5651e-04,  1.0021e-04,  2.2592e-04,  ..., -7.2345e-04,
         -4.3418e-04,  6.3021e-04],
        [-2.4253e-04,  2.3442e-04, -3.8618e-04,  ..., -2.2433e-04,
          2.1822e-04, -1.2886e-05],
        ...,
        [-7.5045e-05, -3.5783e-04,  2.3476e-05,  ..., -1.9333e-04,
          5.0775e-04,  2.3432e-04],
        [-2.4154e-04,  2.4346e-04, -3.8793e-04,  ..., -2.2522e-04,
          2.2614e-04, -1.1049e-05],
        [ 4.8697e-04, -1.8780e-05, -2.0811e-05,  ..., -8.3806e-05,
         -3.5726e-04, -3.2326e-04]]) 
 old gradient:tensor([[ 0.0021,  0.0014,  0.0018,  0.0014, -0.0142,  0.0014,  0.0014,  0.0014,
          0.0017,  0.0014],
        [ 0.0023,  0.0014,  0.0017, -0.0143,  0.0015,  0.0014,  0.0014,  0.0014,
          0.0018,  0.0014],
        [ 0.0021,  0.0014,  0.0018,  0.0014,  0.0015,  0.0014,  0.0015,  0.0014,
         -0.0138,  0.0014],
        [ 0.0021,  0.0015,  0.0018,  0.0012, -0.0142,  0.0015,  0.0013,  0.0014,
          0.0019,  0.0015],
        [ 0.0020,  0.0015,  0.0018,  0.0013,  0.0015,  0.0014,  0.0014,  0.0015,
         -0.0139,  0.0015],
        [ 0.0019, -0.0141,  0.0017,  0.0013,  0.0014,  0.0015,  0.0015,  0.0015,
          0.0017,  0.0016],
        [ 0.0021,  0.0015, -0.0138,  0.0013,  0.0015,  0.0013,  0.0015,  0.0014,
          0.0018,  0.0014],
        [ 0.0019,  0.0014,  0.0018,  0.0014,  0.0015,  0.0014,  0.0015,  0.0014,
         -0.0138,  0.0016],
        [ 0.0021,  0.0014,  0.0016, -0.0142,  0.0015,  0.0015,  0.0014,  0.0014,
          0.0018,  0.0015],
        [ 0.0020,  0.0015,  0.0017,  0.0015,  0.0014,  0.0015,  0.0015, -0.0142,
          0.0016,  0.0015],
        [ 0.0020,  0.0015,  0.0017, -0.0142,  0.0015,  0.0014,  0.0015,  0.0015,
          0.0017,  0.0015],
        [ 0.0020, -0.0142,  0.0017,  0.0014,  0.0015,  0.0014,  0.0015,  0.0014,
          0.0019,  0.0015],
        [ 0.0020,  0.0014,  0.0020,  0.0014, -0.0141,  0.0014,  0.0014,  0.0014,
          0.0017,  0.0015],
        [ 0.0022,  0.0015,  0.0019,  0.0013,  0.0014,  0.0014,  0.0012,  0.0015,
         -0.0139,  0.0015],
        [ 0.0020,  0.0014,  0.0017,  0.0015,  0.0017, -0.0143,  0.0014,  0.0014,
          0.0017,  0.0015],
        [ 0.0022,  0.0014,  0.0019,  0.0013,  0.0015,  0.0013,  0.0014,  0.0014,
         -0.0140,  0.0015],
        [ 0.0019, -0.0142,  0.0017,  0.0014,  0.0015,  0.0015,  0.0015,  0.0014,
          0.0018,  0.0016],
        [ 0.0019, -0.0141,  0.0017,  0.0014,  0.0015,  0.0015,  0.0015,  0.0015,
          0.0016,  0.0015],
        [ 0.0019,  0.0015,  0.0017,  0.0015,  0.0015,  0.0015,  0.0015, -0.0142,
          0.0017,  0.0016],
        [ 0.0022,  0.0014,  0.0018,  0.0013, -0.0142,  0.0014,  0.0014,  0.0014,
          0.0017,  0.0015],
        [ 0.0021,  0.0014,  0.0018,  0.0014,  0.0016,  0.0014, -0.0142,  0.0014,
          0.0017,  0.0014],
        [ 0.0023,  0.0015,  0.0017,  0.0013, -0.0142,  0.0015,  0.0014,  0.0014,
          0.0018,  0.0014],
        [ 0.0021,  0.0016, -0.0139,  0.0012,  0.0014,  0.0015,  0.0014,  0.0015,
          0.0019,  0.0015],
        [ 0.0019, -0.0142,  0.0017,  0.0014,  0.0015,  0.0015,  0.0015,  0.0014,
          0.0018,  0.0016],
        [ 0.0021,  0.0014,  0.0016, -0.0142,  0.0016,  0.0015,  0.0014,  0.0014,
          0.0018,  0.0015],
        [ 0.0020,  0.0013,  0.0017,  0.0015,  0.0015,  0.0015,  0.0015,  0.0014,
          0.0017, -0.0141],
        [ 0.0018,  0.0015,  0.0016,  0.0014,  0.0016, -0.0142,  0.0015,  0.0015,
          0.0017,  0.0016],
        [ 0.0021,  0.0014,  0.0017,  0.0013,  0.0015,  0.0014,  0.0014,  0.0014,
         -0.0137,  0.0015],
        [ 0.0019,  0.0015,  0.0017,  0.0015,  0.0015,  0.0015,  0.0014, -0.0142,
          0.0017,  0.0015],
        [ 0.0019,  0.0015, -0.0140,  0.0014,  0.0015,  0.0015,  0.0015,  0.0015,
          0.0018,  0.0015],
        [ 0.0023,  0.0015,  0.0018,  0.0013,  0.0014,  0.0014,  0.0014,  0.0014,
         -0.0139,  0.0015],
        [ 0.0018,  0.0014,  0.0016,  0.0015,  0.0015,  0.0015,  0.0015, -0.0142,
          0.0016,  0.0016],
        [ 0.0018, -0.0141,  0.0016,  0.0014,  0.0015,  0.0015,  0.0016,  0.0015,
          0.0016,  0.0015],
        [ 0.0019,  0.0014,  0.0019,  0.0013, -0.0142,  0.0015,  0.0014,  0.0013,
          0.0018,  0.0016],
        [ 0.0024,  0.0015,  0.0017,  0.0012, -0.0142,  0.0014,  0.0013,  0.0014,
          0.0018,  0.0014],
        [ 0.0021,  0.0014,  0.0018,  0.0014,  0.0015, -0.0143,  0.0014,  0.0014,
          0.0017,  0.0016],
        [ 0.0019, -0.0142,  0.0017,  0.0014,  0.0015,  0.0015,  0.0016,  0.0015,
          0.0017,  0.0016],
        [ 0.0023,  0.0015,  0.0018,  0.0014,  0.0015,  0.0014,  0.0014,  0.0014,
          0.0016, -0.0142],
        [ 0.0021,  0.0014,  0.0017, -0.0142,  0.0015,  0.0014,  0.0014,  0.0015,
          0.0018,  0.0015],
        [ 0.0020,  0.0015, -0.0138,  0.0013,  0.0015,  0.0014,  0.0015,  0.0015,
          0.0017,  0.0014],
        [ 0.0020,  0.0015,  0.0017,  0.0013,  0.0016,  0.0014,  0.0015,  0.0015,
         -0.0140,  0.0014],
        [ 0.0022,  0.0014,  0.0017,  0.0013,  0.0015,  0.0014,  0.0014,  0.0014,
          0.0018, -0.0141],
        [ 0.0020,  0.0015,  0.0018,  0.0014, -0.0141,  0.0014,  0.0015,  0.0014,
          0.0016,  0.0015],
        [ 0.0021,  0.0015,  0.0016,  0.0014,  0.0016, -0.0142,  0.0013,  0.0014,
          0.0018,  0.0015],
        [ 0.0021,  0.0015,  0.0018,  0.0014,  0.0014,  0.0014,  0.0015,  0.0015,
          0.0017, -0.0142],
        [-0.0133,  0.0013,  0.0018,  0.0014,  0.0015,  0.0014,  0.0014,  0.0015,
          0.0017,  0.0014],
        [ 0.0019,  0.0014,  0.0017,  0.0014,  0.0016,  0.0014,  0.0015,  0.0014,
         -0.0139,  0.0015],
        [ 0.0021,  0.0015,  0.0018,  0.0013,  0.0015,  0.0014, -0.0143,  0.0014,
          0.0017,  0.0015],
        [ 0.0019, -0.0142,  0.0017,  0.0014,  0.0015,  0.0014,  0.0015,  0.0013,
          0.0019,  0.0015],
        [ 0.0022,  0.0015,  0.0019,  0.0013, -0.0142,  0.0015,  0.0013,  0.0013,
          0.0017,  0.0015],
        [-0.0134,  0.0014,  0.0016,  0.0014,  0.0016,  0.0014,  0.0015,  0.0014,
          0.0017,  0.0015],
        [ 0.0019, -0.0142,  0.0018,  0.0015,  0.0016,  0.0014,  0.0015,  0.0013,
          0.0018,  0.0015],
        [ 0.0023,  0.0015,  0.0018,  0.0013, -0.0142,  0.0014,  0.0014,  0.0014,
          0.0018,  0.0014],
        [ 0.0019,  0.0015, -0.0139,  0.0013,  0.0015,  0.0015,  0.0014,  0.0015,
          0.0018,  0.0015],
        [ 0.0020,  0.0015,  0.0017,  0.0014, -0.0141,  0.0015,  0.0014,  0.0014,
          0.0017,  0.0015],
        [ 0.0021,  0.0014,  0.0016,  0.0014,  0.0017, -0.0142,  0.0014,  0.0014,
          0.0018,  0.0015],
        [ 0.0022,  0.0014,  0.0017, -0.0143,  0.0015,  0.0014,  0.0015,  0.0014,
          0.0018,  0.0014],
        [-0.0133,  0.0014,  0.0018,  0.0014,  0.0014,  0.0013,  0.0013,  0.0015,
          0.0017,  0.0014],
        [ 0.0022,  0.0015,  0.0018,  0.0013,  0.0016,  0.0014, -0.0143,  0.0014,
          0.0017,  0.0015],
        [ 0.0020,  0.0015,  0.0018,  0.0014,  0.0015,  0.0014,  0.0015,  0.0014,
          0.0016, -0.0141],
        [-0.0136,  0.0015,  0.0017,  0.0013,  0.0014,  0.0015,  0.0014,  0.0016,
          0.0017,  0.0014],
        [ 0.0020,  0.0014,  0.0017,  0.0014,  0.0015,  0.0015,  0.0014, -0.0142,
          0.0017,  0.0015],
        [ 0.0021,  0.0014,  0.0018,  0.0015,  0.0014,  0.0014,  0.0015,  0.0014,
         -0.0139,  0.0015],
        [-0.0135,  0.0014,  0.0017,  0.0014,  0.0015,  0.0014,  0.0015,  0.0014,
          0.0018,  0.0015]])
2024-11-30 13:26:31,988 - INFO - reading batch[95] client 4
2024-11-30 13:26:32,012 - INFO - reading batch[96] client 1
2024-11-30 13:26:32,032 - INFO - reading batch[96] client 2
2024-11-30 13:26:32,053 - INFO - reading batch[96] client 3
2024-11-30 13:26:32,083 - INFO - reading batch[96] client 4
2024-11-30 13:26:32,109 - INFO - reading batch[97] client 1
2024-11-30 13:26:32,128 - INFO - reading batch[97] client 2
2024-11-30 13:26:32,154 - INFO - reading batch[97] client 3
2024-11-30 13:26:32,178 - INFO - reading batch[97] client 4
2024-11-30 13:26:32,203 - INFO - reading batch[98] client 1
2024-11-30 13:26:32,233 - INFO - reading batch[98] client 2
2024-11-30 13:26:32,253 - INFO - reading batch[98] client 3
2024-11-30 13:26:32,266 - INFO - reading batch[98] client 4
2024-11-30 13:26:32,298 - INFO - reading batch[99] client 1
2024-11-30 13:26:32,326 - INFO - reading batch[99] client 2
2024-11-30 13:26:32,350 - INFO - reading batch[99] client 3
2024-11-30 13:26:32,368 - ERROR - backward on partition 4
2024-11-30 13:26:32,369 - CRITICAL - calculate backward $4 on client4
2024-11-30 13:26:32,375 - CRITICAL - new gradient:tensor([[-4.8574e-04,  4.0429e-04,  3.5367e-04,  ...,  3.7958e-04,
          6.1086e-04,  1.0408e-04],
        [-4.7963e-04, -6.8125e-04, -4.0669e-04,  ..., -1.8064e-04,
          2.8478e-04,  5.6524e-04],
        [-4.5456e-04,  4.1196e-04,  3.3262e-04,  ...,  3.7378e-04,
          5.9172e-04,  7.6301e-05],
        ...,
        [-2.4014e-04,  2.4278e-04, -3.8958e-04,  ..., -2.2291e-04,
          2.1304e-04, -1.6695e-05],
        [ 6.0655e-04,  1.6865e-04, -1.8059e-04,  ...,  4.7431e-05,
          2.1588e-04, -3.8276e-04],
        [-7.3865e-05, -3.5555e-04,  2.0211e-05,  ..., -1.9268e-04,
          5.0002e-04,  2.3108e-04]]) 
 old gradient:tensor([[ 0.0023,  0.0015,  0.0020,  0.0012,  0.0014,  0.0013, -0.0144,  0.0014,
          0.0018,  0.0014],
        [ 0.0019,  0.0014,  0.0016,  0.0015,  0.0017, -0.0142,  0.0016,  0.0014,
          0.0017,  0.0015],
        [ 0.0019,  0.0015,  0.0018,  0.0014,  0.0016,  0.0015, -0.0142,  0.0014,
          0.0016,  0.0016],
        [ 0.0021,  0.0014, -0.0139,  0.0014,  0.0015,  0.0014,  0.0013,  0.0015,
          0.0018,  0.0015],
        [ 0.0020,  0.0014,  0.0016,  0.0015,  0.0016, -0.0142,  0.0015,  0.0014,
          0.0017,  0.0015],
        [ 0.0021,  0.0015, -0.0138,  0.0013,  0.0014,  0.0014,  0.0014,  0.0015,
          0.0017,  0.0014],
        [ 0.0019,  0.0014,  0.0016,  0.0014,  0.0016, -0.0142,  0.0015,  0.0014,
          0.0017,  0.0015],
        [ 0.0022,  0.0015,  0.0018,  0.0013,  0.0015,  0.0013, -0.0144,  0.0014,
          0.0017,  0.0015],
        [ 0.0019, -0.0142,  0.0017,  0.0014,  0.0015,  0.0015,  0.0015,  0.0014,
          0.0018,  0.0015],
        [ 0.0019,  0.0015,  0.0018,  0.0013,  0.0015, -0.0142,  0.0014,  0.0015,
          0.0017,  0.0015],
        [ 0.0022,  0.0014,  0.0018,  0.0015,  0.0014,  0.0014,  0.0013,  0.0014,
         -0.0139,  0.0014],
        [ 0.0021,  0.0014,  0.0017, -0.0142,  0.0015,  0.0015,  0.0015,  0.0014,
          0.0016,  0.0015],
        [ 0.0021,  0.0014,  0.0016,  0.0014,  0.0015,  0.0014,  0.0014,  0.0014,
         -0.0138,  0.0015],
        [ 0.0019,  0.0015, -0.0139,  0.0014,  0.0014,  0.0015,  0.0014,  0.0015,
          0.0018,  0.0016],
        [ 0.0022,  0.0015,  0.0018,  0.0014,  0.0014,  0.0014,  0.0014,  0.0014,
          0.0017, -0.0142],
        [ 0.0020,  0.0014,  0.0016, -0.0143,  0.0015,  0.0015,  0.0015,  0.0016,
          0.0017,  0.0015],
        [ 0.0019, -0.0142,  0.0017,  0.0014,  0.0015,  0.0014,  0.0014,  0.0014,
          0.0019,  0.0015],
        [ 0.0021,  0.0015,  0.0018,  0.0014,  0.0015, -0.0143,  0.0014,  0.0015,
          0.0017,  0.0015],
        [ 0.0019,  0.0015,  0.0019,  0.0013, -0.0141,  0.0015,  0.0014,  0.0014,
          0.0017,  0.0015],
        [ 0.0021,  0.0014,  0.0018, -0.0143,  0.0016,  0.0014,  0.0014,  0.0015,
          0.0016,  0.0015],
        [ 0.0024,  0.0015, -0.0138,  0.0011,  0.0013,  0.0014,  0.0013,  0.0014,
          0.0020,  0.0015],
        [ 0.0019,  0.0015,  0.0017,  0.0014,  0.0015,  0.0016,  0.0015, -0.0141,
          0.0016,  0.0015],
        [ 0.0021,  0.0014,  0.0017,  0.0014,  0.0015,  0.0014,  0.0014,  0.0015,
         -0.0139,  0.0015],
        [-0.0135,  0.0013,  0.0016,  0.0014,  0.0016,  0.0014,  0.0014,  0.0014,
          0.0018,  0.0015],
        [ 0.0019,  0.0015,  0.0018,  0.0014, -0.0141,  0.0015,  0.0013,  0.0015,
          0.0017,  0.0015],
        [ 0.0023,  0.0014,  0.0017,  0.0014,  0.0015, -0.0144,  0.0014,  0.0014,
          0.0018,  0.0014],
        [ 0.0020,  0.0014,  0.0017, -0.0143,  0.0015,  0.0014,  0.0014,  0.0015,
          0.0017,  0.0016],
        [ 0.0021,  0.0014,  0.0019,  0.0014,  0.0014,  0.0014,  0.0013,  0.0014,
         -0.0139,  0.0015],
        [ 0.0023,  0.0014,  0.0017,  0.0014,  0.0015, -0.0143,  0.0015,  0.0014,
          0.0017,  0.0014],
        [ 0.0021,  0.0014,  0.0016,  0.0013,  0.0015,  0.0015, -0.0142,  0.0014,
          0.0019,  0.0015],
        [-0.0133,  0.0014,  0.0016,  0.0013,  0.0015,  0.0014,  0.0014,  0.0015,
          0.0018,  0.0014],
        [ 0.0021,  0.0014,  0.0017,  0.0015,  0.0015,  0.0014,  0.0015,  0.0014,
         -0.0139,  0.0015],
        [ 0.0021,  0.0014,  0.0018,  0.0014,  0.0016,  0.0014,  0.0014,  0.0014,
          0.0016, -0.0141],
        [ 0.0024,  0.0015,  0.0018,  0.0012,  0.0013,  0.0013,  0.0013,  0.0014,
         -0.0138,  0.0015],
        [ 0.0018, -0.0142,  0.0016,  0.0014,  0.0015,  0.0015,  0.0016,  0.0015,
          0.0017,  0.0016],
        [ 0.0020,  0.0014, -0.0139,  0.0014,  0.0015,  0.0015,  0.0015,  0.0015,
          0.0016,  0.0015],
        [ 0.0019, -0.0142,  0.0016,  0.0014,  0.0015,  0.0015,  0.0016,  0.0015,
          0.0017,  0.0016],
        [ 0.0024,  0.0015,  0.0017,  0.0013,  0.0015,  0.0012, -0.0144,  0.0014,
          0.0019,  0.0015],
        [ 0.0020,  0.0015,  0.0017,  0.0014,  0.0015, -0.0142,  0.0015,  0.0015,
          0.0017,  0.0015],
        [ 0.0024,  0.0015, -0.0139,  0.0012,  0.0013,  0.0013,  0.0014,  0.0015,
          0.0019,  0.0014],
        [ 0.0019, -0.0142,  0.0018,  0.0013,  0.0014,  0.0015,  0.0015,  0.0016,
          0.0017,  0.0015],
        [ 0.0018,  0.0015,  0.0016,  0.0015,  0.0016,  0.0016,  0.0016, -0.0142,
          0.0015,  0.0015],
        [ 0.0020,  0.0015,  0.0017,  0.0014,  0.0015,  0.0014,  0.0015,  0.0015,
          0.0016, -0.0141],
        [-0.0133,  0.0014,  0.0018,  0.0013,  0.0015,  0.0013,  0.0014,  0.0014,
          0.0018,  0.0014],
        [ 0.0021,  0.0014, -0.0137,  0.0012,  0.0015,  0.0013,  0.0014,  0.0015,
          0.0018,  0.0015],
        [ 0.0019, -0.0141,  0.0017,  0.0014,  0.0014,  0.0015,  0.0015,  0.0015,
          0.0016,  0.0016],
        [ 0.0024,  0.0015,  0.0017,  0.0012,  0.0014,  0.0013, -0.0144,  0.0014,
          0.0019,  0.0014],
        [ 0.0018,  0.0016,  0.0016,  0.0015,  0.0015,  0.0015,  0.0015, -0.0142,
          0.0016,  0.0015],
        [ 0.0022,  0.0015,  0.0017,  0.0013,  0.0015,  0.0013, -0.0143,  0.0014,
          0.0018,  0.0015],
        [ 0.0021,  0.0015,  0.0018,  0.0013,  0.0016,  0.0014, -0.0143,  0.0014,
          0.0017,  0.0015],
        [ 0.0021,  0.0016, -0.0140,  0.0012,  0.0014,  0.0014,  0.0015,  0.0015,
          0.0018,  0.0015],
        [ 0.0020,  0.0014,  0.0017,  0.0014,  0.0015, -0.0142,  0.0014,  0.0015,
          0.0017,  0.0016],
        [ 0.0019,  0.0014, -0.0139,  0.0015,  0.0015,  0.0015,  0.0015,  0.0015,
          0.0017,  0.0015],
        [ 0.0018, -0.0142,  0.0017,  0.0014,  0.0014,  0.0015,  0.0015,  0.0015,
          0.0017,  0.0016],
        [ 0.0019,  0.0014,  0.0016,  0.0014,  0.0016, -0.0141,  0.0015,  0.0014,
          0.0018,  0.0015],
        [ 0.0021,  0.0014,  0.0018,  0.0013,  0.0014,  0.0014,  0.0014, -0.0141,
          0.0017,  0.0014],
        [ 0.0021,  0.0016, -0.0140,  0.0013,  0.0015,  0.0014,  0.0014,  0.0014,
          0.0018,  0.0015],
        [ 0.0022,  0.0013,  0.0018, -0.0143,  0.0015,  0.0014,  0.0015,  0.0014,
          0.0017,  0.0015],
        [ 0.0022,  0.0014,  0.0017, -0.0142,  0.0014,  0.0015,  0.0014,  0.0014,
          0.0017,  0.0015],
        [-0.0135,  0.0014,  0.0017,  0.0014,  0.0015,  0.0014,  0.0014,  0.0016,
          0.0018,  0.0014],
        [-0.0132,  0.0014,  0.0016,  0.0013,  0.0016,  0.0013,  0.0013,  0.0014,
          0.0019,  0.0015],
        [ 0.0020,  0.0014,  0.0017,  0.0014,  0.0015,  0.0014,  0.0015,  0.0015,
         -0.0139,  0.0014],
        [ 0.0020, -0.0142,  0.0017,  0.0013,  0.0016,  0.0013,  0.0015,  0.0014,
          0.0017,  0.0016],
        [ 0.0019,  0.0015,  0.0017,  0.0015,  0.0015,  0.0015,  0.0015, -0.0141,
          0.0016,  0.0015]])
2024-11-30 13:26:32,375 - INFO - reading batch[99] client 4
2024-11-30 13:26:32,405 - INFO - reading batch[100] client 1
2024-11-30 13:26:32,431 - INFO - reading batch[100] client 2
2024-11-30 13:26:32,457 - INFO - reading batch[100] client 3
2024-11-30 13:26:32,484 - INFO - reading batch[100] client 4
2024-11-30 13:26:32,501 - INFO - Final partition
2024-11-30 13:26:32,502 - INFO - reading batch[101] client 1
2024-11-30 13:26:32,531 - INFO - reading batch[101] client 2
2024-11-30 13:26:32,549 - INFO - reading batch[101] client 3
2024-11-30 13:26:32,575 - INFO - reading batch[101] client 4
2024-11-30 13:26:32,603 - INFO - reading batch[102] client 1
2024-11-30 13:26:32,626 - INFO - reading batch[102] client 2
2024-11-30 13:26:32,650 - INFO - reading batch[102] client 3
2024-11-30 13:26:32,663 - INFO - reading batch[102] client 4
2024-11-30 13:26:32,690 - INFO - reading batch[103] client 1
2024-11-30 13:26:32,714 - INFO - reading batch[103] client 2
2024-11-30 13:26:32,727 - ERROR - backward on partition 3
2024-11-30 13:26:32,730 - CRITICAL - calculate backward $3 on client3
2024-11-30 13:26:32,740 - CRITICAL - new gradient:tensor([[[[-2.0458e-04, -1.9480e-04,  1.5835e-04,  8.1735e-05],
          [ 6.9867e-05, -1.1318e-04, -2.4567e-04, -5.3697e-05],
          [ 5.4151e-05,  3.5714e-05,  1.1593e-04, -9.5592e-05],
          [-1.2021e-04,  3.5396e-05, -8.3428e-05, -1.0997e-04]],

         [[-4.3670e-05, -1.5413e-04, -1.6163e-05,  6.9122e-05],
          [-9.0350e-05, -2.2002e-05,  6.3860e-05, -5.6450e-05],
          [ 3.9285e-05,  1.4050e-05, -2.4725e-05,  1.5268e-04],
          [-6.8278e-05, -6.9280e-05, -2.8013e-05, -1.3279e-04]],

         [[ 1.3501e-04,  2.8394e-05,  3.3337e-05, -6.1236e-05],
          [-3.4694e-05, -3.0883e-05, -2.8743e-05, -4.9785e-05],
          [ 1.4081e-04,  4.6332e-05,  8.0922e-05,  9.7232e-05],
          [ 1.7291e-04, -6.3151e-05, -1.4685e-04, -1.1269e-04]],

         ...,

         [[-8.7312e-05,  1.9389e-04,  1.9016e-04, -4.0683e-05],
          [ 1.1967e-06, -5.5113e-06, -2.7018e-05,  2.0670e-04],
          [ 6.5654e-05,  2.3901e-04,  1.3326e-04,  2.2512e-05],
          [-2.4747e-05, -4.2561e-05,  6.1114e-06,  4.7102e-05]],

         [[ 1.6683e-05,  2.2351e-05,  5.0574e-05, -5.8654e-05],
          [-1.1362e-04, -1.3587e-04, -1.2653e-04,  1.0215e-04],
          [-1.7008e-04, -1.8031e-04,  7.2514e-05, -1.1020e-04],
          [ 6.9564e-05,  2.2117e-04,  9.6865e-05,  7.8369e-05]],

         [[-4.3243e-05, -2.5129e-04,  8.8972e-06,  1.2360e-04],
          [-1.9951e-04,  6.3285e-05,  4.7358e-05,  1.4907e-04],
          [ 2.1269e-05, -9.6148e-05, -1.2011e-04,  2.5606e-05],
          [-1.4244e-04, -1.1457e-04,  2.2603e-05, -2.2981e-04]]],


        [[[-8.4639e-05,  1.8900e-04,  6.3411e-05, -7.6262e-05],
          [-1.1462e-04,  8.1972e-05, -1.1210e-04, -7.2993e-05],
          [-6.2121e-05, -2.6643e-05, -1.6724e-04, -1.0727e-04],
          [ 2.0186e-04,  1.0026e-05, -2.9987e-05,  1.0454e-04]],

         [[-2.1434e-04,  3.8105e-06, -8.4105e-05,  3.8660e-05],
          [ 1.3412e-04, -8.1242e-05,  1.5950e-04,  1.3802e-05],
          [-1.0769e-04, -6.5884e-05,  2.4218e-04, -1.2078e-04],
          [ 1.0534e-04, -2.7407e-05,  4.0155e-05,  1.0059e-04]],

         [[-1.2236e-04, -9.5183e-06, -5.7702e-05, -8.6825e-05],
          [-2.2644e-04, -5.7869e-06, -5.9526e-05, -1.6937e-04],
          [ 9.0168e-05,  8.1583e-06, -3.9737e-05, -1.7106e-04],
          [ 9.6681e-06,  3.0940e-05, -2.8059e-05, -1.1413e-04]],

         ...,

         [[-2.3467e-05,  1.1837e-05,  3.3414e-05, -7.0013e-05],
          [ 9.0469e-05, -2.7181e-05, -1.4167e-04, -3.2888e-04],
          [ 2.5327e-04, -1.5827e-04, -6.8976e-05, -5.7397e-05],
          [ 8.2129e-05,  3.5007e-05, -2.0883e-05, -7.2970e-06]],

         [[ 3.4881e-05,  3.5015e-05, -6.3373e-05, -3.7332e-05],
          [-4.7792e-05,  4.8982e-05,  1.7962e-04,  1.9395e-04],
          [-1.5112e-05, -1.9184e-05, -1.6028e-04, -6.4289e-06],
          [-1.2824e-05,  1.9940e-04,  9.3073e-05,  1.2305e-05]],

         [[ 9.8534e-05,  4.2788e-05,  7.9686e-05, -1.1594e-04],
          [ 2.0445e-05,  9.9499e-05,  8.2835e-05, -2.8594e-05],
          [ 6.8800e-05,  1.2521e-04, -1.2028e-04, -1.9328e-05],
          [ 5.2816e-05,  2.1138e-04, -3.9905e-05, -4.9889e-05]]],


        [[[ 2.3326e-04,  3.8126e-05,  1.9480e-05,  1.4495e-04],
          [-7.7047e-05,  9.3268e-05, -1.4397e-04, -2.1204e-04],
          [-8.6220e-05, -1.8034e-04, -1.3910e-04,  1.6594e-04],
          [ 1.9921e-04, -4.7204e-05, -2.3615e-04, -4.2110e-06]],

         [[ 1.8676e-04,  1.1840e-04,  2.0808e-05,  1.3731e-04],
          [ 1.6685e-04, -1.8959e-05, -3.5871e-05, -1.0219e-04],
          [ 1.1933e-04, -9.4949e-05, -1.6567e-04, -2.3007e-05],
          [-9.4427e-05, -1.5980e-05, -2.7017e-05,  9.9559e-06]],

         [[ 6.0029e-05, -8.7482e-06, -8.8976e-05,  9.2492e-05],
          [-9.8446e-05,  3.5230e-05,  2.5824e-05,  5.3092e-06],
          [-1.2967e-04, -5.7698e-05, -3.2406e-04,  4.7663e-05],
          [-9.0913e-05, -5.6881e-05,  1.3942e-04,  9.1663e-08]],

         ...,

         [[-2.0607e-05, -8.7129e-05, -6.9785e-05,  6.7730e-05],
          [ 1.1306e-04,  1.0391e-04,  1.4082e-05, -1.7501e-04],
          [ 2.3167e-04,  1.3603e-05,  6.8019e-05, -1.3731e-04],
          [-5.5797e-05,  2.7985e-05, -1.2677e-04, -5.2514e-05]],

         [[-3.1923e-05,  1.1838e-05,  1.5678e-05, -7.5899e-05],
          [-3.2946e-05, -3.1728e-06,  1.2815e-04, -7.8364e-05],
          [-9.8188e-05,  8.3106e-05, -5.5372e-05,  3.0166e-04],
          [-1.2242e-04, -8.3253e-05, -2.2044e-06, -1.1253e-04]],

         [[ 3.3717e-05,  5.2806e-05,  1.9870e-04, -1.6741e-04],
          [ 1.5014e-04, -2.3921e-04, -1.0228e-05,  1.1498e-04],
          [ 1.0499e-04,  7.3362e-06, -1.6857e-05, -1.1035e-06],
          [ 9.1095e-05,  1.0578e-04,  1.2165e-04,  2.9234e-05]]],


        ...,


        [[[ 4.8866e-05,  7.7706e-05, -3.1665e-05, -2.4039e-04],
          [ 1.1359e-04, -2.7838e-05,  9.9789e-05,  6.4713e-05],
          [-1.2344e-05, -6.1077e-05,  1.0870e-05,  1.4868e-04],
          [ 3.7401e-05, -1.6399e-05, -1.3695e-04, -2.6519e-05]],

         [[-1.9913e-04,  2.8583e-04,  1.2397e-04, -1.5133e-04],
          [-1.4310e-04, -3.6721e-05,  8.9356e-05,  1.0563e-04],
          [ 1.0274e-04,  2.0833e-04,  4.4679e-06,  6.6628e-05],
          [ 1.7690e-04, -1.7068e-05, -3.1266e-05,  5.8321e-05]],

         [[ 6.7186e-06, -4.4032e-05,  4.7487e-05, -2.3921e-05],
          [ 9.5259e-05, -5.7462e-05,  2.0977e-04,  1.3728e-04],
          [-1.5336e-04,  6.1420e-05,  4.1512e-05,  5.9157e-05],
          [-5.0023e-05,  6.8616e-05, -6.1483e-06,  2.8164e-04]],

         ...,

         [[ 2.0940e-06,  2.6473e-05, -4.1321e-06, -4.4528e-05],
          [-2.7048e-05,  1.0642e-04,  8.2248e-05, -5.4102e-05],
          [-1.6288e-04, -1.1349e-05,  1.6959e-04,  3.2585e-05],
          [ 1.8133e-05, -1.2260e-05, -8.6186e-05,  5.2658e-06]],

         [[ 1.4730e-04,  4.6080e-05, -1.0041e-04,  6.2015e-05],
          [ 1.9338e-04,  3.1042e-04, -4.2537e-06, -7.6664e-05],
          [-6.8859e-05,  4.0067e-05, -1.1245e-04, -1.4920e-04],
          [ 1.9832e-04,  4.9479e-05, -8.7797e-05,  1.1317e-04]],

         [[-1.4219e-04,  7.3737e-05, -4.7946e-05, -2.2552e-07],
          [-1.8847e-05,  1.7927e-05,  7.5170e-05, -4.0633e-04],
          [-5.2366e-05,  5.6930e-05,  1.5101e-04,  3.1947e-05],
          [-9.7164e-05,  1.6967e-04, -6.5067e-05, -1.4363e-04]]],


        [[[ 1.7926e-04, -9.9632e-05, -2.0457e-04, -3.6655e-05],
          [ 7.9192e-05,  3.3504e-05,  2.0738e-04, -1.0873e-04],
          [ 4.6831e-05,  6.3552e-05, -6.9752e-05,  1.4549e-05],
          [-6.8079e-06, -1.6419e-04,  1.9589e-04, -1.3523e-05]],

         [[ 1.7878e-04, -1.3008e-04,  5.2613e-05, -4.9910e-05],
          [-9.6391e-05, -3.4385e-05, -1.5626e-04, -4.2634e-05],
          [-7.9736e-05, -1.1915e-04,  1.4827e-05,  9.9814e-05],
          [ 2.5587e-05,  8.6696e-06,  9.7129e-06,  1.3045e-04]],

         [[ 1.5708e-05, -2.3481e-04,  1.8295e-05, -2.1752e-05],
          [ 2.6697e-04, -1.1901e-05, -3.8110e-05,  1.3062e-04],
          [ 1.0176e-04,  7.0064e-05, -4.7435e-05,  1.7591e-04],
          [-5.2696e-05,  6.3352e-06,  2.1783e-04,  1.0048e-04]],

         ...,

         [[ 1.5546e-05,  1.0929e-05, -8.0112e-05, -2.6160e-05],
          [ 6.9506e-05, -9.7936e-05, -8.3491e-05,  5.8354e-05],
          [-1.4185e-04, -2.2511e-04, -1.6618e-04, -1.9154e-04],
          [-1.6532e-04,  1.1035e-04, -9.6998e-05, -1.6314e-05]],

         [[-1.0206e-04, -3.4449e-05,  1.8973e-04, -4.0030e-05],
          [ 7.5695e-05, -1.2907e-05, -1.0028e-04, -1.4465e-04],
          [-5.1292e-05, -8.6618e-05,  9.6694e-06,  8.9792e-06],
          [-3.0339e-05,  1.5147e-04,  1.3040e-06,  1.0538e-05]],

         [[-4.8063e-05,  1.5732e-06, -1.5336e-04,  1.0631e-04],
          [-4.3132e-06,  1.5044e-04,  1.5850e-04,  3.3169e-05],
          [ 9.8652e-05, -2.7165e-05, -5.0647e-05, -6.7326e-05],
          [ 1.0024e-04, -2.2322e-04,  6.9069e-05,  3.5442e-05]]],


        [[[ 3.1247e-06,  2.6519e-04, -1.2642e-04,  9.4433e-05],
          [-1.5262e-04,  6.7350e-05,  5.2206e-05,  7.0496e-05],
          [-1.4869e-04,  7.2575e-05, -3.7022e-05, -1.7787e-05],
          [ 9.7258e-05,  1.7471e-04,  1.7689e-04,  1.0383e-04]],

         [[-7.4509e-05,  2.3275e-04, -5.1820e-07,  2.4203e-05],
          [-1.1953e-04,  5.4338e-05,  2.4583e-05,  7.9113e-05],
          [ 4.7037e-05,  9.5464e-05,  1.4623e-04,  7.6425e-05],
          [-7.4733e-05, -1.7454e-04,  1.4257e-04,  6.0985e-05]],

         [[ 2.3729e-04,  1.4094e-04, -8.9073e-06,  1.4092e-04],
          [-3.5085e-05, -1.2885e-04, -8.2784e-05,  1.1205e-04],
          [-1.0583e-05,  8.3191e-05,  1.5380e-04,  2.6706e-04],
          [-6.4548e-05,  3.1580e-05,  7.6923e-05, -6.8078e-05]],

         ...,

         [[-2.6295e-05,  8.2800e-07, -2.6188e-05, -9.4397e-05],
          [ 1.4976e-04,  4.7033e-05, -1.0732e-05, -1.1454e-05],
          [-3.7791e-05,  5.7166e-05, -5.4951e-05, -2.9784e-05],
          [ 1.8125e-04, -6.4929e-06, -7.5131e-05, -5.4842e-05]],

         [[-8.1641e-05,  9.4899e-06, -4.1681e-05,  2.2815e-04],
          [ 1.3235e-04,  5.7438e-05, -1.0514e-04,  1.2100e-04],
          [ 4.2864e-05,  7.9482e-05,  6.5359e-06, -3.5570e-05],
          [-1.4282e-04, -2.1970e-04,  8.7699e-05, -1.6276e-05]],

         [[-5.4957e-05, -1.2294e-04,  9.2247e-05,  1.8194e-04],
          [ 2.0298e-04,  2.4501e-05, -1.6244e-05,  8.2123e-05],
          [ 1.0911e-04, -1.7942e-04, -6.6660e-05, -1.2524e-04],
          [ 4.8502e-05,  4.7675e-05, -2.2847e-04,  2.0869e-05]]]]) 
 old gradient:tensor([[-2.7548e-04, -7.2489e-04,  2.4295e-04,  ...,  5.3934e-04,
         -4.6596e-04, -4.4788e-04],
        [-2.4619e-04,  2.4927e-04, -3.8439e-04,  ..., -2.2933e-04,
          2.1971e-04, -2.3135e-06],
        [-6.7528e-05, -3.5792e-04,  2.1228e-05,  ..., -1.9441e-04,
          5.0357e-04,  2.2918e-04],
        ...,
        [-4.7577e-04,  4.0599e-04,  3.4418e-04,  ...,  3.8003e-04,
          6.0341e-04,  9.7100e-05],
        [-1.2547e-04,  4.0388e-04,  5.3934e-04,  ...,  2.2619e-04,
          3.3092e-04,  3.7487e-04],
        [-5.0163e-04, -6.7456e-04, -3.8875e-04,  ..., -1.7586e-04,
          2.9711e-04,  5.8766e-04]])
2024-11-30 13:26:32,740 - INFO - reading batch[103] client 3
2024-11-30 13:26:32,762 - INFO - reading batch[103] client 4
2024-11-30 13:26:32,785 - INFO - reading batch[104] client 1
2024-11-30 13:26:32,804 - INFO - reading batch[104] client 2
2024-11-30 13:26:32,825 - INFO - reading batch[104] client 3
2024-11-30 13:26:32,853 - INFO - reading batch[104] client 4
2024-11-30 13:26:32,875 - INFO - reading batch[105] client 1
2024-11-30 13:26:32,895 - INFO - reading batch[105] client 2
2024-11-30 13:26:32,921 - INFO - reading batch[105] client 3
2024-11-30 13:26:32,946 - INFO - reading batch[105] client 4
2024-11-30 13:26:32,978 - INFO - reading batch[106] client 1
2024-11-30 13:26:33,003 - INFO - reading batch[106] client 2
2024-11-30 13:26:33,030 - INFO - reading batch[106] client 3
2024-11-30 13:26:33,054 - INFO - reading batch[106] client 4
2024-11-30 13:26:33,081 - INFO - reading batch[107] client 1
2024-11-30 13:26:33,103 - INFO - reading batch[107] client 2
2024-11-30 13:26:33,118 - INFO - reading batch[107] client 3
2024-11-30 13:26:33,141 - INFO - reading batch[107] client 4
2024-11-30 13:26:33,164 - INFO - reading batch[108] client 1
2024-11-30 13:26:33,182 - INFO - reading batch[108] client 2
2024-11-30 13:26:33,209 - INFO - reading batch[108] client 3
2024-11-30 13:26:33,227 - INFO - reading batch[108] client 4
2024-11-30 13:26:33,255 - INFO - reading batch[109] client 1
2024-11-30 13:26:33,280 - INFO - reading batch[109] client 2
2024-11-30 13:26:33,296 - INFO - reading batch[109] client 3
2024-11-30 13:26:33,309 - INFO - Final partition
2024-11-30 13:26:33,310 - INFO - reading batch[109] client 4
2024-11-30 13:26:33,345 - INFO - reading batch[110] client 1
2024-11-30 13:26:33,371 - INFO - reading batch[110] client 2
2024-11-30 13:26:33,394 - INFO - reading batch[110] client 3
2024-11-30 13:26:33,419 - INFO - reading batch[110] client 4
2024-11-30 13:26:33,444 - INFO - reading batch[111] client 1
2024-11-30 13:26:33,467 - INFO - reading batch[111] client 2
2024-11-30 13:26:33,480 - INFO - reading batch[111] client 3
2024-11-30 13:26:33,507 - INFO - reading batch[111] client 4
2024-11-30 13:26:33,535 - INFO - reading batch[112] client 1
2024-11-30 13:26:33,565 - INFO - reading batch[112] client 2
2024-11-30 13:26:33,590 - INFO - reading batch[112] client 3
2024-11-30 13:26:33,603 - INFO - reading batch[112] client 4
2024-11-30 13:26:33,622 - INFO - Final partition
2024-11-30 13:26:33,622 - INFO - reading batch[113] client 1
2024-11-30 13:26:33,645 - INFO - reading batch[113] client 2
2024-11-30 13:26:33,675 - INFO - reading batch[113] client 3
2024-11-30 13:26:33,706 - INFO - reading batch[113] client 4
2024-11-30 13:26:33,733 - INFO - reading batch[114] client 1
2024-11-30 13:26:33,752 - INFO - reading batch[114] client 2
2024-11-30 13:26:33,779 - INFO - reading batch[114] client 3
2024-11-30 13:26:33,802 - INFO - reading batch[114] client 4
2024-11-30 13:26:33,828 - INFO - reading batch[115] client 1
2024-11-30 13:26:33,854 - INFO - reading batch[115] client 2
2024-11-30 13:26:33,873 - INFO - reading batch[115] client 3
2024-11-30 13:26:33,901 - INFO - reading batch[115] client 4
2024-11-30 13:26:33,931 - INFO - reading batch[116] client 1
2024-11-30 13:26:33,955 - INFO - reading batch[116] client 2
2024-11-30 13:26:33,982 - INFO - reading batch[116] client 3
2024-11-30 13:26:33,995 - INFO - reading batch[116] client 4
2024-11-30 13:26:34,023 - INFO - reading batch[117] client 1
2024-11-30 13:26:34,045 - INFO - reading batch[117] client 2
2024-11-30 13:26:34,059 - INFO - Final partition
2024-11-30 13:26:34,060 - INFO - reading batch[117] client 3
2024-11-30 13:26:34,091 - INFO - reading batch[117] client 4
2024-11-30 13:26:34,120 - INFO - reading batch[118] client 1
2024-11-30 13:26:34,147 - INFO - reading batch[118] client 2
2024-11-30 13:26:34,165 - INFO - reading batch[118] client 3
2024-11-30 13:26:34,199 - INFO - reading batch[118] client 4
2024-11-30 13:26:34,227 - INFO - reading batch[119] client 1
2024-11-30 13:26:34,252 - INFO - reading batch[119] client 2
2024-11-30 13:26:34,277 - INFO - reading batch[119] client 3
2024-11-30 13:26:34,294 - INFO - reading batch[119] client 4
2024-11-30 13:26:34,321 - INFO - reading batch[120] client 1
2024-11-30 13:26:34,345 - INFO - reading batch[120] client 2
2024-11-30 13:26:34,370 - INFO - reading batch[120] client 3
2024-11-30 13:26:34,394 - INFO - reading batch[120] client 4
2024-11-30 13:26:34,420 - INFO - reading batch[121] client 1
2024-11-30 13:26:34,448 - INFO - reading batch[121] client 2
2024-11-30 13:26:34,468 - INFO - reading batch[121] client 3
2024-11-30 13:26:34,495 - INFO - reading batch[121] client 4
2024-11-30 13:26:34,521 - INFO - reading batch[122] client 1
2024-11-30 13:26:34,548 - INFO - reading batch[122] client 2
2024-11-30 13:26:34,572 - INFO - reading batch[122] client 3
2024-11-30 13:26:34,587 - INFO - reading batch[122] client 4
2024-11-30 13:26:34,609 - INFO - reading batch[123] client 1
2024-11-30 13:26:34,627 - INFO - reading batch[123] client 2
2024-11-30 13:26:34,641 - ERROR - backward on partition 3
2024-11-30 13:26:34,644 - CRITICAL - calculate backward $3 on client3
2024-11-30 13:26:34,658 - CRITICAL - new gradient:tensor([[[[-5.3731e-06, -8.3498e-05,  1.4100e-04, -1.0983e-04],
          [-2.9377e-06, -2.4789e-05,  8.0975e-06, -3.9532e-06],
          [-2.9351e-05,  1.6704e-04,  9.7180e-05, -1.1147e-04],
          [-1.2565e-04,  7.2838e-05,  8.8365e-05,  1.2615e-05]],

         [[ 5.6242e-05,  1.2158e-04,  5.2991e-05,  1.0021e-05],
          [-8.9654e-05, -3.4197e-05,  1.7739e-04,  1.1612e-05],
          [ 8.6176e-07, -1.0834e-04, -1.7700e-04, -4.4471e-05],
          [ 8.8258e-05,  6.4425e-05, -2.0072e-05, -2.4309e-04]],

         [[ 8.8841e-05,  1.4141e-05,  4.8120e-05,  1.3506e-04],
          [ 5.2128e-05,  2.9124e-05,  3.8935e-05,  8.3381e-06],
          [ 1.3901e-05, -9.9141e-05, -1.1170e-04,  6.9469e-06],
          [ 9.8357e-05, -2.4191e-04,  6.7040e-05, -1.6680e-04]],

         ...,

         [[ 1.3465e-04,  5.6178e-05, -1.2137e-04,  2.9677e-05],
          [-1.6955e-04, -5.4051e-07,  1.2296e-04, -1.9665e-05],
          [-4.3093e-05, -1.4406e-04,  1.2360e-05, -3.0363e-06],
          [-7.7583e-06,  1.1215e-04,  1.0329e-04, -1.0685e-04]],

         [[-2.0295e-05, -1.0789e-05,  7.5827e-05,  4.9995e-06],
          [-4.6740e-05,  3.9256e-06,  5.2080e-05,  6.5595e-05],
          [ 1.8708e-04, -8.8964e-05,  1.7158e-04,  9.7322e-06],
          [ 9.7595e-05, -2.4628e-04, -1.5463e-04, -9.4604e-05]],

         [[-3.3713e-05, -3.8766e-05, -6.2219e-05, -1.1606e-04],
          [ 2.4588e-05, -1.1872e-04, -1.2954e-04, -2.3991e-05],
          [ 4.6449e-05,  6.2434e-05, -1.5177e-05,  1.9048e-05],
          [ 8.2812e-05, -6.2539e-05,  8.3867e-06, -2.2621e-05]]],


        [[[-1.4072e-04, -1.3087e-05,  1.5026e-04, -3.2015e-05],
          [ 4.7464e-05, -1.4918e-04, -3.4466e-04, -6.0135e-05],
          [ 1.9342e-04,  4.1981e-05,  2.2214e-05,  1.0386e-04],
          [-7.5958e-05,  4.5320e-05, -1.6759e-05, -1.0071e-04]],

         [[ 5.3419e-05, -1.8152e-04, -8.3389e-06, -1.9737e-05],
          [-4.4690e-05,  3.2166e-06, -1.7267e-04, -8.1394e-05],
          [-1.9832e-06, -3.7748e-05, -1.2451e-05,  1.2425e-04],
          [-1.7050e-04, -3.0255e-05, -8.7908e-07, -6.1215e-06]],

         [[ 1.1981e-05,  2.4015e-05, -1.1399e-06, -7.4300e-05],
          [ 4.5033e-05,  2.7949e-05, -1.4972e-04, -3.6859e-05],
          [ 7.0028e-05,  1.1514e-04, -3.4643e-05,  4.8801e-05],
          [ 4.3339e-05, -9.5499e-05, -1.0261e-04, -7.8302e-05]],

         ...,

         [[-6.3534e-05,  1.6645e-04,  1.9954e-04,  1.5102e-04],
          [-7.9225e-06,  4.1405e-05, -3.6142e-05,  2.1543e-04],
          [ 1.4338e-04,  2.5971e-04,  2.1101e-04, -4.3407e-05],
          [-9.1974e-05,  1.3077e-05,  9.2029e-05,  8.8590e-07]],

         [[ 8.6882e-05, -4.6366e-05,  6.6971e-05, -1.1295e-05],
          [-8.7210e-05, -1.9816e-04, -2.2606e-04,  8.3195e-05],
          [-2.1252e-04, -9.5613e-05,  1.7278e-04, -7.1063e-05],
          [ 8.9744e-05,  1.4247e-04,  6.3361e-05, -9.9633e-06]],

         [[ 1.3850e-04, -1.1082e-04, -7.1442e-06,  3.9500e-05],
          [-2.3946e-04,  1.0247e-04,  9.6328e-05,  1.6604e-04],
          [-1.4405e-05, -2.4395e-05,  7.9106e-05, -2.1342e-05],
          [-8.8949e-05, -1.0931e-04,  1.6944e-05, -8.7982e-06]]],


        [[[ 1.4096e-04, -1.1955e-04,  8.8923e-05,  2.8074e-05],
          [ 2.0981e-04, -5.9185e-05,  9.6434e-06,  1.8313e-04],
          [ 1.2919e-04,  4.2929e-05,  6.8813e-05,  5.2635e-05],
          [ 4.1776e-05, -6.3595e-05, -8.0237e-05, -1.0836e-04]],

         [[ 2.6592e-05, -1.4625e-04, -5.4494e-05,  1.2825e-04],
          [ 1.8488e-04,  1.1906e-04, -4.7994e-04,  3.8936e-05],
          [-1.0304e-04, -2.2363e-04, -1.3935e-04,  1.9745e-05],
          [ 2.8536e-05,  1.4130e-04,  1.0746e-06, -7.3806e-05]],

         [[ 1.3233e-04, -9.3489e-05,  1.8343e-04,  6.4158e-05],
          [ 3.8204e-05,  2.8930e-05,  1.2523e-04, -2.1339e-04],
          [ 3.7456e-05, -4.9707e-05,  5.4062e-05, -7.6498e-05],
          [-1.6902e-04, -2.0828e-04, -1.4888e-04, -8.3518e-05]],

         ...,

         [[ 4.5926e-05, -2.4431e-05,  1.7624e-04,  7.8719e-05],
          [ 2.1718e-04,  1.9034e-05, -5.8014e-05,  1.4898e-04],
          [ 1.4892e-05,  1.1755e-04,  1.2645e-04,  1.4901e-04],
          [ 1.5158e-05, -4.1287e-05, -1.2591e-04, -4.5298e-05]],

         [[-5.2916e-05, -5.4669e-05,  9.4833e-05,  9.4899e-05],
          [ 9.1563e-06, -3.2232e-04, -3.9323e-05, -2.1731e-05],
          [-1.4746e-04, -5.2993e-05,  5.0976e-05, -1.4730e-05],
          [ 4.8053e-05,  6.3099e-05, -1.1436e-04,  4.6552e-05]],

         [[ 3.2601e-05,  2.8112e-05, -2.7829e-05,  1.0784e-04],
          [ 4.8097e-05, -9.6746e-05,  2.5529e-07, -3.2087e-05],
          [ 1.3508e-04, -9.3246e-05,  4.2503e-05, -1.6104e-05],
          [ 1.4404e-05, -2.5905e-04,  1.6267e-04,  8.2582e-05]]],


        ...,


        [[[ 2.0354e-04, -8.0313e-06, -1.6764e-05,  1.0981e-04],
          [-1.2339e-04,  7.8575e-05, -2.7239e-05, -1.1891e-04],
          [-9.5258e-05, -4.7622e-05, -1.5067e-04,  1.0906e-04],
          [ 1.2946e-04,  2.0054e-05, -2.7849e-04, -6.3624e-05]],

         [[ 7.2854e-05,  9.9218e-05,  7.6875e-05,  9.7682e-05],
          [ 2.1373e-04,  1.7900e-06,  3.0570e-05, -1.5723e-04],
          [ 1.5437e-04, -8.5118e-05, -1.4643e-04, -9.2838e-06],
          [-1.6297e-04, -3.8859e-05, -8.7354e-05,  6.9296e-05]],

         [[ 1.6173e-05,  1.1169e-05, -6.9224e-05,  9.3271e-05],
          [-1.6248e-04, -2.0553e-05, -1.0293e-04, -2.5507e-05],
          [-1.0065e-04,  1.4938e-05, -2.5162e-04,  5.0776e-05],
          [-1.1015e-04, -1.8002e-05,  1.7688e-04, -4.7915e-05]],

         ...,

         [[-8.4339e-05, -5.9037e-05, -7.7243e-05,  9.7235e-05],
          [ 1.2790e-04,  1.1901e-04, -9.0018e-06, -1.5503e-04],
          [ 2.5131e-04,  2.3555e-06,  5.0633e-05, -6.2691e-05],
          [-3.3691e-05,  9.9389e-06, -4.3857e-05,  3.7366e-05]],

         [[-2.8372e-05,  3.8492e-05, -4.0226e-05, -1.2217e-04],
          [-2.9848e-05, -1.2432e-05,  1.6571e-04, -1.3619e-05],
          [-9.1041e-05,  6.2076e-05, -8.3575e-05,  2.2522e-04],
          [-8.9730e-05, -2.1963e-05, -1.0455e-04, -5.2607e-05]],

         [[ 6.8790e-05,  4.8733e-05,  1.5229e-04, -1.0399e-04],
          [ 1.2835e-04, -2.1096e-04, -5.0643e-05,  8.6702e-05],
          [ 1.9166e-04,  1.3160e-05, -5.9583e-05, -4.4188e-06],
          [ 6.1781e-06,  4.0998e-05,  9.8322e-05, -4.7489e-05]]],


        [[[-7.5123e-06,  3.1312e-04, -1.5964e-04,  4.1843e-05],
          [-6.7886e-05, -9.0025e-07,  8.2480e-05, -1.5997e-05],
          [-3.3264e-05,  6.7120e-05,  1.2008e-04,  6.8379e-05],
          [-5.9351e-05,  1.3708e-04,  1.2871e-04,  4.9868e-05]],

         [[-5.6534e-05,  1.0157e-04,  2.4310e-05, -4.7214e-05],
          [-1.3697e-04,  1.4075e-04,  1.3893e-04,  1.2681e-04],
          [ 7.5228e-05,  1.0261e-04,  9.3703e-05,  8.7859e-05],
          [-1.1995e-04, -1.6459e-04,  4.0903e-05,  2.8030e-05]],

         [[ 1.2359e-04,  1.6716e-04,  1.1636e-06,  1.8652e-04],
          [-3.7360e-05, -3.4733e-05, -6.9963e-05,  1.1332e-04],
          [ 2.8281e-05,  4.7378e-05,  7.2025e-05,  1.9769e-04],
          [ 3.8009e-05,  5.0647e-05,  1.5832e-04, -9.5037e-05]],

         ...,

         [[-9.3722e-05, -1.3511e-06, -5.1872e-05, -1.1093e-04],
          [ 1.7345e-04,  1.2614e-05, -3.4747e-05,  6.6084e-05],
          [-2.6526e-05,  7.3396e-05, -6.1394e-05, -1.4753e-05],
          [ 1.6657e-04, -1.2795e-04, -6.2356e-05, -1.0605e-04]],

         [[-7.2050e-05, -8.6575e-05,  4.9066e-05,  1.8732e-04],
          [-1.5383e-05,  8.7010e-05, -4.9684e-05,  1.0541e-04],
          [ 1.2002e-04,  1.2309e-04,  6.0026e-05, -1.6334e-04],
          [-1.1283e-04, -2.0647e-04,  1.1130e-04, -2.7998e-06]],

         [[-3.9416e-05, -6.9677e-05,  1.3522e-04,  1.1375e-04],
          [ 1.5443e-04,  1.6057e-04, -1.4267e-04,  1.0057e-04],
          [-1.7682e-05, -1.7738e-04, -9.1450e-05, -3.0803e-05],
          [-6.2798e-06, -1.0003e-04, -1.5529e-04,  3.6825e-05]]],


        [[[-1.1012e-04,  3.4310e-04, -1.5085e-04,  1.0025e-04],
          [-9.5939e-05, -5.8178e-05, -2.2222e-06,  2.1453e-04],
          [-1.1631e-04,  1.4290e-04,  4.1404e-05, -1.4106e-05],
          [ 8.8961e-05,  1.9764e-04,  9.4990e-05,  1.1612e-04]],

         [[-7.5178e-05,  9.3421e-05, -1.0145e-04,  3.1192e-05],
          [-2.0052e-04,  1.2238e-04,  1.1329e-04, -2.1051e-05],
          [ 8.2627e-05,  1.3623e-04, -3.5440e-05,  1.1867e-04],
          [-2.6741e-04, -9.1957e-05,  1.2327e-04,  1.4694e-04]],

         [[ 1.4932e-04,  8.0684e-05,  1.4938e-05,  1.6937e-04],
          [-2.0203e-05, -2.0945e-04, -1.7129e-05,  5.7866e-05],
          [ 6.4149e-05, -1.7365e-05,  3.5787e-05,  2.4466e-04],
          [ 4.3409e-05,  9.6488e-05,  2.3646e-05, -2.6800e-05]],

         ...,

         [[-1.2806e-04,  1.0881e-05, -1.4928e-04, -2.9938e-04],
          [ 9.7191e-05,  1.0733e-05, -5.5509e-05,  1.4634e-05],
          [ 1.9686e-05,  1.5239e-04,  6.2749e-05, -1.1558e-04],
          [ 2.0843e-04, -1.5623e-04, -1.5008e-05, -5.6434e-05]],

         [[ 3.8444e-05,  1.7760e-06,  3.2227e-05,  2.0686e-04],
          [ 4.8044e-05,  7.1849e-05, -3.5516e-05,  1.0636e-04],
          [ 8.7879e-05, -3.1253e-05,  9.0300e-05, -1.5351e-04],
          [-6.7404e-05, -2.3193e-04,  5.8042e-05,  5.2314e-05]],

         [[-1.1392e-04, -1.5065e-04,  1.3262e-04,  1.1352e-04],
          [ 2.0993e-04,  3.4894e-05, -1.4039e-04,  7.8984e-05],
          [ 7.1713e-05, -1.8900e-04, -7.4206e-05,  2.4257e-06],
          [-5.1595e-05, -5.6847e-05, -9.3307e-05, -2.3638e-06]]]]) 
 old gradient:tensor([[ 4.8780e-04,  3.4667e-04, -2.7305e-04,  ...,  1.8466e-04,
         -6.7063e-04, -4.6133e-04],
        [-2.7650e-04, -7.2083e-04,  2.4407e-04,  ...,  5.4003e-04,
         -4.5592e-04, -4.4798e-04],
        [-1.4329e-04,  1.1042e-04,  2.2355e-04,  ..., -7.3185e-04,
         -4.4106e-04,  6.2599e-04],
        ...,
        [-6.5923e-05, -3.4974e-04,  2.3742e-05,  ..., -1.9102e-04,
          5.0525e-04,  2.3001e-04],
        [-4.9245e-04, -6.7249e-04, -3.9634e-04,  ..., -1.7936e-04,
          3.0191e-04,  5.7984e-04],
        [-4.9806e-04, -6.8159e-04, -3.9047e-04,  ..., -1.8067e-04,
          2.9640e-04,  5.8618e-04]])
2024-11-30 13:26:34,659 - INFO - reading batch[123] client 3
2024-11-30 13:26:34,687 - INFO - reading batch[123] client 4
2024-11-30 13:26:34,700 - INFO - Final partition
2024-11-30 13:26:34,701 - INFO - reading batch[124] client 1
2024-11-30 13:26:34,725 - INFO - reading batch[124] client 2
2024-11-30 13:26:34,742 - INFO - reading batch[124] client 3
2024-11-30 13:26:34,767 - INFO - reading batch[124] client 4
2024-11-30 13:26:34,792 - INFO - reading batch[125] client 1
2024-11-30 13:26:34,811 - INFO - reading batch[125] client 2
2024-11-30 13:26:34,833 - INFO - reading batch[125] client 3
2024-11-30 13:26:34,846 - ERROR - backward on partition 4
2024-11-30 13:26:34,847 - CRITICAL - calculate backward $4 on client4
2024-11-30 13:26:34,852 - CRITICAL - new gradient:tensor([[-4.6219e-04,  4.1411e-04,  3.4382e-04,  ...,  3.7670e-04,
          5.9494e-04,  8.6197e-05],
        [-4.8502e-04, -6.8576e-04, -3.9916e-04,  ..., -1.7890e-04,
          2.8900e-04,  5.7082e-04],
        [-8.4611e-05, -3.5833e-04,  3.0805e-05,  ..., -1.9436e-04,
          5.0535e-04,  2.4412e-04],
        ...,
        [-4.5085e-04,  4.0856e-04,  3.2265e-04,  ...,  3.7302e-04,
          5.9051e-04,  7.0589e-05],
        [ 4.9001e-04, -8.1289e-06, -1.9973e-05,  ..., -7.9169e-05,
         -3.6782e-04, -3.3026e-04],
        [ 4.7341e-04,  3.5442e-04, -2.6397e-04,  ...,  1.8703e-04,
         -6.7483e-04, -4.4858e-04]]) 
 old gradient:tensor([[ 0.0019,  0.0015,  0.0018,  0.0013,  0.0014,  0.0014, -0.0142,  0.0015,
          0.0018,  0.0015],
        [ 0.0020,  0.0014,  0.0017,  0.0014,  0.0015, -0.0142,  0.0016,  0.0014,
          0.0017,  0.0014],
        [ 0.0020,  0.0015,  0.0018,  0.0013,  0.0014,  0.0014,  0.0014, -0.0141,
          0.0017,  0.0015],
        [ 0.0020,  0.0015, -0.0139,  0.0014,  0.0014,  0.0014,  0.0014,  0.0015,
          0.0018,  0.0015],
        [ 0.0020,  0.0015,  0.0017,  0.0013,  0.0016,  0.0014, -0.0142,  0.0015,
          0.0017,  0.0014],
        [ 0.0018,  0.0014,  0.0017,  0.0014,  0.0014,  0.0015,  0.0015,  0.0015,
         -0.0139,  0.0015],
        [ 0.0020,  0.0014,  0.0017,  0.0014,  0.0015,  0.0014,  0.0015,  0.0015,
         -0.0139,  0.0015],
        [ 0.0020,  0.0015,  0.0017,  0.0013, -0.0140,  0.0015,  0.0015,  0.0016,
          0.0017,  0.0014],
        [ 0.0020,  0.0014,  0.0017,  0.0014,  0.0015,  0.0015,  0.0015,  0.0015,
          0.0016, -0.0142],
        [ 0.0020,  0.0013,  0.0016,  0.0014,  0.0016, -0.0142,  0.0016,  0.0015,
          0.0017,  0.0015],
        [ 0.0021,  0.0015,  0.0017,  0.0014,  0.0014,  0.0014,  0.0014,  0.0015,
         -0.0138,  0.0015],
        [ 0.0019,  0.0015,  0.0018,  0.0013, -0.0141,  0.0015,  0.0014,  0.0015,
          0.0017,  0.0016],
        [ 0.0020,  0.0014,  0.0017,  0.0014,  0.0015,  0.0015,  0.0015,  0.0015,
          0.0017, -0.0141],
        [ 0.0020,  0.0014,  0.0017, -0.0143,  0.0015,  0.0014,  0.0015,  0.0015,
          0.0016,  0.0015],
        [ 0.0021,  0.0015,  0.0018,  0.0014, -0.0142,  0.0015,  0.0014,  0.0014,
          0.0018,  0.0014],
        [ 0.0021,  0.0014,  0.0017,  0.0014,  0.0016, -0.0142,  0.0015,  0.0015,
          0.0016,  0.0016],
        [ 0.0021,  0.0014,  0.0018,  0.0014, -0.0141,  0.0014,  0.0014,  0.0015,
          0.0018,  0.0014],
        [-0.0138,  0.0014,  0.0016,  0.0014,  0.0016,  0.0015,  0.0015,  0.0014,
          0.0017,  0.0016],
        [ 0.0018, -0.0142,  0.0016,  0.0014,  0.0015,  0.0015,  0.0016,  0.0015,
          0.0016,  0.0016],
        [-0.0134,  0.0014,  0.0017,  0.0014,  0.0015,  0.0014,  0.0014,  0.0015,
          0.0017,  0.0014],
        [-0.0136,  0.0014,  0.0016,  0.0013,  0.0015,  0.0014,  0.0015,  0.0014,
          0.0018,  0.0015],
        [ 0.0020,  0.0015,  0.0017, -0.0142,  0.0016,  0.0014,  0.0014,  0.0015,
          0.0016,  0.0015],
        [ 0.0020,  0.0014,  0.0016,  0.0015,  0.0016,  0.0015,  0.0016, -0.0142,
          0.0015,  0.0015],
        [ 0.0021,  0.0014,  0.0018,  0.0014, -0.0142,  0.0014,  0.0014,  0.0014,
          0.0019,  0.0015],
        [ 0.0022,  0.0015,  0.0018,  0.0012,  0.0014,  0.0013, -0.0143,  0.0015,
          0.0018,  0.0015],
        [ 0.0018, -0.0142,  0.0017,  0.0014,  0.0015,  0.0015,  0.0015,  0.0015,
          0.0018,  0.0016],
        [ 0.0020,  0.0014,  0.0017,  0.0015,  0.0016, -0.0143,  0.0014,  0.0015,
          0.0018,  0.0015],
        [ 0.0019, -0.0142,  0.0017,  0.0014,  0.0015,  0.0015,  0.0015,  0.0014,
          0.0017,  0.0016],
        [ 0.0020,  0.0014, -0.0138,  0.0014,  0.0016,  0.0014,  0.0014,  0.0015,
          0.0018,  0.0014],
        [ 0.0021,  0.0014,  0.0017,  0.0013,  0.0016,  0.0014, -0.0142,  0.0015,
          0.0018,  0.0014],
        [ 0.0020,  0.0014,  0.0018,  0.0014, -0.0141,  0.0015,  0.0014,  0.0014,
          0.0017,  0.0015],
        [ 0.0021,  0.0014,  0.0017,  0.0013,  0.0016,  0.0015,  0.0015,  0.0015,
          0.0017, -0.0142],
        [ 0.0021,  0.0014, -0.0139,  0.0012,  0.0014,  0.0015,  0.0014,  0.0016,
          0.0020,  0.0014],
        [ 0.0022,  0.0015,  0.0016, -0.0143,  0.0014,  0.0013,  0.0014,  0.0014,
          0.0019,  0.0015],
        [-0.0134,  0.0015,  0.0018,  0.0013,  0.0014,  0.0014,  0.0014,  0.0014,
          0.0018,  0.0014],
        [ 0.0020,  0.0014,  0.0018,  0.0013,  0.0016,  0.0014, -0.0142,  0.0015,
          0.0017,  0.0015],
        [ 0.0023,  0.0014,  0.0018,  0.0014,  0.0013,  0.0014,  0.0014,  0.0014,
         -0.0138,  0.0015],
        [ 0.0021,  0.0014, -0.0138,  0.0013,  0.0014,  0.0014,  0.0014,  0.0015,
          0.0018,  0.0014],
        [-0.0134,  0.0013,  0.0017,  0.0014,  0.0014,  0.0014,  0.0014,  0.0013,
          0.0018,  0.0016],
        [ 0.0020,  0.0014,  0.0017,  0.0015,  0.0016,  0.0015,  0.0015, -0.0142,
          0.0016,  0.0015],
        [ 0.0021,  0.0014,  0.0016, -0.0143,  0.0015,  0.0014,  0.0016,  0.0015,
          0.0017,  0.0015],
        [ 0.0021,  0.0014,  0.0017,  0.0014,  0.0015,  0.0014,  0.0015,  0.0014,
         -0.0139,  0.0015],
        [ 0.0019,  0.0014,  0.0017, -0.0142,  0.0016,  0.0015,  0.0015,  0.0014,
          0.0018,  0.0015],
        [ 0.0019,  0.0014,  0.0017,  0.0015,  0.0015,  0.0015,  0.0015,  0.0014,
          0.0017, -0.0141],
        [ 0.0020,  0.0014,  0.0018,  0.0014,  0.0015,  0.0014,  0.0015,  0.0015,
          0.0016, -0.0141],
        [ 0.0022,  0.0015,  0.0018,  0.0012,  0.0015,  0.0014, -0.0143,  0.0014,
          0.0019,  0.0015],
        [ 0.0021,  0.0014,  0.0018,  0.0014,  0.0015,  0.0014,  0.0014,  0.0015,
         -0.0139,  0.0015],
        [ 0.0021,  0.0015,  0.0019,  0.0012,  0.0015,  0.0014, -0.0143,  0.0014,
          0.0018,  0.0015],
        [ 0.0021,  0.0015, -0.0138,  0.0013,  0.0014,  0.0014,  0.0014,  0.0015,
          0.0017,  0.0015],
        [ 0.0019, -0.0142,  0.0017,  0.0014,  0.0014,  0.0014,  0.0015,  0.0015,
          0.0018,  0.0016],
        [ 0.0020,  0.0015,  0.0018, -0.0144,  0.0014,  0.0015,  0.0015,  0.0015,
          0.0016,  0.0015],
        [ 0.0019, -0.0142,  0.0017,  0.0014,  0.0015,  0.0014,  0.0015,  0.0015,
          0.0017,  0.0016],
        [-0.0136,  0.0013,  0.0016,  0.0014,  0.0016,  0.0014,  0.0016,  0.0013,
          0.0018,  0.0015],
        [ 0.0020,  0.0015,  0.0018,  0.0014, -0.0141,  0.0014,  0.0014,  0.0015,
          0.0017,  0.0015],
        [ 0.0020,  0.0013,  0.0018, -0.0143,  0.0015,  0.0014,  0.0015,  0.0015,
          0.0019,  0.0014],
        [ 0.0020,  0.0013,  0.0017,  0.0014,  0.0015, -0.0143,  0.0015,  0.0015,
          0.0017,  0.0015],
        [ 0.0020,  0.0014,  0.0018,  0.0014, -0.0141,  0.0015,  0.0014,  0.0014,
          0.0017,  0.0015],
        [ 0.0022,  0.0014,  0.0017,  0.0014,  0.0013,  0.0014,  0.0014,  0.0014,
          0.0020, -0.0142],
        [ 0.0020,  0.0015,  0.0018,  0.0013, -0.0142,  0.0015,  0.0014,  0.0015,
          0.0018,  0.0015],
        [ 0.0020,  0.0014,  0.0017, -0.0142,  0.0015,  0.0014,  0.0014,  0.0014,
          0.0017,  0.0016],
        [ 0.0019,  0.0015,  0.0017,  0.0014, -0.0141,  0.0015,  0.0015,  0.0014,
          0.0016,  0.0015],
        [ 0.0018,  0.0015,  0.0017,  0.0015,  0.0017,  0.0014, -0.0142,  0.0014,
          0.0016,  0.0016],
        [-0.0134,  0.0014,  0.0016,  0.0013,  0.0016,  0.0014,  0.0014,  0.0015,
          0.0018,  0.0015],
        [ 0.0021,  0.0016, -0.0140,  0.0013,  0.0014,  0.0015,  0.0014,  0.0015,
          0.0018,  0.0015]])
2024-11-30 13:26:34,853 - INFO - reading batch[125] client 4
2024-11-30 13:26:34,876 - INFO - reading batch[126] client 1
2024-11-30 13:26:34,902 - INFO - reading batch[126] client 2
2024-11-30 13:26:34,932 - INFO - reading batch[126] client 3
2024-11-30 13:26:34,949 - INFO - reading batch[126] client 4
2024-11-30 13:26:34,971 - INFO - reading batch[127] client 1
2024-11-30 13:26:34,989 - INFO - reading batch[127] client 2
2024-11-30 13:26:35,003 - INFO - reading batch[127] client 3
2024-11-30 13:26:35,025 - INFO - reading batch[127] client 4
2024-11-30 13:26:35,054 - INFO - reading batch[128] client 1
2024-11-30 13:26:35,078 - INFO - reading batch[128] client 2
2024-11-30 13:26:35,112 - INFO - reading batch[128] client 3
2024-11-30 13:26:35,140 - INFO - reading batch[128] client 4
2024-11-30 13:26:35,171 - INFO - reading batch[129] client 1
2024-11-30 13:26:35,190 - INFO - reading batch[129] client 2
2024-11-30 13:26:35,204 - INFO - reading batch[129] client 3
2024-11-30 13:26:35,226 - INFO - reading batch[129] client 4
2024-11-30 13:26:35,251 - INFO - reading batch[130] client 1
2024-11-30 13:26:35,269 - INFO - reading batch[130] client 2
2024-11-30 13:26:35,291 - INFO - reading batch[130] client 3
2024-11-30 13:26:35,315 - INFO - reading batch[130] client 4
2024-11-30 13:26:35,342 - INFO - reading batch[131] client 1
2024-11-30 13:26:35,359 - INFO - reading batch[131] client 2
2024-11-30 13:26:35,373 - INFO - reading batch[131] client 3
2024-11-30 13:26:35,386 - INFO - reading batch[131] client 4
2024-11-30 13:26:35,408 - INFO - reading batch[132] client 1
2024-11-30 13:26:35,433 - INFO - reading batch[132] client 2
2024-11-30 13:26:35,463 - INFO - reading batch[132] client 3
2024-11-30 13:26:35,488 - INFO - reading batch[132] client 4
2024-11-30 13:26:35,514 - INFO - reading batch[133] client 1
2024-11-30 13:26:35,532 - INFO - reading batch[133] client 2
2024-11-30 13:26:35,561 - INFO - reading batch[133] client 3
2024-11-30 13:26:35,588 - INFO - reading batch[133] client 4
2024-11-30 13:26:35,610 - INFO - reading batch[134] client 1
2024-11-30 13:26:35,634 - INFO - reading batch[134] client 2
2024-11-30 13:26:35,649 - ERROR - backward on partition 3
2024-11-30 13:26:35,652 - CRITICAL - calculate backward $3 on client3
2024-11-30 13:26:35,660 - CRITICAL - new gradient:tensor([[[[-5.5272e-05, -1.7945e-04,  2.3059e-04, -2.0872e-04],
          [-2.2723e-04, -2.2696e-04, -4.2620e-05,  1.0652e-04],
          [ 3.3891e-05,  9.5301e-05,  1.0316e-04, -6.8719e-05],
          [-2.4979e-04,  1.1300e-04,  3.9044e-05, -1.3162e-05]],

         [[-7.2015e-05,  5.3691e-05,  1.0538e-04, -5.0027e-05],
          [-1.2407e-04, -1.7075e-04,  9.4060e-05, -2.0515e-04],
          [ 8.7189e-05, -1.3416e-04, -2.7936e-05, -1.1115e-04],
          [ 2.5581e-04,  1.7581e-04, -1.0138e-05, -3.6392e-04]],

         [[ 8.8638e-05, -9.3977e-05, -1.6057e-04,  2.3346e-05],
          [-1.7185e-04,  1.0932e-05,  2.8613e-05,  2.5154e-06],
          [-2.6031e-05, -7.7464e-05,  7.3648e-05, -4.9309e-05],
          [ 1.2189e-04,  1.6941e-05, -1.6786e-04, -7.5850e-05]],

         ...,

         [[ 9.3067e-05,  6.0385e-07, -2.1795e-05,  2.6211e-05],
          [-3.6901e-04, -6.7305e-06,  1.8387e-04, -7.0897e-05],
          [ 1.3181e-06, -5.0622e-05,  1.7182e-04,  1.3355e-04],
          [ 2.1852e-05, -8.8475e-05,  2.6941e-04, -3.4787e-05]],

         [[-6.3686e-05, -3.8240e-05, -2.4277e-05,  3.0533e-05],
          [-1.2089e-04, -1.9946e-05,  1.0498e-04,  2.3205e-04],
          [ 2.7635e-04, -6.0150e-06,  1.4425e-04,  5.7621e-05],
          [-3.0984e-05, -2.8816e-04, -1.0996e-04, -2.5676e-04]],

         [[ 1.2536e-05,  2.5815e-04,  6.5836e-06, -1.6086e-04],
          [ 4.6463e-05, -3.6528e-05,  2.2366e-05,  1.6905e-05],
          [-3.2631e-05,  2.1400e-04,  1.8312e-04,  8.1315e-05],
          [ 9.0519e-05,  4.8062e-05,  3.3952e-05, -1.4378e-05]]],


        [[[-2.2038e-04,  2.3135e-05, -4.2003e-05,  1.0344e-04],
          [ 3.0295e-05,  2.0378e-04, -6.4813e-05, -8.4182e-06],
          [-5.8741e-05, -1.8425e-04, -1.6766e-04, -2.9121e-04],
          [ 1.1773e-04, -1.8168e-04,  5.1186e-05,  2.0006e-04]],

         [[ 1.0024e-04, -3.2446e-04, -1.5758e-04, -2.3527e-05],
          [ 1.6164e-04, -1.2566e-04,  4.0376e-04,  7.7571e-06],
          [-1.5087e-04,  1.4863e-04,  2.4311e-04, -2.0094e-04],
          [-1.0624e-04, -9.0172e-05, -1.5983e-04,  2.7403e-04]],

         [[-3.5238e-04,  1.7510e-04, -5.3541e-05, -6.4921e-05],
          [-3.0191e-04,  6.3766e-05, -1.2217e-04, -1.6633e-04],
          [ 4.3496e-05,  7.0038e-05,  3.7471e-05, -3.0044e-04],
          [ 3.0129e-05,  1.0226e-04, -1.6691e-05, -6.9927e-05]],

         ...,

         [[ 7.6262e-05, -6.9822e-05, -7.8922e-05, -6.6212e-05],
          [-8.0040e-05, -7.2615e-05,  3.0655e-05, -2.8955e-04],
          [-2.7023e-05, -1.9619e-04, -1.7389e-04,  6.1914e-05],
          [ 3.8170e-05,  1.3937e-04,  1.1833e-04,  1.0544e-04]],

         [[ 3.5675e-05,  1.5105e-04, -1.2979e-04, -2.2292e-04],
          [-6.0173e-05,  1.0076e-06,  1.5316e-04,  1.0595e-04],
          [ 2.3631e-05,  9.6572e-05, -2.9015e-04,  9.2673e-05],
          [-9.3545e-06,  1.8398e-04,  6.1968e-05,  7.1832e-05]],

         [[-9.8149e-06, -1.3525e-04,  8.9408e-05, -9.6102e-05],
          [-9.5526e-05,  4.4687e-06, -1.2936e-04, -1.0397e-04],
          [-3.7625e-05,  3.0006e-05, -8.6117e-05, -2.2316e-04],
          [-1.7970e-05,  3.4499e-04,  1.1327e-04,  5.5924e-05]]],


        [[[ 1.4671e-04, -1.3428e-04,  2.5145e-04,  7.5382e-06],
          [-6.7954e-04, -1.4617e-04,  9.4311e-05,  5.4190e-05],
          [ 1.8329e-04, -3.9530e-05,  2.2261e-05,  4.8022e-05],
          [-1.9368e-05, -9.9528e-05, -3.0560e-04, -1.6370e-04]],

         [[-1.9655e-04,  5.8160e-05, -3.1072e-05, -3.2332e-04],
          [ 1.8890e-04, -6.2304e-04,  2.4338e-06, -3.7366e-04],
          [-5.1637e-05, -2.7009e-05,  4.0297e-04, -3.4463e-04],
          [ 1.2015e-04,  2.4812e-04, -7.7438e-06,  1.0622e-04]],

         [[ 1.1524e-04, -1.1353e-04, -1.0383e-04, -4.9906e-05],
          [-2.6527e-04, -7.6312e-05,  6.5164e-05, -3.8293e-05],
          [ 1.9323e-04, -4.4432e-05,  1.8116e-04, -1.9310e-04],
          [-3.4429e-05,  3.8758e-04, -2.2886e-04, -6.7048e-05]],

         ...,

         [[-1.1055e-04, -8.4517e-05,  5.1181e-05, -1.3366e-04],
          [-2.8731e-04,  1.3827e-05, -2.4083e-04, -2.5004e-04],
          [-4.7964e-05,  5.5258e-05,  2.2707e-04,  1.4544e-05],
          [ 7.2342e-05, -1.6777e-04,  1.8526e-04, -1.0817e-04]],

         [[-2.5520e-05, -3.4186e-04, -2.6455e-05,  1.4391e-04],
          [-1.0946e-04,  1.8062e-04,  1.0563e-05,  1.6206e-04],
          [ 1.5267e-04, -3.2679e-05,  3.0248e-04,  1.1281e-04],
          [-5.5389e-04, -7.3367e-05,  7.8562e-05, -8.2235e-05]],

         [[-1.4149e-04,  5.4689e-04, -9.1036e-05, -4.7981e-05],
          [ 1.2299e-04,  6.3823e-05,  1.0320e-04,  1.1032e-04],
          [-2.0744e-04,  4.9347e-05,  6.1909e-04,  3.2031e-04],
          [-9.6637e-05,  5.8880e-05, -2.5032e-05, -1.2066e-04]]],


        ...,


        [[[ 1.4751e-04, -1.9536e-04, -1.4260e-04, -1.5046e-04],
          [ 1.3953e-04, -5.3597e-05,  2.0815e-04, -6.9673e-06],
          [ 1.8788e-06,  2.5758e-05, -3.8889e-05,  1.5259e-04],
          [ 2.3008e-04, -4.8202e-05,  1.2267e-05,  9.6111e-05]],

         [[ 1.0538e-04,  2.2502e-05,  2.3870e-04,  9.0072e-05],
          [-2.2667e-04,  4.4544e-05,  5.0083e-05, -1.4321e-04],
          [ 6.8522e-05,  1.9192e-04, -9.9348e-05,  1.6816e-04],
          [ 5.6334e-05, -7.8155e-05,  5.9741e-05,  1.5258e-04]],

         [[ 4.6423e-05, -1.7795e-04, -1.4265e-04, -4.1215e-05],
          [ 4.3396e-04, -6.1099e-05,  1.9069e-04,  1.5029e-04],
          [ 8.7353e-05,  6.5566e-05, -3.2153e-05,  1.5993e-04],
          [-3.3484e-05,  1.1293e-04,  1.0825e-04,  2.4374e-04]],

         ...,

         [[ 1.3705e-04, -2.4487e-05, -6.8423e-05, -1.3756e-04],
          [ 1.0498e-04, -4.2120e-05, -2.7502e-05,  1.2290e-05],
          [-4.4236e-04, -3.1830e-04, -1.9346e-04, -2.1924e-04],
          [ 7.1767e-07,  1.2922e-04, -1.2850e-04, -1.1227e-04]],

         [[-1.5128e-05,  3.4672e-05, -2.4043e-05,  3.7297e-05],
          [ 2.1621e-04,  3.2670e-04, -6.4638e-05, -1.2151e-04],
          [-1.7487e-04,  6.5890e-05, -6.1663e-05, -1.4179e-04],
          [ 2.5264e-04,  1.7384e-04,  1.2022e-04,  2.2629e-06]],

         [[-2.4472e-04,  2.2578e-04, -2.1301e-04,  1.4179e-04],
          [ 5.3084e-05,  3.5814e-05,  1.0722e-04, -2.9979e-04],
          [-6.7666e-05, -3.2848e-05, -4.9688e-05,  5.6429e-05],
          [-2.2983e-05,  6.8037e-05, -5.9959e-05, -2.6085e-04]]],


        [[[-2.2922e-05, -3.2752e-05,  2.2640e-04, -1.8984e-05],
          [ 1.0452e-04, -4.7059e-05, -2.7909e-04,  8.9626e-05],
          [ 8.0324e-05, -3.6599e-06, -6.6058e-05, -1.4292e-04],
          [ 2.0214e-04, -2.7706e-05, -1.4621e-05,  2.5230e-05]],

         [[-1.7238e-04, -1.4846e-04, -2.7406e-04,  1.2659e-04],
          [ 5.0711e-04,  9.9323e-06, -2.7490e-04,  1.5085e-04],
          [-2.4239e-04, -3.6558e-04,  9.7451e-05,  1.4964e-06],
          [ 1.0037e-06,  1.0789e-04,  1.5152e-04,  2.3565e-05]],

         [[-2.4294e-05, -1.0348e-04, -7.1536e-05, -3.8707e-06],
          [-1.2436e-04, -2.9288e-05,  7.1676e-05, -2.1219e-04],
          [ 1.3208e-04, -3.2307e-05, -6.1776e-05, -1.8231e-04],
          [-1.9664e-04, -1.7060e-04, -2.1922e-05, -1.5402e-04]],

         ...,

         [[ 1.6056e-05,  1.0997e-05,  2.2074e-04,  5.3891e-06],
          [ 3.5759e-04,  2.7452e-05, -1.8256e-04, -9.6761e-05],
          [ 2.3712e-04, -1.2559e-05, -9.3055e-05,  7.8210e-05],
          [ 4.1148e-05, -2.2479e-04, -1.7042e-04, -7.4522e-05]],

         [[-9.1153e-05,  6.8923e-05,  1.3666e-04,  4.2338e-06],
          [-7.9954e-05, -2.1520e-04,  1.0725e-04,  1.1121e-04],
          [-5.7645e-05, -1.9279e-04, -1.4438e-04,  7.1010e-05],
          [ 2.4765e-05,  2.3183e-04,  1.9510e-05,  1.9761e-04]],

         [[ 1.5269e-04,  2.1046e-05, -2.1890e-05,  9.7065e-05],
          [ 1.1999e-04, -4.0470e-05,  7.1588e-05, -1.5196e-05],
          [ 1.5178e-04,  9.6035e-05, -1.2146e-04, -3.3679e-05],
          [-9.0389e-06, -1.4270e-04,  1.1942e-04,  3.2862e-05]]],


        [[[ 2.8660e-04,  1.4273e-05, -2.0141e-04, -1.1638e-04],
          [ 9.9874e-05, -7.0029e-05,  2.2654e-04,  1.2447e-05],
          [-2.9744e-05, -6.4264e-06, -4.8636e-06,  2.7171e-04],
          [ 1.2913e-04, -7.1048e-05,  5.2306e-05, -5.4109e-05]],

         [[ 5.2281e-05,  7.6835e-05,  1.0732e-04, -1.3304e-04],
          [-1.9105e-04, -1.4065e-05, -2.1530e-05,  1.8727e-05],
          [ 6.2903e-05,  1.5115e-04, -8.3385e-05,  2.4637e-04],
          [ 5.4152e-06, -4.5439e-05, -2.6126e-06,  1.9767e-04]],

         [[-9.6894e-05, -1.1034e-04,  5.9267e-06, -1.4817e-04],
          [ 3.4223e-04,  1.5124e-05,  1.1376e-04,  1.9961e-04],
          [-1.6714e-05,  1.0426e-04,  7.0342e-05,  1.0168e-04],
          [-4.2702e-05,  5.7423e-06,  9.7974e-05,  3.4789e-04]],

         ...,

         [[ 3.2146e-05,  1.5806e-05, -1.2626e-04, -3.8591e-05],
          [ 5.1137e-05, -1.5933e-04, -2.8341e-05, -7.9875e-05],
          [-2.1692e-04, -2.3613e-04,  4.7442e-05, -1.9051e-04],
          [-9.7054e-05, -1.1073e-04, -2.5838e-04, -1.0101e-05]],

         [[ 8.9414e-05, -3.9169e-06,  4.4952e-05,  3.5312e-05],
          [ 3.6840e-04,  3.0821e-04, -2.7298e-04, -2.4014e-04],
          [-1.9546e-04,  1.5486e-04, -1.7803e-04, -1.2779e-04],
          [ 3.1367e-04,  2.4115e-05, -9.1917e-06,  3.6716e-05]],

         [[-2.1503e-04,  1.9348e-05, -1.3812e-04,  9.5443e-05],
          [-2.7082e-04,  1.1717e-04,  1.7700e-04, -2.5843e-04],
          [-8.6800e-06,  1.9328e-05,  3.5780e-05,  1.7570e-04],
          [-2.2114e-04,  1.8668e-05,  1.5388e-05,  4.3414e-05]]]]) 
 old gradient:tensor([[ 0.0011,  0.0005, -0.0004,  ...,  0.0002, -0.0004, -0.0008],
        [ 0.0002,  0.0002, -0.0004,  ..., -0.0003, -0.0001, -0.0003],
        [ 0.0012,  0.0003, -0.0003,  ...,  0.0001,  0.0004, -0.0008],
        ...,
        [-0.0006,  0.0008,  0.0009,  ...,  0.0006,  0.0009,  0.0005],
        [-0.0004,  0.0004, -0.0002,  ..., -0.0010, -0.0002,  0.0006],
        [-0.0006,  0.0008,  0.0009,  ...,  0.0006,  0.0009,  0.0005]])
2024-11-30 13:26:35,660 - INFO - reading batch[134] client 3
2024-11-30 13:26:35,686 - INFO - reading batch[134] client 4
2024-11-30 13:26:35,700 - INFO - Final partition
2024-11-30 13:26:35,701 - INFO - reading batch[135] client 1
2024-11-30 13:26:35,719 - INFO - reading batch[135] client 2
2024-11-30 13:26:35,741 - INFO - reading batch[135] client 3
2024-11-30 13:26:35,758 - INFO - reading batch[135] client 4
2024-11-30 13:26:35,786 - INFO - reading batch[136] client 1
2024-11-30 13:26:35,812 - INFO - reading batch[136] client 2
2024-11-30 13:26:35,841 - INFO - reading batch[136] client 3
2024-11-30 13:26:35,865 - INFO - reading batch[136] client 4
2024-11-30 13:26:35,898 - INFO - reading batch[137] client 1
2024-11-30 13:26:35,920 - INFO - reading batch[137] client 2
2024-11-30 13:26:35,934 - INFO - reading batch[137] client 3
2024-11-30 13:26:35,955 - INFO - reading batch[137] client 4
2024-11-30 13:26:35,979 - INFO - reading batch[138] client 1
2024-11-30 13:26:35,997 - INFO - reading batch[138] client 2
2024-11-30 13:26:36,024 - INFO - reading batch[138] client 3
2024-11-30 13:26:36,037 - INFO - reading batch[138] client 4
2024-11-30 13:26:36,060 - INFO - reading batch[139] client 1
2024-11-30 13:26:36,087 - INFO - reading batch[139] client 2
2024-11-30 13:26:36,112 - INFO - reading batch[139] client 3
2024-11-30 13:26:36,127 - INFO - Final partition
2024-11-30 13:26:36,128 - INFO - reading batch[139] client 4
2024-11-30 13:26:36,159 - INFO - reading batch[140] client 1
2024-11-30 13:26:36,186 - INFO - reading batch[140] client 2
2024-11-30 13:26:36,200 - ERROR - backward on partition 3
2024-11-30 13:26:36,205 - CRITICAL - calculate backward $3 on client3
2024-11-30 13:26:36,217 - CRITICAL - new gradient:tensor([[[[ 2.6464e-05, -1.1956e-04,  1.9165e-04, -1.3745e-04],
          [-3.3431e-04, -6.4964e-05,  8.6239e-05,  1.2622e-07],
          [ 9.9881e-05,  3.1894e-05,  6.3621e-05,  7.4400e-05],
          [-2.6757e-04,  1.1862e-05, -3.4133e-05, -8.2985e-06]],

         [[-1.1122e-04,  8.5978e-05,  9.4837e-05, -9.8370e-05],
          [-1.5208e-04, -1.3144e-04,  5.7800e-05, -3.9875e-05],
          [-2.1012e-05, -1.6237e-04,  1.0340e-04, -1.8541e-04],
          [ 1.0384e-04,  3.8577e-05, -1.4771e-04, -3.1433e-04]],

         [[-2.8352e-05, -4.1850e-05, -3.2307e-05, -2.5359e-06],
          [-1.2736e-04, -8.7701e-06,  7.3357e-05, -6.2434e-05],
          [-5.7968e-06, -5.1426e-05,  5.1519e-05, -1.4803e-04],
          [ 2.4844e-04, -2.3887e-05, -1.4699e-04, -9.6506e-05]],

         ...,

         [[ 1.0375e-04,  8.6225e-06,  8.6872e-05,  2.4634e-06],
          [-2.9817e-04,  2.8503e-05,  1.5744e-04, -2.2952e-04],
          [-1.9214e-04,  1.2654e-04,  8.9779e-05,  3.0263e-05],
          [ 1.4498e-04,  1.8582e-05,  1.7569e-04, -3.1754e-05]],

         [[-4.1214e-05, -1.0193e-04, -1.7217e-04,  1.6750e-04],
          [-9.8031e-05,  8.9472e-05,  5.4798e-05,  1.3038e-04],
          [ 2.0844e-04, -8.0398e-05,  2.4280e-04,  1.6977e-05],
          [-1.7755e-04, -2.2388e-04, -2.0371e-04, -1.6433e-04]],

         [[-1.7726e-05,  2.6791e-04, -1.5143e-05, -1.3017e-04],
          [ 2.3985e-05,  5.3574e-06,  5.2226e-05,  4.9154e-05],
          [-7.0172e-05,  1.7599e-04,  2.6618e-04,  2.3793e-04],
          [ 1.5426e-04, -1.0253e-04, -1.1407e-05,  2.7024e-05]]],


        [[[-3.0635e-04,  1.0805e-04, -4.5157e-05, -6.3004e-05],
          [ 5.6368e-05,  2.1474e-04,  5.6855e-05,  1.6959e-05],
          [-9.4143e-05, -9.8373e-05, -1.9263e-04, -2.7244e-04],
          [-3.1256e-05, -2.7857e-04,  5.7610e-05,  1.4798e-04]],

         [[-4.0941e-05, -2.7715e-04, -1.3031e-04, -6.3026e-05],
          [ 4.9079e-05, -4.6320e-05,  2.9369e-04,  3.4848e-05],
          [-1.7005e-04,  2.6527e-04,  2.7269e-04, -1.2435e-04],
          [-5.7329e-05, -3.7048e-06, -1.0944e-05,  2.8622e-04]],

         [[-4.2392e-04,  1.2974e-04, -3.1145e-05, -1.4732e-04],
          [-1.9957e-04,  4.6865e-05, -1.9908e-04, -8.8566e-05],
          [ 1.4434e-04, -3.7690e-05,  4.0711e-05, -2.8508e-04],
          [-6.8996e-06,  1.9850e-04,  1.9839e-05, -3.7117e-05]],

         ...,

         [[-4.2637e-06, -1.2924e-04, -4.7905e-05, -8.9373e-05],
          [-1.6157e-05, -5.8988e-05, -1.0050e-04, -2.1024e-04],
          [ 1.2011e-04, -2.1041e-04, -2.6127e-04,  1.7414e-04],
          [-7.9255e-05,  1.1429e-04,  1.0101e-04,  1.3476e-04]],

         [[ 3.8795e-05,  8.5405e-05, -1.7188e-04, -2.1188e-04],
          [-8.7669e-05,  3.4246e-05,  2.4245e-04, -3.6484e-05],
          [ 6.1296e-05,  4.7303e-05, -2.7581e-04,  1.3698e-04],
          [ 8.3619e-05,  2.7000e-04,  2.7821e-05,  1.5482e-04]],

         [[ 5.6504e-05,  1.6642e-05, -1.5098e-05, -2.0139e-04],
          [-1.3512e-04,  1.0102e-04, -4.2024e-05, -1.4613e-04],
          [-1.2443e-04,  6.4786e-05, -4.6993e-05, -1.7113e-04],
          [ 3.9483e-06,  3.3130e-04, -3.6035e-05,  6.7471e-05]]],


        [[[-1.9547e-04, -1.9512e-04,  1.5568e-04,  1.6530e-05],
          [-5.8250e-04, -2.9494e-04, -6.1013e-05, -1.5200e-05],
          [ 2.9388e-04, -1.3550e-04, -2.4543e-07, -7.3826e-05],
          [-1.1616e-04, -8.2150e-05, -1.7814e-04, -6.5814e-05]],

         [[ 1.0293e-04,  4.9219e-06, -2.0756e-04, -2.1713e-04],
          [-8.8198e-05, -4.7578e-04,  7.0651e-05, -4.1808e-04],
          [-1.6972e-04, -5.9963e-05,  5.1958e-04, -2.0731e-04],
          [ 1.3448e-04,  1.1316e-04, -3.7804e-05, -1.0089e-04]],

         [[-3.4574e-05,  4.6642e-05, -9.3808e-05, -2.1314e-05],
          [-4.4780e-04,  2.1527e-05,  2.1019e-04,  7.6641e-05],
          [ 2.8740e-04, -1.0077e-05,  2.7236e-04, -2.1456e-04],
          [ 1.5529e-05,  4.5233e-04, -2.7923e-04,  6.3387e-05]],

         ...,

         [[-4.2634e-05,  4.2264e-05,  1.9557e-04, -2.4381e-04],
          [-3.6495e-04, -2.8059e-05, -5.7790e-05, -2.5379e-04],
          [-2.1571e-04,  4.5896e-04,  1.6151e-05,  9.5185e-05],
          [ 1.1254e-04, -2.4335e-04,  7.2916e-05, -8.6877e-06]],

         [[ 7.9639e-05, -1.9186e-04,  4.8778e-05,  1.3863e-04],
          [-6.3612e-05,  3.6278e-04,  8.6867e-05,  3.8640e-05],
          [ 1.0284e-04,  1.3238e-04,  2.9897e-04, -7.5158e-05],
          [-4.4065e-04, -2.3282e-04,  3.0087e-05, -1.4973e-04]],

         [[-2.7756e-04,  5.2354e-04,  8.1109e-05,  6.2133e-05],
          [ 2.2713e-04,  8.2187e-05,  1.0447e-04,  1.3609e-04],
          [-2.6433e-04,  1.4926e-04,  5.3366e-04,  2.8086e-04],
          [ 5.7562e-05,  2.8950e-05, -7.1574e-05, -1.3308e-04]]],


        ...,


        [[[ 3.3033e-04,  2.7714e-05, -1.3932e-04, -2.2856e-04],
          [ 2.2662e-04, -1.7240e-05,  1.9733e-04, -8.7899e-05],
          [ 1.9006e-04,  1.6981e-04,  6.0059e-05,  2.9390e-04],
          [ 7.1039e-05, -3.5066e-06, -4.3469e-05,  2.3540e-05]],

         [[ 7.7210e-05,  1.7273e-04,  1.5699e-04,  7.9382e-05],
          [-2.3882e-04,  6.6425e-06, -8.1478e-05,  2.6452e-04],
          [ 1.3993e-04,  1.9786e-04,  2.3700e-05,  1.1442e-04],
          [ 2.6870e-04,  1.0971e-04,  1.1228e-04,  1.4000e-04]],

         [[-7.2770e-05, -1.8738e-04, -1.0010e-04, -1.7967e-04],
          [ 4.4418e-04,  1.0927e-05,  2.2270e-04,  1.9060e-04],
          [-1.2150e-04,  1.1695e-04, -6.1947e-06,  1.6470e-04],
          [-1.0051e-04,  2.3497e-04,  6.8338e-05,  3.9273e-04]],

         ...,

         [[ 7.7484e-05, -1.1268e-05, -1.7285e-04, -1.3221e-04],
          [ 8.4323e-05,  1.2805e-04,  6.0479e-05,  3.8927e-05],
          [-2.5387e-04, -1.4253e-04, -1.0953e-04, -1.5450e-04],
          [-5.3723e-05, -2.3295e-05,  2.5676e-05,  5.5735e-05]],

         [[ 1.3743e-04,  4.5860e-05,  1.8245e-04,  3.0302e-05],
          [ 2.1186e-04,  2.0473e-04, -1.4112e-04, -2.7425e-04],
          [-2.1688e-04,  1.1766e-04,  7.5230e-05, -1.1977e-04],
          [ 3.2561e-04,  6.9560e-05,  4.5009e-05,  4.2069e-05]],

         [[-4.0270e-05,  1.3169e-04, -1.6666e-04,  1.2764e-04],
          [-2.2281e-05, -5.5868e-05,  1.2306e-04, -3.0512e-04],
          [-7.5262e-05,  1.0314e-04,  2.7391e-05, -1.1213e-05],
          [ 8.6526e-06, -6.2901e-06, -9.9917e-05, -1.3808e-05]]],


        [[[-2.3682e-04,  2.7452e-05,  2.5019e-04, -2.8354e-05],
          [ 1.3128e-04,  5.0657e-05, -2.0439e-04,  3.1939e-05],
          [ 6.7909e-05, -9.3321e-05, -2.9212e-05, -7.2414e-05],
          [ 1.8155e-04, -1.2093e-04, -3.8655e-05,  5.0952e-06]],

         [[-2.6687e-04, -1.9814e-04, -3.3276e-04,  1.0186e-04],
          [ 4.9416e-04, -2.2307e-06, -3.5065e-04,  1.7816e-04],
          [-2.1843e-04, -3.3326e-04,  4.9543e-05, -9.3223e-05],
          [ 7.0284e-05,  1.1905e-04,  1.6423e-04,  3.6073e-05]],

         [[-1.0785e-04, -1.4678e-04,  8.4597e-06, -5.9620e-05],
          [-6.9232e-05,  6.5437e-05,  9.0192e-05, -1.7268e-04],
          [ 2.1324e-04, -6.9776e-05, -1.5283e-04, -2.3951e-04],
          [-1.7001e-04, -2.1326e-04, -1.8838e-06, -2.0305e-04]],

         ...,

         [[ 1.3722e-05, -3.5336e-06,  2.5924e-04,  4.0047e-05],
          [ 3.0450e-04,  2.0406e-05, -1.8537e-04, -9.5580e-05],
          [ 2.1955e-04,  2.2571e-05, -5.5818e-05,  1.0563e-04],
          [ 1.4938e-05, -1.8315e-04, -6.1458e-05,  9.5597e-06]],

         [[-1.6453e-04, -2.1348e-05,  2.7362e-04, -6.5583e-05],
          [-4.2805e-06, -1.7518e-04,  2.3395e-04,  3.2709e-05],
          [-8.7717e-05, -6.0814e-05, -1.2462e-04, -1.7068e-05],
          [ 6.2073e-05,  2.1428e-04, -4.3737e-05,  2.1588e-04]],

         [[ 1.4541e-04,  9.2171e-05, -1.2035e-04,  5.2373e-05],
          [ 1.4971e-04, -6.2345e-05,  1.0216e-04, -1.0303e-04],
          [ 1.0708e-04,  3.8335e-05, -9.7750e-05, -6.3974e-05],
          [-5.3360e-05, -6.1437e-05,  2.1110e-04, -1.3362e-05]]],


        [[[ 4.0991e-04,  8.0734e-05, -2.2551e-04, -1.6443e-04],
          [ 1.0752e-04, -4.4141e-05,  3.3973e-04,  2.4723e-05],
          [-2.6646e-05,  3.4790e-05, -3.4116e-05,  2.2381e-04],
          [ 1.1358e-04,  5.2220e-05, -8.1262e-05,  4.3656e-05]],

         [[ 1.0145e-04,  1.3930e-04,  1.9709e-04,  4.3681e-05],
          [-2.2640e-04,  2.9580e-05,  2.3751e-05,  1.3560e-04],
          [ 1.3626e-04, -9.6735e-06,  3.7336e-05,  1.0692e-04],
          [ 2.8426e-04,  3.6104e-05,  4.7234e-05,  1.6147e-04]],

         [[ 8.7837e-05, -6.6601e-05, -7.1910e-05, -5.6473e-05],
          [ 4.0017e-04, -6.3046e-05,  1.2907e-04,  1.1597e-04],
          [-1.3304e-04,  1.0113e-04, -2.6881e-05,  1.4260e-04],
          [-2.8373e-07,  1.6003e-04,  2.3378e-04,  3.2531e-04]],

         ...,

         [[ 1.9175e-04,  7.2400e-05, -1.1990e-04, -4.9729e-05],
          [ 5.7108e-06, -1.8567e-05,  1.0114e-04,  8.4392e-05],
          [-1.6598e-04, -2.1611e-04, -1.3792e-04, -2.6878e-04],
          [-1.8495e-04,  9.7916e-05,  5.2770e-05, -7.8223e-05]],

         [[ 9.4775e-05,  8.9750e-05,  7.9802e-05, -2.1153e-05],
          [ 1.8331e-04,  7.9155e-05, -1.3686e-04, -1.0516e-04],
          [-1.0688e-04,  2.1360e-04,  4.6156e-05, -9.7132e-05],
          [ 1.0970e-04,  1.5281e-04,  3.3544e-05, -1.1027e-04]],

         [[-2.1647e-04,  1.1882e-04, -2.1768e-04,  1.0084e-04],
          [ 5.6014e-05, -2.5738e-05,  7.2485e-05, -2.7497e-04],
          [-9.2920e-05,  1.2899e-04, -6.1755e-05, -6.5729e-05],
          [-4.1735e-05, -7.9247e-05, -1.4163e-04, -1.6016e-04]]]]) 
 old gradient:tensor([[ 0.0011,  0.0005, -0.0004,  ...,  0.0002, -0.0004, -0.0008],
        [ 0.0002,  0.0002, -0.0004,  ..., -0.0003, -0.0001, -0.0003],
        [ 0.0012,  0.0003, -0.0003,  ...,  0.0001,  0.0004, -0.0008],
        ...,
        [-0.0006,  0.0008,  0.0009,  ...,  0.0006,  0.0009,  0.0005],
        [-0.0004,  0.0004, -0.0002,  ..., -0.0010, -0.0002,  0.0006],
        [-0.0006,  0.0008,  0.0009,  ...,  0.0006,  0.0009,  0.0005]])
2024-11-30 13:26:36,218 - INFO - reading batch[140] client 3
2024-11-30 13:26:36,241 - INFO - reading batch[140] client 4
2024-11-30 13:26:36,266 - INFO - reading batch[141] client 1
2024-11-30 13:26:36,287 - INFO - reading batch[141] client 2
2024-11-30 13:26:36,305 - INFO - reading batch[141] client 3
2024-11-30 13:26:36,330 - INFO - reading batch[141] client 4
2024-11-30 13:26:36,356 - INFO - reading batch[142] client 1
2024-11-30 13:26:36,374 - INFO - reading batch[142] client 2
2024-11-30 13:26:36,399 - INFO - reading batch[142] client 3
2024-11-30 13:26:36,413 - ERROR - backward on partition 4
2024-11-30 13:26:36,413 - CRITICAL - calculate backward $4 on client4
2024-11-30 13:26:36,419 - CRITICAL - new gradient:tensor([[-4.8687e-04, -6.8093e-04, -3.9540e-04,  ..., -1.7742e-04,
          2.9389e-04,  5.7609e-04],
        [-4.9292e-04, -6.8240e-04, -3.9818e-04,  ..., -1.7475e-04,
          2.9131e-04,  5.6934e-04],
        [-2.3226e-04,  2.4776e-04, -3.9154e-04,  ..., -2.2367e-04,
          2.0826e-04, -2.2908e-05],
        ...,
        [-2.7189e-04, -7.2772e-04,  2.3476e-04,  ...,  5.4296e-04,
         -4.7215e-04, -4.5816e-04],
        [ 4.9295e-04, -2.0015e-05, -2.5391e-05,  ..., -8.5324e-05,
         -3.7672e-04, -3.3160e-04],
        [-4.6238e-04,  4.0742e-04,  3.3036e-04,  ...,  3.7475e-04,
          5.9325e-04,  8.2270e-05]]) 
 old gradient:tensor([[ 0.0021,  0.0014,  0.0017,  0.0014,  0.0014, -0.0142,  0.0016,  0.0014,
          0.0018,  0.0015],
        [ 0.0020,  0.0015,  0.0018,  0.0015,  0.0016, -0.0142,  0.0015,  0.0015,
          0.0016,  0.0014],
        [ 0.0019,  0.0014,  0.0017,  0.0014,  0.0015,  0.0014,  0.0015,  0.0015,
         -0.0139,  0.0015],
        [ 0.0020,  0.0015,  0.0017,  0.0014,  0.0015,  0.0014,  0.0015,  0.0015,
          0.0016, -0.0142],
        [ 0.0021,  0.0015, -0.0139,  0.0013,  0.0013,  0.0014,  0.0015,  0.0015,
          0.0018,  0.0015],
        [ 0.0018, -0.0142,  0.0016,  0.0014,  0.0015,  0.0015,  0.0016,  0.0015,
          0.0018,  0.0016],
        [ 0.0020,  0.0014,  0.0017,  0.0014,  0.0015, -0.0142,  0.0015,  0.0015,
          0.0017,  0.0015],
        [ 0.0023,  0.0015,  0.0017,  0.0012,  0.0014,  0.0013, -0.0143,  0.0015,
          0.0020,  0.0014],
        [ 0.0022,  0.0015,  0.0018,  0.0012, -0.0142,  0.0015,  0.0014,  0.0015,
          0.0017,  0.0015],
        [-0.0135,  0.0014,  0.0017,  0.0014,  0.0015,  0.0014,  0.0015,  0.0014,
          0.0017,  0.0014],
        [ 0.0021,  0.0014,  0.0017,  0.0014,  0.0015, -0.0143,  0.0015,  0.0015,
          0.0018,  0.0015],
        [ 0.0020,  0.0014,  0.0017,  0.0014,  0.0015,  0.0015,  0.0015,  0.0014,
          0.0017, -0.0142],
        [ 0.0019,  0.0015,  0.0017,  0.0015,  0.0017,  0.0015,  0.0016, -0.0142,
          0.0014,  0.0015],
        [ 0.0019, -0.0142,  0.0017,  0.0013,  0.0015,  0.0015,  0.0015,  0.0014,
          0.0018,  0.0015],
        [ 0.0019,  0.0015,  0.0016, -0.0142,  0.0015,  0.0015,  0.0015,  0.0015,
          0.0017,  0.0015],
        [ 0.0018,  0.0015,  0.0016,  0.0014,  0.0015,  0.0015,  0.0016, -0.0141,
          0.0015,  0.0015],
        [ 0.0020,  0.0014,  0.0017, -0.0142,  0.0016,  0.0014,  0.0015,  0.0016,
          0.0017,  0.0014],
        [ 0.0021,  0.0016, -0.0140,  0.0012,  0.0014,  0.0014,  0.0014,  0.0015,
          0.0018,  0.0014],
        [ 0.0020,  0.0015, -0.0139,  0.0013,  0.0014,  0.0015,  0.0015,  0.0015,
          0.0018,  0.0014],
        [ 0.0022,  0.0014,  0.0016,  0.0015,  0.0015, -0.0143,  0.0016,  0.0014,
          0.0017,  0.0014],
        [ 0.0020,  0.0015,  0.0019,  0.0014,  0.0014,  0.0015,  0.0014, -0.0142,
          0.0017,  0.0015],
        [ 0.0021,  0.0015,  0.0017,  0.0014,  0.0015,  0.0015,  0.0015,  0.0015,
          0.0016, -0.0142],
        [ 0.0022,  0.0015,  0.0016, -0.0143,  0.0015,  0.0014,  0.0014,  0.0014,
          0.0018,  0.0015],
        [ 0.0018, -0.0142,  0.0016,  0.0014,  0.0015,  0.0015,  0.0016,  0.0015,
          0.0016,  0.0016],
        [ 0.0020,  0.0015,  0.0018,  0.0014, -0.0142,  0.0014,  0.0015,  0.0014,
          0.0016,  0.0015],
        [ 0.0019,  0.0013,  0.0016,  0.0015,  0.0017, -0.0140,  0.0015,  0.0014,
          0.0017,  0.0015],
        [ 0.0020,  0.0015,  0.0017,  0.0013,  0.0015, -0.0142,  0.0015,  0.0015,
          0.0017,  0.0015],
        [ 0.0021,  0.0014,  0.0018,  0.0013,  0.0015,  0.0013, -0.0142,  0.0015,
          0.0017,  0.0014],
        [ 0.0022,  0.0015,  0.0019,  0.0012,  0.0014,  0.0013, -0.0142,  0.0015,
          0.0018,  0.0014],
        [ 0.0021,  0.0015,  0.0017,  0.0014,  0.0014,  0.0013,  0.0014,  0.0015,
         -0.0138,  0.0015],
        [-0.0134,  0.0015,  0.0017,  0.0013,  0.0014,  0.0014,  0.0014,  0.0015,
          0.0018,  0.0014],
        [ 0.0019, -0.0142,  0.0017,  0.0014,  0.0015,  0.0014,  0.0014,  0.0015,
          0.0018,  0.0015],
        [ 0.0020, -0.0142,  0.0017,  0.0014,  0.0014,  0.0015,  0.0014,  0.0014,
          0.0017,  0.0015],
        [ 0.0020,  0.0015,  0.0018,  0.0013,  0.0016,  0.0014, -0.0142,  0.0014,
          0.0017,  0.0014],
        [ 0.0021,  0.0014,  0.0017,  0.0015,  0.0015, -0.0142,  0.0015,  0.0014,
          0.0017,  0.0015],
        [ 0.0021,  0.0015,  0.0016, -0.0143,  0.0015,  0.0014,  0.0014,  0.0015,
          0.0017,  0.0015],
        [ 0.0020,  0.0014,  0.0017, -0.0142,  0.0016,  0.0014,  0.0015,  0.0015,
          0.0017,  0.0014],
        [ 0.0018, -0.0141,  0.0016,  0.0014,  0.0015,  0.0015,  0.0016,  0.0015,
          0.0016,  0.0016],
        [ 0.0018, -0.0142,  0.0017,  0.0014,  0.0015,  0.0015,  0.0015,  0.0014,
          0.0018,  0.0016],
        [ 0.0021,  0.0014,  0.0018,  0.0014,  0.0014,  0.0014,  0.0014,  0.0015,
          0.0018, -0.0142],
        [ 0.0019,  0.0015,  0.0016,  0.0015,  0.0016,  0.0016,  0.0015, -0.0141,
          0.0015,  0.0015],
        [ 0.0021,  0.0016, -0.0139,  0.0013,  0.0014,  0.0014,  0.0014,  0.0015,
          0.0018,  0.0015],
        [ 0.0019, -0.0141,  0.0017,  0.0013,  0.0015,  0.0015,  0.0015,  0.0015,
          0.0017,  0.0016],
        [ 0.0018,  0.0015,  0.0017,  0.0014,  0.0016, -0.0141,  0.0015,  0.0015,
          0.0016,  0.0016],
        [ 0.0020,  0.0013,  0.0017, -0.0142,  0.0015,  0.0014,  0.0015,  0.0015,
          0.0017,  0.0015],
        [ 0.0020,  0.0015,  0.0017,  0.0014,  0.0014,  0.0014,  0.0014,  0.0015,
         -0.0139,  0.0015],
        [ 0.0021,  0.0014,  0.0018,  0.0014,  0.0015, -0.0142,  0.0014,  0.0014,
          0.0018,  0.0015],
        [ 0.0018, -0.0142,  0.0017,  0.0014,  0.0015,  0.0015,  0.0016,  0.0015,
          0.0016,  0.0016],
        [ 0.0020,  0.0014, -0.0139,  0.0013,  0.0015,  0.0013,  0.0013,  0.0015,
          0.0018,  0.0016],
        [ 0.0022,  0.0015,  0.0017,  0.0013, -0.0141,  0.0014,  0.0013,  0.0015,
          0.0018,  0.0014],
        [ 0.0020,  0.0014,  0.0017, -0.0142,  0.0015,  0.0014,  0.0015,  0.0015,
          0.0017,  0.0016],
        [ 0.0021,  0.0014,  0.0017, -0.0143,  0.0015,  0.0015,  0.0015,  0.0015,
          0.0016,  0.0015],
        [ 0.0018,  0.0016,  0.0017,  0.0015,  0.0014,  0.0015,  0.0015, -0.0141,
          0.0017,  0.0015],
        [ 0.0022,  0.0014, -0.0139,  0.0012,  0.0015,  0.0014,  0.0015,  0.0015,
          0.0018,  0.0014],
        [ 0.0022,  0.0016,  0.0018,  0.0012,  0.0015,  0.0013, -0.0144,  0.0015,
          0.0018,  0.0015],
        [ 0.0019,  0.0015,  0.0018,  0.0014,  0.0017,  0.0015,  0.0016, -0.0142,
          0.0015,  0.0014],
        [ 0.0018,  0.0015,  0.0016,  0.0014,  0.0016, -0.0141,  0.0015,  0.0015,
          0.0016,  0.0016],
        [ 0.0020,  0.0015,  0.0017,  0.0013,  0.0015,  0.0015,  0.0014,  0.0014,
         -0.0139,  0.0015],
        [ 0.0019,  0.0014,  0.0017,  0.0015,  0.0015,  0.0016,  0.0015, -0.0142,
          0.0016,  0.0015],
        [ 0.0023,  0.0015,  0.0018,  0.0012,  0.0014,  0.0013, -0.0142,  0.0015,
          0.0019,  0.0015],
        [ 0.0018,  0.0015,  0.0016,  0.0015,  0.0015,  0.0016,  0.0015, -0.0142,
          0.0016,  0.0015],
        [ 0.0020,  0.0015,  0.0017,  0.0014,  0.0015,  0.0015,  0.0015,  0.0015,
          0.0017, -0.0142],
        [-0.0136,  0.0014,  0.0016,  0.0013,  0.0017,  0.0014,  0.0015,  0.0015,
          0.0018,  0.0015],
        [ 0.0022,  0.0014,  0.0017,  0.0013,  0.0017,  0.0014, -0.0143,  0.0014,
          0.0018,  0.0015]])
2024-11-30 13:26:36,419 - INFO - reading batch[142] client 4
2024-11-30 13:26:36,448 - INFO - reading batch[143] client 1
2024-11-30 13:26:36,471 - INFO - reading batch[143] client 2
2024-11-30 13:26:36,486 - INFO - reading batch[143] client 3
2024-11-30 13:26:36,505 - INFO - reading batch[143] client 4
2024-11-30 13:26:36,536 - INFO - reading batch[144] client 1
2024-11-30 13:26:36,558 - INFO - reading batch[144] client 2
2024-11-30 13:26:36,583 - INFO - reading batch[144] client 3
2024-11-30 13:26:36,609 - INFO - reading batch[144] client 4
2024-11-30 13:26:36,626 - INFO - Final partition
2024-11-30 13:26:36,626 - INFO - reading batch[145] client 1
2024-11-30 13:26:36,653 - INFO - reading batch[145] client 2
2024-11-30 13:26:36,670 - INFO - Final partition
2024-11-30 13:26:36,671 - INFO - reading batch[145] client 3
2024-11-30 13:26:36,702 - INFO - reading batch[145] client 4
2024-11-30 13:26:36,732 - INFO - reading batch[146] client 1
2024-11-30 13:26:36,756 - INFO - reading batch[146] client 2
2024-11-30 13:26:36,778 - INFO - reading batch[146] client 3
2024-11-30 13:26:36,802 - INFO - reading batch[146] client 4
2024-11-30 13:26:36,834 - INFO - reading batch[147] client 1
2024-11-30 13:26:36,853 - INFO - reading batch[147] client 2
2024-11-30 13:26:36,882 - INFO - reading batch[147] client 3
2024-11-30 13:26:36,898 - ERROR - backward on partition 4
2024-11-30 13:26:36,899 - CRITICAL - calculate backward $4 on client4
2024-11-30 13:26:36,904 - CRITICAL - new gradient:tensor([[-2.7192e-04, -7.2693e-04,  2.3391e-04,  ...,  5.4176e-04,
         -4.6914e-04, -4.5750e-04],
        [ 4.8419e-04, -1.5607e-05, -1.2808e-05,  ..., -7.4358e-05,
         -3.6313e-04, -3.2692e-04],
        [-4.8353e-04, -6.7675e-04, -3.9912e-04,  ..., -1.7675e-04,
          2.9383e-04,  5.6888e-04],
        ...,
        [-1.3422e-04,  3.9732e-04,  5.3332e-04,  ...,  2.2877e-04,
          3.4237e-04,  3.7486e-04],
        [ 4.7075e-04,  3.4800e-04, -2.6452e-04,  ...,  1.8722e-04,
         -6.5759e-04, -4.4716e-04],
        [ 4.8351e-04,  3.5190e-04, -2.6734e-04,  ...,  1.8333e-04,
         -6.6257e-04, -4.5231e-04]]) 
 old gradient:tensor([[ 0.0021,  0.0014,  0.0017,  0.0014,  0.0015,  0.0014,  0.0014,  0.0015,
          0.0017, -0.0142],
        [-0.0135,  0.0014,  0.0017,  0.0014,  0.0014,  0.0014,  0.0015,  0.0015,
          0.0018,  0.0014],
        [ 0.0020,  0.0014,  0.0017,  0.0015,  0.0016, -0.0142,  0.0015,  0.0014,
          0.0017,  0.0015],
        [ 0.0020,  0.0015,  0.0017,  0.0013,  0.0014,  0.0015,  0.0014,  0.0015,
         -0.0139,  0.0015],
        [ 0.0020,  0.0014,  0.0018,  0.0014,  0.0015, -0.0141,  0.0014,  0.0014,
          0.0017,  0.0015],
        [ 0.0020,  0.0015,  0.0018,  0.0013,  0.0015,  0.0014,  0.0014,  0.0014,
         -0.0139,  0.0015],
        [-0.0135,  0.0014,  0.0016,  0.0013,  0.0015,  0.0015,  0.0014,  0.0014,
          0.0018,  0.0016],
        [ 0.0019,  0.0014,  0.0019,  0.0015,  0.0015,  0.0015,  0.0014, -0.0142,
          0.0016,  0.0015],
        [ 0.0020,  0.0014, -0.0137,  0.0013,  0.0015,  0.0014,  0.0014,  0.0014,
          0.0018,  0.0015],
        [ 0.0020,  0.0015, -0.0138,  0.0013,  0.0014,  0.0015,  0.0014,  0.0015,
          0.0018,  0.0014],
        [ 0.0019,  0.0014,  0.0017,  0.0015,  0.0016,  0.0014,  0.0015, -0.0143,
          0.0017,  0.0015],
        [-0.0133,  0.0014,  0.0017,  0.0013,  0.0015,  0.0014,  0.0015,  0.0014,
          0.0018,  0.0014],
        [ 0.0020,  0.0014,  0.0016, -0.0142,  0.0015,  0.0014,  0.0015,  0.0014,
          0.0018,  0.0015],
        [ 0.0020,  0.0014,  0.0017,  0.0014,  0.0015,  0.0015,  0.0014,  0.0014,
         -0.0138,  0.0015],
        [ 0.0021,  0.0015,  0.0017,  0.0014,  0.0016, -0.0142,  0.0015,  0.0015,
          0.0016,  0.0014],
        [ 0.0019, -0.0142,  0.0017,  0.0014,  0.0015,  0.0015,  0.0015,  0.0015,
          0.0018,  0.0016],
        [ 0.0022,  0.0014,  0.0016, -0.0142,  0.0015,  0.0013,  0.0014,  0.0015,
          0.0017,  0.0015],
        [ 0.0019,  0.0014,  0.0018,  0.0014, -0.0141,  0.0015,  0.0015,  0.0014,
          0.0017,  0.0015],
        [ 0.0021,  0.0014,  0.0017, -0.0142,  0.0015,  0.0014,  0.0014,  0.0014,
          0.0017,  0.0015],
        [ 0.0023,  0.0015,  0.0017, -0.0143,  0.0014,  0.0014,  0.0013,  0.0015,
          0.0018,  0.0014],
        [ 0.0019, -0.0142,  0.0017,  0.0014,  0.0014,  0.0015,  0.0015,  0.0015,
          0.0018,  0.0016],
        [-0.0135,  0.0014,  0.0016,  0.0014,  0.0016,  0.0014,  0.0015,  0.0014,
          0.0018,  0.0016],
        [ 0.0021,  0.0014,  0.0017, -0.0143,  0.0014,  0.0014,  0.0015,  0.0015,
          0.0017,  0.0014],
        [ 0.0023,  0.0016, -0.0139,  0.0011,  0.0013,  0.0013,  0.0013,  0.0015,
          0.0019,  0.0015],
        [ 0.0019, -0.0142,  0.0017,  0.0014,  0.0014,  0.0015,  0.0015,  0.0015,
          0.0017,  0.0016],
        [-0.0135,  0.0014,  0.0016,  0.0014,  0.0016,  0.0013,  0.0015,  0.0014,
          0.0017,  0.0015],
        [ 0.0019,  0.0015,  0.0017,  0.0014, -0.0140,  0.0015,  0.0015,  0.0014,
          0.0016,  0.0015],
        [ 0.0022,  0.0015, -0.0139,  0.0013,  0.0014,  0.0013,  0.0014,  0.0015,
          0.0018,  0.0015],
        [ 0.0020,  0.0015,  0.0019,  0.0013,  0.0015,  0.0014, -0.0142,  0.0014,
          0.0018,  0.0014],
        [ 0.0021,  0.0014,  0.0018, -0.0143,  0.0015,  0.0014,  0.0015,  0.0014,
          0.0017,  0.0015],
        [ 0.0020, -0.0142,  0.0018,  0.0014,  0.0015,  0.0014,  0.0014,  0.0014,
          0.0019,  0.0015],
        [ 0.0021,  0.0015,  0.0018,  0.0013,  0.0016,  0.0014, -0.0142,  0.0014,
          0.0017,  0.0014],
        [ 0.0020,  0.0015,  0.0018,  0.0013, -0.0141,  0.0014,  0.0014,  0.0014,
          0.0017,  0.0016],
        [ 0.0020,  0.0014,  0.0018,  0.0013,  0.0016, -0.0143,  0.0015,  0.0014,
          0.0017,  0.0015],
        [ 0.0020,  0.0014,  0.0017,  0.0014, -0.0141,  0.0015,  0.0015,  0.0014,
          0.0017,  0.0015],
        [-0.0138,  0.0015,  0.0016,  0.0014,  0.0016,  0.0015,  0.0015,  0.0014,
          0.0017,  0.0015],
        [ 0.0020,  0.0015, -0.0139,  0.0013,  0.0015,  0.0014,  0.0014,  0.0014,
          0.0018,  0.0015],
        [ 0.0018,  0.0015,  0.0017,  0.0015,  0.0015,  0.0015,  0.0015, -0.0142,
          0.0016,  0.0015],
        [ 0.0019,  0.0015,  0.0017,  0.0015,  0.0016,  0.0015,  0.0016, -0.0142,
          0.0015,  0.0015],
        [ 0.0018,  0.0015,  0.0017,  0.0015,  0.0014,  0.0015,  0.0015, -0.0142,
          0.0018,  0.0015],
        [ 0.0018, -0.0142,  0.0017,  0.0014,  0.0016,  0.0015,  0.0016,  0.0015,
          0.0016,  0.0016],
        [ 0.0022,  0.0014,  0.0017,  0.0014,  0.0015,  0.0014,  0.0014,  0.0014,
         -0.0139,  0.0015],
        [ 0.0019,  0.0015,  0.0018,  0.0014,  0.0014,  0.0016,  0.0014, -0.0142,
          0.0016,  0.0016],
        [-0.0134,  0.0013,  0.0016,  0.0014,  0.0016,  0.0013,  0.0015,  0.0014,
          0.0018,  0.0015],
        [ 0.0020,  0.0014,  0.0019,  0.0013,  0.0015,  0.0013, -0.0142,  0.0014,
          0.0017,  0.0016],
        [ 0.0018, -0.0142,  0.0017,  0.0014,  0.0016,  0.0015,  0.0015,  0.0014,
          0.0018,  0.0016],
        [-0.0133,  0.0014,  0.0015,  0.0013,  0.0015,  0.0014,  0.0014,  0.0014,
          0.0018,  0.0014],
        [ 0.0021,  0.0014,  0.0018,  0.0014,  0.0015, -0.0143,  0.0014,  0.0014,
          0.0017,  0.0015],
        [-0.0135,  0.0014,  0.0016,  0.0014,  0.0016,  0.0015,  0.0015,  0.0013,
          0.0018,  0.0014],
        [-0.0134,  0.0014,  0.0017,  0.0013,  0.0014,  0.0013,  0.0013,  0.0014,
          0.0019,  0.0015],
        [ 0.0022,  0.0015,  0.0017,  0.0013,  0.0014,  0.0014,  0.0014, -0.0142,
          0.0018,  0.0014],
        [ 0.0021,  0.0015,  0.0018,  0.0014, -0.0143,  0.0014,  0.0013,  0.0014,
          0.0018,  0.0014],
        [ 0.0022,  0.0015,  0.0019,  0.0012,  0.0015,  0.0013, -0.0142,  0.0014,
          0.0018,  0.0014],
        [ 0.0018, -0.0142,  0.0017,  0.0014,  0.0015,  0.0015,  0.0015,  0.0014,
          0.0018,  0.0016],
        [ 0.0023,  0.0014,  0.0018,  0.0013,  0.0015,  0.0013,  0.0013,  0.0014,
         -0.0138,  0.0015],
        [-0.0134,  0.0013,  0.0017,  0.0014,  0.0016,  0.0014,  0.0014,  0.0015,
          0.0018,  0.0014],
        [ 0.0018,  0.0016,  0.0016,  0.0015,  0.0015,  0.0015,  0.0014, -0.0142,
          0.0016,  0.0016],
        [ 0.0018, -0.0142,  0.0017,  0.0014,  0.0015,  0.0015,  0.0015,  0.0014,
          0.0017,  0.0016],
        [-0.0134,  0.0014,  0.0017,  0.0013,  0.0016,  0.0013,  0.0015,  0.0014,
          0.0017,  0.0015],
        [ 0.0022,  0.0015,  0.0018,  0.0013, -0.0143,  0.0014,  0.0014,  0.0014,
          0.0018,  0.0014],
        [ 0.0023,  0.0015,  0.0017,  0.0014,  0.0014,  0.0014,  0.0014,  0.0014,
         -0.0138,  0.0014],
        [ 0.0022,  0.0014,  0.0018,  0.0013, -0.0141,  0.0014,  0.0013,  0.0014,
          0.0017,  0.0014],
        [ 0.0021,  0.0014, -0.0138,  0.0013,  0.0015,  0.0014,  0.0013,  0.0015,
          0.0018,  0.0015],
        [ 0.0019,  0.0014, -0.0139,  0.0014,  0.0015,  0.0015,  0.0015,  0.0014,
          0.0017,  0.0016]])
2024-11-30 13:26:36,905 - INFO - reading batch[147] client 4
2024-11-30 13:26:36,937 - INFO - reading batch[148] client 1
2024-11-30 13:26:36,962 - INFO - reading batch[148] client 2
2024-11-30 13:26:36,994 - INFO - reading batch[148] client 3
2024-11-30 13:26:37,010 - ERROR - backward on partition 4
2024-11-30 13:26:37,011 - CRITICAL - calculate backward $4 on client4
2024-11-30 13:26:37,016 - CRITICAL - new gradient:tensor([[-7.4263e-04, -3.2037e-04,  5.7339e-04,  ...,  9.1871e-04,
          1.2235e-04, -3.6794e-04],
        [ 3.7112e-04,  3.8168e-04,  5.1723e-04,  ...,  1.5379e-04,
         -3.6722e-05,  3.3121e-05],
        [ 1.3731e-04, -4.9661e-04, -5.7182e-04,  ..., -1.2600e-04,
          5.0138e-04,  1.7716e-04],
        ...,
        [-2.5600e-04,  7.9684e-04,  1.0695e-03,  ...,  4.5647e-04,
          6.7688e-04,  7.4522e-04],
        [-2.4645e-05, -3.2599e-04, -6.5515e-04,  ...,  1.0648e-05,
         -3.6412e-04,  1.3837e-04],
        [ 2.1033e-04, -3.7374e-04, -3.5185e-05,  ...,  7.2122e-04,
         -1.1320e-03, -9.0542e-04]]) 
 old gradient:tensor([[ 0.0022,  0.0015,  0.0017,  0.0012,  0.0015,  0.0013, -0.0143,  0.0015,
          0.0018,  0.0015],
        [ 0.0018,  0.0015,  0.0018,  0.0014, -0.0141,  0.0015,  0.0015,  0.0015,
          0.0017,  0.0015],
        [ 0.0018, -0.0142,  0.0017,  0.0014,  0.0015,  0.0015,  0.0015,  0.0015,
          0.0017,  0.0016],
        [-0.0134,  0.0014,  0.0017,  0.0013,  0.0015,  0.0014,  0.0015,  0.0015,
          0.0017,  0.0014],
        [ 0.0021,  0.0014,  0.0017,  0.0013,  0.0015, -0.0142,  0.0015,  0.0015,
          0.0017,  0.0015],
        [ 0.0019, -0.0142,  0.0017,  0.0014,  0.0015,  0.0015,  0.0015,  0.0014,
          0.0017,  0.0016],
        [ 0.0018, -0.0142,  0.0018,  0.0014,  0.0015,  0.0015,  0.0015,  0.0014,
          0.0018,  0.0015],
        [ 0.0021,  0.0015,  0.0017, -0.0143,  0.0013,  0.0014,  0.0014,  0.0015,
          0.0020,  0.0015],
        [ 0.0018,  0.0015,  0.0017,  0.0015,  0.0015,  0.0014,  0.0015, -0.0142,
          0.0017,  0.0015],
        [ 0.0020,  0.0014,  0.0017,  0.0014, -0.0142,  0.0015,  0.0014,  0.0014,
          0.0018,  0.0015],
        [ 0.0022,  0.0015,  0.0018,  0.0013, -0.0142,  0.0014,  0.0012,  0.0015,
          0.0018,  0.0014],
        [ 0.0020,  0.0013,  0.0016, -0.0141,  0.0016,  0.0014,  0.0015,  0.0014,
          0.0017,  0.0015],
        [-0.0135,  0.0014,  0.0017,  0.0014,  0.0015,  0.0014,  0.0013,  0.0015,
          0.0018,  0.0014],
        [ 0.0022,  0.0014,  0.0018,  0.0013,  0.0016, -0.0142,  0.0014,  0.0015,
          0.0018,  0.0014],
        [ 0.0020,  0.0014,  0.0018,  0.0014,  0.0015,  0.0015,  0.0016,  0.0015,
          0.0016, -0.0141],
        [-0.0133,  0.0014,  0.0016,  0.0013,  0.0015,  0.0013,  0.0015,  0.0015,
          0.0018,  0.0014],
        [-0.0136,  0.0014,  0.0017,  0.0013,  0.0016,  0.0013,  0.0015,  0.0015,
          0.0018,  0.0015],
        [ 0.0023,  0.0016,  0.0017,  0.0012,  0.0015,  0.0013, -0.0143,  0.0014,
          0.0019,  0.0014],
        [ 0.0020,  0.0015,  0.0018,  0.0013,  0.0016,  0.0014, -0.0142,  0.0015,
          0.0017,  0.0014],
        [ 0.0022,  0.0014, -0.0138,  0.0013,  0.0014,  0.0014,  0.0013,  0.0015,
          0.0018,  0.0014],
        [ 0.0022,  0.0015,  0.0018,  0.0013,  0.0014,  0.0014,  0.0014,  0.0014,
         -0.0139,  0.0016],
        [ 0.0018, -0.0142,  0.0017,  0.0014,  0.0015,  0.0015,  0.0016,  0.0015,
          0.0017,  0.0016],
        [ 0.0023,  0.0014,  0.0017, -0.0144,  0.0015,  0.0014,  0.0015,  0.0015,
          0.0017,  0.0015],
        [ 0.0020,  0.0015,  0.0018,  0.0013,  0.0015,  0.0015, -0.0143,  0.0014,
          0.0018,  0.0015],
        [ 0.0021,  0.0014,  0.0017,  0.0014,  0.0016, -0.0142,  0.0015,  0.0014,
          0.0017,  0.0015],
        [ 0.0021,  0.0014,  0.0017,  0.0014,  0.0015,  0.0014,  0.0014,  0.0014,
          0.0018, -0.0141],
        [ 0.0021,  0.0014,  0.0018,  0.0014,  0.0016,  0.0014, -0.0142,  0.0015,
          0.0017,  0.0014],
        [ 0.0020,  0.0015,  0.0018,  0.0013, -0.0142,  0.0016,  0.0013,  0.0015,
          0.0017,  0.0015],
        [ 0.0020,  0.0014,  0.0017,  0.0014,  0.0016,  0.0015,  0.0014,  0.0014,
          0.0017, -0.0142],
        [ 0.0020,  0.0015, -0.0139,  0.0013,  0.0014,  0.0016,  0.0014,  0.0015,
          0.0018,  0.0015],
        [-0.0134,  0.0014,  0.0016,  0.0013,  0.0015,  0.0013,  0.0015,  0.0014,
          0.0019,  0.0015],
        [ 0.0021,  0.0014,  0.0017,  0.0013, -0.0141,  0.0015,  0.0014,  0.0015,
          0.0018,  0.0014],
        [ 0.0020,  0.0015,  0.0017,  0.0013, -0.0141,  0.0015,  0.0014,  0.0014,
          0.0019,  0.0014],
        [ 0.0020,  0.0015,  0.0018,  0.0013,  0.0016,  0.0014,  0.0014,  0.0015,
         -0.0139,  0.0015],
        [ 0.0018, -0.0142,  0.0018,  0.0014,  0.0015,  0.0015,  0.0014,  0.0013,
          0.0019,  0.0015],
        [ 0.0021,  0.0014,  0.0018,  0.0013,  0.0014,  0.0014,  0.0015,  0.0015,
         -0.0138,  0.0015],
        [ 0.0022,  0.0015,  0.0018,  0.0013,  0.0014,  0.0014,  0.0014,  0.0015,
          0.0017, -0.0142],
        [ 0.0019,  0.0014,  0.0017,  0.0014,  0.0014,  0.0015,  0.0015, -0.0141,
          0.0018,  0.0014],
        [-0.0135,  0.0014,  0.0017,  0.0014,  0.0015,  0.0014,  0.0016,  0.0014,
          0.0018,  0.0014],
        [ 0.0021,  0.0015,  0.0016, -0.0143,  0.0014,  0.0015,  0.0015,  0.0014,
          0.0017,  0.0016],
        [ 0.0020,  0.0014,  0.0018,  0.0014, -0.0141,  0.0015,  0.0013,  0.0014,
          0.0018,  0.0015],
        [ 0.0021,  0.0013,  0.0018, -0.0142,  0.0016,  0.0014,  0.0015,  0.0014,
          0.0016,  0.0014],
        [ 0.0021,  0.0016, -0.0140,  0.0012,  0.0014,  0.0015,  0.0014,  0.0014,
          0.0019,  0.0015],
        [ 0.0021,  0.0015,  0.0019,  0.0013,  0.0015,  0.0014, -0.0143,  0.0014,
          0.0018,  0.0015],
        [ 0.0021,  0.0015,  0.0017,  0.0014,  0.0015,  0.0014,  0.0014,  0.0014,
         -0.0138,  0.0015],
        [ 0.0021,  0.0015,  0.0017,  0.0014,  0.0015,  0.0015,  0.0014,  0.0015,
          0.0017, -0.0142],
        [-0.0134,  0.0013,  0.0016,  0.0014,  0.0016,  0.0013,  0.0014,  0.0014,
          0.0018,  0.0014],
        [ 0.0022,  0.0014, -0.0139,  0.0013,  0.0014,  0.0014,  0.0014,  0.0014,
          0.0019,  0.0014],
        [ 0.0020,  0.0015,  0.0018,  0.0013, -0.0142,  0.0014,  0.0014,  0.0015,
          0.0018,  0.0015],
        [ 0.0019,  0.0015, -0.0140,  0.0013,  0.0015,  0.0015,  0.0015,  0.0015,
          0.0018,  0.0015],
        [ 0.0020,  0.0014,  0.0017,  0.0014,  0.0016,  0.0015,  0.0015,  0.0014,
          0.0016, -0.0142],
        [ 0.0022,  0.0015,  0.0018,  0.0013,  0.0014,  0.0015,  0.0013,  0.0014,
          0.0018, -0.0142],
        [ 0.0021,  0.0015,  0.0016, -0.0143,  0.0013,  0.0015,  0.0014,  0.0014,
          0.0019,  0.0016],
        [ 0.0019,  0.0015,  0.0018,  0.0013,  0.0015, -0.0141,  0.0015,  0.0015,
          0.0017,  0.0015],
        [-0.0136,  0.0014,  0.0016,  0.0014,  0.0017,  0.0014,  0.0016,  0.0015,
          0.0017,  0.0015],
        [ 0.0020,  0.0015,  0.0016,  0.0013,  0.0015, -0.0143,  0.0014,  0.0015,
          0.0018,  0.0015],
        [-0.0135,  0.0014,  0.0019,  0.0014,  0.0014,  0.0014,  0.0014,  0.0015,
          0.0017,  0.0014],
        [ 0.0023,  0.0014,  0.0016,  0.0014,  0.0015, -0.0143,  0.0013,  0.0014,
          0.0018,  0.0015],
        [ 0.0023,  0.0015, -0.0139,  0.0012,  0.0014,  0.0014,  0.0013,  0.0014,
          0.0020,  0.0015],
        [ 0.0020,  0.0015, -0.0140,  0.0014,  0.0013,  0.0015,  0.0015,  0.0015,
          0.0018,  0.0015],
        [ 0.0019,  0.0015,  0.0017,  0.0014,  0.0014,  0.0014,  0.0015, -0.0142,
          0.0018,  0.0015],
        [ 0.0019,  0.0015,  0.0018,  0.0014, -0.0142,  0.0015,  0.0014,  0.0014,
          0.0017,  0.0015],
        [ 0.0022,  0.0015,  0.0016,  0.0013,  0.0014, -0.0143,  0.0014,  0.0014,
          0.0019,  0.0015],
        [ 0.0020,  0.0015,  0.0017,  0.0014,  0.0015,  0.0014,  0.0015,  0.0015,
          0.0016, -0.0141]])
2024-11-30 13:26:37,016 - INFO - reading batch[148] client 4
2024-11-30 13:26:37,040 - INFO - reading batch[149] client 1
2024-11-30 13:26:37,058 - INFO - reading batch[149] client 2
2024-11-30 13:26:37,072 - INFO - reading batch[149] client 3
2024-11-30 13:26:37,093 - INFO - reading batch[149] client 4
2024-11-30 13:26:37,116 - INFO - reading batch[150] client 1
2024-11-30 13:26:37,144 - INFO - reading batch[150] client 2
2024-11-30 13:26:37,176 - INFO - reading batch[150] client 3
2024-11-30 13:26:37,191 - INFO - reading batch[150] client 4
2024-11-30 13:26:37,220 - INFO - reading batch[151] client 1
2024-11-30 13:26:37,240 - INFO - reading batch[151] client 2
2024-11-30 13:26:37,254 - INFO - reading batch[151] client 3
2024-11-30 13:26:37,287 - INFO - reading batch[151] client 4
2024-11-30 13:26:37,311 - INFO - reading batch[152] client 1
2024-11-30 13:26:37,335 - INFO - reading batch[152] client 2
2024-11-30 13:26:37,361 - INFO - reading batch[152] client 3
2024-11-30 13:26:37,394 - INFO - reading batch[152] client 4
2024-11-30 13:26:37,420 - INFO - reading batch[153] client 1
2024-11-30 13:26:37,443 - INFO - reading batch[153] client 2
2024-11-30 13:26:37,469 - INFO - reading batch[153] client 3
2024-11-30 13:26:37,486 - INFO - reading batch[153] client 4
2024-11-30 13:26:37,516 - INFO - reading batch[154] client 1
2024-11-30 13:26:37,543 - INFO - reading batch[154] client 2
2024-11-30 13:26:37,558 - INFO - reading batch[154] client 3
2024-11-30 13:26:37,583 - INFO - reading batch[154] client 4
2024-11-30 13:26:37,607 - INFO - reading batch[155] client 1
2024-11-30 13:26:37,625 - INFO - reading batch[155] client 2
2024-11-30 13:26:37,651 - INFO - reading batch[155] client 3
2024-11-30 13:26:37,675 - INFO - reading batch[155] client 4
2024-11-30 13:26:37,698 - INFO - reading batch[156] client 1
2024-11-30 13:26:37,716 - INFO - reading batch[156] client 2
2024-11-30 13:26:37,741 - INFO - reading batch[156] client 3
2024-11-30 13:26:37,757 - INFO - reading batch[156] client 4
2024-11-30 13:26:37,779 - INFO - reading batch[157] client 1
2024-11-30 13:26:37,798 - INFO - reading batch[157] client 2
2024-11-30 13:26:37,811 - INFO - reading batch[157] client 3
2024-11-30 13:26:37,833 - INFO - reading batch[157] client 4
2024-11-30 13:26:37,848 - INFO - Final partition
2024-11-30 13:26:37,849 - INFO - reading batch[158] client 1
2024-11-30 13:26:37,877 - INFO - reading batch[158] client 2
2024-11-30 13:26:37,908 - INFO - reading batch[158] client 3
2024-11-30 13:26:37,932 - INFO - reading batch[158] client 4
2024-11-30 13:26:37,957 - INFO - reading batch[159] client 1
2024-11-30 13:26:37,975 - INFO - reading batch[159] client 2
2024-11-30 13:26:37,988 - INFO - reading batch[159] client 3
2024-11-30 13:26:38,011 - INFO - reading batch[159] client 4
2024-11-30 13:26:38,041 - INFO - reading batch[160] client 1
2024-11-30 13:26:38,056 - INFO - Final partition
2024-11-30 13:26:38,057 - INFO - reading batch[160] client 2
2024-11-30 13:26:38,085 - INFO - reading batch[160] client 3
2024-11-30 13:26:38,107 - ERROR - backward on partition 4
2024-11-30 13:26:38,108 - CRITICAL - calculate backward $4 on client4
2024-11-30 13:26:38,118 - CRITICAL - new gradient:tensor([[ 6.1504e-04,  1.7321e-04, -1.7327e-04,  ...,  5.1726e-05,
          2.1090e-04, -3.8818e-04],
        [ 4.7715e-04,  3.4373e-04, -2.6279e-04,  ...,  1.8845e-04,
         -6.7498e-04, -4.5048e-04],
        [ 4.8844e-04, -2.4854e-05, -2.1726e-05,  ..., -8.0437e-05,
         -3.7310e-04, -3.3268e-04],
        ...,
        [-4.6028e-04,  4.0324e-04,  3.2853e-04,  ...,  3.7331e-04,
          5.8873e-04,  8.1019e-05],
        [-2.6909e-04, -7.2879e-04,  2.3653e-04,  ...,  5.3780e-04,
         -4.7020e-04, -4.5383e-04],
        [-4.7862e-04,  4.0957e-04,  3.4536e-04,  ...,  3.7713e-04,
          6.0039e-04,  9.8042e-05]]) 
 old gradient:tensor([[ 0.0019, -0.0141,  0.0017,  0.0014,  0.0015,  0.0015,  0.0015,  0.0014,
          0.0018,  0.0016],
        [ 0.0020,  0.0015, -0.0139,  0.0013,  0.0014,  0.0014,  0.0016,  0.0015,
          0.0018,  0.0014],
        [-0.0136,  0.0014,  0.0017,  0.0014,  0.0016,  0.0014,  0.0016,  0.0015,
          0.0017,  0.0014],
        [ 0.0019,  0.0015,  0.0018,  0.0014, -0.0142,  0.0015,  0.0014,  0.0014,
          0.0017,  0.0015],
        [-0.0135,  0.0015,  0.0017,  0.0013,  0.0014,  0.0015,  0.0014,  0.0015,
          0.0017,  0.0015],
        [ 0.0018, -0.0141,  0.0017,  0.0014,  0.0015,  0.0015,  0.0016,  0.0015,
          0.0016,  0.0016],
        [ 0.0022,  0.0015, -0.0140,  0.0013,  0.0015,  0.0014,  0.0014,  0.0014,
          0.0018,  0.0015],
        [ 0.0019,  0.0015,  0.0016,  0.0015,  0.0015,  0.0015,  0.0016, -0.0142,
          0.0016,  0.0015],
        [ 0.0018,  0.0016,  0.0016,  0.0015,  0.0014,  0.0015,  0.0015, -0.0142,
          0.0017,  0.0016],
        [ 0.0020,  0.0015,  0.0018,  0.0013,  0.0015,  0.0014,  0.0015,  0.0015,
         -0.0139,  0.0014],
        [ 0.0020,  0.0015,  0.0018,  0.0013, -0.0141,  0.0015,  0.0015,  0.0015,
          0.0015,  0.0015],
        [ 0.0021,  0.0016, -0.0138,  0.0012,  0.0013,  0.0014,  0.0014,  0.0015,
          0.0018,  0.0014],
        [ 0.0021,  0.0014,  0.0017,  0.0014,  0.0015,  0.0014,  0.0014,  0.0015,
          0.0017, -0.0141],
        [ 0.0022,  0.0014,  0.0018,  0.0013,  0.0015,  0.0014,  0.0015,  0.0015,
         -0.0139,  0.0014],
        [ 0.0022,  0.0014,  0.0018, -0.0143,  0.0014,  0.0014,  0.0015,  0.0015,
          0.0018,  0.0014],
        [ 0.0019,  0.0015,  0.0017,  0.0015,  0.0016,  0.0015,  0.0015, -0.0142,
          0.0016,  0.0015],
        [ 0.0019,  0.0015, -0.0139,  0.0013,  0.0013,  0.0016,  0.0014,  0.0015,
          0.0018,  0.0015],
        [ 0.0019,  0.0014,  0.0018,  0.0014,  0.0016, -0.0142,  0.0015,  0.0015,
          0.0017,  0.0015],
        [ 0.0020,  0.0014,  0.0017,  0.0014, -0.0141,  0.0015,  0.0015,  0.0015,
          0.0017,  0.0015],
        [ 0.0020,  0.0015,  0.0018,  0.0013,  0.0015,  0.0014,  0.0015,  0.0015,
          0.0017, -0.0141],
        [ 0.0021,  0.0014,  0.0017,  0.0014,  0.0016,  0.0014,  0.0014,  0.0014,
         -0.0138,  0.0014],
        [ 0.0020,  0.0015,  0.0018,  0.0013,  0.0015,  0.0015,  0.0014,  0.0014,
         -0.0139,  0.0015],
        [ 0.0019,  0.0015,  0.0017,  0.0014,  0.0016,  0.0014,  0.0014, -0.0142,
          0.0018,  0.0015],
        [ 0.0020,  0.0015,  0.0018,  0.0014,  0.0016, -0.0142,  0.0014,  0.0015,
          0.0016,  0.0015],
        [ 0.0020,  0.0015,  0.0018,  0.0014,  0.0014,  0.0014,  0.0014,  0.0015,
         -0.0138,  0.0015],
        [ 0.0018,  0.0015, -0.0140,  0.0014,  0.0016,  0.0016,  0.0016,  0.0015,
          0.0016,  0.0015],
        [ 0.0018,  0.0016,  0.0017,  0.0015,  0.0015,  0.0015,  0.0014, -0.0141,
          0.0016,  0.0015],
        [ 0.0019,  0.0014,  0.0016,  0.0015,  0.0016,  0.0016,  0.0016, -0.0142,
          0.0015,  0.0015],
        [ 0.0022,  0.0013,  0.0017, -0.0142,  0.0014,  0.0014,  0.0015,  0.0014,
          0.0019,  0.0014],
        [ 0.0020,  0.0016,  0.0018,  0.0013,  0.0014,  0.0014,  0.0015,  0.0015,
         -0.0139,  0.0014],
        [ 0.0022,  0.0014,  0.0018,  0.0012,  0.0014,  0.0013, -0.0142,  0.0016,
          0.0019,  0.0015],
        [ 0.0022,  0.0014,  0.0016, -0.0142,  0.0015,  0.0014,  0.0015,  0.0014,
          0.0018,  0.0015],
        [ 0.0020,  0.0015,  0.0017,  0.0013,  0.0016, -0.0142,  0.0016,  0.0015,
          0.0016,  0.0015],
        [-0.0136,  0.0014,  0.0016,  0.0014,  0.0015,  0.0014,  0.0015,  0.0016,
          0.0018,  0.0015],
        [ 0.0020,  0.0014,  0.0017,  0.0014,  0.0015,  0.0014,  0.0014, -0.0141,
          0.0017,  0.0015],
        [ 0.0022,  0.0014,  0.0018,  0.0013,  0.0016,  0.0013, -0.0144,  0.0014,
          0.0018,  0.0015],
        [ 0.0021,  0.0015,  0.0016,  0.0013,  0.0015,  0.0014, -0.0142,  0.0014,
          0.0018,  0.0015],
        [ 0.0021,  0.0016,  0.0016,  0.0014,  0.0016, -0.0142,  0.0014,  0.0014,
          0.0017,  0.0015],
        [ 0.0021,  0.0014,  0.0017,  0.0013,  0.0015,  0.0014,  0.0014,  0.0015,
         -0.0139,  0.0015],
        [-0.0136,  0.0014,  0.0016,  0.0014,  0.0017,  0.0014,  0.0015,  0.0013,
          0.0017,  0.0015],
        [ 0.0021,  0.0015,  0.0018,  0.0014,  0.0015, -0.0142,  0.0014,  0.0015,
          0.0017,  0.0016],
        [ 0.0021,  0.0015,  0.0018,  0.0013,  0.0015,  0.0015,  0.0014,  0.0014,
          0.0016, -0.0142],
        [ 0.0019,  0.0014,  0.0017,  0.0015,  0.0015,  0.0014,  0.0015,  0.0015,
         -0.0139,  0.0015],
        [ 0.0019, -0.0142,  0.0017,  0.0014,  0.0015,  0.0014,  0.0016,  0.0015,
          0.0017,  0.0016],
        [ 0.0019, -0.0141,  0.0016,  0.0014,  0.0014,  0.0015,  0.0015,  0.0015,
          0.0018,  0.0016],
        [ 0.0019, -0.0142,  0.0017,  0.0014,  0.0015,  0.0015,  0.0015,  0.0015,
          0.0017,  0.0015],
        [ 0.0021,  0.0014, -0.0139,  0.0013,  0.0014,  0.0014,  0.0013,  0.0015,
          0.0019,  0.0015],
        [ 0.0019,  0.0014,  0.0017,  0.0014,  0.0016, -0.0142,  0.0015,  0.0015,
          0.0017,  0.0015],
        [ 0.0019,  0.0015,  0.0018,  0.0014, -0.0141,  0.0015,  0.0014,  0.0015,
          0.0017,  0.0015],
        [ 0.0020,  0.0015,  0.0017,  0.0014,  0.0016,  0.0013, -0.0142,  0.0015,
          0.0017,  0.0015],
        [ 0.0021,  0.0015,  0.0017,  0.0014,  0.0016,  0.0014,  0.0015,  0.0014,
          0.0016, -0.0142],
        [-0.0135,  0.0014,  0.0017,  0.0014,  0.0015,  0.0014,  0.0016,  0.0014,
          0.0017,  0.0014],
        [-0.0135,  0.0014,  0.0016,  0.0013,  0.0016,  0.0015,  0.0014,  0.0014,
          0.0018,  0.0015],
        [ 0.0018, -0.0142,  0.0018,  0.0014,  0.0015,  0.0015,  0.0015,  0.0014,
          0.0018,  0.0015],
        [ 0.0020,  0.0015,  0.0017,  0.0014, -0.0142,  0.0014,  0.0014,  0.0014,
          0.0019,  0.0015],
        [ 0.0021,  0.0014,  0.0017,  0.0013,  0.0014,  0.0015,  0.0016,  0.0015,
         -0.0139,  0.0014],
        [ 0.0018, -0.0141,  0.0016,  0.0014,  0.0015,  0.0015,  0.0016,  0.0015,
          0.0016,  0.0016],
        [-0.0134,  0.0014,  0.0017,  0.0014,  0.0015,  0.0013,  0.0015,  0.0014,
          0.0018,  0.0014],
        [ 0.0019,  0.0014,  0.0017,  0.0014,  0.0015,  0.0015,  0.0016, -0.0141,
          0.0016,  0.0015],
        [ 0.0018, -0.0142,  0.0017,  0.0014,  0.0015,  0.0015,  0.0016,  0.0015,
          0.0016,  0.0016],
        [ 0.0019,  0.0016, -0.0140,  0.0013,  0.0014,  0.0014,  0.0015,  0.0015,
          0.0019,  0.0015],
        [ 0.0021,  0.0014,  0.0017,  0.0013,  0.0016,  0.0013, -0.0142,  0.0015,
          0.0017,  0.0015],
        [ 0.0020,  0.0014,  0.0018,  0.0014,  0.0015,  0.0014,  0.0015,  0.0014,
          0.0018, -0.0141],
        [ 0.0022,  0.0016,  0.0018,  0.0012,  0.0014,  0.0013, -0.0143,  0.0015,
          0.0018,  0.0015]])
2024-11-30 13:26:38,118 - INFO - reading batch[160] client 4
2024-11-30 13:26:38,143 - INFO - reading batch[161] client 1
2024-11-30 13:26:38,161 - INFO - reading batch[161] client 2
2024-11-30 13:26:38,175 - INFO - reading batch[161] client 3
2024-11-30 13:26:38,188 - INFO - reading batch[161] client 4
2024-11-30 13:26:38,216 - INFO - reading batch[162] client 1
2024-11-30 13:26:38,239 - INFO - reading batch[162] client 2
2024-11-30 13:26:38,262 - INFO - reading batch[162] client 3
2024-11-30 13:26:38,284 - INFO - reading batch[162] client 4
2024-11-30 13:26:38,311 - INFO - reading batch[163] client 1
2024-11-30 13:26:38,330 - INFO - reading batch[163] client 2
2024-11-30 13:26:38,354 - INFO - reading batch[163] client 3
2024-11-30 13:26:38,376 - INFO - reading batch[163] client 4
2024-11-30 13:26:38,400 - INFO - reading batch[164] client 1
2024-11-30 13:26:38,417 - INFO - reading batch[164] client 2
2024-11-30 13:26:38,433 - INFO - reading batch[164] client 3
2024-11-30 13:26:38,457 - INFO - reading batch[164] client 4
2024-11-30 13:26:38,483 - INFO - reading batch[165] client 1
2024-11-30 13:26:38,513 - INFO - reading batch[165] client 2
2024-11-30 13:26:38,543 - INFO - reading batch[165] client 3
2024-11-30 13:26:38,558 - INFO - reading batch[165] client 4
2024-11-30 13:26:38,591 - INFO - reading batch[166] client 1
2024-11-30 13:26:38,609 - INFO - reading batch[166] client 2
2024-11-30 13:26:38,623 - INFO - reading batch[166] client 3
2024-11-30 13:26:38,645 - INFO - reading batch[166] client 4
2024-11-30 13:26:38,667 - INFO - reading batch[167] client 1
2024-11-30 13:26:38,689 - INFO - reading batch[167] client 2
2024-11-30 13:26:38,719 - INFO - reading batch[167] client 3
2024-11-30 13:26:38,741 - INFO - reading batch[167] client 4
2024-11-30 13:26:38,766 - INFO - reading batch[168] client 1
2024-11-30 13:26:38,789 - INFO - reading batch[168] client 2
2024-11-30 13:26:38,803 - INFO - reading batch[168] client 3
2024-11-30 13:26:38,834 - INFO - reading batch[168] client 4
2024-11-30 13:26:38,859 - INFO - reading batch[169] client 1
2024-11-30 13:26:38,884 - INFO - reading batch[169] client 2
2024-11-30 13:26:38,911 - INFO - reading batch[169] client 3
2024-11-30 13:26:38,924 - INFO - reading batch[169] client 4
2024-11-30 13:26:38,946 - INFO - reading batch[170] client 1
2024-11-30 13:26:38,964 - INFO - reading batch[170] client 2
2024-11-30 13:26:38,990 - INFO - reading batch[170] client 3
2024-11-30 13:26:39,012 - INFO - reading batch[170] client 4
2024-11-30 13:26:39,039 - INFO - reading batch[171] client 1
2024-11-30 13:26:39,064 - INFO - reading batch[171] client 2
2024-11-30 13:26:39,081 - INFO - reading batch[171] client 3
2024-11-30 13:26:39,094 - INFO - Final partition
2024-11-30 13:26:39,095 - INFO - reading batch[171] client 4
2024-11-30 13:26:39,108 - INFO - Final partition
2024-11-30 13:26:39,110 - INFO - reading batch[172] client 1
2024-11-30 13:26:39,136 - INFO - reading batch[172] client 2
2024-11-30 13:26:39,170 - INFO - reading batch[172] client 3
2024-11-30 13:26:39,204 - INFO - reading batch[172] client 4
2024-11-30 13:26:39,234 - INFO - reading batch[173] client 1
2024-11-30 13:26:39,257 - INFO - reading batch[173] client 2
2024-11-30 13:26:39,270 - INFO - reading batch[173] client 3
2024-11-30 13:26:39,283 - INFO - reading batch[173] client 4
2024-11-30 13:26:39,308 - INFO - reading batch[174] client 1
2024-11-30 13:26:39,334 - INFO - reading batch[174] client 2
2024-11-30 13:26:39,361 - INFO - reading batch[174] client 3
2024-11-30 13:26:39,373 - ERROR - backward on partition 4
2024-11-30 13:26:39,374 - CRITICAL - calculate backward $4 on client4
2024-11-30 13:26:39,457 - CRITICAL - new gradient:tensor([[-4.6407e-04,  4.0800e-04,  3.3983e-04,  ...,  3.7751e-04,
          5.9579e-04,  8.4328e-05],
        [-6.6296e-05, -3.6249e-04,  1.8141e-05,  ..., -1.8810e-04,
          5.0122e-04,  2.2238e-04],
        [-1.5693e-04,  1.0214e-04,  2.3286e-04,  ..., -7.2155e-04,
         -4.4178e-04,  6.3286e-04],
        ...,
        [-2.3301e-04,  2.4643e-04, -3.8787e-04,  ..., -2.2681e-04,
          2.1037e-04, -1.6409e-05],
        [-7.1176e-05, -3.5468e-04,  2.8629e-05,  ..., -1.8641e-04,
          4.9483e-04,  2.2872e-04],
        [ 4.7331e-04,  3.5494e-04, -2.5686e-04,  ...,  1.8660e-04,
         -6.7144e-04, -4.4420e-04]]) 
 old gradient:tensor([[ 0.0022,  0.0014,  0.0018,  0.0013,  0.0016,  0.0014, -0.0143,  0.0014,
          0.0018,  0.0015],
        [ 0.0018,  0.0014,  0.0017,  0.0016,  0.0015,  0.0015,  0.0015, -0.0142,
          0.0016,  0.0015],
        [ 0.0022,  0.0014,  0.0017, -0.0143,  0.0014,  0.0014,  0.0014,  0.0015,
          0.0019,  0.0014],
        [ 0.0019,  0.0015,  0.0018,  0.0015,  0.0014,  0.0014,  0.0014,  0.0015,
          0.0017, -0.0142],
        [ 0.0019, -0.0142,  0.0017,  0.0014,  0.0016,  0.0014,  0.0015,  0.0015,
          0.0016,  0.0015],
        [ 0.0019,  0.0015,  0.0017,  0.0015,  0.0015,  0.0014,  0.0015,  0.0014,
          0.0017, -0.0141],
        [-0.0136,  0.0014,  0.0017,  0.0014,  0.0017,  0.0013,  0.0015,  0.0015,
          0.0017,  0.0014],
        [ 0.0021,  0.0015, -0.0140,  0.0013,  0.0014,  0.0014,  0.0014,  0.0015,
          0.0018,  0.0016],
        [ 0.0022,  0.0013,  0.0017,  0.0014,  0.0015, -0.0142,  0.0015,  0.0014,
          0.0018,  0.0014],
        [ 0.0021,  0.0014,  0.0018,  0.0013,  0.0015,  0.0014, -0.0143,  0.0015,
          0.0018,  0.0015],
        [ 0.0018, -0.0142,  0.0017,  0.0014,  0.0015,  0.0015,  0.0016,  0.0015,
          0.0017,  0.0016],
        [-0.0134,  0.0013,  0.0016,  0.0013,  0.0017,  0.0013,  0.0015,  0.0015,
          0.0017,  0.0015],
        [ 0.0019,  0.0014,  0.0017,  0.0015,  0.0016,  0.0015,  0.0015, -0.0142,
          0.0016,  0.0015],
        [ 0.0021,  0.0013,  0.0018, -0.0143,  0.0015,  0.0014,  0.0015,  0.0015,
          0.0017,  0.0015],
        [ 0.0021,  0.0014,  0.0017,  0.0014,  0.0015,  0.0014,  0.0015,  0.0015,
         -0.0140,  0.0014],
        [ 0.0019,  0.0014,  0.0018,  0.0013, -0.0141,  0.0016,  0.0015,  0.0014,
          0.0018,  0.0015],
        [ 0.0021,  0.0014,  0.0017,  0.0014,  0.0016, -0.0142,  0.0015,  0.0014,
          0.0017,  0.0015],
        [ 0.0019, -0.0142,  0.0018,  0.0014,  0.0016,  0.0014,  0.0014,  0.0013,
          0.0018,  0.0015],
        [ 0.0022,  0.0015,  0.0018,  0.0012,  0.0015,  0.0013, -0.0144,  0.0014,
          0.0019,  0.0015],
        [ 0.0020,  0.0013,  0.0018,  0.0014,  0.0015,  0.0014,  0.0015,  0.0014,
         -0.0139,  0.0015],
        [ 0.0020,  0.0014,  0.0018,  0.0013,  0.0015,  0.0015,  0.0014,  0.0014,
          0.0018, -0.0142],
        [ 0.0022,  0.0015,  0.0017,  0.0012,  0.0015,  0.0014, -0.0143,  0.0014,
          0.0018,  0.0015],
        [ 0.0020,  0.0015,  0.0017,  0.0014,  0.0016,  0.0014,  0.0015,  0.0014,
         -0.0139,  0.0015],
        [-0.0135,  0.0014,  0.0017,  0.0013,  0.0015,  0.0015,  0.0014,  0.0015,
          0.0017,  0.0014],
        [ 0.0018,  0.0015,  0.0016,  0.0014,  0.0016, -0.0142,  0.0015,  0.0016,
          0.0016,  0.0015],
        [ 0.0020,  0.0015, -0.0139,  0.0013,  0.0013,  0.0015,  0.0015,  0.0015,
          0.0018,  0.0015],
        [ 0.0019, -0.0142,  0.0018,  0.0014,  0.0015,  0.0014,  0.0015,  0.0014,
          0.0019,  0.0015],
        [ 0.0021,  0.0014,  0.0018,  0.0013,  0.0016,  0.0015, -0.0142,  0.0014,
          0.0017,  0.0014],
        [ 0.0018,  0.0014,  0.0017, -0.0142,  0.0015,  0.0015,  0.0015,  0.0016,
          0.0017,  0.0016],
        [ 0.0019,  0.0014,  0.0016,  0.0014,  0.0016, -0.0142,  0.0014,  0.0015,
          0.0017,  0.0016],
        [ 0.0020,  0.0014,  0.0016, -0.0143,  0.0015,  0.0014,  0.0015,  0.0016,
          0.0017,  0.0014],
        [-0.0135,  0.0014,  0.0018,  0.0013,  0.0015,  0.0014,  0.0014,  0.0016,
          0.0017,  0.0014],
        [ 0.0020,  0.0014,  0.0017,  0.0014,  0.0015,  0.0015,  0.0015,  0.0015,
          0.0016, -0.0142],
        [ 0.0022,  0.0014,  0.0017,  0.0013,  0.0015,  0.0014,  0.0014,  0.0014,
         -0.0138,  0.0015],
        [ 0.0020,  0.0014,  0.0018,  0.0013, -0.0141,  0.0014,  0.0014,  0.0015,
          0.0017,  0.0015],
        [ 0.0018,  0.0015,  0.0017,  0.0014,  0.0015,  0.0015,  0.0014, -0.0141,
          0.0016,  0.0016],
        [ 0.0021,  0.0016, -0.0139,  0.0013,  0.0012,  0.0014,  0.0014,  0.0015,
          0.0019,  0.0015],
        [ 0.0019,  0.0015,  0.0017,  0.0015,  0.0016,  0.0015,  0.0016, -0.0142,
          0.0015,  0.0015],
        [-0.0134,  0.0013,  0.0015,  0.0013,  0.0016,  0.0013,  0.0014,  0.0015,
          0.0018,  0.0015],
        [ 0.0020,  0.0015,  0.0015,  0.0014,  0.0015, -0.0141,  0.0015,  0.0014,
          0.0017,  0.0015],
        [ 0.0021,  0.0016, -0.0139,  0.0013,  0.0014,  0.0014,  0.0014,  0.0015,
          0.0018,  0.0015],
        [ 0.0020,  0.0014,  0.0017, -0.0143,  0.0015,  0.0014,  0.0015,  0.0014,
          0.0018,  0.0015],
        [ 0.0020, -0.0141,  0.0017,  0.0013,  0.0014,  0.0015,  0.0015,  0.0016,
          0.0018,  0.0015],
        [ 0.0018,  0.0015,  0.0016,  0.0015,  0.0015,  0.0015,  0.0014, -0.0141,
          0.0016,  0.0016],
        [ 0.0019,  0.0014,  0.0019,  0.0013,  0.0015,  0.0014, -0.0142,  0.0014,
          0.0018,  0.0015],
        [ 0.0019, -0.0142,  0.0016,  0.0014,  0.0015,  0.0015,  0.0016,  0.0015,
          0.0017,  0.0016],
        [ 0.0019,  0.0014,  0.0017,  0.0015,  0.0016,  0.0015,  0.0015, -0.0142,
          0.0016,  0.0016],
        [ 0.0020,  0.0014,  0.0017, -0.0142,  0.0016,  0.0015,  0.0015,  0.0014,
          0.0017,  0.0016],
        [ 0.0019,  0.0014,  0.0018,  0.0014, -0.0141,  0.0014,  0.0014,  0.0014,
          0.0018,  0.0015],
        [ 0.0020,  0.0015,  0.0017,  0.0014,  0.0015,  0.0015,  0.0014,  0.0015,
          0.0017, -0.0142],
        [ 0.0020,  0.0015,  0.0018,  0.0014,  0.0015,  0.0014, -0.0142,  0.0015,
          0.0016,  0.0014],
        [ 0.0019, -0.0142,  0.0017,  0.0014,  0.0015,  0.0014,  0.0015,  0.0014,
          0.0018,  0.0016],
        [ 0.0022,  0.0014,  0.0018,  0.0013,  0.0015,  0.0013, -0.0142,  0.0015,
          0.0017,  0.0015],
        [-0.0135,  0.0014,  0.0017,  0.0013,  0.0016,  0.0013,  0.0016,  0.0015,
          0.0017,  0.0015],
        [ 0.0020,  0.0014, -0.0138,  0.0013,  0.0015,  0.0015,  0.0013,  0.0014,
          0.0018,  0.0015],
        [ 0.0018,  0.0016,  0.0019,  0.0014,  0.0015,  0.0015,  0.0014, -0.0142,
          0.0017,  0.0015],
        [ 0.0020,  0.0014,  0.0017,  0.0014,  0.0015,  0.0015,  0.0014,  0.0014,
         -0.0137,  0.0015],
        [ 0.0019, -0.0141,  0.0016,  0.0014,  0.0014,  0.0015,  0.0016,  0.0015,
          0.0017,  0.0016],
        [ 0.0019,  0.0014,  0.0016,  0.0013,  0.0016, -0.0142,  0.0014,  0.0015,
          0.0018,  0.0016],
        [ 0.0020,  0.0015,  0.0018,  0.0013,  0.0015,  0.0015, -0.0142,  0.0015,
          0.0017,  0.0015],
        [ 0.0020,  0.0014,  0.0018,  0.0013,  0.0015,  0.0014,  0.0015,  0.0015,
          0.0017, -0.0141],
        [ 0.0020,  0.0014,  0.0017,  0.0014,  0.0015,  0.0014,  0.0015,  0.0015,
         -0.0138,  0.0015],
        [ 0.0018,  0.0015,  0.0017,  0.0015,  0.0014,  0.0015,  0.0014, -0.0141,
          0.0017,  0.0015],
        [ 0.0020,  0.0016, -0.0139,  0.0013,  0.0013,  0.0015,  0.0014,  0.0015,
          0.0018,  0.0015]])
2024-11-30 13:26:39,458 - INFO - reading batch[174] client 4
2024-11-30 13:26:39,486 - INFO - reading batch[175] client 1
2024-11-30 13:26:39,504 - INFO - reading batch[175] client 2
2024-11-30 13:26:39,531 - INFO - reading batch[175] client 3
2024-11-30 13:26:39,554 - INFO - reading batch[175] client 4
2024-11-30 13:26:39,587 - INFO - reading batch[176] client 1
2024-11-30 13:26:39,613 - INFO - reading batch[176] client 2
2024-11-30 13:26:39,626 - ERROR - backward on partition 3
2024-11-30 13:26:39,629 - CRITICAL - calculate backward $3 on client3
2024-11-30 13:26:39,637 - CRITICAL - new gradient:tensor([[[[ 2.7120e-04, -2.0858e-05, -2.0891e-04, -2.5554e-05],
          [ 4.1460e-05, -4.6942e-06,  1.5253e-04, -9.0747e-05],
          [ 5.2406e-05,  2.9095e-06,  6.3094e-06,  3.4283e-06],
          [ 1.2010e-04,  2.1565e-05,  8.1788e-05,  1.0396e-06]],

         [[ 1.2048e-04, -3.3160e-05, -2.9093e-05,  3.9454e-05],
          [-9.1151e-05,  1.1384e-05, -8.7234e-05,  1.6558e-04],
          [ 8.0415e-05, -9.1447e-05, -1.0614e-05, -3.8078e-05],
          [-1.6962e-05,  2.1466e-05,  2.6330e-06,  5.3636e-05]],

         [[ 1.0822e-04, -1.8696e-04, -8.2417e-05, -1.0784e-04],
          [ 3.9914e-04,  1.2983e-05,  3.5147e-05,  6.1272e-05],
          [ 9.1565e-06,  4.5887e-05, -1.9977e-05,  7.5955e-05],
          [ 3.1766e-05,  3.9543e-06,  8.9105e-05,  5.7722e-05]],

         ...,

         [[ 6.4131e-06, -8.7525e-05, -1.0003e-04,  4.2913e-05],
          [ 1.3898e-04,  3.4852e-05,  4.3688e-05,  3.8195e-05],
          [-1.2969e-04, -3.1238e-04, -1.2633e-04, -2.8920e-04],
          [ 1.0115e-05,  1.9128e-05, -7.5002e-07, -1.2375e-04]],

         [[-9.6787e-05,  1.4442e-04,  1.6357e-04,  2.7619e-05],
          [-2.4284e-05,  1.8002e-05, -1.8088e-04,  3.0300e-06],
          [-7.2566e-05,  1.4294e-05,  1.4837e-05,  6.1263e-05],
          [-3.9590e-05,  4.9803e-06,  4.3929e-05, -2.5246e-05]],

         [[-9.9100e-05,  5.2648e-05, -1.2893e-04,  1.6775e-05],
          [ 1.1269e-04,  4.4062e-05,  1.6823e-04,  2.0288e-05],
          [ 6.5571e-06,  2.6060e-06, -7.2082e-05, -1.4180e-04],
          [ 3.3152e-05, -1.4681e-04, -3.4495e-05, -9.4220e-06]]],


        [[[-5.1743e-05, -1.1191e-04,  1.4125e-04, -1.1007e-05],
          [ 2.9693e-04, -8.4235e-05,  4.1554e-05,  1.7711e-04],
          [ 3.5632e-05,  4.2213e-05,  1.6525e-04,  6.9831e-05],
          [ 9.5683e-05, -2.9357e-05, -1.0864e-04, -4.7409e-05]],

         [[ 1.2147e-04, -1.0951e-04, -1.2228e-04,  9.7227e-05],
          [ 1.0406e-04,  6.6885e-05, -4.6235e-04,  2.9172e-05],
          [-1.1155e-04, -1.8745e-04, -9.1574e-05,  1.5405e-04],
          [-6.4862e-05,  1.8099e-04,  7.0874e-05, -1.1939e-04]],

         [[ 1.1877e-04, -3.7112e-06,  1.3295e-04, -8.2761e-06],
          [ 5.0047e-05,  6.6274e-05,  2.2208e-04, -2.2207e-04],
          [ 6.7672e-05, -1.6592e-05,  4.8090e-05, -5.2392e-05],
          [-9.8749e-05, -1.9285e-04, -1.3589e-04, -1.3418e-04]],

         ...,

         [[ 8.0020e-05,  1.6221e-05,  1.9318e-04,  8.0502e-05],
          [ 1.7966e-04, -6.6679e-05, -4.0197e-05,  1.1946e-04],
          [ 6.5192e-05,  1.6427e-04,  3.1074e-05,  1.1316e-04],
          [-3.2206e-05, -1.1312e-04, -1.3565e-04, -4.0395e-05]],

         [[-5.4456e-05, -1.0637e-05,  1.1037e-04,  2.4108e-05],
          [ 3.1682e-05, -1.4368e-04, -1.4649e-04, -2.8368e-05],
          [-1.2477e-04, -5.2291e-05,  1.0004e-04, -6.0012e-05],
          [-4.6701e-05,  1.6101e-04, -7.1536e-05,  2.5628e-05]],

         [[ 1.1338e-04,  4.4974e-05,  1.7299e-05,  1.5463e-04],
          [ 1.0507e-04, -3.2282e-05,  1.0048e-05, -2.3566e-05],
          [ 3.1436e-05, -1.2215e-04,  1.2730e-05,  7.5875e-06],
          [ 2.7744e-05, -2.7264e-04,  1.5935e-04,  1.4307e-04]]],


        [[[-1.0851e-04,  1.8951e-04,  1.9361e-05, -5.4258e-05],
          [-8.5805e-05,  3.3267e-05, -1.2114e-04, -7.3224e-05],
          [-1.4846e-05, -1.1769e-04, -1.7820e-04, -8.8629e-05],
          [ 1.8890e-04, -9.9575e-05, -1.3640e-04,  9.7765e-05]],

         [[-1.5236e-04, -6.6984e-06, -1.9700e-04,  3.7783e-05],
          [ 1.4559e-04, -1.6245e-04,  1.7315e-04,  6.7064e-05],
          [-5.1426e-05, -3.2481e-05,  2.1187e-04,  2.6414e-06],
          [-6.5200e-06, -3.6277e-05,  7.9812e-06,  1.3972e-04]],

         [[-8.8761e-05,  2.0793e-05, -9.6395e-06,  2.2500e-05],
          [-2.3411e-04,  2.7931e-05,  6.0912e-05, -2.1089e-04],
          [ 1.3062e-04, -7.1039e-05,  1.2970e-06, -1.2883e-04],
          [-2.7519e-05, -8.7107e-05, -1.0233e-04, -3.8082e-05]],

         ...,

         [[ 2.3379e-05,  7.1334e-05,  8.8255e-05, -9.7582e-05],
          [ 9.7225e-05, -1.2675e-05, -1.0502e-04, -3.1795e-04],
          [ 2.0410e-04, -1.8170e-04, -7.9834e-05, -4.3020e-05],
          [ 1.1425e-04, -5.4674e-05, -3.8097e-05,  6.8701e-05]],

         [[-8.0436e-05,  1.3096e-04,  3.9638e-05, -4.1537e-05],
          [-3.4089e-05,  5.5993e-05,  1.1976e-04,  1.8933e-04],
          [-1.8388e-05,  1.4465e-04, -2.1436e-04,  8.3946e-05],
          [-3.0978e-05,  9.7023e-05,  1.5395e-04,  3.4770e-05]],

         [[ 1.8899e-04,  2.3385e-05,  1.3197e-04, -1.1531e-04],
          [-1.0200e-05, -6.5790e-06,  1.9725e-05,  6.9460e-05],
          [ 8.2004e-05,  1.6337e-04, -5.7287e-05, -9.8031e-05],
          [-5.5512e-05,  2.5917e-04,  1.7854e-05,  7.9220e-06]]],


        ...,


        [[[ 2.4263e-04, -3.8370e-05, -1.1323e-04,  1.7265e-04],
          [-7.8386e-05,  1.0493e-04, -2.9158e-05, -1.3886e-04],
          [-8.0432e-05, -1.1465e-04, -1.1420e-04,  1.4272e-04],
          [ 2.2493e-04, -3.2460e-05, -2.2206e-04,  5.7791e-06]],

         [[ 1.9651e-04,  2.2505e-05, -1.0288e-04,  4.3200e-05],
          [ 2.9983e-04, -1.0637e-05,  6.7354e-05, -1.6882e-04],
          [ 2.0226e-04, -7.3694e-05, -4.2910e-05, -9.9196e-05],
          [-8.4842e-06, -1.1919e-04, -5.7389e-05,  4.6900e-06]],

         [[ 8.5607e-05, -2.1545e-05, -1.4034e-04,  1.0345e-04],
          [-5.1567e-05,  6.5620e-05,  4.3350e-05,  3.3326e-05],
          [-4.8804e-05, -5.8061e-05, -2.4575e-04,  6.0869e-05],
          [-1.0472e-04, -6.1321e-05,  1.8270e-04, -1.5416e-05]],

         ...,

         [[-7.1722e-05,  2.2182e-05, -1.0066e-04, -1.6227e-05],
          [ 1.5028e-04,  1.0755e-04, -4.9779e-05, -8.3407e-05],
          [ 8.1822e-05,  6.4407e-05,  1.0345e-04, -1.3134e-04],
          [-1.6862e-08,  1.9129e-05, -6.7529e-05, -8.9167e-05]],

         [[ 8.8008e-05,  5.7446e-05,  3.6883e-05, -1.9169e-04],
          [-6.7317e-06,  1.9777e-05,  1.0634e-04,  4.1094e-06],
          [-8.4228e-05, -7.4670e-05, -7.4844e-05,  2.0136e-04],
          [-1.0565e-04,  2.0183e-05, -4.7465e-05, -1.7607e-05]],

         [[-1.2314e-05,  3.4866e-05,  1.0297e-04, -1.8731e-04],
          [ 1.2069e-04, -1.4849e-04,  3.9032e-05,  6.1229e-05],
          [ 1.6048e-04,  4.1061e-05,  3.3818e-05, -2.4400e-05],
          [-6.6400e-06,  1.9658e-04,  8.0362e-05, -4.9652e-05]]],


        [[[-2.4394e-04,  1.4790e-04,  7.9767e-05, -4.9958e-05],
          [-7.3311e-06,  1.0888e-04, -5.9213e-05, -8.0278e-05],
          [-4.6454e-05, -8.1077e-05, -1.1241e-04, -8.0860e-05],
          [ 1.0735e-04, -5.5882e-05, -3.6023e-05,  1.3404e-04]],

         [[-1.1278e-04, -2.4776e-05, -1.8503e-04,  4.2639e-05],
          [ 1.7396e-04, -9.3577e-05,  1.1138e-04,  5.9262e-05],
          [-1.0323e-04, -8.5143e-05,  2.4989e-04, -8.8675e-05],
          [ 3.9293e-05, -2.1216e-05,  6.4124e-05,  1.8814e-04]],

         [[-1.2250e-04,  5.3664e-05, -5.2060e-05, -8.0116e-05],
          [-2.4167e-04,  3.5197e-05, -9.9995e-05, -9.6988e-05],
          [ 1.3205e-04, -1.1567e-04, -5.8984e-05, -1.5626e-04],
          [ 1.3580e-05,  8.0439e-05,  1.1041e-05, -8.4015e-05]],

         ...,

         [[-1.8871e-05, -2.2152e-05,  3.7704e-05, -4.5394e-05],
          [ 9.0235e-05, -8.3396e-05, -1.3636e-04, -3.3460e-04],
          [ 2.9172e-04, -1.9236e-04, -1.5354e-04,  1.2195e-05],
          [-1.1899e-05, -3.7963e-05,  4.0415e-05,  1.4286e-04]],

         [[ 3.7202e-05,  1.1260e-05, -5.1724e-05, -8.3126e-05],
          [-1.4536e-04,  8.5859e-05,  1.7009e-04,  9.6851e-05],
          [-1.0709e-04,  8.3914e-05, -2.4006e-04,  5.8803e-05],
          [ 1.8012e-05,  1.7462e-04,  1.1156e-04, -4.1040e-05]],

         [[ 1.0420e-04,  4.9030e-05,  1.5660e-04, -1.2869e-04],
          [ 1.1109e-06,  8.9390e-05,  4.0647e-05, -1.6638e-05],
          [ 1.5213e-04,  1.5373e-04, -1.1297e-04, -9.9981e-05],
          [-1.1351e-05,  2.7929e-04,  3.7506e-05, -3.3128e-06]]],


        [[[-1.6983e-04, -9.9642e-05, -1.5058e-04, -9.0183e-07],
          [ 1.0596e-04,  1.7020e-04,  1.3291e-04,  1.5753e-04],
          [-1.8935e-05, -9.8924e-05, -3.6700e-05, -1.7151e-04],
          [-8.0094e-05, -1.2706e-04,  1.0826e-04,  4.4323e-05]],

         [[ 9.0605e-05, -2.3630e-04,  4.8036e-05, -1.9990e-04],
          [-1.0735e-04,  1.2041e-05,  2.4752e-04, -3.7740e-05],
          [-6.0954e-05,  2.5123e-04,  2.7877e-05, -9.2142e-05],
          [-1.1856e-04,  4.8415e-05, -9.1967e-05,  1.1466e-04]],

         [[-1.9204e-04, -5.8436e-06,  1.9320e-04, -8.5109e-05],
          [-9.5527e-05,  6.6137e-05, -5.1880e-05,  6.1107e-05],
          [-3.7465e-05,  1.0523e-05,  6.3761e-05, -6.6661e-05],
          [-2.0128e-05,  1.4390e-04,  4.3510e-05,  9.0431e-05]],

         ...,

         [[ 8.1486e-06, -1.7993e-04, -7.0374e-05, -1.5904e-05],
          [-1.2943e-04,  2.8251e-05,  5.1895e-05,  1.6101e-04],
          [-1.8244e-04, -5.4942e-06, -1.5329e-04,  1.5814e-04],
          [-1.0304e-04,  1.4892e-04, -3.6542e-05,  1.0649e-04]],

         [[ 2.0186e-05,  8.3624e-05, -1.6598e-04, -1.6603e-04],
          [ 9.1728e-05, -4.8667e-05,  6.3987e-05, -1.3214e-04],
          [ 8.6596e-05,  2.0867e-05, -7.8532e-05,  9.4535e-05],
          [ 2.0016e-06,  1.0381e-04, -1.4188e-04,  6.3829e-05]],

         [[-1.1566e-04, -1.3012e-04, -1.4910e-04, -5.6604e-05],
          [-1.3015e-04, -1.5388e-05, -3.6125e-05, -1.4291e-04],
          [-2.1675e-04, -6.0399e-07, -1.6362e-05, -1.2036e-04],
          [ 2.2563e-05,  2.2214e-05, -6.5500e-05,  7.3011e-05]]]]) 
 old gradient:tensor([[-1.2738e-04,  3.9750e-04,  5.3539e-04,  ...,  2.3444e-04,
          3.4166e-04,  3.7007e-04],
        [-1.5651e-04,  1.0021e-04,  2.2592e-04,  ..., -7.2345e-04,
         -4.3418e-04,  6.3021e-04],
        [-2.4253e-04,  2.3442e-04, -3.8618e-04,  ..., -2.2433e-04,
          2.1822e-04, -1.2886e-05],
        ...,
        [-7.5045e-05, -3.5783e-04,  2.3476e-05,  ..., -1.9333e-04,
          5.0775e-04,  2.3432e-04],
        [-2.4154e-04,  2.4346e-04, -3.8793e-04,  ..., -2.2522e-04,
          2.2614e-04, -1.1049e-05],
        [ 4.8697e-04, -1.8780e-05, -2.0811e-05,  ..., -8.3806e-05,
         -3.5726e-04, -3.2326e-04]])
2024-11-30 13:26:39,638 - INFO - reading batch[176] client 3
2024-11-30 13:26:39,659 - INFO - reading batch[176] client 4
2024-11-30 13:26:39,691 - INFO - reading batch[177] client 1
2024-11-30 13:26:39,710 - INFO - reading batch[177] client 2
2024-11-30 13:26:39,729 - INFO - reading batch[177] client 3
2024-11-30 13:26:39,742 - INFO - reading batch[177] client 4
2024-11-30 13:26:39,755 - INFO - Final partition
2024-11-30 13:26:39,756 - INFO - reading batch[178] client 1
2024-11-30 13:26:39,775 - INFO - reading batch[178] client 2
2024-11-30 13:26:39,808 - INFO - reading batch[178] client 3
2024-11-30 13:26:39,837 - INFO - reading batch[178] client 4
2024-11-30 13:26:39,864 - INFO - reading batch[179] client 1
2024-11-30 13:26:39,882 - INFO - reading batch[179] client 2
2024-11-30 13:26:39,896 - INFO - reading batch[179] client 3
2024-11-30 13:26:39,922 - INFO - reading batch[179] client 4
2024-11-30 13:26:39,949 - INFO - reading batch[180] client 1
2024-11-30 13:26:39,977 - INFO - reading batch[180] client 2
2024-11-30 13:26:40,000 - INFO - reading batch[180] client 3
2024-11-30 13:26:40,012 - ERROR - backward on partition 4
2024-11-30 13:26:40,013 - CRITICAL - calculate backward $4 on client4
2024-11-30 13:26:40,019 - CRITICAL - new gradient:tensor([[ 6.1388e-04,  1.6895e-04, -1.7674e-04,  ...,  5.3344e-05,
          2.0805e-04, -3.9134e-04],
        [ 6.1563e-04,  1.7444e-04, -1.7639e-04,  ...,  5.1374e-05,
          1.9967e-04, -3.9497e-04],
        [ 4.7484e-04,  3.4261e-04, -2.6843e-04,  ...,  1.8699e-04,
         -6.8239e-04, -4.5231e-04],
        ...,
        [-1.2248e-04,  3.9969e-04,  5.2955e-04,  ...,  2.2852e-04,
          3.3176e-04,  3.6802e-04],
        [ 4.8271e-04,  3.4637e-04, -2.6297e-04,  ...,  1.8838e-04,
         -6.7593e-04, -4.5634e-04],
        [ 6.1839e-04,  1.7555e-04, -1.7519e-04,  ...,  5.2889e-05,
          2.0174e-04, -3.9377e-04]]) 
 old gradient:tensor([[ 0.0019, -0.0141,  0.0017,  0.0014,  0.0015,  0.0014,  0.0015,  0.0014,
          0.0017,  0.0015],
        [ 0.0018, -0.0141,  0.0017,  0.0014,  0.0015,  0.0015,  0.0016,  0.0016,
          0.0016,  0.0015],
        [ 0.0020,  0.0016, -0.0140,  0.0013,  0.0014,  0.0014,  0.0015,  0.0016,
          0.0017,  0.0014],
        [ 0.0021,  0.0015,  0.0017,  0.0014, -0.0142,  0.0014,  0.0013,  0.0015,
          0.0018,  0.0014],
        [ 0.0022,  0.0015,  0.0019,  0.0013,  0.0015,  0.0014, -0.0142,  0.0015,
          0.0017,  0.0014],
        [ 0.0020,  0.0015,  0.0017,  0.0013,  0.0016,  0.0014, -0.0142,  0.0015,
          0.0016,  0.0014],
        [ 0.0020,  0.0015,  0.0018, -0.0143,  0.0015,  0.0014,  0.0014,  0.0015,
          0.0016,  0.0015],
        [ 0.0019,  0.0015,  0.0017,  0.0015,  0.0015,  0.0014,  0.0015, -0.0142,
          0.0017,  0.0015],
        [ 0.0021,  0.0015,  0.0019,  0.0014,  0.0014,  0.0014,  0.0015,  0.0015,
          0.0016, -0.0143],
        [ 0.0020,  0.0014,  0.0017, -0.0142,  0.0015,  0.0015,  0.0017,  0.0015,
          0.0016,  0.0014],
        [ 0.0019,  0.0014,  0.0018, -0.0142,  0.0015,  0.0015,  0.0016,  0.0015,
          0.0017,  0.0014],
        [ 0.0019,  0.0016, -0.0139,  0.0013,  0.0013,  0.0015,  0.0014,  0.0015,
          0.0019,  0.0015],
        [ 0.0019,  0.0015,  0.0017,  0.0014, -0.0141,  0.0014,  0.0015,  0.0015,
          0.0017,  0.0014],
        [-0.0135,  0.0014,  0.0017,  0.0014,  0.0015,  0.0014,  0.0016,  0.0014,
          0.0018,  0.0013],
        [ 0.0021,  0.0016,  0.0018,  0.0013, -0.0142,  0.0014,  0.0013,  0.0015,
          0.0018,  0.0014],
        [ 0.0021,  0.0015,  0.0017,  0.0014,  0.0016, -0.0143,  0.0014,  0.0015,
          0.0016,  0.0015],
        [ 0.0021,  0.0015,  0.0017,  0.0014, -0.0142,  0.0014,  0.0014,  0.0014,
          0.0018,  0.0014],
        [ 0.0021,  0.0014,  0.0016, -0.0142,  0.0016,  0.0014,  0.0014,  0.0015,
          0.0017,  0.0014],
        [ 0.0020,  0.0015,  0.0017,  0.0015, -0.0142,  0.0014,  0.0015,  0.0015,
          0.0016,  0.0014],
        [-0.0135,  0.0015,  0.0016,  0.0014,  0.0015,  0.0013,  0.0015,  0.0015,
          0.0016,  0.0014],
        [ 0.0020,  0.0015,  0.0017, -0.0142,  0.0014,  0.0015,  0.0015,  0.0015,
          0.0017,  0.0015],
        [ 0.0020,  0.0015,  0.0017,  0.0014,  0.0016, -0.0143,  0.0015,  0.0015,
          0.0017,  0.0015],
        [-0.0133,  0.0016,  0.0016,  0.0013,  0.0014,  0.0014,  0.0014,  0.0015,
          0.0018,  0.0013],
        [ 0.0020,  0.0015, -0.0139,  0.0012,  0.0014,  0.0015,  0.0015,  0.0016,
          0.0017,  0.0014],
        [ 0.0020,  0.0014,  0.0017,  0.0014,  0.0015,  0.0014,  0.0015,  0.0015,
         -0.0140,  0.0015],
        [ 0.0022,  0.0016, -0.0140,  0.0013,  0.0015,  0.0014,  0.0015,  0.0015,
          0.0017,  0.0014],
        [ 0.0021,  0.0015,  0.0017, -0.0143,  0.0016,  0.0014,  0.0015,  0.0015,
          0.0016,  0.0014],
        [ 0.0020,  0.0015,  0.0018,  0.0014,  0.0015,  0.0014,  0.0016,  0.0015,
          0.0015, -0.0142],
        [ 0.0019,  0.0015,  0.0018,  0.0015,  0.0015,  0.0015,  0.0014,  0.0015,
         -0.0140,  0.0014],
        [-0.0136,  0.0014,  0.0016,  0.0014,  0.0017,  0.0014,  0.0015,  0.0015,
          0.0017,  0.0014],
        [ 0.0022,  0.0015,  0.0017, -0.0143,  0.0014,  0.0014,  0.0014,  0.0015,
          0.0018,  0.0014],
        [ 0.0019,  0.0014,  0.0016, -0.0141,  0.0016,  0.0015,  0.0015,  0.0015,
          0.0017,  0.0015],
        [ 0.0019, -0.0141,  0.0017,  0.0014,  0.0015,  0.0014,  0.0015,  0.0015,
          0.0017,  0.0015],
        [ 0.0018, -0.0141,  0.0017,  0.0014,  0.0015,  0.0014,  0.0015,  0.0014,
          0.0018,  0.0015],
        [ 0.0020,  0.0015,  0.0018,  0.0013,  0.0016,  0.0013, -0.0141,  0.0014,
          0.0017,  0.0014],
        [ 0.0021,  0.0015,  0.0017,  0.0014,  0.0015,  0.0015,  0.0015,  0.0014,
          0.0017, -0.0142],
        [ 0.0022,  0.0015,  0.0017, -0.0143,  0.0015,  0.0013,  0.0015,  0.0014,
          0.0017,  0.0014],
        [ 0.0018,  0.0015,  0.0017,  0.0016,  0.0015,  0.0014,  0.0015, -0.0141,
          0.0017,  0.0015],
        [ 0.0022,  0.0016,  0.0017,  0.0013,  0.0014,  0.0014, -0.0143,  0.0015,
          0.0018,  0.0014],
        [ 0.0021,  0.0015,  0.0017,  0.0015,  0.0015,  0.0014,  0.0015,  0.0015,
          0.0016, -0.0142],
        [-0.0135,  0.0014,  0.0016,  0.0014,  0.0016,  0.0014,  0.0015,  0.0014,
          0.0017,  0.0015],
        [ 0.0019,  0.0015,  0.0017,  0.0014,  0.0015, -0.0142,  0.0015,  0.0015,
          0.0017,  0.0015],
        [ 0.0020,  0.0014,  0.0018,  0.0015,  0.0015,  0.0014,  0.0015,  0.0015,
          0.0016, -0.0142],
        [ 0.0020,  0.0015,  0.0017,  0.0014,  0.0016, -0.0142,  0.0014,  0.0015,
          0.0017,  0.0015],
        [ 0.0020,  0.0014,  0.0017, -0.0142,  0.0015,  0.0014,  0.0015,  0.0015,
          0.0017,  0.0015],
        [ 0.0021,  0.0015,  0.0017,  0.0015,  0.0015,  0.0014,  0.0014,  0.0015,
          0.0017, -0.0142],
        [ 0.0020,  0.0016,  0.0017,  0.0013,  0.0015,  0.0014, -0.0142,  0.0015,
          0.0017,  0.0014],
        [ 0.0020,  0.0014,  0.0017,  0.0015,  0.0016,  0.0015,  0.0015,  0.0015,
          0.0016, -0.0142],
        [ 0.0020,  0.0015,  0.0017, -0.0143,  0.0015,  0.0015,  0.0015,  0.0015,
          0.0017,  0.0015],
        [ 0.0020,  0.0014,  0.0018,  0.0014, -0.0141,  0.0014,  0.0015,  0.0014,
          0.0017,  0.0014],
        [ 0.0020,  0.0016, -0.0140,  0.0014,  0.0013,  0.0014,  0.0015,  0.0015,
          0.0018,  0.0014],
        [ 0.0021,  0.0015,  0.0018,  0.0014, -0.0141,  0.0014,  0.0015,  0.0015,
          0.0017,  0.0014],
        [ 0.0020,  0.0014,  0.0018, -0.0142,  0.0016,  0.0014,  0.0015,  0.0014,
          0.0017,  0.0014],
        [ 0.0021,  0.0015,  0.0017,  0.0014,  0.0015,  0.0014,  0.0014,  0.0015,
          0.0017, -0.0142],
        [ 0.0020,  0.0015,  0.0018,  0.0015,  0.0015,  0.0014,  0.0015,  0.0016,
         -0.0140,  0.0014],
        [ 0.0018,  0.0015,  0.0016,  0.0015,  0.0016,  0.0015,  0.0017, -0.0142,
          0.0015,  0.0014],
        [ 0.0020,  0.0016,  0.0018,  0.0013,  0.0015,  0.0014, -0.0142,  0.0015,
          0.0017,  0.0014],
        [ 0.0020,  0.0015, -0.0140,  0.0014,  0.0014,  0.0014,  0.0015,  0.0015,
          0.0018,  0.0015],
        [ 0.0019, -0.0141,  0.0017,  0.0014,  0.0015,  0.0014,  0.0015,  0.0015,
          0.0017,  0.0015],
        [ 0.0020,  0.0014,  0.0017,  0.0014, -0.0141,  0.0014,  0.0015,  0.0015,
          0.0016,  0.0015],
        [ 0.0021,  0.0015, -0.0139,  0.0013,  0.0013,  0.0014,  0.0015,  0.0016,
          0.0019,  0.0013],
        [ 0.0020,  0.0015,  0.0017,  0.0014, -0.0142,  0.0014,  0.0015,  0.0014,
          0.0016,  0.0015],
        [ 0.0019,  0.0015, -0.0139,  0.0014,  0.0014,  0.0015,  0.0016,  0.0015,
          0.0018,  0.0015],
        [ 0.0018, -0.0142,  0.0016,  0.0014,  0.0015,  0.0015,  0.0016,  0.0016,
          0.0017,  0.0015]])
2024-11-30 13:26:40,019 - INFO - reading batch[180] client 4
2024-11-30 13:26:40,046 - INFO - reading batch[181] client 1
2024-11-30 13:26:40,071 - INFO - reading batch[181] client 2
2024-11-30 13:26:40,096 - INFO - reading batch[181] client 3
2024-11-30 13:26:40,124 - INFO - reading batch[181] client 4
2024-11-30 13:26:40,148 - INFO - reading batch[182] client 1
2024-11-30 13:26:40,172 - INFO - reading batch[182] client 2
2024-11-30 13:26:40,187 - INFO - Final partition
2024-11-30 13:26:40,188 - INFO - reading batch[182] client 3
2024-11-30 13:26:40,221 - INFO - reading batch[182] client 4
2024-11-30 13:26:40,254 - INFO - reading batch[183] client 1
2024-11-30 13:26:40,279 - INFO - reading batch[183] client 2
2024-11-30 13:26:40,295 - INFO - reading batch[183] client 3
2024-11-30 13:26:40,310 - INFO - reading batch[183] client 4
2024-11-30 13:26:40,332 - INFO - reading batch[184] client 1
2024-11-30 13:26:40,350 - INFO - reading batch[184] client 2
2024-11-30 13:26:40,372 - INFO - reading batch[184] client 3
2024-11-30 13:26:40,399 - INFO - reading batch[184] client 4
2024-11-30 13:26:40,424 - INFO - reading batch[185] client 1
2024-11-30 13:26:40,444 - INFO - reading batch[185] client 2
2024-11-30 13:26:40,458 - ERROR - backward on partition 3
2024-11-30 13:26:40,461 - CRITICAL - calculate backward $3 on client3
2024-11-30 13:26:40,469 - CRITICAL - new gradient:tensor([[[[ 2.0011e-04,  1.1837e-04, -6.2337e-05, -1.3707e-04],
          [ 2.2872e-04, -1.2276e-04,  4.3597e-05,  7.8675e-05],
          [-3.9539e-05, -1.7700e-05,  7.7410e-05,  2.8513e-04],
          [-3.0598e-06,  3.6571e-05, -2.1749e-04, -7.5378e-05]],

         [[-1.5036e-04,  2.6100e-04,  3.6681e-05, -1.5192e-04],
          [-1.3009e-04, -8.6202e-05,  4.3155e-05,  2.0057e-04],
          [ 1.9516e-04,  1.8830e-04,  8.6850e-06,  1.6904e-05],
          [ 2.1619e-04,  6.2853e-06,  9.1603e-05,  8.9266e-05]],

         [[-3.0378e-05, -4.4211e-05, -6.7906e-05, -9.9406e-05],
          [ 5.6537e-05, -6.5837e-05,  2.1499e-04,  5.9630e-05],
          [-2.3433e-04,  1.3487e-04,  2.3539e-05,  4.1840e-05],
          [-5.1740e-05,  5.4064e-05, -6.0836e-05,  2.3296e-04]],

         ...,

         [[-4.4867e-05,  5.7810e-05, -8.9092e-06, -1.3253e-04],
          [-9.6073e-05,  7.9006e-05,  7.2137e-05,  3.9931e-05],
          [-1.8878e-04,  9.9351e-05,  9.8571e-05,  5.1517e-05],
          [-7.7538e-05, -4.7040e-05, -9.0535e-05,  7.0139e-05]],

         [[ 1.3482e-04,  2.1718e-06,  8.7619e-05,  9.6358e-05],
          [ 2.3077e-04,  3.0609e-04, -8.1283e-05, -1.3451e-04],
          [-1.1974e-05,  6.8618e-05, -8.0854e-05, -1.6889e-04],
          [ 2.3491e-04,  5.1771e-05,  5.1921e-05,  1.0131e-04]],

         [[-1.1679e-04,  5.5948e-05, -1.1004e-04,  9.7209e-05],
          [-1.0155e-04, -1.4632e-04, -2.6076e-05, -3.1435e-04],
          [-1.5119e-04, -8.4440e-06,  4.1786e-05,  7.7503e-05],
          [-4.9403e-05,  1.4151e-04, -5.1221e-05, -9.2151e-05]]],


        [[[-1.2851e-05,  3.7019e-04, -1.5294e-04,  1.4391e-04],
          [-7.0499e-05, -5.3014e-05,  9.8149e-05,  7.0406e-05],
          [-1.2976e-04,  1.5041e-04,  6.2974e-05, -1.0084e-05],
          [ 8.1786e-06,  2.2190e-04,  1.7158e-04,  8.2790e-05]],

         [[-8.4576e-05,  2.0054e-04,  3.3897e-05, -4.4230e-05],
          [-1.9032e-04,  5.1994e-05,  1.0622e-04,  8.0130e-06],
          [ 1.4741e-04,  1.3352e-04,  9.1550e-05,  1.2134e-04],
          [-8.7491e-05, -1.8978e-04,  3.3056e-05,  8.9480e-05]],

         [[ 1.2905e-04,  1.5373e-04, -2.0414e-05,  1.5595e-04],
          [-3.9081e-05, -1.4135e-04, -1.6107e-04,  4.2074e-05],
          [-2.5125e-05,  8.5387e-05,  5.0337e-05,  2.2728e-04],
          [-1.6417e-05,  4.6928e-05,  8.4885e-05, -1.1858e-05]],

         ...,

         [[-1.0020e-04,  1.6168e-05, -8.1364e-05, -1.0969e-04],
          [ 1.6693e-04,  3.5198e-05, -7.4407e-06,  2.8438e-05],
          [ 8.8800e-05,  1.4082e-04, -4.6791e-05, -7.3077e-05],
          [ 1.0605e-04, -3.2275e-05, -1.3730e-04, -4.9508e-05]],

         [[ 2.0884e-05, -4.7631e-05,  2.7634e-05,  1.3143e-04],
          [ 6.8282e-05,  7.9523e-05, -6.2700e-06,  5.6235e-05],
          [ 1.8765e-04,  1.6600e-05, -4.1122e-06, -1.7145e-04],
          [-6.5808e-05, -2.3877e-04,  4.8280e-05,  1.1230e-05]],

         [[-4.4860e-05, -1.2883e-04,  1.6746e-04,  1.3795e-04],
          [ 2.0270e-04,  6.9011e-05, -1.1957e-04,  7.4835e-05],
          [ 4.4242e-05, -1.9831e-04, -1.5247e-04, -3.3099e-05],
          [ 2.6196e-06, -1.1255e-04, -1.7461e-04,  2.7573e-05]]],


        [[[ 1.2560e-04,  5.1716e-05, -2.0045e-05, -7.1095e-05],
          [ 1.1758e-04, -1.3361e-04, -5.7945e-06,  2.7110e-05],
          [-6.2941e-05,  6.1131e-05,  4.9904e-05,  1.7940e-04],
          [ 1.6112e-04,  9.2598e-05, -1.9894e-04, -1.1508e-04]],

         [[-4.1825e-05,  2.9857e-04,  1.4114e-05,  5.3205e-06],
          [-1.2392e-04, -5.9378e-06,  4.6427e-05,  7.5947e-05],
          [ 6.5035e-05,  2.0500e-04,  5.6059e-05,  8.7141e-05],
          [ 1.9443e-04,  1.7698e-05,  1.7947e-04,  1.0156e-04]],

         [[-1.3475e-04, -1.0092e-05, -1.6121e-05,  5.2522e-06],
          [ 1.2975e-04, -3.7553e-05,  2.2605e-04,  9.9377e-05],
          [-1.4345e-04, -3.3395e-05,  6.7487e-05,  6.3799e-05],
          [-1.3042e-04,  1.3491e-04, -1.6854e-05,  1.5582e-04]],

         ...,

         [[-7.2956e-06,  7.6883e-05,  4.2161e-05, -1.4142e-05],
          [-6.5878e-05,  6.9257e-05,  1.0321e-04,  2.8465e-05],
          [-7.8220e-05, -1.7684e-06, -8.9308e-06, -1.1141e-05],
          [-6.1468e-05, -1.6530e-06, -2.6874e-05,  3.8292e-05]],

         [[ 8.1577e-05,  2.7017e-05,  6.5837e-05,  8.2837e-05],
          [ 2.5958e-04,  3.0107e-04,  2.5895e-05, -2.0748e-04],
          [-1.8617e-05,  6.0588e-05, -4.6116e-05, -2.3214e-04],
          [ 2.1237e-04, -1.1313e-04,  5.5907e-05,  1.3376e-04]],

         [[-1.8259e-04,  1.3368e-04, -9.2919e-05, -5.0591e-06],
          [-3.3823e-05, -5.5760e-05,  1.2360e-05, -3.0834e-04],
          [-1.4503e-04,  1.0529e-04,  1.9953e-04,  9.3878e-05],
          [-8.2786e-05,  2.5767e-04, -1.3468e-04, -2.2363e-04]]],


        ...,


        [[[-2.5923e-04,  1.3012e-04,  1.4367e-04,  2.8103e-05],
          [ 4.4905e-05,  1.1453e-04, -1.4723e-04, -6.8821e-05],
          [-4.2430e-05, -6.9935e-05, -1.2280e-04, -8.6329e-05],
          [ 1.5519e-04, -1.0479e-05, -7.0044e-06,  1.4180e-04]],

         [[-1.1226e-04, -1.2364e-05, -2.8404e-04,  8.4650e-05],
          [ 1.6610e-04, -1.0200e-04,  1.6223e-04,  1.3601e-04],
          [-1.3850e-04, -7.5069e-05,  2.5287e-04, -3.8006e-05],
          [ 3.3226e-06,  2.4252e-05,  1.2163e-04,  1.6473e-04]],

         [[-1.5710e-04,  7.3973e-05, -2.6324e-05, -1.0896e-04],
          [-2.3483e-04,  3.4798e-06, -4.8683e-05, -2.6264e-05],
          [ 2.4247e-04,  4.8229e-06, -6.2610e-05, -1.6618e-04],
          [-4.9698e-05,  1.0354e-05, -4.1129e-06, -1.6073e-04]],

         ...,

         [[-6.1521e-05, -3.3736e-07,  4.4011e-05, -3.2814e-05],
          [ 1.1655e-04, -4.7682e-05, -9.0596e-05, -3.4588e-04],
          [ 2.7912e-04, -9.3097e-05, -8.2780e-05, -2.6579e-05],
          [ 1.2696e-04, -6.7698e-05,  3.3030e-05,  5.1621e-05]],

         [[ 1.3592e-05,  3.3126e-05,  5.2305e-05, -2.0149e-05],
          [ 2.0664e-05,  9.0866e-05,  2.0490e-04,  1.1102e-04],
          [-6.3132e-05,  9.5667e-06, -2.3681e-04,  1.6452e-04],
          [ 5.9798e-05,  1.0718e-04,  1.5737e-04, -1.1822e-04]],

         [[ 1.6568e-04,  1.1915e-04,  5.2794e-05, -1.3175e-04],
          [-1.2085e-05,  5.2545e-05,  1.1114e-04,  4.1317e-05],
          [ 9.4008e-05,  1.7815e-04, -2.7846e-05, -1.1186e-04],
          [-4.8620e-05,  2.0291e-04,  1.2938e-05, -1.0027e-04]]],


        [[[-5.3849e-05,  2.7962e-05,  1.9803e-04, -2.5041e-06],
          [-3.2483e-04, -1.1905e-04, -1.1413e-05,  6.1181e-05],
          [ 1.1710e-04, -4.9259e-05, -3.9996e-05, -9.7456e-06],
          [-2.6006e-04, -8.0815e-05, -5.0320e-05, -7.6884e-05]],

         [[-3.3703e-05,  1.9514e-05, -4.2881e-06, -2.6460e-04],
          [-3.4596e-05, -1.4399e-04, -7.2011e-05, -2.1975e-04],
          [ 1.0068e-05, -4.2923e-05,  2.5110e-04, -6.2808e-05],
          [ 1.4571e-04,  8.8000e-05, -6.3562e-05, -6.4832e-05]],

         [[ 1.2643e-05,  6.3523e-05, -5.7054e-05, -6.6407e-05],
          [-2.0090e-04, -8.7585e-05,  7.2086e-05, -2.5435e-05],
          [ 1.5122e-04,  1.0152e-04,  1.6754e-04, -1.5787e-04],
          [-4.8822e-06,  9.8929e-05, -2.1480e-04,  6.6804e-05]],

         ...,

         [[-1.0235e-05,  3.8951e-05, -8.9506e-05,  1.4669e-04],
          [-1.3380e-04,  1.9848e-06, -5.3395e-05, -3.8990e-05],
          [-8.8655e-05,  1.3699e-04,  2.3924e-06,  1.7280e-04],
          [-1.0790e-04, -1.3213e-04,  5.3507e-05,  6.0460e-05]],

         [[ 7.5608e-05, -1.5963e-04, -1.5192e-04,  6.7048e-05],
          [ 4.6416e-05,  1.6894e-04,  4.0660e-05,  5.1862e-05],
          [ 1.0058e-04,  4.7851e-05,  1.3056e-04, -6.0794e-05],
          [-2.6874e-04, -1.0394e-04, -1.8367e-05, -1.2974e-04]],

         [[-7.4620e-05,  2.7155e-04, -2.7845e-05,  7.2889e-06],
          [ 1.5777e-04, -3.4679e-05,  8.8266e-05,  4.8361e-05],
          [-5.1187e-05,  1.7627e-05,  2.5638e-04,  2.2889e-04],
          [ 1.0201e-05, -5.9393e-05,  2.9063e-05,  2.0382e-05]]],


        [[[ 1.3622e-04,  7.4646e-05, -4.3567e-05,  7.2658e-05],
          [-1.7118e-04,  4.8952e-05, -5.4076e-05, -2.7156e-04],
          [-9.3221e-05, -1.3719e-04, -1.8181e-04,  1.5806e-04],
          [ 1.8281e-04,  4.0081e-05, -2.3676e-04,  1.6834e-05]],

         [[ 1.0373e-04,  9.0509e-07, -1.9337e-05,  9.4587e-05],
          [ 2.0293e-04,  8.3727e-05,  2.0920e-05, -1.3212e-04],
          [ 1.9360e-04, -6.5525e-05, -6.9017e-05, -1.4143e-05],
          [ 1.0237e-05, -3.7412e-05, -6.5353e-05, -1.2246e-04]],

         [[ 6.3989e-05, -6.6590e-05, -9.6833e-05,  1.6558e-04],
          [-1.2505e-04,  6.2934e-05, -6.2964e-05,  2.9571e-05],
          [-9.7676e-05, -6.9517e-05, -1.1758e-04,  8.8215e-05],
          [-1.0134e-04, -5.1528e-05,  1.1013e-04, -1.1526e-05]],

         ...,

         [[-1.9642e-05, -5.4145e-05, -1.2288e-04, -1.0015e-05],
          [ 3.0971e-05,  4.5599e-05, -6.7621e-06, -1.1319e-04],
          [ 1.3634e-04,  6.4230e-05,  1.7404e-05, -7.0652e-05],
          [-9.9759e-05,  7.9630e-06, -6.1624e-05,  1.0312e-05]],

         [[ 3.3106e-05,  1.1586e-04, -1.0632e-04, -6.7617e-05],
          [-8.9242e-05, -1.2883e-06,  2.0575e-05, -1.2730e-04],
          [-9.8586e-05,  1.1145e-04, -1.6203e-04,  1.6681e-04],
          [-5.5388e-05,  2.4237e-05, -6.1100e-06, -2.6811e-05]],

         [[-3.4312e-06, -2.6298e-05,  1.7102e-04, -1.2361e-04],
          [ 4.0637e-05, -1.0882e-04,  6.3056e-05,  5.2138e-05],
          [ 1.0129e-04,  4.5194e-05,  3.7940e-05,  5.2274e-05],
          [-1.5332e-05,  1.0949e-04,  1.5468e-04,  2.6385e-05]]]]) 
 old gradient:tensor([[-4.8574e-04,  4.0429e-04,  3.5367e-04,  ...,  3.7958e-04,
          6.1086e-04,  1.0408e-04],
        [-4.7963e-04, -6.8125e-04, -4.0669e-04,  ..., -1.8064e-04,
          2.8478e-04,  5.6524e-04],
        [-4.5456e-04,  4.1196e-04,  3.3262e-04,  ...,  3.7378e-04,
          5.9172e-04,  7.6301e-05],
        ...,
        [-2.4014e-04,  2.4278e-04, -3.8958e-04,  ..., -2.2291e-04,
          2.1304e-04, -1.6695e-05],
        [ 6.0655e-04,  1.6865e-04, -1.8059e-04,  ...,  4.7431e-05,
          2.1588e-04, -3.8276e-04],
        [-7.3865e-05, -3.5555e-04,  2.0211e-05,  ..., -1.9268e-04,
          5.0002e-04,  2.3108e-04]])
2024-11-30 13:26:40,470 - INFO - reading batch[185] client 3
2024-11-30 13:26:40,492 - INFO - reading batch[185] client 4
2024-11-30 13:26:40,524 - INFO - reading batch[186] client 1
2024-11-30 13:26:40,543 - INFO - reading batch[186] client 2
2024-11-30 13:26:40,564 - INFO - reading batch[186] client 3
2024-11-30 13:26:40,579 - ERROR - backward on partition 4
2024-11-30 13:26:40,580 - CRITICAL - calculate backward $4 on client4
2024-11-30 13:26:40,585 - CRITICAL - new gradient:tensor([[ 6.1683e-04,  1.8000e-04, -1.7044e-04,  ...,  5.3657e-05,
          2.0823e-04, -3.8880e-04],
        [ 4.6111e-04,  3.4025e-04, -2.6007e-04,  ...,  1.8576e-04,
         -6.6368e-04, -4.3842e-04],
        [-2.5746e-04,  2.4208e-04, -3.7751e-04,  ..., -2.2675e-04,
          2.2563e-04,  3.3011e-06],
        ...,
        [ 4.6051e-04,  3.4324e-04, -2.5649e-04,  ...,  1.9082e-04,
         -6.6316e-04, -4.3863e-04],
        [-1.2847e-04,  3.9967e-04,  5.4114e-04,  ...,  2.3191e-04,
          3.3656e-04,  3.7451e-04],
        [-1.4701e-04,  1.0756e-04,  2.2168e-04,  ..., -7.2774e-04,
         -4.4532e-04,  6.2333e-04]]) 
 old gradient:tensor([[ 0.0019, -0.0142,  0.0016,  0.0013,  0.0014,  0.0015,  0.0015,  0.0015,
          0.0018,  0.0016],
        [ 0.0022,  0.0015, -0.0138,  0.0012,  0.0014,  0.0014,  0.0014,  0.0015,
          0.0018,  0.0014],
        [ 0.0021,  0.0015,  0.0019,  0.0013,  0.0013,  0.0013,  0.0014,  0.0015,
         -0.0139,  0.0015],
        [ 0.0019,  0.0014,  0.0017,  0.0014,  0.0015,  0.0015,  0.0015,  0.0015,
         -0.0139,  0.0015],
        [ 0.0022,  0.0014,  0.0017,  0.0013,  0.0016,  0.0013, -0.0143,  0.0014,
          0.0018,  0.0015],
        [ 0.0019, -0.0142,  0.0017,  0.0014,  0.0016,  0.0015,  0.0015,  0.0014,
          0.0019,  0.0015],
        [ 0.0020,  0.0014,  0.0017, -0.0142,  0.0016,  0.0014,  0.0015,  0.0015,
          0.0017,  0.0014],
        [ 0.0020,  0.0014,  0.0019,  0.0014,  0.0016,  0.0014, -0.0142,  0.0014,
          0.0017,  0.0015],
        [ 0.0018,  0.0015,  0.0017,  0.0015,  0.0015,  0.0015,  0.0015, -0.0141,
          0.0016,  0.0015],
        [ 0.0021,  0.0014, -0.0137,  0.0012,  0.0015,  0.0014,  0.0013,  0.0015,
          0.0018,  0.0015],
        [ 0.0022,  0.0015,  0.0018,  0.0012, -0.0142,  0.0014,  0.0013,  0.0015,
          0.0017,  0.0015],
        [ 0.0019,  0.0014,  0.0017,  0.0014,  0.0016, -0.0141,  0.0014,  0.0014,
          0.0018,  0.0015],
        [ 0.0020,  0.0015,  0.0017, -0.0142,  0.0014,  0.0015,  0.0015,  0.0014,
          0.0017,  0.0015],
        [ 0.0019, -0.0143,  0.0018,  0.0014,  0.0015,  0.0014,  0.0014,  0.0013,
          0.0019,  0.0015],
        [ 0.0023,  0.0015,  0.0018,  0.0013,  0.0016,  0.0013, -0.0142,  0.0014,
          0.0018,  0.0014],
        [ 0.0024,  0.0015,  0.0017,  0.0013,  0.0015,  0.0013, -0.0143,  0.0014,
          0.0019,  0.0015],
        [ 0.0022,  0.0013,  0.0018, -0.0143,  0.0016,  0.0013,  0.0015,  0.0015,
          0.0017,  0.0014],
        [ 0.0022,  0.0016,  0.0015,  0.0013,  0.0015,  0.0013, -0.0142,  0.0015,
          0.0018,  0.0015],
        [ 0.0022,  0.0014,  0.0017, -0.0142,  0.0015,  0.0014,  0.0013,  0.0015,
          0.0017,  0.0015],
        [ 0.0019, -0.0142,  0.0017,  0.0013,  0.0015,  0.0014,  0.0015,  0.0014,
          0.0019,  0.0015],
        [ 0.0020,  0.0015,  0.0017, -0.0143,  0.0015,  0.0014,  0.0015,  0.0015,
          0.0016,  0.0015],
        [ 0.0020,  0.0015,  0.0017,  0.0013, -0.0140,  0.0015,  0.0015,  0.0014,
          0.0017,  0.0015],
        [ 0.0019,  0.0014,  0.0017,  0.0014,  0.0014,  0.0015,  0.0015, -0.0141,
          0.0018,  0.0015],
        [ 0.0020,  0.0015,  0.0018,  0.0013,  0.0015,  0.0014, -0.0142,  0.0015,
          0.0017,  0.0015],
        [ 0.0019,  0.0015,  0.0017,  0.0014,  0.0015,  0.0015,  0.0015, -0.0142,
          0.0016,  0.0016],
        [ 0.0019,  0.0015,  0.0018,  0.0015,  0.0015,  0.0015,  0.0015, -0.0142,
          0.0017,  0.0015],
        [ 0.0019,  0.0015,  0.0018,  0.0014, -0.0140,  0.0015,  0.0014,  0.0014,
          0.0016,  0.0014],
        [ 0.0020,  0.0015,  0.0018,  0.0013,  0.0016,  0.0014, -0.0142,  0.0014,
          0.0017,  0.0014],
        [ 0.0020,  0.0014,  0.0017,  0.0014,  0.0016, -0.0142,  0.0015,  0.0014,
          0.0017,  0.0015],
        [ 0.0018,  0.0015,  0.0017,  0.0015,  0.0015,  0.0015,  0.0015, -0.0142,
          0.0017,  0.0015],
        [ 0.0021,  0.0015, -0.0139,  0.0012,  0.0014,  0.0015,  0.0014,  0.0015,
          0.0019,  0.0014],
        [ 0.0020,  0.0015,  0.0017,  0.0014,  0.0016, -0.0142,  0.0015,  0.0015,
          0.0016,  0.0014],
        [ 0.0023,  0.0015, -0.0138,  0.0012,  0.0014,  0.0013,  0.0015,  0.0015,
          0.0018,  0.0014],
        [ 0.0023,  0.0013,  0.0017, -0.0144,  0.0015,  0.0013,  0.0015,  0.0015,
          0.0017,  0.0015],
        [ 0.0020,  0.0016,  0.0018,  0.0013,  0.0014,  0.0015,  0.0015, -0.0141,
          0.0016,  0.0014],
        [ 0.0020,  0.0015,  0.0018,  0.0014, -0.0141,  0.0015,  0.0014,  0.0015,
          0.0017,  0.0014],
        [ 0.0021,  0.0014,  0.0018,  0.0013, -0.0141,  0.0014,  0.0014,  0.0014,
          0.0017,  0.0015],
        [ 0.0022,  0.0014,  0.0017,  0.0013,  0.0015,  0.0014,  0.0013,  0.0014,
         -0.0138,  0.0014],
        [ 0.0021,  0.0015,  0.0018,  0.0014, -0.0141,  0.0015,  0.0014,  0.0015,
          0.0017,  0.0014],
        [ 0.0019,  0.0015,  0.0018,  0.0014,  0.0016,  0.0014,  0.0015, -0.0142,
          0.0017,  0.0015],
        [ 0.0019,  0.0015,  0.0017,  0.0014,  0.0016, -0.0142,  0.0014,  0.0014,
          0.0017,  0.0015],
        [ 0.0023,  0.0015,  0.0018,  0.0012, -0.0142,  0.0014,  0.0013,  0.0015,
          0.0017,  0.0014],
        [ 0.0018,  0.0015,  0.0016,  0.0015,  0.0016,  0.0016,  0.0015, -0.0142,
          0.0015,  0.0015],
        [ 0.0019,  0.0015,  0.0018,  0.0013,  0.0015,  0.0015, -0.0142,  0.0015,
          0.0017,  0.0015],
        [ 0.0023,  0.0015, -0.0139,  0.0013,  0.0015,  0.0013,  0.0015,  0.0015,
          0.0018,  0.0014],
        [ 0.0020,  0.0014,  0.0016, -0.0142,  0.0016,  0.0014,  0.0015,  0.0015,
          0.0017,  0.0015],
        [ 0.0021,  0.0015,  0.0017,  0.0013,  0.0015, -0.0142,  0.0013,  0.0014,
          0.0018,  0.0016],
        [-0.0134,  0.0013,  0.0016,  0.0014,  0.0016,  0.0013,  0.0014,  0.0014,
          0.0018,  0.0014],
        [ 0.0019, -0.0142,  0.0017,  0.0014,  0.0015,  0.0015,  0.0015,  0.0015,
          0.0017,  0.0016],
        [ 0.0018, -0.0142,  0.0017,  0.0014,  0.0015,  0.0016,  0.0016,  0.0015,
          0.0016,  0.0016],
        [-0.0134,  0.0014,  0.0017,  0.0014,  0.0016,  0.0013,  0.0015,  0.0014,
          0.0017,  0.0014],
        [ 0.0020,  0.0014,  0.0018,  0.0014,  0.0016,  0.0014,  0.0014,  0.0014,
          0.0017, -0.0141],
        [ 0.0018,  0.0015,  0.0016,  0.0014,  0.0016, -0.0142,  0.0015,  0.0015,
          0.0017,  0.0016],
        [ 0.0020,  0.0014,  0.0016, -0.0143,  0.0015,  0.0016,  0.0015,  0.0014,
          0.0018,  0.0015],
        [-0.0135,  0.0014,  0.0016,  0.0014,  0.0016,  0.0013,  0.0016,  0.0013,
          0.0018,  0.0015],
        [ 0.0021,  0.0016,  0.0017,  0.0013,  0.0015,  0.0014, -0.0142,  0.0014,
          0.0018,  0.0015],
        [ 0.0019,  0.0015, -0.0139,  0.0013,  0.0015,  0.0014,  0.0015,  0.0015,
          0.0018,  0.0015],
        [ 0.0018,  0.0015,  0.0017, -0.0142,  0.0016,  0.0015,  0.0015,  0.0015,
          0.0017,  0.0015],
        [ 0.0018,  0.0015,  0.0017,  0.0014,  0.0016, -0.0142,  0.0015,  0.0014,
          0.0017,  0.0016],
        [ 0.0020,  0.0014,  0.0018,  0.0014,  0.0015,  0.0015,  0.0014,  0.0014,
          0.0017, -0.0141],
        [ 0.0022,  0.0015,  0.0016, -0.0143,  0.0015,  0.0014,  0.0014,  0.0014,
          0.0017,  0.0015],
        [ 0.0022,  0.0015, -0.0139,  0.0013,  0.0013,  0.0014,  0.0014,  0.0015,
          0.0018,  0.0014],
        [ 0.0021,  0.0015,  0.0017,  0.0013, -0.0142,  0.0015,  0.0013,  0.0014,
          0.0018,  0.0015],
        [ 0.0020,  0.0015,  0.0016, -0.0142,  0.0015,  0.0015,  0.0014,  0.0015,
          0.0017,  0.0015]])
2024-11-30 13:26:40,586 - INFO - reading batch[186] client 4
2024-11-30 13:26:40,610 - INFO - reading batch[187] client 1
2024-11-30 13:26:40,634 - INFO - reading batch[187] client 2
2024-11-30 13:26:40,659 - INFO - reading batch[187] client 3
2024-11-30 13:26:40,680 - INFO - reading batch[187] client 4
2024-11-30 13:26:40,711 - INFO - reading batch[188] client 1
2024-11-30 13:26:40,738 - INFO - reading batch[188] client 2
2024-11-30 13:26:40,772 - INFO - reading batch[188] client 3
2024-11-30 13:26:40,793 - INFO - reading batch[188] client 4
2024-11-30 13:26:40,876 - INFO - reading batch[189] client 1
2024-11-30 13:26:40,917 - INFO - reading batch[189] client 2
2024-11-30 13:26:40,931 - INFO - reading batch[189] client 3
2024-11-30 13:26:40,958 - INFO - reading batch[189] client 4
2024-11-30 13:26:40,989 - INFO - reading batch[190] client 1
2024-11-30 13:26:41,011 - INFO - reading batch[190] client 2
2024-11-30 13:26:41,036 - INFO - reading batch[190] client 3
2024-11-30 13:26:41,050 - INFO - Final partition
2024-11-30 13:26:41,051 - INFO - reading batch[190] client 4
2024-11-30 13:26:41,081 - INFO - reading batch[191] client 1
2024-11-30 13:26:41,113 - INFO - reading batch[191] client 2
2024-11-30 13:26:41,130 - INFO - reading batch[191] client 3
2024-11-30 13:26:41,156 - INFO - reading batch[191] client 4
2024-11-30 13:26:41,181 - INFO - reading batch[192] client 1
2024-11-30 13:26:41,199 - INFO - reading batch[192] client 2
2024-11-30 13:26:41,224 - INFO - reading batch[192] client 3
2024-11-30 13:26:41,252 - INFO - reading batch[192] client 4
2024-11-30 13:26:41,275 - INFO - reading batch[193] client 1
2024-11-30 13:26:41,296 - INFO - reading batch[193] client 2
2024-11-30 13:26:41,310 - INFO - reading batch[193] client 3
2024-11-30 13:26:41,323 - INFO - reading batch[193] client 4
2024-11-30 13:26:41,348 - INFO - reading batch[194] client 1
2024-11-30 13:26:41,369 - INFO - reading batch[194] client 2
2024-11-30 13:26:41,395 - INFO - reading batch[194] client 3
2024-11-30 13:26:41,425 - INFO - reading batch[194] client 4
2024-11-30 13:26:41,438 - INFO - Final partition
2024-11-30 13:26:41,438 - INFO - reading batch[195] client 1
2024-11-30 13:26:41,459 - INFO - reading batch[195] client 2
2024-11-30 13:26:41,481 - INFO - reading batch[195] client 3
2024-11-30 13:26:41,510 - INFO - reading batch[195] client 4
2024-11-30 13:26:41,536 - INFO - reading batch[196] client 1
2024-11-30 13:26:41,559 - INFO - reading batch[196] client 2
2024-11-30 13:26:41,587 - INFO - reading batch[196] client 3
2024-11-30 13:26:41,615 - INFO - reading batch[196] client 4
2024-11-30 13:26:41,637 - INFO - reading batch[197] client 1
2024-11-30 13:26:41,657 - INFO - reading batch[197] client 2
2024-11-30 13:26:41,684 - INFO - reading batch[197] client 3
2024-11-30 13:26:41,701 - ERROR - backward on partition 4
2024-11-30 13:26:41,702 - CRITICAL - calculate backward $4 on client4
2024-11-30 13:26:41,709 - CRITICAL - new gradient:tensor([[ 4.7318e-04,  3.4081e-04, -2.7282e-04,  ...,  1.9482e-04,
         -6.6583e-04, -4.5708e-04],
        [-1.2570e-04,  3.8694e-04,  5.2779e-04,  ...,  2.3056e-04,
          3.3651e-04,  3.6595e-04],
        [-2.4135e-04,  2.3741e-04, -4.0230e-04,  ..., -2.1883e-04,
          2.1554e-04, -2.8446e-05],
        ...,
        [-7.4310e-05, -3.6806e-04,  1.3987e-05,  ..., -1.8721e-04,
          4.9876e-04,  2.2428e-04],
        [ 6.1760e-04,  1.7156e-04, -1.8035e-04,  ...,  6.0088e-05,
          2.0127e-04, -4.0044e-04],
        [ 6.1248e-04,  1.6557e-04, -1.8019e-04,  ...,  5.5330e-05,
          2.1398e-04, -3.9329e-04]]) 
 old gradient:tensor([[ 0.0021,  0.0015, -0.0139,  0.0015,  0.0014,  0.0014,  0.0016,  0.0015,
          0.0016,  0.0014],
        [ 0.0019,  0.0015,  0.0019,  0.0015, -0.0141,  0.0014,  0.0015,  0.0015,
          0.0016,  0.0014],
        [ 0.0020,  0.0014,  0.0017,  0.0016,  0.0016,  0.0014,  0.0015,  0.0015,
         -0.0141,  0.0014],
        [ 0.0018, -0.0142,  0.0017,  0.0015,  0.0015,  0.0014,  0.0015,  0.0014,
          0.0017,  0.0015],
        [ 0.0020,  0.0015,  0.0017,  0.0015,  0.0016, -0.0143,  0.0015,  0.0016,
          0.0016,  0.0014],
        [ 0.0020,  0.0015,  0.0017,  0.0015,  0.0016, -0.0143,  0.0016,  0.0015,
          0.0015,  0.0014],
        [ 0.0022,  0.0016,  0.0017,  0.0014, -0.0142,  0.0013,  0.0015,  0.0016,
          0.0016,  0.0014],
        [ 0.0022,  0.0016,  0.0019,  0.0014,  0.0016,  0.0013, -0.0142,  0.0015,
          0.0015,  0.0014],
        [ 0.0024,  0.0016,  0.0018,  0.0014,  0.0014,  0.0012, -0.0142,  0.0016,
          0.0016,  0.0013],
        [ 0.0021,  0.0015, -0.0139,  0.0013,  0.0016,  0.0013,  0.0016,  0.0016,
          0.0015,  0.0013],
        [ 0.0022,  0.0014,  0.0016, -0.0141,  0.0016,  0.0013,  0.0016,  0.0015,
          0.0016,  0.0014],
        [ 0.0019,  0.0015,  0.0016, -0.0141,  0.0016,  0.0013,  0.0016,  0.0016,
          0.0015,  0.0014],
        [ 0.0021,  0.0015,  0.0017,  0.0014,  0.0016,  0.0013,  0.0015,  0.0016,
         -0.0141,  0.0014],
        [ 0.0022,  0.0016,  0.0017,  0.0013,  0.0016,  0.0012, -0.0141,  0.0015,
          0.0016,  0.0014],
        [ 0.0020,  0.0015,  0.0018,  0.0014, -0.0141,  0.0013,  0.0015,  0.0016,
          0.0015,  0.0014],
        [ 0.0021,  0.0016,  0.0017,  0.0015, -0.0141,  0.0013,  0.0015,  0.0015,
          0.0015,  0.0013],
        [ 0.0022,  0.0015,  0.0017, -0.0142,  0.0015,  0.0014,  0.0015,  0.0015,
          0.0015,  0.0015],
        [ 0.0022,  0.0014,  0.0017, -0.0141,  0.0015,  0.0013,  0.0015,  0.0016,
          0.0015,  0.0014],
        [ 0.0020,  0.0016,  0.0017,  0.0015,  0.0015,  0.0013,  0.0016,  0.0016,
          0.0015, -0.0141],
        [ 0.0018,  0.0015,  0.0017,  0.0014,  0.0016, -0.0142,  0.0016,  0.0016,
          0.0015,  0.0015],
        [ 0.0021,  0.0016,  0.0018,  0.0014, -0.0141,  0.0014,  0.0015,  0.0016,
          0.0015,  0.0014],
        [ 0.0020,  0.0015,  0.0017, -0.0141,  0.0016,  0.0015,  0.0015,  0.0014,
          0.0015,  0.0014],
        [ 0.0019,  0.0014,  0.0017, -0.0141,  0.0016,  0.0015,  0.0016,  0.0015,
          0.0015,  0.0014],
        [ 0.0020,  0.0015,  0.0016,  0.0015,  0.0015,  0.0013,  0.0016,  0.0016,
         -0.0140,  0.0013],
        [ 0.0021,  0.0015,  0.0017,  0.0014,  0.0016,  0.0012, -0.0141,  0.0015,
          0.0016,  0.0014],
        [ 0.0020,  0.0015,  0.0017,  0.0015,  0.0015,  0.0013,  0.0016,  0.0016,
         -0.0141,  0.0015],
        [ 0.0020,  0.0014,  0.0017,  0.0015,  0.0016,  0.0013,  0.0016,  0.0015,
         -0.0141,  0.0014],
        [ 0.0018,  0.0016,  0.0016,  0.0016,  0.0015,  0.0014,  0.0016, -0.0140,
          0.0015,  0.0014],
        [ 0.0020,  0.0015,  0.0017,  0.0015,  0.0015,  0.0013,  0.0016,  0.0016,
         -0.0140,  0.0014],
        [ 0.0019,  0.0015,  0.0018,  0.0015,  0.0017,  0.0013, -0.0141,  0.0015,
          0.0015,  0.0014],
        [ 0.0020,  0.0015,  0.0016,  0.0016,  0.0016, -0.0143,  0.0017,  0.0015,
          0.0015,  0.0014],
        [ 0.0022,  0.0014,  0.0017, -0.0142,  0.0015,  0.0013,  0.0015,  0.0016,
          0.0016,  0.0014],
        [ 0.0020,  0.0015,  0.0018,  0.0014,  0.0014, -0.0143,  0.0015,  0.0015,
          0.0018,  0.0014],
        [ 0.0020,  0.0015,  0.0017,  0.0015,  0.0015,  0.0014,  0.0016,  0.0015,
         -0.0141,  0.0014],
        [ 0.0021,  0.0014,  0.0018,  0.0016, -0.0141,  0.0013,  0.0015,  0.0015,
          0.0016,  0.0013],
        [ 0.0019,  0.0015,  0.0018,  0.0015,  0.0015,  0.0014,  0.0015, -0.0141,
          0.0016,  0.0014],
        [-0.0134,  0.0015,  0.0017,  0.0015,  0.0015,  0.0012,  0.0015,  0.0016,
          0.0016,  0.0013],
        [ 0.0020,  0.0015, -0.0139,  0.0013,  0.0014,  0.0014,  0.0015,  0.0016,
          0.0017,  0.0014],
        [ 0.0021,  0.0015,  0.0018,  0.0014,  0.0016,  0.0013, -0.0142,  0.0016,
          0.0015,  0.0014],
        [ 0.0018, -0.0142,  0.0017,  0.0014,  0.0015,  0.0015,  0.0016,  0.0015,
          0.0016,  0.0015],
        [ 0.0020,  0.0016,  0.0017,  0.0014,  0.0016,  0.0013, -0.0141,  0.0016,
          0.0016,  0.0014],
        [ 0.0018,  0.0015,  0.0016,  0.0016,  0.0015,  0.0014,  0.0016, -0.0140,
          0.0014,  0.0014],
        [ 0.0021,  0.0015,  0.0018,  0.0014,  0.0017,  0.0013, -0.0142,  0.0016,
          0.0015,  0.0013],
        [ 0.0020,  0.0014,  0.0017,  0.0016,  0.0015,  0.0013,  0.0016,  0.0015,
          0.0016, -0.0142],
        [ 0.0022,  0.0015,  0.0018,  0.0014,  0.0015,  0.0013, -0.0142,  0.0015,
          0.0016,  0.0014],
        [ 0.0020,  0.0016,  0.0018,  0.0014,  0.0015,  0.0013, -0.0142,  0.0015,
          0.0016,  0.0015],
        [ 0.0020,  0.0015,  0.0016,  0.0015,  0.0015, -0.0143,  0.0016,  0.0016,
          0.0016,  0.0015],
        [ 0.0021,  0.0015,  0.0017,  0.0015,  0.0016,  0.0013,  0.0016,  0.0015,
         -0.0141,  0.0014],
        [ 0.0021,  0.0016,  0.0018,  0.0015, -0.0141,  0.0013,  0.0014,  0.0016,
          0.0014,  0.0014],
        [ 0.0023,  0.0015,  0.0017,  0.0014,  0.0015,  0.0012, -0.0142,  0.0015,
          0.0017,  0.0014],
        [ 0.0018, -0.0141,  0.0017,  0.0015,  0.0016,  0.0014,  0.0016,  0.0014,
          0.0017,  0.0015],
        [ 0.0019,  0.0015,  0.0017,  0.0016,  0.0016,  0.0014,  0.0016, -0.0141,
          0.0015,  0.0014],
        [ 0.0019,  0.0015,  0.0017, -0.0142,  0.0015,  0.0014,  0.0017,  0.0016,
          0.0015,  0.0014],
        [ 0.0020,  0.0015,  0.0017,  0.0015,  0.0016,  0.0014,  0.0016,  0.0015,
          0.0015, -0.0142],
        [ 0.0019,  0.0014,  0.0018, -0.0141,  0.0016,  0.0013,  0.0015,  0.0015,
          0.0016,  0.0014],
        [ 0.0022,  0.0016,  0.0018,  0.0014,  0.0015,  0.0013, -0.0142,  0.0015,
          0.0015,  0.0014],
        [ 0.0021,  0.0015, -0.0138,  0.0014,  0.0014,  0.0013,  0.0016,  0.0016,
          0.0016,  0.0013],
        [ 0.0020,  0.0015,  0.0017,  0.0016,  0.0016,  0.0013,  0.0016, -0.0141,
          0.0014,  0.0014],
        [ 0.0019, -0.0142,  0.0017,  0.0015,  0.0015,  0.0014,  0.0016,  0.0015,
          0.0015,  0.0015],
        [ 0.0020,  0.0015,  0.0017,  0.0015,  0.0016,  0.0013,  0.0016,  0.0015,
          0.0016, -0.0142],
        [ 0.0018,  0.0015,  0.0017,  0.0016,  0.0016,  0.0015,  0.0016, -0.0142,
          0.0014,  0.0015],
        [ 0.0019,  0.0015,  0.0017,  0.0016,  0.0016,  0.0014,  0.0016, -0.0141,
          0.0016,  0.0014],
        [ 0.0019, -0.0142,  0.0016,  0.0015,  0.0014,  0.0015,  0.0017,  0.0016,
          0.0015,  0.0014],
        [ 0.0019, -0.0141,  0.0017,  0.0015,  0.0015,  0.0014,  0.0015,  0.0014,
          0.0017,  0.0015]])
2024-11-30 13:26:41,709 - INFO - reading batch[197] client 4
2024-11-30 13:26:41,737 - INFO - reading batch[198] client 1
2024-11-30 13:26:41,764 - INFO - reading batch[198] client 2
2024-11-30 13:26:41,782 - INFO - reading batch[198] client 3
2024-11-30 13:26:41,801 - INFO - reading batch[198] client 4
2024-11-30 13:26:41,827 - INFO - reading batch[199] client 1
2024-11-30 13:26:41,854 - INFO - reading batch[199] client 2
2024-11-30 13:26:41,879 - INFO - reading batch[199] client 3
2024-11-30 13:26:41,909 - INFO - reading batch[199] client 4
2024-11-30 13:26:41,932 - INFO - reading batch[200] client 1
2024-11-30 13:26:41,950 - INFO - reading batch[200] client 2
2024-11-30 13:26:41,967 - INFO - reading batch[200] client 3
2024-11-30 13:26:41,992 - INFO - reading batch[200] client 4
2024-11-30 13:26:42,020 - INFO - reading batch[201] client 1
2024-11-30 13:26:42,043 - INFO - reading batch[201] client 2
2024-11-30 13:26:42,065 - INFO - reading batch[201] client 3
2024-11-30 13:26:42,093 - INFO - reading batch[201] client 4
2024-11-30 13:26:42,116 - INFO - reading batch[202] client 1
2024-11-30 13:26:42,138 - INFO - reading batch[202] client 2
2024-11-30 13:26:42,170 - INFO - reading batch[202] client 3
2024-11-30 13:26:42,186 - INFO - reading batch[202] client 4
2024-11-30 13:26:42,208 - INFO - reading batch[203] client 1
2024-11-30 13:26:42,234 - INFO - reading batch[203] client 2
2024-11-30 13:26:42,254 - INFO - reading batch[203] client 3
